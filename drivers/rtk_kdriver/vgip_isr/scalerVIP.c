/***************************************************************************
                          scalerVIP.c  -  description
                             -------------------
    begin                : Mon Dec 22 2008
    copyright           : (C) 2008 by hsliao
    email                : hsliao@realtek.com
 ***************************************************************************/
//oliver-
/*
#include <linux/version.h>	// kernel version

#if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,0)
	#ifndef __KERNEL__
		#define __KERNEL__
	#endif
#endif

#include <linux/module.h>	// normal module use
#include <linux/kernel.h>	// printk()
*/


/*******************************************************************************
 * Header include
******************************************************************************/
//#include <stdio.h> /***/
//#include <stdlib.h> /***/
//#include <string.h> /***/
//#include <rtd_types.h> /***/
//#include <rtd_gpio.h> /***/
#include <asm/div64.h>

//#include <kernel/ifd/ifdemod.h>//planck add for TV AutoNR.
//#include <kernel/scaler/scalerDrv.h>
//#include <kernel/scaler/scalerInfo.h>
#include "vgip_isr/scalerVideo.h"
#include "vgip_isr/scalerVIP.h"
//#include <kernel/scaler/scalerIRQ.h>
#include "vgip_isr/scalerDI.h"
#include "vgip_isr/scalerDCC.h"
//#include <kernel/scaler/smoothtoggle.h>
#include <scalercommon/scalerDrvCommon.h>
#include <scalercommon/vipCommon.h>
#include <scalercommon/vipRPCCommon.h>
#include <scalercommon/vdcCommon.h>
//#include <VP_ScalerVOCommon.h>

#include <rbus/vdtop_reg.h>
#include <rbus/vdpq_reg.h>
#include <rbus/color_edge_smooth_reg.h>
#include <rbus/color_sharp_reg.h>
#include <rbus/color_dcc_reg.h>
#include <rbus/color_icm_reg.h>
#include <rbus/color_reg.h>
#include <rbus/histogram_reg.h>
#include <rbus/rgb2yuv_reg.h>
#include <rbus/scaledown_reg.h>
#include <rbus/scaleup_reg.h>
#include <rbus/yuv2rgb_reg.h>
#include <rbus/srgb_reg.h>
#include <rbus/od_reg.h>
#include <rbus/vodma_reg.h>
#include <rbus/smartfit_reg.h>
#include <rbus/di_reg.h>
#include <rbus/peaking_reg.h>
#include <rbus/nr_reg.h>
#include <rbus/mpegnr_reg.h>
#include <rbus/idcti_reg.h>
#include <rbus/vgip_reg.h>
#include <rbus/profile_reg.h>
#include <rbus/color_dlcti_reg.h>
#include <rbus/misc_pwm_reg.h>
#include <rbus/iso_misc_pwm_reg.h>
#include <rbus/smartfit_reg.h>
#include <rbus/iedge_smooth_reg.h>
#include <rbus/ppoverlay_reg.h>
#include <rbus/gamma_reg.h>
#include <rbus/inv_gamma_reg.h>
#include <rbus/dm_reg.h>
#include <rbus/dolby_v_top_reg.h>
#include <rbus/sys_reg_reg.h>
//#include "merlin2_reg.h"
#include <rbus/hsd_dither_reg.h>
#include <rbus/color_mb_peaking_reg.h>
//#include <rbus/sub_dither_reg.h> /* henry @ mac5 161214*/
//#include <rbus/color_temp_reg.h> /* henry @ mac5 161214*/
#include <rbus/dither_reg.h>
#include <rbus/memc_mux_reg.h>

#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
#include <tvscalercontrol/vip/vip_reg_def.h>
#include "tvscalercontrol/scaler/scalerstruct.h"
#include <tvscalercontrol/scaler/scalercolorlib_tv002.h>
#include <tvscalercontrol/vip/di_ma.h>
#endif

#ifdef CONFIG_RTK_KDEV_MEMC_INTERRUPT
#include "memc_isr/scalerMEMC.h"
#endif

/*******************************************************************************
* Macro
******************************************************************************/

//#define false FALSE
//#define true TRUE

#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
#define detect_pattern 0
#define motion_concentric_circles_log 0
#define black_white_pattern_log 0
#endif
extern unsigned char pattern_gen_pan_flag;
extern VIP_I_De_XC_TBL I_De_XC_TBL[I_De_XC_TBL_Max];
extern void scaler_HDR10_set_sta(unsigned short vo_width, unsigned short vo_height);
extern unsigned char scalerVideo_readMode(void);
//extern unsigned char curr_motion_status;

unsigned char h_pan_vfir_value=0;
unsigned char Sony_radio_detect_flag=0;
unsigned char pan_detect_flag=0;
unsigned char hifraquency_flag=0;
unsigned char hifraquencyroof_flag=0;
unsigned char high_freq_condition = 0;
unsigned char	Corn_tone_result = 0; // added by Jerry Wu 20100128
unsigned char Line_girl_tone_result =0; // added by Jerry Wu 20100128
unsigned char m_film_clear_isr = 0;
int m_film_isr = 0;
unsigned char ini_ReadSrcDet=0;

#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
unsigned int vcpu_smooth_toggle_update_flag = 1;
#endif


#define ABS(x,y)				((x > y) ? (x-y) : (y-x))
#define abs(x) ( (x>0) ? (x) : (-(x)) )
#define CLAMP(a,b,c) ( (a)<(b) ? (b) : ((a)>(c)?(c):(a)) )    //!< clamp a to the range of [b;c]
#ifndef max
#define max(a,b)            (((a) > (b)) ? (a) : (b))
#endif

unsigned char AutoMADebugMsg = FALSE; // Erin add for auto ma debug message 100624

unsigned char LineClothesGirl = 0;
char LineClothesGirlCount = 0;
unsigned char gSmd_weak_move=80,gSmd_offset=0x0f,gSmd_gain=2;

unsigned short PF_Trans_Sum=0;
unsigned char AutoMa_chessboard_log_en=0;

unsigned int MA_print_count = 0;
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
unsigned int VCPU_info_print_count = 0;
#endif

#define Print_Profile_Data 0
unsigned char Profile_Initial_Flag = 0;
unsigned int Profile1_Y_Print_Count = 0;
unsigned int Profile1_U_Print_Count = 0;
unsigned int Profile1_V_Print_Count = 0;
unsigned int Profile2_Y_Print_Count = 0;
unsigned int Profile2_U_Print_Count = 0;
unsigned int Profile2_V_Print_Count = 0;
unsigned int Profile3_Y_Print_Count = 0;
unsigned int Profile3_U_Print_Count = 0;
unsigned int Profile3_V_Print_Count = 0;
unsigned int Profile_Print_Count_1 = 0;
unsigned int Profile_Print_Count_2 = 0;
extern unsigned int soft_move;
extern unsigned int static_move;
int soft_move_cnt=0;

//static int NEW_RTNR_Switch = 0;	//Elsie 20130523: negative value is acceptable.
//static int OLD_RTNR_Switch = 0;
//static int C_RTNR_Switch = 0;
int pure_color_weighting = 0;

unsigned int film_cnt[10];
static unsigned char g_fw_film_en = 1;
#if 0
unsigned char iniDCR_init = 0;
#endif
unsigned char DCR_reset_flag = 0;
#ifdef ISR_RTNR_SWITCH_CORRECTION_BIT_FUNCTION_ENABLE
static unsigned char pre_correction_flag=99;
#endif
#if 0//frank21127 reduce code
static unsigned short pre_APL_value=0;
#endif
static unsigned short log_count=0;

unsigned char vd_pwr_ok = 0;//check_vdc_power_ok

unsigned char TV_05_style_ON = 0;
unsigned char TV_057_style_ON = 0; //Panasonic
static unsigned char DccScurveLevel;

//TSB Active backlight control
unsigned short BlackAPL_a_HSCA=0xFF;
unsigned short BlackAPL_b_HSCB=0xFF;
unsigned short BlackAPL_c_HSCC=0xFD;
unsigned short BlackAPL_d_HSCD=0xC8;
unsigned short BlackAPL_e_HSCE=0x37;
unsigned short BlackAPL_f_HSCF=0;
unsigned short BlackAPL_g_HSCG=0;
unsigned short BlackAPL_h_HSCH=0;

unsigned short BlackAPL_BL_Th1_SABH=0x03;
unsigned short BlackAPL_BL_Th1_SABL=0xDE;
unsigned short BlackAPL_BL_Th2_EABH=0x03;
unsigned short BlackAPL_BL_Th2_EABL=0xF0;
unsigned short BlackAPL_BL_Th3_MLBL=0x32;
unsigned short BlackAPL_BL_Th1=0x03DE;
unsigned short BlackAPL_BL_Th2=0x03F0;
unsigned short BlackAPL_M_ATAB=16;
unsigned short BlackAPL_KU_USAB=56;
unsigned short BlackAPL_KD_DSAB=24;

unsigned char APL_BL_MAX = 99;
unsigned char APL_BL_MIN = 10;
unsigned char panalinecount=0;

//======= dark_area_AutoNR ========================
char Dark_level_autoNR = 0;

unsigned char TableDCTI=0;

unsigned short Difference_H[16], Difference_V[16];
unsigned short very_motion_cnt=0;
unsigned short very_still_cnt=0;
//unsigned char source_timing_index = 0;
unsigned int Smartfit_Mean_value = 0;

//get R,G,B data for ambilight sensor with profile, elieli 20130131
#ifdef ISR_AMBILIGHT_ENABLE
#define AMBI_DEBUG_TPV 0
#define AMBI_PROFILE_DETECT_DEBUG_TPV 0
static unsigned char m_AmbilightMode = 0 ;

unsigned char Profile_RGB_data_flag_V=0, Profile_RGB_data_flag_H=0,flag_profile_read_status=0;
static unsigned short Profile_Y_V[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}, Profile_U_V[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
static unsigned short Profile_V_V[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}, Profile_Y_H[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
static unsigned short Profile_U_H[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}, Profile_V_H[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
static unsigned short Profile_R_V[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}, Profile_G_V[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
static unsigned short Profile_B_V[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}, Profile_R_H[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
static unsigned short Profile_G_H[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}, Profile_B_H[16]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
#endif
DRV_SNR_Veritcal_NR vlpf_table[2] =
{
	{1, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, }, //hdmi hd ori
	{1, 1,0, 0, 0, 0, 0, 0, 0, 170, 6, 32, 1, 255, 6, 0, 0, 0,1,0,0,0,0,0,0,0, }, //hdmi hd sd2hd
	//{1, 0, 0, 0, 0, 0, 0, 0, 233, 6, 32, 0, 255, 6, 0, 1, 0, },


};

extern unsigned char ID_TV002_Flag[ID_ITEM_TV002_MAX];

unsigned int step_count=0;

#define BADUP_SCALING_ENTER 2500;
#define BADUP_SCALING_LEAVE 4100;
unsigned int BadUpScalingThreshold = BADUP_SCALING_ENTER;

//=================================================================================//
//=============== LeoChen add for DCR initial setting =================
//=================================================================================//

//======= DCR ========================
//===============DCR for TPV
//static unsigned char Profile_Motion_Detect_ON = _ON;		//roger add 20110826, for motion detect for all source
static unsigned char Profile_Motion_Detect_ON = _OFF;		//roger add 20110826, for motion detect for all source
static unsigned char Profile_Motion_Detect_Value = 0;		//roger add 20110826, range: 0-100

#define DCR_DEBUG_TPV 0
#define APL_Buf_NUM    10
#define DNR_Auto_Count_Num 30

unsigned char g_IsNot4KVO = 1;
unsigned char m_nTPV_New_DCR = 0;
static unsigned char m_bIsTVSource = FALSE;
static unsigned char m_nDCR_Mode = 1 ;
static short BL_current = 100,BL_prev=100;
//========fix memory===
#define fix_DCR_Table_memory 1
#define fix_DCR_Table_2694A_global 1
#ifdef fix_DCR_Table_memory
unsigned char DCR_Table_TPV_non_TV[DCR_TABLE_COL_NUM*DCR_TABLE_ROW_NUM];//20130502
#ifdef fix_DCR_Table_2694A_global
unsigned char DCR_Table_TPV_global_setting[DCR_TABLE_COL_NUM*2];//20130731
#endif
#endif
//===========
unsigned char DCR_Table_TPV[20];
unsigned char APL_Buf[APL_Buf_NUM]= {0,0,0,0,0,0,0,0,0,0};
unsigned char nAPL_Buf_index=0;
unsigned char m_nMotion_Th=3*DCR_TABLE_COL_NUM+1;
unsigned char m_nAPL_Tolerate=3*DCR_TABLE_COL_NUM+2;

unsigned char frame_idx = 0; //frame change

unsigned char m_bDefault_OFF = FALSE; //by customer
static unsigned char m_bDetectMotion = TRUE;//0:static 1:dynamic
static unsigned char m_bMotion_Par_Ini = TRUE;//0:static 1:dynamic
//=================================

static unsigned int m_PIN_BL_ADJ=0,m_PIN_BL_ON_OFF=0,m_BACKLIGHT_ON=0,m_isIncreaseMode=0,m_DCR_UI_Max_Value=0,m_DCR_UI_Min_Value=0;
static unsigned int m_BL_LV_From_User=0,m_BL_LV_Act_Max=0,m_BL_LV_Act_Min=0;

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
static unsigned char *DCR_TABLE; // DCR Table
#endif

static unsigned char MV_ref[DCR_NODE_NUM]= {30,40,70,90,100},BL_ref[DCR_NODE_NUM]={30,40,70,90,100};
static unsigned char BL_Duty_ref[DCR_NODE_NUM]= {30,40,70,90,100},Duty_ref[DCR_NODE_NUM]={30,40,70,90,100};
static unsigned short m_frame_need_SC=8,m_frame_need_NML=20,m_stable_buf_thl=5,m_DZ_break_thl=10;
static unsigned char DCR_set_mapping=FALSE,m_DCR_refresh=FALSE;
static unsigned char m_DCR_On_Off=FALSE,m_last_DCR_On_Off=FALSE;
static unsigned char m_DCR_mode = DCR_MASTER_ISR;
unsigned char VIP_DCR_powersave_enable=0;
unsigned char still_piccture_auto_clean=0;

#define DCR_NUM_APL 12
#define DCR_NUM_OSD 12

unsigned char m_nTV057_New_DCR=0;//Panasonic DCR flag enable

unsigned char APL_LEVEL[DCR_NUM_APL] ={  0,  5,10, 20, 30, 40, 50, 60, 70, 80, 90, 100};
unsigned char OSD_LEVEL[DCR_NUM_OSD] ={  0,  5,10, 20, 30, 40, 50, 60, 70, 80, 90, 100};

unsigned char Duty_YMax[DCR_NUM_APL] ={   37,  70, 110, 190, 255, 255, 255, 255, 255, 255, 255, 255};

short  Current_Dutyvalue = 255;
unsigned char panaFlag = TRUE;
unsigned char DCR_refresh_TV057=FALSE;
char smarfit_APL_cout=0;

// Profiling
//global for others to use it. 090713 March
//unsigned short H_Block[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
//unsigned short V_Block[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
static unsigned int ProfSum = 0;

static unsigned int Profile1_Y_Sum = 0;
static unsigned int Profile1_U_Sum = 0;
static unsigned int Profile1_V_Sum = 0;
static unsigned int Profile2_Y_Sum = 0;
static unsigned int Profile2_U_Sum = 0;
static unsigned int Profile2_V_Sum = 0;
static unsigned int Profile3_Y_Sum = 0;
static unsigned int Profile3_U_Sum = 0;
static unsigned int Profile3_V_Sum = 0;

static unsigned int Profile1_H_Block_size = 0;
static unsigned char Noise_Level=0;
// Input source detection
unsigned int Step_Hist[20] = {0};
unsigned int PMH_Hist[6] = {0};
static unsigned int Y_Main_Hist_pre[128] = {0};

//Elsie 20140307
//    0<--------------------------->255
//natural<----------------------->artificial
//note:
//*********************** ID PATERN FOR  DEMO*******************************8//

unsigned char DynamicOptimizeSystem[200];
unsigned char CITestPatch[1];
unsigned char LGBirdCRTNRPatch = 0, LGBirdCRTNRPatchPre = 0;
unsigned char LGBirdCRTNRPatchTrigger = 0;
unsigned char LGPTFatoryMultiC34 = 0;
unsigned char LGTVPALBGE52 = 0;
unsigned char SandM_Chroma_Zone_Plate = 0;
unsigned char ID_CB_NO[20];
unsigned char DI_Video_Broken = 0;
unsigned char DI_Res_Pat_pan_65ppf= 0;
unsigned char GMV_status_for_Filim = 0;

#ifdef ISR_ICM_ADJUST_FUNCTIOM_ENABLE
static int g_dhue;
static int g_dsatbysat[SATSEGMAX];
static int g_ditnbyitn[ITNSEGMAX];
#endif
unsigned char g_Inv_Gamma = 255;
unsigned char BlackDetection_en = 0;
/*#ifdef LG_Demo_flag*/
//No.001
unsigned short DynamicOptimizeSystem_001_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 1, 3, 8, 8, 3, 17, 47, 49, 35, 37, 41, 47, 49, 51, 51, 53, 52, 54, 57, 59, 56, 55, 50, 87, 16, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 3, 8, 9, 3, 17, 53, 52, 35, 39, 47, 52, 56, 59, 59, 60, 62, 66, 68, 61, 57, 73, 54, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 2, 4, 10, 5, 4, 23, 51, 43, 31, 35, 42, 55, 51, 53, 53, 54, 55, 61, 64, 68, 53, 51, 51, 75, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 3, 8, 9, 4, 23, 61, 52, 46, 50, 53, 54, 56, 56, 58, 60, 68, 71, 66, 60, 68, 66, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 2, 4, 10, 5, 4, 23, 51, 43, 31, 35, 42, 55, 51, 53, 53, 54, 55, 61, 64, 68, 53, 51, 51, 75, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 1, 3, 8, 8, 3, 17, 47, 49, 35, 37, 41, 47, 49, 51, 51, 53, 52, 54, 57, 59, 56, 55, 50, 87, 16, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 3, 8, 9, 3, 17, 53, 52, 35, 39, 47, 52, 56, 59, 59, 60, 62, 66, 68, 61, 57, 73, 54, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 2, 4, 10, 5, 4, 23, 51, 43, 31, 35, 42, 55, 51, 53, 53, 54, 55, 61, 64, 68, 53, 51, 51, 75, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 2, 4, 10, 5, 4, 23, 51, 43, 31, 35, 42, 55, 51, 53, 53, 54, 55, 61, 64, 68, 53, 51, 51, 75, 0, 0, },


};

unsigned short DynamicOptimizeSystem_001_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 3, 133, 707, 91, 33, 16, 8, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 1, 80, 682, 129, 38, 35, 20, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 2, 117, 718, 91, 27, 19, 12, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 2, 117, 718, 91, 27, 19, 12, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 2, 117, 718, 91, 27, 19, 12, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 3, 133, 707, 91, 33, 16, 8, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 1, 80, 682, 129, 38, 35, 20, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 2, 117, 718, 91, 27, 19, 12, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 2, 117, 718, 91, 27, 19, 12, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

//No.002
unsigned short DynamicOptimizeSystem_002_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 8, 114, 81, 34, 24, 25, 36, 35, 33, 24, 18, 12, 11, 12, 13, 22, 105, 112, 60, 45, 36, 24, 34, 36, 24, 7, 2, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 1, 84, 111, 40, 25, 27, 42, 37, 31, 22, 17, 13, 13, 14, 21, 107, 120, 62, 47, 36, 27, 42, 30, 16, 3, 0, 0, 0, },
	/*2*/ {0, 0, 13, 119, 78, 30, 22, 24, 38, 32, 35, 23, 17, 11, 11, 12, 13, 24, 115, 104, 57, 43, 37, 22, 35, 37, 23, 8, 2, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 53, 134, 58, 30, 28, 41, 37, 37, 22, 16, 13, 12, 14, 39, 139, 86, 53, 43, 27, 40, 40, 23, 4, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 5, 114, 89, 46, 29, 26, 36, 33, 32, 22, 16, 11, 10, 9, 9, 18, 97, 109, 62, 45, 34, 25, 29, 38, 26, 14, 2, 0, 0, 0, },
	/*5*/ {43, 115, 78, 35, 25, 20, 31, 34, 29, 28, 18, 16, 10, 9, 10, 12, 16, 73, 111, 62, 43, 32, 26, 18, 31, 31, 19, 7, 2, 0, 0, 0, },
	/*6*/ {22, 0, 5, 112, 96, 37, 25, 24, 36, 32, 33, 25, 18, 13, 10, 11, 12, 19, 95, 111, 54, 43, 31, 22, 30, 34, 23, 9, 2, 0, 0, 0, },
	/*7*/ {0, 0, 2, 99, 92, 38, 22, 19, 33, 34, 31, 29, 19, 14, 10, 11, 12, 14, 49, 126, 85, 52, 41, 33, 20, 38, 34, 22, 6, 1, 0, 0, },
	/*8*/ {0, 0, 5, 114, 89, 46, 29, 26, 36, 33, 32, 22, 16, 11, 10, 9, 9, 18, 97, 109, 62, 45, 34, 25, 29, 38, 26, 14, 2, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_002_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 20, 198, 75, 78, 79, 51, 81, 56, 42, 82, 88, 61, 81, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 1, 12, 159, 99, 105, 63, 43, 76, 52, 45, 122, 85, 64, 65, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 2, 57, 190, 71, 57, 54, 53, 94, 48, 36, 61, 82, 72, 110, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 1, 3, 34, 178, 74, 77, 71, 58, 86, 55, 43, 75, 80, 63, 93, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {2, 3, 7, 48, 140, 95, 70, 57, 43, 60, 68, 50, 53, 81, 87, 113, 4, 1, 1, 1, 1, 1, 1, 1, },
	/*5*/ {0, 0, 1, 8, 150, 101, 98, 76, 47, 86, 56, 47, 119, 80, 66, 58, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 1, 12, 159, 99, 105, 63, 43, 76, 52, 45, 122, 85, 64, 65, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 1, 3, 34, 178, 74, 77, 71, 58, 86, 55, 43, 75, 80, 63, 93, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {2, 3, 7, 48, 140, 95, 70, 57, 43, 60, 68, 50, 53, 81, 87, 113, 4, 1, 1, 1, 1, 1, 1, 1, },
};

//No.003
unsigned short DynamicOptimizeSystem_003_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
	/*1*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
	/*2*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
	/*3*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
	/*4*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
	/*5*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
	/*6*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
	/*7*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
	/*8*/ {0, 218, 190, 88, 123, 97, 52, 31, 20, 14, 10, 7, 6, 6, 7, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 16, 8, 6, 5, 4, 5, 10, },
};
unsigned short DynamicOptimizeSystem_003_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW

	/*0*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 1, 45, 543, 298, 60, 5, 3, 1, 0, 0, 0, 0, 0, 3, 16, 15, 0, 0, 0, 0, 0, 0, 0, },
};

//No.004
unsigned short DynamicOptimizeSystem_004_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 1, 9, 35, 59, 62, 58, 56, 57, 59, 61, 64, 71, 77, 80, 73, 62, 47, 29, 14, 7, 3, 2, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 3, 13, 36, 58, 62, 57, 54, 54, 55, 57, 60, 65, 70, 72, 68, 61, 51, 39, 24, 13, 7, 4, 2, 1, 0, 0, 0, },
	/*2*/ {0, 19, 6, 2, 5, 18, 46, 55, 52, 51, 50, 52, 53, 56, 60, 69, 82, 80, 69, 58, 46, 29, 15, 7, 3, 2, 1, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 1, 10, 50, 78, 71, 66, 64, 65, 69, 76, 91, 95, 85, 69, 50, 29, 13, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 1, 10, 50, 78, 71, 66, 64, 65, 69, 76, 91, 95, 85, 69, 50, 29, 13, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {22, 2, 6, 18, 38, 49, 49, 48, 47, 48, 48, 49, 52, 56, 62, 68, 69, 64, 56, 48, 37, 24, 14, 7, 3, 2, 1, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 3, 13, 36, 58, 62, 57, 54, 54, 55, 57, 60, 65, 70, 72, 68, 61, 51, 39, 24, 13, 7, 4, 2, 1, 0, 0, 0, },
	/*7*/ {0, 0, 0, 1, 10, 50, 78, 71, 66, 64, 65, 69, 76, 91, 95, 85, 69, 50, 29, 13, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 1, 10, 50, 78, 71, 66, 64, 65, 69, 76, 91, 95, 85, 69, 50, 29, 13, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_004_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 224, 591, 119, 59, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 3, 387, 393, 107, 80, 23, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 340, 487, 101, 54, 14, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 441, 354, 108, 67, 22, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 441, 354, 108, 67, 22, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 224, 591, 119, 59, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 3, 387, 393, 107, 80, 23, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 441, 354, 108, 67, 22, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 441, 354, 108, 67, 22, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, }
};

//No.005
unsigned short DynamicOptimizeSystem_005_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 7, 26, 31, 32, 35, 39, 48, 47, 47, 50, 54, 56, 56, 51, 44, 35, 26, 65, 199, 7, 5, 8, 9, 4, 3, 2, 1, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 2, 26, 34, 36, 40, 45, 53, 53, 51, 57, 62, 61, 55, 47, 37, 27, 217, 46, 7, 8, 9, 5, 3, 4, 1, 0, 0, },
	/*2*/ {0, 0, 0, 9, 32, 34, 34, 37, 40, 48, 47, 45, 47, 52, 54, 54, 50, 43, 34, 26, 174, 87, 7, 5, 6, 6, 4, 3, 2, 0, 0, 0, },
	/*3*/ {0, 0, 0, 4, 25, 31, 31, 35, 38, 46, 46, 48, 48, 53, 57, 59, 55, 46, 37, 28, 24, 226, 18, 5, 5, 10, 5, 3, 2, 1, 0, 0, },
	/*4*/ {0, 0, 0, 17, 54, 43, 35, 33, 35, 42, 55, 72, 83, 92, 88, 73, 57, 44, 35, 29, 26, 23, 19, 17, 12, 3, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 7, 26, 31, 32, 35, 39, 48, 47, 47, 50, 54, 56, 56, 51, 44, 35, 26, 65, 199, 7, 5, 8, 9, 4, 3, 2, 1, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 2, 26, 34, 36, 40, 45, 53, 53, 51, 57, 62, 61, 55, 47, 37, 27, 217, 46, 7, 8, 9, 5, 3, 4, 1, 0, 0, },
	/*7*/ {0, 0, 0, 4, 25, 31, 31, 35, 38, 46, 46, 48, 48, 53, 57, 59, 55, 46, 37, 28, 24, 226, 18, 5, 5, 10, 5, 3, 2, 1, 0, 0, },
	/*8*/ {0, 0, 0, 17, 54, 43, 35, 33, 35, 42, 55, 72, 83, 92, 88, 73, 57, 44, 35, 29, 26, 23, 19, 17, 12, 3, 0, 0, 0, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_005_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 17, 278, 242, 109, 45, 15, 11, 12, 16, 16, 77, 155, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 11, 301, 230, 110, 32, 14, 10, 11, 13, 15, 73, 172, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 17, 397, 336, 111, 17, 0, 0, 0, 0, 0, 0, 117, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 2, 324, 347, 111, 33, 5, 0, 0, 1, 2, 56, 113, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 6, 162, 380, 298, 107, 31, 7, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 17, 278, 242, 109, 45, 15, 11, 12, 16, 16, 77, 155, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 11, 301, 230, 110, 32, 14, 10, 11, 13, 15, 73, 172, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 2, 324, 347, 111, 33, 5, 0, 0, 1, 2, 56, 113, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 6, 162, 380, 298, 107, 31, 7, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

//No.007
unsigned short DynamicOptimizeSystem_007_y[][32]= // ntsc 01:28  , pal 01:47
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 9, 45, 41, 51, 69, 71, 75, 75, 75, 88, 181, 129, 38, 14, 4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 4, 34, 37, 42, 51, 59, 69, 69, 78, 222, 238, 45, 12, 5, 3, 3, 3, 2, 2, 2, 3, 2, 2, 1, 0, 0, 0, },
	/*2*/ {0, 0, 0, 13, 45, 42, 48, 65, 70, 75, 74, 77, 107, 214, 96, 32, 5, 4, 3, 3, 2, 2, 2, 2, 3, 2, 1, 1, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 31, 47, 50, 68, 74, 80, 82, 92, 216, 178, 40, 7, 4, 4, 3, 2, 2, 2, 3, 3, 2, 1, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 6, 28, 32, 34, 40, 44, 51, 55, 61, 91, 282, 184, 41, 12, 4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 0, 0, },
	/*5*/ {21, 8, 35, 37, 43, 61, 75, 84, 77, 77, 81, 101, 158, 80, 20, 7, 3, 2, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 0, 0, 0, 0, },
	/*6*/ {21, 1, 0, 7, 36, 35, 39, 49, 52, 60, 62, 65, 98, 280, 122, 29, 7, 4, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 6, 28, 32, 34, 40, 44, 51, 55, 61, 91, 282, 184, 41, 12, 4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 0, 0, },
	/*8*/ {0, 0, 0, 6, 28, 32, 34, 40, 44, 51, 55, 61, 91, 282, 184, 41, 12, 4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_007_hue[][24] = // 01:28
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 356, 566, 43, 26, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 1, 253, 663, 56, 20, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 326, 667, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 272, 680, 34, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 272, 680, 34, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 429, 504, 39, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 1, 253, 663, 56, 20, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 272, 680, 34, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 272, 680, 34, 8, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

//No.007
unsigned short DynamicOptimizeSystem_007_y2[][32]= // ntsc 01:28  , pal 01:47
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 9, 30, 37, 44, 80, 114, 109, 93, 115, 97, 104, 95, 29, 6, 5, 3, 3, 2, 2, 2, 1, 2, 2, 2, 1, 1, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 3, 33, 42, 52, 88, 123, 111, 108, 111, 124, 117, 43, 9, 5, 3, 3, 2, 2, 2, 2, 3, 2, 2, 1, 0, 0, 0, },
	/*2*/ {0, 0, 0, 13, 45, 42, 48, 65, 70, 75, 74, 77, 107, 214, 96, 32, 5, 4, 3, 3, 2, 2, 2, 2, 3, 2, 1, 1, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 23, 47, 51, 89, 122, 113, 117, 113, 132, 114, 35, 7, 4, 4, 3, 2, 2, 2, 2, 2, 1, 1, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 6, 26, 39, 41, 74, 111, 113, 93, 117, 103, 107, 92, 33, 8, 4, 3, 3, 2, 2, 2, 1, 2, 2, 2, 1, 1, 0, 0, 0, },
	/*5*/ {0, 0, 0, 9, 30, 37, 44, 80, 114, 109, 93, 115, 97, 104, 95, 29, 6, 5, 3, 3, 2, 2, 2, 1, 2, 2, 2, 1, 1, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 3, 33, 42, 52, 88, 123, 111, 108, 111, 124, 117, 43, 9, 5, 3, 3, 2, 2, 2, 2, 3, 2, 2, 1, 0, 0, 0, },
	/*7*/ {0, 0, 0, 6, 26, 39, 41, 74, 111, 113, 93, 117, 103, 107, 92, 33, 8, 4, 3, 3, 2, 2, 2, 1, 2, 2, 2, 1, 1, 0, 0, 0, },
	/*8*/ {0, 0, 0, 6, 26, 39, 41, 74, 111, 113, 93, 117, 103, 107, 92, 33, 8, 4, 3, 3, 2, 2, 2, 1, 2, 2, 2, 1, 1, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_007_hue2[][24] = // 01:28
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 472, 445, 53, 21, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 476, 445, 49, 24, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 326, 667, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 552, 390, 37, 14, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 552, 390, 37, 14, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 472, 445, 53, 21, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 476, 445, 49, 24, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 552, 390, 37, 14, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 552, 390, 37, 14, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

//No.011
unsigned short DynamicOptimizeSystem_011_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 13, 4, 0, 0, 0, 0, 13, 38, 14, 12, 24, 54, 79, 99, 74, 58, 43, 18, 8, 6, 28, 27, 352, 25, 2, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 13, 4, 0, 0, 0, 0, 13, 38, 14, 12, 24, 54, 79, 99, 74, 58, 43, 18, 8, 6, 28, 27, 352, 25, 2, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 13, 4, 0, 0, 0, 0, 13, 38, 14, 12, 24, 54, 79, 99, 74, 58, 43, 18, 8, 6, 28, 27, 352, 25, 2, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 13, 4, 0, 0, 0, 0, 13, 38, 14, 12, 24, 54, 79, 99, 74, 58, 43, 18, 8, 6, 28, 27, 352, 25, 2, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 13, 4, 0, 0, 0, 0, 13, 38, 14, 12, 24, 54, 79, 99, 74, 58, 43, 18, 8, 6, 28, 27, 352, 25, 2, 0, 0, 0, 0, 0, 0, },
	/*5*/ {21, 0, 0, 0, 0, 4, 35, 18, 10, 15, 32, 55, 75, 81, 65, 52, 42, 26, 11, 5, 26, 21, 289, 94, 9, 2, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 13, 4, 0, 0, 0, 0, 13, 38, 14, 12, 24, 54, 79, 99, 74, 58, 43, 18, 8, 6, 28, 27, 352, 25, 2, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 27, 3, 0, 0, 0, 0, 14, 36, 14, 13, 25, 53, 78, 94, 75, 58, 41, 18, 7, 11, 28, 70, 309, 15, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 13, 4, 0, 0, 0, 0, 13, 38, 14, 12, 24, 54, 79, 99, 74, 58, 43, 18, 8, 6, 28, 27, 352, 25, 2, 0, 0, 0, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_011_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 301, 146, 34, 21, 5, 6, 12, 28, 13, 5, 5, 414, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 301, 146, 34, 21, 5, 6, 12, 28, 13, 5, 5, 414, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 409, 65, 12, 20, 5, 9, 19, 22, 8, 4, 2, 399, 19, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 301, 146, 34, 21, 5, 6, 12, 28, 13, 5, 5, 414, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 301, 146, 34, 21, 5, 6, 12, 28, 13, 5, 5, 414, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 307, 137, 32, 20, 5, 8, 18, 25, 8, 3, 5, 422, 2, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 301, 146, 34, 21, 5, 6, 12, 28, 13, 5, 5, 414, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 301, 146, 34, 21, 5, 6, 12, 28, 13, 5, 5, 414, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 301, 146, 34, 21, 5, 6, 12, 28, 13, 5, 5, 414, 3, 0, 0, 0, 0, 0, 0, 0, },
};

//No.012
unsigned short DynamicOptimizeSystem_012_y[][32]= //02:21
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 2, 20, 61, 92, 121, 124, 135, 120, 85, 60, 47, 36, 26, 18, 13, 8, 5, 4, 3, 2, 1, 1, 1, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 1, 17, 63, 99, 132, 146, 153, 115, 80, 59, 43, 30, 19, 12, 7, 4, 3, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 20, 7, 2, 28, 68, 103, 118, 123, 132, 113, 78, 58, 44, 32, 22, 14, 9, 6, 4, 3, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 1, 4, 14, 67, 98, 135, 131, 138, 114, 80, 59, 45, 31, 22, 15, 10, 7, 4, 3, 2, 2, 1, 1, 1, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 1, 16, 57, 85, 126, 126, 141, 127, 86, 62, 48, 36, 25, 16, 10, 7, 5, 3, 2, 2, 1, 1, 1, 0, 1, 0, 0, 0, 0, },
	/*5*/ {22, 3, 25, 64, 87, 115, 106, 120, 115, 87, 60, 48, 37, 29, 21, 14, 9, 6, 5, 3, 2, 2, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {22, 0, 0, 2, 27, 70, 96, 124, 123, 129, 114, 76, 57, 43, 33, 23, 15, 10, 7, 5, 3, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 1, 4, 25, 67, 93, 128, 127, 132, 116, 80, 57, 43, 34, 25, 18, 12, 8, 6, 4, 3, 2, 1, 1, 1, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 1, 16, 57, 85, 126, 126, 141, 127, 86, 62, 48, 36, 25, 16, 10, 7, 5, 3, 2, 2, 1, 1, 1, 0, 1, 0, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_012_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 2, 45, 72, 180, 528, 134, 26, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 2, 10, 62, 70, 183, 474, 146, 34, 8, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 1, 7, 72, 83, 144, 446, 199, 40, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 3, 18, 76, 88, 160, 456, 142, 35, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*4*/ {0, 1, 4, 33, 88, 96, 166, 384, 149, 48, 12, 5, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 0, 1, 8, 63, 76, 169, 502, 139, 30, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 2, 10, 62, 70, 183, 474, 146, 34, 8, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 3, 18, 76, 88, 160, 456, 142, 35, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*8*/ {0, 1, 4, 33, 88, 96, 166, 384, 149, 48, 12, 5, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
};

//No.014
unsigned short DynamicOptimizeSystem_014_y[][32]= //02:21
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 2, 2, 3, 4, 123, 46, 42, 46, 56, 60, 60, 62, 71, 88, 93, 87, 69, 48, 20, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 2, 2, 3, 4, 123, 46, 42, 46, 56, 60, 60, 62, 71, 88, 93, 87, 69, 48, 20, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 2, 2, 3, 4, 123, 46, 42, 46, 56, 60, 60, 62, 71, 88, 93, 87, 69, 48, 20, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 2, 2, 3, 4, 123, 46, 42, 46, 56, 60, 60, 62, 71, 88, 93, 87, 69, 48, 20, 0, 0, },//for_LG_demo
	/*4*/ {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 5, 11, 9, 12, 158, 56, 49, 51, 51, 60, 59, 68, 91, 117, 102, 75, 13, 0, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 2, 2, 3, 4, 123, 46, 42, 46, 56, 60, 60, 62, 71, 88, 93, 87, 69, 48, 20, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 2, 2, 3, 4, 123, 46, 42, 46, 56, 60, 60, 62, 71, 88, 93, 87, 69, 48, 20, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 2, 2, 3, 4, 123, 46, 42, 46, 56, 60, 60, 62, 71, 88, 93, 87, 69, 48, 20, 0, 0, },//for_LG_demo
	/*8*/ {0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 3, 2, 2, 3, 4, 123, 46, 42, 46, 56, 60, 60, 62, 71, 88, 93, 87, 69, 48, 20, 0, 0, },//for_LG_demo

};
unsigned short DynamicOptimizeSystem_014_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*4*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*8*/ {0, 0, 3, 4, 256, 459, 233, 28, 6, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo

};

//No.023
unsigned short DynamicOptimizeSystem_023_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 5, 67, 90, 92, 78, 72, 64, 60, 57, 50, 43, 37, 33, 31, 28, 27, 26, 25, 22, 20, 18, 15, 12, 10, 6, 1, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 1, 55, 74, 86, 87, 80, 73, 74, 66, 57, 46, 38, 35, 32, 30, 27, 24, 24, 26, 23, 16, 10, 3, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 9, 50, 69, 82, 85, 79, 74, 73, 66, 54, 44, 38, 35, 32, 27, 25, 22, 18, 19, 19, 19, 19, 17, 9, 3, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 51, 94, 91, 94, 78, 69, 73, 64, 55, 44, 37, 35, 32, 30, 28, 26, 27, 22, 17, 13, 6, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 1, 86, 89, 101, 93, 78, 67, 69, 61, 48, 39, 36, 34, 31, 30, 26, 24, 23, 20, 15, 12, 6, 1, 0, 0, 0, 0, 0, },
	/*5*/ {16, 12, 71, 68, 78, 79, 70, 64, 59, 60, 51, 44, 36, 32, 29, 28, 26, 24, 23, 20, 18, 16, 16, 15, 14, 9, 6, 2, 0, 0, 0, 0, },
	/*6*/ {17, 0, 0, 33, 137, 145, 127, 84, 53, 37, 31, 28, 26, 28, 30, 32, 32, 25, 21, 20, 22, 19, 17, 14, 7, 2, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 3, 71, 57, 69, 76, 75, 72, 71, 70, 59, 49, 40, 34, 32, 29, 25, 23, 23, 23, 21, 19, 19, 15, 10, 4, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 42, 89, 69, 81, 77, 66, 59, 60, 56, 49, 41, 34, 33, 31, 29, 28, 26, 22, 20, 19, 17, 14, 13, 8, 2, 0, 0, 0, 0, },

};

unsigned short DynamicOptimizeSystem_023_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 3, 12, 11, 15, 28, 81, 79, 199, 563, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 4, 14, 10, 12, 22, 44, 55, 227, 608, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 21, 30, 170, 765, 4, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 7, 15, 13, 20, 25, 27, 52, 128, 706, 2, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 1, 4, 9, 14, 22, 32, 46, 48, 59, 106, 626, 23, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 3, 12, 11, 15, 28, 81, 79, 199, 563, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 4, 14, 10, 12, 22, 44, 55, 227, 608, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 7, 15, 13, 20, 25, 27, 52, 128, 706, 2, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 1, 4, 9, 14, 22, 32, 46, 48, 59, 106, 626, 23, 0, 0, 0, 0, 0, 0, 0, },
};

unsigned short DynamicOptimizeSystem_023_y2[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 40, 129, 150, 133, 78, 47, 33, 29, 27, 27, 27, 29, 32, 34, 30, 25, 26, 23, 22, 19, 14, 9, 3, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 12, 124, 157, 149, 89, 53, 37, 30, 29, 29, 35, 36, 39, 32, 27, 28, 26, 21, 17, 12, 6, 1, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 48, 136, 151, 126, 74, 47, 33, 29, 27, 28, 30, 34, 33, 31, 28, 23, 23, 24, 21, 15, 13, 10, 3, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 7, 118, 160, 148, 101, 56, 40, 36, 31, 30, 35, 38, 35, 28, 27, 27, 27, 20, 13, 8, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 8, 133, 170, 151, 93, 56, 38, 33, 31, 29, 33, 37, 35, 27, 25, 28, 22, 17, 15, 6, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {18, 51, 122, 131, 122, 85, 56, 37, 29, 27, 25, 25, 25, 29, 29, 27, 25, 20, 19, 20, 18, 16, 14, 11, 5, 2, 0, 0, 0, 0, 0, 0, },
	/*6*/ {16, 0, 0, 4, 76, 70, 72, 78, 75, 74, 69, 63, 55, 45, 37, 33, 32, 28, 25, 24, 21, 21, 18, 16, 12, 9, 7, 3, 0, 0, 0, 0, },
	/*7*/ {0, 0, 2, 22, 133, 155, 139, 83, 56, 38, 31, 28, 25, 25, 29, 33, 34, 27, 21, 20, 21, 21, 17, 16, 9, 3, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 39, 141, 160, 132, 76, 47, 34, 29, 28, 28, 28, 29, 32, 30, 25, 23, 25, 22, 21, 19, 12, 7, 2, 0, 0, 0, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_023_hue2[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 5, 8, 45, 70, 260, 600, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 43, 47, 281, 621, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 141, 839, 16, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 4, 9, 18, 34, 142, 763, 22, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 1, 3, 4, 7, 12, 24, 41, 111, 734, 52, 1, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 5, 8, 45, 70, 260, 600, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 43, 47, 281, 621, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 5, 12, 24, 43, 164, 717, 26, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 1, 3, 4, 7, 12, 24, 41, 111, 734, 52, 1, 0, 0, 0, 0, 0, 0, },
};


//No.024
unsigned short DynamicOptimizeSystem_024_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 1, 4, 8, 26, 62, 76, 76, 83, 109, 101, 68, 56, 48, 43, 37, 32, 27, 23, 19, 15, 13, 10, 9, 8, 6, 6, 6, 9, 1, 0, 0, },
	/*1*/ {0, 0, 0, 0, 3, 8, 20, 63, 84, 87, 98, 122, 93, 66, 55, 48, 42, 38, 32, 26, 20, 16, 13, 11, 9, 8, 7, 7, 10, 2, 0, 0, },
	/*2*/ {0, 0, 2, 9, 29, 69, 80, 81, 89, 110, 95, 66, 54, 46, 40, 36, 31, 27, 22, 19, 15, 12, 10, 9, 8, 7, 6, 6, 7, 2, 0, 0, },
	/*3*/ {0, 0, 0, 3, 7, 17, 60, 87, 93, 99, 126, 98, 68, 56, 48, 40, 35, 29, 24, 19, 15, 13, 10, 9, 8, 8, 10, 4, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 1, 5, 10, 47, 85, 92, 96, 122, 113, 73, 58, 49, 42, 36, 30, 25, 20, 16, 13, 11, 9, 8, 8, 10, 8, 1, 0, 0, 0, },
	/*5*/ {23, 5, 19, 52, 69, 70, 73, 88, 112, 77, 59, 49, 43, 39, 34, 30, 25, 21, 17, 14, 12, 10, 8, 7, 6, 5, 5, 5, 6, 1, 0, 0, },
	/*6*/ {22, 0, 1, 4, 20, 58, 71, 77, 81, 105, 112, 71, 56, 48, 43, 39, 33, 27, 22, 18, 15, 12, 10, 8, 8, 6, 6, 5, 8, 1, 0, 0, },
	/*7*/ {0, 1, 3, 7, 20, 57, 75, 78, 81, 102, 114, 71, 56, 47, 42, 38, 33, 29, 23, 19, 16, 13, 11, 9, 8, 7, 6, 6, 8, 5, 0, 0, },
	/*8*/ {0, 0, 2, 5, 15, 56, 82, 83, 84, 106, 110, 70, 55, 47, 41, 37, 32, 28, 24, 19, 16, 13, 11, 9, 8, 7, 6, 6, 8, 6, 0, 0, },
};
unsigned short DynamicOptimizeSystem_024_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 2, 9, 39, 153, 334, 182, 67, 35, 29, 30, 31, 37, 35, 8, 1, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 2, 9, 27, 161, 325, 184, 65, 41, 34, 34, 34, 39, 32, 6, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 1, 9, 42, 111, 324, 231, 77, 35, 27, 29, 32, 32, 31, 10, 2, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 4, 15, 55, 122, 324, 179, 74, 38, 27, 24, 32, 38, 46, 11, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*4*/ {0, 0, 2, 7, 21, 69, 128, 288, 169, 79, 40, 25, 26, 32, 37, 44, 18, 2, 1, 0, 0, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 0, 0, 2, 8, 29, 135, 344, 197, 75, 40, 27, 31, 34, 34, 26, 7, 2, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 2, 9, 27, 161, 325, 184, 65, 41, 34, 34, 34, 39, 32, 6, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 4, 15, 55, 122, 324, 179, 74, 38, 27, 24, 32, 38, 46, 11, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*8*/ {0, 0, 2, 7, 21, 69, 128, 288, 169, 79, 40, 25, 26, 32, 37, 44, 18, 2, 1, 0, 0, 0, 0, 0, },//for_LG_demo
};


//No.028
unsigned short DynamicOptimizeSystem_028_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 558, 29, 10, 12, 13, 11, 10, 11, 11, 12, 16, 21, 22, 32, 48, 35, 37, 35, 31, 15, 10, 2, 2, 1, 1, 0, 0, 1, 0, 0, 0, },
	/*1*/ {0, 21, 1, 344, 229, 13, 15, 14, 12, 11, 13, 12, 16, 24, 23, 33, 48, 37, 38, 35, 27, 13, 4, 2, 1, 1, 0, 0, 1, 0, 0, 0, },
	/*2*/ {0, 568, 26, 10, 12, 12, 11, 9, 10, 11, 12, 15, 21, 20, 33, 48, 34, 37, 35, 29, 15, 10, 2, 2, 1, 1, 0, 0, 1, 0, 0, 0, },
	/*3*/ {0, 0, 0, 583, 9, 12, 12, 12, 11, 11, 13, 17, 22, 25, 33, 55, 39, 43, 41, 25, 14, 4, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, },
	/*4*/ {0, 0, 577, 8, 10, 11, 10, 9, 10, 11, 12, 15, 21, 23, 24, 51, 36, 38, 37, 35, 22, 13, 5, 2, 2, 1, 1, 1, 1, 0, 0, 0, },
	/*5*/ {0, 558, 29, 10, 12, 13, 11, 10, 11, 11, 12, 16, 21, 22, 32, 48, 35, 37, 35, 31, 15, 10, 2, 2, 1, 1, 0, 0, 1, 0, 0, 0, },
	/*6*/ {0, 21, 1, 344, 229, 13, 15, 14, 12, 11, 13, 12, 16, 24, 23, 33, 48, 37, 38, 35, 27, 13, 4, 2, 1, 1, 0, 0, 1, 0, 0, 0, },
	/*7*/ {0, 289, 305, 7, 9, 10, 10, 8, 9, 10, 12, 15, 21, 21, 24, 50, 36, 37, 36, 32, 20, 12, 4, 2, 2, 1, 1, 1, 1, 1, 0, 0, },
	/*8*/ {0, 0, 577, 8, 10, 11, 10, 9, 10, 11, 12, 15, 21, 23, 24, 51, 36, 38, 37, 35, 22, 13, 5, 2, 2, 1, 1, 1, 1, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_028_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 3, 42, 807, 102, 16, 7, 4, 4, 5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 1, 29, 828, 108, 19, 5, 2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {1, 4, 49, 834, 92, 7, 1, 0, 0, 3, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 2, 43, 805, 92, 14, 6, 6, 5, 3, 4, 5, 3, 1, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*4*/ {8, 24, 210, 713, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 1, 2, 4, },//for_LG_demo
	/*5*/ {0, 3, 42, 807, 102, 16, 7, 4, 4, 5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 1, 29, 828, 108, 19, 5, 2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 2, 43, 805, 92, 14, 6, 6, 5, 3, 4, 5, 3, 1, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*8*/ {8, 24, 210, 713, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 1, 2, 4, },//for_LG_demo
};

//No.028
unsigned short DynamicOptimizeSystem_028_y2[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 51, 582, 9, 12, 12, 6, 3, 3, 3, 3, 5, 8, 10, 16, 24, 53, 55, 34, 26, 18, 15, 18, 11, 6, 1, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 20, 3, 3, 596, 10, 14, 12, 5, 3, 4, 4, 4, 9, 11, 16, 27, 61, 55, 35, 29, 15, 22, 13, 11, 1, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 91, 556, 8, 12, 12, 5, 3, 3, 3, 3, 5, 8, 10, 16, 23, 53, 54, 32, 25, 18, 13, 19, 9, 4, 1, 0, 0, 0, 1, 0, 0, },
	/*3*/ {0, 0, 0, 228, 22, 27, 25, 20, 19, 20, 22, 28, 37, 65, 109, 103, 103, 56, 40, 13, 4, 5, 14, 8, 6, 3, 4, 7, 0, 0, 0, 0, },
	/*4*/ {0, 0, 577, 8, 10, 11, 10, 9, 10, 11, 12, 15, 21, 23, 24, 51, 36, 38, 37, 35, 22, 13, 5, 2, 2, 1, 1, 1, 1, 0, 0, 0, },
	/*5*/ {616, 8, 12, 12, 7, 3, 3, 3, 3, 3, 7, 9, 11, 16, 23, 51, 55, 37, 25, 23, 12, 20, 11, 11, 2, 0, 0, 0, 0, 1, 0, 0, },
	/*6*/ {23, 13, 590, 9, 12, 12, 6, 3, 3, 3, 3, 5, 9, 11, 15, 25, 53, 52, 39, 27, 20, 15, 17, 10, 7, 1, 0, 0, 0, 1, 0, 0, },
	/*7*/ {0, 289, 305, 7, 9, 10, 10, 8, 9, 10, 12, 15, 21, 21, 24, 50, 36, 37, 36, 32, 20, 12, 4, 2, 2, 1, 1, 1, 1, 1, 0, 0, },
	/*8*/ {0, 0, 577, 8, 10, 11, 10, 9, 10, 11, 12, 15, 21, 23, 24, 51, 36, 38, 37, 35, 22, 13, 5, 2, 2, 1, 1, 1, 1, 0, 0, 0, }
};

unsigned short DynamicOptimizeSystem_028_hue2[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
    /*0*/ {1, 3, 22, 539, 133, 17, 5, 1, 0, 0, 1, 3, 18, 25, 42, 45, 49, 35, 48, 0, 0, 0, 0, 0, },
    /*1*/ {1, 3, 21, 542, 136, 17, 5, 1, 0, 0, 1, 3, 17, 24, 41, 46, 52, 36, 42, 0, 0, 0, 0, 0, },
    /*2*/ {0, 1, 13, 597, 118, 16, 1, 0, 0, 0, 0, 0, 3, 15, 131, 78, 22, 0, 0, 0, 0, 0, 0, 0, },
    /*3*/ {0, 2, 43, 805, 92, 14, 6, 6, 5, 3, 4, 5, 3, 1, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, },
    /*4*/ {8, 24, 210, 713, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 1, 2, 4, },
    /*5*/ {0, 2, 26, 585, 105, 12, 3, 0, 0, 0, 0, 0, 4, 15, 51, 90, 81, 14, 2, 0, 0, 0, 0, 0, },
    /*6*/ {2, 4, 32, 599, 100, 11, 3, 0, 0, 0, 0, 0, 2, 8, 27, 58, 83, 45, 15, 0, 0, 0, 0, 1, },
    /*7*/ {0, 2, 43, 805, 92, 14, 6, 6, 5, 3, 4, 5, 3, 1, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, },
    /*8*/ {8, 24, 210, 713, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 1, 2, 4, }
};


//No.032
unsigned short DynamicOptimizeSystem_032_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 70, 248, 73, 98, 108, 117, 66, 27, 20, 21, 21, 18, 16, 14, 13, 12, 12, 11, 8, 4, 3, 3, 1, 1, 0, 0, 0, 1, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 282, 97, 101, 109, 131, 67, 28, 24, 25, 19, 18, 16, 15, 13, 13, 11, 7, 4, 3, 2, 1, 1, 0, 0, 1, 0, 0, 0, },
	/*2*/ {0, 2, 32, 41, 78, 126, 129, 104, 66, 45, 38, 27, 23, 21, 17, 17, 15, 14, 16, 21, 30, 53, 40, 18, 7, 3, 1, 1, 1, 0, 0, 0, },
	/*3*/ {0, 2, 32, 41, 78, 126, 129, 104, 66, 45, 38, 27, 23, 21, 17, 17, 15, 14, 16, 21, 30, 53, 40, 18, 7, 3, 1, 1, 1, 0, 0, 0, },
	/*4*/ {0, 2, 32, 41, 78, 126, 129, 104, 66, 45, 38, 27, 23, 21, 17, 17, 15, 14, 16, 21, 30, 53, 40, 18, 7, 3, 1, 1, 1, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 70, 248, 73, 98, 108, 117, 66, 27, 20, 21, 21, 18, 16, 14, 13, 12, 12, 11, 8, 4, 3, 3, 1, 1, 0, 0, 0, 1, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 282, 97, 101, 109, 131, 67, 28, 24, 25, 19, 18, 16, 15, 13, 13, 11, 7, 4, 3, 2, 1, 1, 0, 0, 1, 0, 0, 0, },
	/*7*/ {0, 2, 32, 41, 78, 126, 129, 104, 66, 45, 38, 27, 23, 21, 17, 17, 15, 14, 16, 21, 30, 53, 40, 18, 7, 3, 1, 1, 1, 0, 0, 0, },
	/*8*/ {0, 2, 32, 41, 78, 126, 129, 104, 66, 45, 38, 27, 23, 21, 17, 17, 15, 14, 16, 21, 30, 53, 40, 18, 7, 3, 1, 1, 1, 0, 0, 0, },//for_LG_demo

};

//No.032
unsigned short DynamicOptimizeSystem_032_y2[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 38, 180, 117, 147, 118, 101, 49, 30, 26, 24, 22, 21, 20, 18, 14, 13, 13, 9, 7, 6, 4, 3, 2, 1, 1, 0, 1, 1, 0, 0, 0, },
	/*1*/ {0, 38, 180, 117, 147, 118, 101, 49, 30, 26, 24, 22, 21, 20, 18, 14, 13, 13, 9, 7, 6, 4, 3, 2, 1, 1, 0, 1, 1, 0, 0, 0, },
	/*2*/ {0, 1, 24, 32, 58, 111, 129, 108, 73, 50, 38, 27, 22, 22, 21, 19, 18, 18, 18, 24, 28, 47, 51, 24, 12, 5, 3, 1, 1, 0, 0, 0, },
	/*3*/ {0, 1, 24, 32, 58, 111, 129, 108, 73, 50, 38, 27, 22, 22, 21, 19, 18, 18, 18, 24, 28, 47, 51, 24, 12, 5, 3, 1, 1, 0, 0, 0, },
	/*4*/ {0, 1, 24, 32, 58, 111, 129, 108, 73, 50, 38, 27, 22, 22, 21, 19, 18, 18, 18, 24, 28, 47, 51, 24, 12, 5, 3, 1, 1, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 38, 180, 117, 147, 118, 101, 49, 30, 26, 24, 22, 21, 20, 18, 14, 13, 13, 9, 7, 6, 4, 3, 2, 1, 1, 0, 1, 1, 0, 0, 0, },
	/*6*/ {0, 38, 180, 117, 147, 118, 101, 49, 30, 26, 24, 22, 21, 20, 18, 14, 13, 13, 9, 7, 6, 4, 3, 2, 1, 1, 0, 1, 1, 0, 0, 0, },
	/*7*/ {0, 1, 24, 32, 58, 111, 129, 108, 73, 50, 38, 27, 22, 22, 21, 19, 18, 18, 18, 24, 28, 47, 51, 24, 12, 5, 3, 1, 1, 0, 0, 0, },
	/*8*/ {0, 1, 24, 32, 58, 111, 129, 108, 73, 50, 38, 27, 22, 22, 21, 19, 18, 18, 18, 24, 28, 47, 51, 24, 12, 5, 3, 1, 1, 0, 0, 0, },//for_LG_demo
};

//No.035
unsigned short DynamicOptimizeSystem_035_y[][32]= //ntst 04:47   pal 05:44
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 4, 229, 615, 108, 9, 5, 4, 3, 3, 3, 2, 1, 0, 1, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 35, 806, 142, 2, 2, 2, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 1, 154, 762, 59, 3, 3, 3, 2, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 1, 125, 697, 152, 6, 2, 2, 2, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 4, 244, 516, 187, 25, 3, 2, 2, 2, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 4, 229, 615, 108, 9, 5, 4, 3, 3, 3, 2, 1, 0, 1, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 35, 806, 142, 2, 2, 2, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 1, 125, 697, 152, 6, 2, 2, 2, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 4, 244, 516, 187, 25, 3, 2, 2, 2, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo


};

unsigned short DynamicOptimizeSystem_035_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 1, 1, 1, 10, 94, 479, 0, 0, 0, 0, 0, 20, 9, 16, 30, 188, 95, 38, 6, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 2, 18, 10, 6, 2, 5, 9, 10, 11, 38, 116, 253, 315, 181, 13, 1, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 199, 393, 311, 69, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 300, 226, 465, 1, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 34, 475, 467, 17, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 1, 1, 1, 10, 94, 479, 0, 0, 0, 0, 0, 20, 9, 16, 30, 188, 95, 38, 6, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 2, 18, 10, 6, 2, 5, 9, 10, 11, 38, 116, 253, 315, 181, 13, 1, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 300, 226, 465, 1, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 34, 475, 467, 17, 0, 0, 0, 0, 0, 0, },//for_LG_demo
};

unsigned short DynamicOptimizeSystem_035_y2[][32]= //nstc 04:51 pal:05:48
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW

	/*0*/ {0, 0, 59, 900, 32, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 16, 831, 144, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 62, 910, 17, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 43, 870, 79, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 1, 181, 629, 174, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 0, 59, 900, 32, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 16, 831, 144, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 43, 870, 79, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 1, 181, 629, 174, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo

};

unsigned short DynamicOptimizeSystem_035_hue2[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 2, 104, 861, 0, 0, 0, 0, 0, 2, 1, 2, 3, 13, 5, 1, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 2, 120, 846, 0, 0, 0, 0, 0, 1, 1, 2, 3, 13, 5, 1, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 17, 234, 441, 265, 41, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 357, 277, 342, 22, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 75, 504, 380, 35, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 2, 104, 861, 0, 0, 0, 0, 0, 2, 1, 2, 3, 13, 5, 1, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 2, 120, 846, 0, 0, 0, 0, 0, 1, 1, 2, 3, 13, 5, 1, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 357, 277, 342, 22, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 75, 504, 380, 35, 0, 0, 0, 0, 0, 0, },
};

unsigned short DynamicOptimizeSystem_035_y3[][32]= //nstc 04:53  pal 05:52
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 28, 958, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 5, 891, 98, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 35, 958, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 19, 937, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 111, 732, 151, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
	/*5*/ {0, 0, 28, 958, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 5, 891, 98, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 19, 937, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 111, 732, 151, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//for_LG_demo
};

//No.039
unsigned short DynamicOptimizeSystem_039_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 22, 12, 44, 28, 19, 19, 18, 18, 19, 17, 17, 18, 47, 202, 272, 169, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },


};

unsigned short DynamicOptimizeSystem_039_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 535, 454, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

//No.044
unsigned short DynamicOptimizeSystem_044_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 1, 3, 6, 8, 9, 10, 10, 10, 10, 65, 96, 392, 55, 29, 38, 46, 52, 63, 43, 21, 1, 0, 0, 1, 1, 16, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 2, 5, 7, 8, 11, 10, 11, 11, 61, 67, 422, 63, 32, 42, 50, 62, 64, 32, 10, 0, 0, 1, 1, 16, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 1, 3, 6, 8, 9, 10, 10, 10, 10, 65, 96, 392, 55, 29, 38, 46, 52, 63, 43, 21, 1, 0, 0, 1, 1, 16, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 2, 5, 7, 8, 11, 10, 11, 11, 61, 67, 422, 63, 32, 42, 50, 62, 64, 32, 10, 0, 0, 1, 1, 16, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

unsigned short DynamicOptimizeSystem_044_hue[][24] = //ntsc 03:25 pal:
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {57, 479, 48, 344, 33, 16, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 1, 0, 0, 1, },
	/*1*/ {60, 476, 47, 345, 32, 15, 7, 2, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 5, 1, 0, 0, 1, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {57, 479, 48, 344, 33, 16, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 1, 0, 0, 1, },
	/*6*/ {60, 476, 47, 345, 32, 15, 7, 2, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 5, 1, 0, 0, 1, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

//No.047
unsigned short DynamicOptimizeSystem_047_y[][32]= //ntsc 03:25  pal:
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 4, 826, 7, 17, 21, 24, 30, 34, 9, 8, 5, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 4, 826, 7, 17, 21, 24, 30, 34, 9, 8, 5, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 2, 4, 854, 7, 15, 17, 20, 20, 22, 9, 5, 6, 2, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 2, 4, 5, 9, 683, 16, 20, 28, 30, 36, 43, 45, 18, 16, 23, 8, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 2, 4, 5, 9, 683, 16, 20, 28, 30, 36, 43, 45, 18, 16, 23, 8, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 4, 826, 7, 17, 21, 24, 30, 34, 9, 8, 5, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 4, 826, 7, 17, 21, 24, 30, 34, 9, 8, 5, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 2, 4, 5, 9, 683, 16, 20, 28, 30, 36, 43, 45, 18, 16, 23, 8, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 2, 4, 5, 9, 683, 16, 20, 28, 30, 36, 43, 45, 18, 16, 23, 8, 0, 0, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_047_hue[][24] = //ntsc 03:25 pal:
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 91, 907, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 91, 907, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 6, 296, 695, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 207, 791, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 207, 791, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 91, 907, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 91, 907, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 207, 791, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 207, 791, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_047_y2[][32]= //ntsc 0:03:26 pal :04:08
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 1, 2, 4, 6, 10, 14, 14, 11, 9, 13, 534, 17, 24, 31, 38, 50, 61, 60, 62, 24, 2, 1, 2, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 1, 2, 4, 6, 10, 14, 14, 11, 9, 13, 534, 17, 24, 31, 38, 50, 61, 60, 62, 24, 2, 1, 2, 0, 0, 0, },
	/*2*/ {0, 0, 0, 2, 3, 5, 7, 9, 12, 16, 17, 12, 9, 9, 13, 714, 9, 12, 14, 15, 17, 21, 24, 28, 19, 1, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 1, 2, 3, 5, 6, 7, 8, 8, 10, 494, 20, 19, 28, 33, 38, 52, 62, 59, 67, 54, 7, 2, 2, 1, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 1, 2, 3, 5, 6, 7, 8, 8, 10, 494, 20, 19, 28, 33, 38, 52, 62, 59, 67, 54, 7, 2, 2, 1, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 1, 2, 4, 6, 10, 14, 14, 11, 9, 13, 534, 17, 24, 31, 38, 50, 61, 60, 62, 24, 2, 1, 2, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 1, 2, 4, 6, 10, 14, 14, 11, 9, 13, 534, 17, 24, 31, 38, 50, 61, 60, 62, 24, 2, 1, 2, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 1, 2, 3, 5, 6, 7, 8, 8, 10, 494, 20, 19, 28, 33, 38, 52, 62, 59, 67, 54, 7, 2, 2, 1, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 1, 2, 3, 5, 6, 7, 8, 8, 10, 494, 20, 19, 28, 33, 38, 52, 62, 59, 67, 54, 7, 2, 2, 1, 0, 0, },

};

//No.49
unsigned short DynamicOptimizeSystem_049_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 10, 17, 35, 90, 105, 101, 91, 83, 70, 60, 52, 54, 48, 44, 38, 29, 24, 18, 11, 6, 3, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 10, 17, 35, 90, 105, 101, 91, 83, 70, 60, 52, 54, 48, 44, 38, 29, 24, 18, 11, 6, 3, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 10, 17, 35, 90, 105, 101, 91, 83, 70, 60, 52, 54, 48, 44, 38, 29, 24, 18, 11, 6, 3, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 9, 18, 51, 129, 167, 155, 126, 97, 64, 42, 36, 34, 25, 17, 11, 5, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 10, 17, 35, 90, 105, 101, 91, 83, 70, 60, 52, 54, 48, 44, 38, 29, 24, 18, 11, 6, 3, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 10, 17, 35, 90, 105, 101, 91, 83, 70, 60, 52, 54, 48, 44, 38, 29, 24, 18, 11, 6, 3, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 10, 17, 35, 90, 105, 101, 91, 83, 70, 60, 52, 54, 48, 44, 38, 29, 24, 18, 11, 6, 3, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 9, 18, 51, 129, 167, 155, 126, 97, 64, 42, 36, 34, 25, 17, 11, 5, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 10, 17, 35, 90, 105, 101, 91, 83, 70, 60, 52, 54, 48, 44, 38, 29, 24, 18, 11, 6, 3, 1, 0, 0, 0, 0, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_049_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 1, 110, 343, 421, 119, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },

};


//No.63
unsigned short DynamicOptimizeSystem_063_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 13, 5, 0, 19, 29, 15, 17, 28, 45, 30, 36, 53, 74, 79, 84, 89, 80, 66, 54, 51, 47, 45, 23, 2, 1, 0, 2, 0, 0, 0, 0, },
	/*1*/ {0, 12, 4, 0, 0, 0, 22, 31, 15, 22, 39, 43, 31, 51, 78, 79, 90, 100, 81, 66, 61, 54, 55, 38, 9, 1, 1, 2, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 17, 25, 15, 15, 27, 41, 40, 38, 46, 69, 78, 108, 96, 96, 78, 54, 46, 34, 31, 22, 8, 1, 1, 1, 1, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 6, 37, 21, 19, 34, 49, 36, 47, 68, 89, 87, 105, 84, 75, 63, 58, 68, 34, 4, 0, 1, 2, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 17, 25, 15, 15, 27, 41, 40, 38, 46, 69, 78, 108, 96, 96, 78, 54, 46, 34, 31, 22, 8, 1, 1, 1, 1, 0, 0, 0, },
	/*5*/ {21, 0, 24, 33, 18, 15, 25, 36, 45, 32, 44, 74, 78, 96, 97, 76, 71, 56, 44, 32, 20, 15, 10, 16, 6, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {21, 0, 0, 0, 16, 29, 14, 17, 27, 42, 36, 35, 57, 85, 93, 119, 103, 80, 70, 48, 32, 23, 15, 12, 10, 1, 0, 1, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 17, 25, 15, 15, 27, 41, 40, 38, 46, 69, 78, 108, 96, 96, 78, 54, 46, 34, 31, 22, 8, 1, 1, 1, 1, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 17, 25, 15, 15, 27, 41, 40, 38, 46, 69, 78, 108, 96, 96, 78, 54, 46, 34, 31, 22, 8, 1, 1, 1, 1, 0, 0, 0, },
};

unsigned short DynamicOptimizeSystem_063_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 50, 319, 479, 38, 31, 7, 6, 5, 3, 7, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 49, 315, 487, 36, 29, 7, 6, 4, 3, 6, 52, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 49, 379, 429, 38, 27, 5, 7, 2, 2, 6, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 49, 379, 429, 38, 27, 5, 7, 2, 2, 6, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 49, 379, 429, 38, 27, 5, 7, 2, 2, 6, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 71, 362, 440, 42, 28, 9, 4, 2, 4, 8, 22, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 52, 388, 429, 37, 29, 7, 6, 2, 2, 8, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 49, 379, 429, 38, 27, 5, 7, 2, 2, 6, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 49, 379, 429, 38, 27, 5, 7, 2, 2, 6, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};



//No.75
unsigned short DynamicOptimizeSystem_075_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 1, 12, 41, 48, 58, 70, 68, 53, 50, 79, 170, 65, 40, 41, 44, 41, 36, 28, 23, 18, 3, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 2, 16, 46, 44, 57, 61, 50, 48, 43, 181, 129, 47, 53, 55, 52, 40, 34, 24, 6, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 21, 4, 4, 19, 46, 48, 61, 69, 55, 50, 46, 133, 146, 41, 39, 40, 42, 42, 32, 23, 18, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 10, 44, 55, 62, 67, 58, 54, 62, 221, 69, 50, 55, 57, 48, 34, 25, 15, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 1, 12, 41, 48, 58, 70, 68, 53, 50, 79, 170, 65, 40, 41, 44, 41, 36, 28, 23, 18, 3, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {21, 4, 14, 40, 39, 42, 52, 48, 45, 45, 41, 137, 151, 42, 40, 42, 45, 44, 31, 25, 20, 16, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {21, 0, 0, 2, 15, 44, 42, 50, 55, 49, 50, 46, 84, 209, 46, 44, 45, 48, 47, 31, 25, 19, 10, 1, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 2, 15, 47, 50, 59, 69, 61, 50, 47, 81, 182, 57, 39, 41, 42, 43, 37, 28, 19, 16, 2, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 1, 12, 41, 48, 58, 70, 68, 53, 50, 79, 170, 65, 40, 41, 44, 41, 36, 28, 23, 18, 3, 0, 0, 0, 0, 0, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_075_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 2, 85, 104, 372, 216, 68, 33, 52, 20, 4, 0, 1, 5, 2, 6, 9, 6, 1, 0, 0, 0, 0, 0, },
	/*1*/ {0, 10, 120, 64, 305, 241, 82, 44, 58, 30, 7, 0, 0, 0, 1, 7, 8, 8, 2, 1, 0, 0, 0, 0, },
	/*2*/ {1, 2, 76, 77, 414, 178, 67, 50, 67, 22, 1, 0, 1, 1, 2, 6, 10, 9, 2, 1, 1, 0, 0, 0, },
	/*3*/ {0, 2, 127, 79, 424, 151, 57, 38, 61, 29, 3, 0, 0, 0, 1, 4, 6, 7, 1, 0, 0, 0, 0, 0, },
	/*4*/ {0, 2, 85, 104, 372, 216, 68, 33, 52, 20, 4, 0, 1, 5, 2, 6, 9, 6, 1, 0, 0, 0, 0, 0, },
	/*5*/ {0, 5, 132, 77, 401, 159, 66, 37, 64, 25, 3, 0, 0, 0, 1, 4, 6, 7, 2, 1, 0, 0, 0, 0, },
	/*6*/ {0, 3, 133, 73, 400, 165, 65, 36, 65, 25, 2, 0, 0, 0, 1, 4, 7, 7, 1, 1, 0, 0, 0, 0, },
	/*7*/ {0, 12, 157, 79, 432, 134, 35, 29, 60, 27, 4, 0, 0, 0, 1, 4, 6, 8, 1, 0, 0, 0, 0, 0, },
	/*8*/ {0, 2, 85, 104, 372, 216, 68, 33, 52, 20, 4, 0, 1, 5, 2, 6, 9, 6, 1, 0, 0, 0, 0, 0, },
};





unsigned short DynamicOptimizeSystem_075_y2[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 16, 5, 6, 13, 25, 31, 31, 47, 45, 39, 38, 119, 261, 41, 41, 44, 41, 41, 31, 26, 18, 13, 6, 7, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 16, 5, 0, 0, 5, 17, 27, 28, 42, 53, 44, 42, 71, 292, 50, 52, 55, 50, 42, 33, 26, 18, 8, 8, 1, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 21, 4, 4, 19, 46, 48, 61, 69, 55, 50, 46, 133, 146, 41, 39, 40, 42, 42, 32, 23, 18, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 1, 12, 41, 48, 58, 70, 68, 53, 50, 79, 170, 65, 40, 41, 44, 41, 36, 28, 23, 18, 3, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 1, 12, 41, 48, 58, 70, 68, 53, 50, 79, 170, 65, 40, 41, 44, 41, 36, 28, 23, 18, 3, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {22, 5, 12, 23, 28, 27, 36, 42, 33, 32, 68, 173, 195, 34, 33, 37, 37, 37, 30, 26, 22, 16, 9, 5, 5, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 16, 5, 0, 0, 5, 17, 27, 28, 42, 53, 44, 42, 71, 292, 50, 52, 55, 50, 42, 33, 26, 18, 8, 8, 1, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 3, 13, 25, 32, 30, 40, 44, 35, 34, 134, 254, 65, 35, 41, 40, 39, 34, 29, 25, 18, 8, 6, 3, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 1, 12, 41, 48, 58, 70, 68, 53, 50, 79, 170, 65, 40, 41, 44, 41, 36, 28, 23, 18, 3, 0, 0, 0, 0, 0, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_075_hue2[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {1, 2, 92, 105, 367, 186, 70, 47, 62, 24, 2, 0, 1, 1, 2, 6, 8, 10, 2, 1, 1, 0, 0, 0, },
	/*1*/ {0, 1, 76, 71, 339, 246, 81, 52, 63, 25, 3, 1, 1, 2, 2, 6, 10, 7, 1, 0, 0, 0, 0, 0, },
	/*2*/ {1, 2, 76, 77, 414, 178, 67, 50, 67, 22, 1, 0, 1, 1, 2, 6, 10, 9, 2, 1, 1, 0, 0, 0, },
	/*3*/ {0, 2, 85, 104, 372, 216, 68, 33, 52, 20, 4, 0, 1, 5, 2, 6, 9, 6, 1, 0, 0, 0, 0, 0, },
	/*4*/ {0, 2, 85, 104, 372, 216, 68, 33, 52, 20, 4, 0, 1, 5, 2, 6, 9, 6, 1, 0, 0, 0, 0, 0, },
	/*5*/ {0, 2, 83, 107, 401, 184, 69, 32, 50, 16, 1, 1, 2, 13, 4, 5, 11, 6, 1, 0, 0, 0, 0, 0, },
	/*6*/ {0, 1, 76, 71, 339, 246, 81, 52, 63, 25, 3, 1, 1, 2, 2, 6, 10, 7, 1, 0, 0, 0, 0, 0, },
	/*7*/ {0, 2, 82, 97, 430, 157, 57, 38, 52, 22, 4, 0, 1, 10, 5, 8, 12, 8, 1, 1, 0, 0, 0, 0, },
	/*8*/ {0, 2, 85, 104, 372, 216, 68, 33, 52, 20, 4, 0, 1, 5, 2, 6, 9, 6, 1, 0, 0, 0, 0, 0, },
};

//No.107
unsigned short DynamicOptimizeSystem_107_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 17, 5, 1, 11, 22, 25, 44, 36, 29, 41, 32, 46, 64, 71, 80, 96, 69, 52, 46, 45, 48, 42, 20, 21, 15, 2, 1, 3, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 7, 23, 20, 41, 37, 50, 33, 36, 52, 82, 88, 119, 87, 60, 58, 57, 53, 34, 18, 21, 8, 1, 1, 1, 0, 0, },
	/*2*/ {0, 24, 2, 0, 8, 30, 22, 42, 28, 35, 39, 36, 51, 56, 69, 84, 107, 73, 53, 43, 51, 44, 33, 20, 13, 16, 2, 1, 3, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 1, 1, 31, 28, 39, 32, 48, 38, 49, 63, 76, 96, 123, 80, 57, 45, 53, 51, 29, 18, 22, 2, 3, 2, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 2, 6, 30, 25, 35, 42, 18, 40, 19, 25, 43, 69, 76, 82, 96, 82, 58, 50, 44, 41, 23, 21, 33, 10, 2, 1, 10, 0, 0, },
	/*5*/ {0, 17, 5, 1, 11, 22, 25, 44, 36, 29, 41, 32, 46, 64, 71, 80, 96, 69, 52, 46, 45, 48, 42, 20, 21, 15, 2, 1, 3, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 7, 23, 20, 41, 37, 50, 33, 36, 52, 82, 88, 119, 87, 60, 58, 57, 53, 34, 18, 21, 8, 1, 1, 1, 0, 0, },
	/*7*/ {0, 0, 0, 1, 8, 28, 25, 35, 41, 19, 40, 19, 25, 43, 69, 78, 80, 95, 85, 61, 48, 44, 40, 25, 20, 29, 11, 3, 2, 8, 0, 0, },
	/*8*/ {0, 0, 0, 2, 6, 30, 25, 35, 42, 18, 40, 19, 25, 43, 69, 76, 82, 96, 82, 58, 50, 44, 41, 23, 21, 33, 10, 2, 1, 10, 0, 0, },
};
unsigned short DynamicOptimizeSystem_107_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {3, 6, 9, 154, 354, 69, 33, 18, 12, 10, 11, 13, 41, 30, 50, 48, 114, 10, 0, 0, 0, 0, 0, 1, },
	/*1*/ {2, 5, 7, 198, 368, 34, 21, 8, 6, 4, 6, 10, 50, 37, 60, 51, 105, 17, 0, 0, 0, 0, 0, 0, },
	/*2*/ {3, 4, 17, 138, 404, 41, 37, 16, 19, 9, 8, 11, 29, 36, 54, 44, 104, 12, 1, 0, 0, 0, 0, 1, },
	/*3*/ {2, 10, 24, 254, 360, 37, 18, 11, 11, 2, 3, 4, 6, 18, 45, 36, 118, 25, 2, 1, 0, 0, 0, 1, },
	/*4*/ {1, 7, 21, 221, 398, 52, 15, 8, 4, 2, 3, 4, 11, 25, 48, 30, 121, 17, 1, 0, 0, 0, 0, 0, },
	/*5*/ {3, 6, 9, 154, 354, 69, 33, 18, 12, 10, 11, 13, 41, 30, 50, 48, 114, 10, 0, 0, 0, 0, 0, 1, },
	/*6*/ {2, 5, 7, 198, 368, 34, 21, 8, 6, 4, 6, 10, 50, 37, 60, 51, 105, 17, 0, 0, 0, 0, 0, 0, },
	/*7*/ {2, 10, 24, 254, 360, 37, 18, 11, 11, 2, 3, 4, 6, 18, 45, 36, 118, 25, 2, 1, 0, 0, 0, 1, },
	/*8*/ {1, 7, 21, 221, 398, 52, 15, 8, 4, 2, 3, 4, 11, 25, 48, 30, 121, 17, 1, 0, 0, 0, 0, 0, },
};

//No.123
unsigned short DynamicOptimizeSystem_123_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {1, 32, 3, 1, 0, 2, 60, 1, 141, 160, 66, 12, 202, 188, 26, 31, 11, 27, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 2, 32, 1, 0, 3, 59, 2, 189, 167, 18, 16, 373, 31, 34, 14, 39, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {1, 32, 3, 1, 0, 2, 60, 1, 141, 160, 66, 12, 202, 188, 26, 31, 11, 27, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 4, 31, 0, 0, 0, 61, 0, 125, 149, 101, 11, 167, 228, 25, 30, 12, 21, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, },
	/*4*/ {1, 32, 3, 1, 0, 2, 60, 1, 141, 160, 66, 12, 202, 188, 26, 31, 11, 27, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {53, 1, 0, 1, 54, 2, 99, 128, 138, 15, 10, 362, 30, 27, 19, 11, 32, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {23, 20, 10, 1, 0, 1, 54, 4, 147, 168, 57, 11, 244, 147, 26, 25, 12, 36, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 4, 31, 0, 0, 0, 61, 0, 125, 149, 101, 11, 167, 228, 25, 30, 12, 21, 25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, },
	/*8*/ {1, 32, 3, 1, 0, 2, 60, 1, 141, 160, 66, 12, 202, 188, 26, 31, 11, 27, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_123_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {5, 122, 326, 1, 1, 1, 0, 2, 4, 50, 95, 7, 4, 3, 3, 7, 59, 8, 3, 4, 7, 59, 210, 7, },
	/*1*/ {4, 69, 368, 9, 3, 2, 2, 4, 4, 58, 95, 7, 4, 3, 3, 6, 61, 5, 2, 4, 6, 65, 199, 7, },
	/*2*/ {5, 122, 326, 1, 1, 1, 0, 2, 4, 50, 95, 7, 4, 3, 3, 7, 59, 8, 3, 4, 7, 59, 210, 7, },
	/*3*/ {2, 107, 326, 12, 3, 1, 0, 0, 1, 59, 124, 5, 2, 1, 2, 6, 57, 4, 2, 3, 3, 87, 181, 2, },
	/*4*/ {5, 122, 326, 1, 1, 1, 0, 2, 4, 50, 95, 7, 4, 3, 3, 7, 59, 8, 3, 4, 7, 59, 210, 7, },
	/*5*/ {4, 145, 280, 14, 2, 1, 2, 2, 6, 99, 78, 5, 2, 2, 2, 8, 56, 5, 3, 3, 5, 80, 177, 7, },
	/*6*/ {4, 144, 276, 15, 3, 2, 2, 4, 7, 98, 78, 6, 3, 3, 3, 8, 55, 5, 3, 3, 5, 82, 172, 7, },
	/*7*/ {2, 107, 326, 12, 3, 1, 0, 0, 1, 59, 124, 5, 2, 1, 2, 6, 57, 4, 2, 3, 3, 87, 181, 2, },
	/*8*/ {5, 122, 326, 1, 1, 1, 0, 2, 4, 50, 95, 7, 4, 3, 3, 7, 59, 8, 3, 4, 7, 59, 210, 7, },
};

//No.132
unsigned short DynamicOptimizeSystem_132_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 85, 4, 0, 133, 1, 0, 0, 1, 134, 0, 1, 98, 0, 0, 1, 126, 1, 1, 136, 1, 0, 0, 3, 133, 1, 6, 120, 0, 0, },
	/*1*/ {0, 0, 0, 85, 4, 0, 133, 1, 0, 0, 1, 134, 0, 1, 98, 0, 0, 1, 126, 1, 1, 136, 1, 0, 0, 3, 133, 1, 6, 120, 0, 0, },
	/*2*/ {0, 13, 93, 0, 1, 129, 0, 0, 0, 2, 129, 0, 0, 129, 0, 0, 0, 0, 122, 0, 0, 119, 0, 0, 0, 0, 109, 1, 2, 137, 0, 0, },
	/*3*/ {0, 13, 93, 0, 1, 129, 0, 0, 0, 2, 129, 0, 0, 129, 0, 0, 0, 0, 122, 0, 0, 119, 0, 0, 0, 0, 109, 1, 2, 137, 0, 0, },
	/*4*/ {0, 13, 93, 0, 1, 129, 0, 0, 0, 2, 129, 0, 0, 129, 0, 0, 0, 0, 122, 0, 0, 119, 0, 0, 0, 0, 109, 1, 2, 137, 0, 0, },
	/*5*/ {0, 0, 0, 85, 4, 0, 133, 1, 0, 0, 1, 134, 0, 1, 98, 0, 0, 1, 126, 1, 1, 136, 1, 0, 0, 3, 133, 1, 6, 120, 0, 0, },
	/*6*/ {0, 0, 0, 85, 4, 0, 133, 1, 0, 0, 1, 134, 0, 1, 98, 0, 0, 1, 126, 1, 1, 136, 1, 0, 0, 3, 133, 1, 6, 120, 0, 0, },
	/*7*/ {0, 13, 93, 0, 1, 129, 0, 0, 0, 2, 129, 0, 0, 129, 0, 0, 0, 0, 122, 0, 0, 119, 0, 0, 0, 0, 109, 1, 2, 137, 0, 0, },
	/*8*/ {0, 13, 93, 0, 1, 129, 0, 0, 0, 2, 129, 0, 0, 129, 0, 0, 0, 0, 122, 0, 0, 119, 0, 0, 0, 0, 109, 1, 2, 137, 0, 0, },
};
unsigned short DynamicOptimizeSystem_132_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {2, 4, 167, 0, 0, 162, 11, 0, 1, 165, 4, 1, 1, 3, 164, 0, 0, 170, 3, 0, 1, 110, 17, 2, },
	/*1*/ {2, 4, 167, 0, 0, 162, 11, 0, 1, 165, 4, 1, 1, 3, 164, 0, 0, 170, 3, 0, 1, 110, 17, 2, },
	/*2*/ {2, 7, 137, 0, 0, 3, 170, 0, 0, 163, 8, 0, 3, 155, 12, 0, 0, 11, 153, 1, 0, 21, 139, 2, },
	/*3*/ {1, 6, 165, 0, 0, 0, 172, 0, 0, 5, 150, 0, 1, 13, 156, 0, 0, 14, 158, 0, 0, 4, 147, 0, },
	/*4*/ {1, 6, 165, 0, 0, 0, 172, 0, 0, 5, 150, 0, 1, 13, 156, 0, 0, 14, 158, 0, 0, 4, 147, 0, },
	/*5*/ {2, 4, 167, 0, 0, 162, 11, 0, 1, 165, 4, 1, 1, 3, 164, 0, 0, 170, 3, 0, 1, 110, 17, 2, },
	/*6*/ {2, 4, 167, 0, 0, 162, 11, 0, 1, 165, 4, 1, 1, 3, 164, 0, 0, 170, 3, 0, 1, 110, 17, 2, },
	/*7*/ {1, 6, 165, 0, 0, 0, 172, 0, 0, 5, 150, 0, 1, 13, 156, 0, 0, 14, 158, 0, 0, 4, 147, 0, },
	/*8*/ {1, 6, 165, 0, 0, 0, 172, 0, 0, 5, 150, 0, 1, 13, 156, 0, 0, 14, 158, 0, 0, 4, 147, 0, },
};

//No.133
unsigned short DynamicOptimizeSystem_133_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 27, 7, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 895, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 37, 1, 0, 0, },
	/*1*/ {0, 26, 7, 1, 0, 0, 1, 0, 0, 0, 0, 3, 0, 0, 0, 0, 894, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 2, 38, 0, 0, 0, },
	/*2*/ {1, 23, 2, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 938, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 16, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 946, 6, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 27, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 946, 6, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 27, 0, 0, },
	/*5*/ {0, 27, 7, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 895, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 37, 1, 0, 0, },
	/*6*/ {0, 26, 7, 1, 0, 0, 1, 0, 0, 0, 0, 3, 0, 0, 0, 0, 894, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 2, 38, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 946, 6, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 27, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 946, 6, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 27, 0, 0, },
};
unsigned short DynamicOptimizeSystem_133_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {8, 49, 110, 11, 18, 24, 45, 31, 30, 97, 98, 34, 58, 111, 42, 15, 14, 101, 64, 7, 13, 2, 2, 5, },
	/*1*/ {4, 26, 73, 7, 7, 11, 23, 45, 61, 242, 139, 115, 68, 29, 13, 10, 11, 68, 27, 4, 3, 3, 0, 1, },
	/*2*/ {2, 28, 82, 9, 13, 15, 14, 25, 43, 210, 124, 59, 78, 106, 58, 11, 10, 51, 54, 0, 0, 0, 1, 1, },
	/*3*/ {4, 71, 182, 13, 9, 9, 33, 17, 21, 214, 90, 1, 1, 1, 3, 4, 8, 192, 88, 18, 5, 2, 1, 2, },
	/*4*/ {4, 71, 182, 13, 9, 9, 33, 17, 21, 214, 90, 1, 1, 1, 3, 4, 8, 192, 88, 18, 5, 2, 1, 2, },
	/*5*/ {8, 49, 110, 11, 18, 24, 45, 31, 30, 97, 98, 34, 58, 111, 42, 15, 14, 101, 64, 7, 13, 2, 2, 5, },
	/*6*/ {4, 26, 73, 7, 7, 11, 23, 45, 61, 242, 139, 115, 68, 29, 13, 10, 11, 68, 27, 4, 3, 3, 0, 1, },
	/*7*/ {4, 71, 182, 13, 9, 9, 33, 17, 21, 214, 90, 1, 1, 1, 3, 4, 8, 192, 88, 18, 5, 2, 1, 2, },
	/*8*/ {4, 71, 182, 13, 9, 9, 33, 17, 21, 214, 90, 1, 1, 1, 3, 4, 8, 192, 88, 18, 5, 2, 1, 2, },
};
unsigned short DynamicOptimizeSystem_133_hue2[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {20, 33, 36, 12, 13, 13, 29, 32, 29, 45, 55, 31, 58, 20, 57, 243, 76, 100, 50, 13, 7, 4, 4, 6, },
	/*1*/ {4, 26, 73, 7, 7, 11, 23, 45, 61, 242, 139, 115, 68, 29, 13, 10, 11, 68, 27, 4, 3, 3, 0, 1, },
	/*2*/ {2, 28, 82, 9, 13, 15, 14, 25, 43, 210, 124, 59, 78, 106, 58, 11, 10, 51, 54, 0, 0, 0, 1, 1, },
	/*3*/ {4, 71, 182, 13, 9, 9, 33, 17, 21, 214, 90, 1, 1, 1, 3, 4, 8, 192, 88, 18, 5, 2, 1, 2, },
	/*4*/ {4, 71, 182, 13, 9, 9, 33, 17, 21, 214, 90, 1, 1, 1, 3, 4, 8, 192, 88, 18, 5, 2, 1, 2, },
	/*5*/ {20, 33, 36, 12, 13, 13, 29, 32, 29, 45, 55, 31, 58, 20, 57, 243, 76, 100, 50, 13, 7, 4, 4, 6, },
	/*6*/ {4, 26, 73, 7, 7, 11, 23, 45, 61, 242, 139, 115, 68, 29, 13, 10, 11, 68, 27, 4, 3, 3, 0, 1, },
	/*7*/ {4, 71, 182, 13, 9, 9, 33, 17, 21, 214, 90, 1, 1, 1, 3, 4, 8, 192, 88, 18, 5, 2, 1, 2, },
	/*8*/ {4, 71, 182, 13, 9, 9, 33, 17, 21, 214, 90, 1, 1, 1, 3, 4, 8, 192, 88, 18, 5, 2, 1, 2, },
};

//No.134
unsigned short DynamicOptimizeSystem_134_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 4, 1, 0, 0, 1, 967, 1, 5, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 4, 1, 0, 0, 1, 967, 1, 5, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 975, 1, 4, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 1, 0, 0, 0, 962, 5, 1, 6, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 1, 0, 0, 0, 962, 5, 1, 6, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 4, 1, 0, 0, 1, 967, 1, 5, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 4, 1, 0, 0, 1, 967, 1, 5, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 1, 0, 0, 0, 962, 5, 1, 6, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 4, 1, 0, 0, 0, 962, 5, 1, 6, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_134_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {2, 68, 157, 7, 8, 8, 27, 48, 45, 174, 132, 31, 24, 9, 8, 8, 10, 160, 56, 2, 3, 1, 1, 2, },
	/*1*/ {0, 112, 219, 6, 0, 0, 0, 0, 5, 145, 191, 3, 0, 0, 0, 0, 1, 160, 154, 0, 0, 0, 0, 0, },
	/*2*/ {18, 132, 162, 6, 6, 3, 3, 0, 5, 258, 78, 4, 0, 0, 1, 2, 5, 75, 233, 0, 0, 0, 0, 0, },
	/*3*/ {0, 108, 216, 5, 0, 0, 0, 0, 3, 212, 138, 2, 1, 0, 0, 0, 2, 184, 123, 0, 0, 0, 0, 0, },
	/*4*/ {0, 108, 216, 5, 0, 0, 0, 0, 3, 212, 138, 2, 1, 0, 0, 0, 2, 184, 123, 0, 0, 0, 0, 0, },
	/*5*/ {0, 112, 219, 6, 0, 0, 0, 0, 5, 145, 191, 3, 0, 0, 0, 0, 1, 160, 154, 0, 0, 0, 0, 0, },
	/*6*/ {0, 112, 219, 6, 0, 0, 0, 0, 5, 145, 191, 3, 0, 0, 0, 0, 1, 160, 154, 0, 0, 0, 0, 0, },
	/*7*/ {0, 108, 216, 5, 0, 0, 0, 0, 3, 212, 138, 2, 1, 0, 0, 0, 2, 184, 123, 0, 0, 0, 0, 0, },
	/*8*/ {0, 108, 216, 5, 0, 0, 0, 0, 3, 212, 138, 2, 1, 0, 0, 0, 2, 184, 123, 0, 0, 0, 0, 0, },
};


//No.135
unsigned short DynamicOptimizeSystem_135_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 946, 2, 2, 1, 1, 0, 0, 0, 1, 1, 1, 1, 6, 29, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 946, 2, 2, 1, 1, 0, 0, 0, 1, 1, 1, 1, 6, 29, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 953, 2, 2, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 21, 7, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 936, 10, 1, 2, 1, 0, 0, 0, 0, 0, 1, 1, 1, 2, 33, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 936, 10, 1, 2, 1, 0, 0, 0, 0, 0, 1, 1, 1, 2, 33, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 946, 2, 2, 1, 1, 0, 0, 0, 1, 1, 1, 1, 6, 29, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 946, 2, 2, 1, 1, 0, 0, 0, 1, 1, 1, 1, 6, 29, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 936, 10, 1, 2, 1, 0, 0, 0, 0, 0, 1, 1, 1, 2, 33, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 936, 10, 1, 2, 1, 0, 0, 0, 0, 0, 1, 1, 1, 2, 33, 0, 0, },
};
unsigned short DynamicOptimizeSystem_135_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 85, 232, 9, 4, 1, 0, 0, 9, 244, 92, 0, 0, 0, 0, 1, 8, 209, 101, 0, 0, 0, 0, 0, },
	/*1*/ {0, 85, 232, 9, 4, 1, 0, 0, 9, 244, 92, 0, 0, 0, 0, 1, 8, 209, 101, 0, 0, 0, 0, 0, },
	/*2*/ {41, 69, 184, 13, 16, 12, 5, 0, 11, 248, 67, 7, 0, 2, 4, 8, 16, 81, 205, 0, 0, 0, 0, 0, },
	/*3*/ {0, 83, 223, 10, 4, 1, 0, 1, 9, 269, 88, 0, 0, 0, 0, 0, 4, 223, 77, 0, 0, 0, 0, 0, },
	/*4*/ {0, 83, 223, 10, 4, 1, 0, 1, 9, 269, 88, 0, 0, 0, 0, 0, 4, 223, 77, 0, 0, 0, 0, 0, },
	/*5*/ {0, 85, 232, 9, 4, 1, 0, 0, 9, 244, 92, 0, 0, 0, 0, 1, 8, 209, 101, 0, 0, 0, 0, 0, },
	/*6*/ {0, 85, 232, 9, 4, 1, 0, 0, 9, 244, 92, 0, 0, 0, 0, 1, 8, 209, 101, 0, 0, 0, 0, 0, },
	/*7*/ {0, 83, 223, 10, 4, 1, 0, 1, 9, 269, 88, 0, 0, 0, 0, 0, 4, 223, 77, 0, 0, 0, 0, 0, },
	/*8*/ {0, 83, 223, 10, 4, 1, 0, 1, 9, 269, 88, 0, 0, 0, 0, 0, 4, 223, 77, 0, 0, 0, 0, 0, },
};


unsigned short DynamicOptimizeSystem_139_y[][32]= // for LG_disk #139 and LG Leaf disk #38
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
    /*0*/ {0, 16, 6, 5, 11, 18, 27, 34, 39, 40, 43, 53, 62, 74, 177, 71, 60, 53, 43, 40, 36, 30, 21, 14, 9, 4, 0, 0, 0, 0, 0, 0, },
    /*1*/ {0, 13, 3, 2, 4, 4, 13, 20, 32, 40, 42, 46, 56, 63, 72, 188, 75, 65, 57, 46, 42, 37, 28, 19, 13, 6, 1, 0, 0, 0, 0, 0, },
    /*2*/ {0, 26, 8, 11, 15, 20, 29, 35, 42, 50, 60, 62, 65, 64, 66, 63, 65, 61, 55, 47, 38, 32, 25, 18, 13, 9, 6, 1, 0, 0, 0, 0, },
    /*3*/ {0, 0, 0, 3, 11, 23, 32, 41, 50, 60, 71, 65, 57, 54, 54, 54, 58, 67, 72, 60, 51, 41, 28, 19, 13, 3, 0, 0, 0, 0, 0, 0, },
    /*4*/ {0, 0, 7, 13, 22, 30, 36, 45, 50, 53, 57, 55, 52, 47, 45, 46, 50, 54, 55, 53, 49, 44, 35, 30, 24, 18, 10, 6, 1, 0, 0, 0, },
    /*5*/ {23, 4, 9, 15, 22, 29, 34, 36, 37, 41, 49, 50, 77, 190, 63, 51, 48, 40, 37, 35, 31, 24, 17, 11, 8, 3, 0, 0, 0, 0, 0, 0, },
    /*6*/ {16, 2, 4, 3, 11, 16, 25, 34, 39, 39, 42, 52, 51, 67, 203, 70, 53, 53, 42, 39, 37, 32, 22, 15, 11, 5, 1, 0, 0, 0, 0, 0, },
    /*7*/ {0, 0, 7, 13, 22, 30, 36, 45, 50, 53, 57, 55, 52, 47, 45, 46, 50, 54, 55, 53, 49, 44, 35, 30, 24, 18, 10, 6, 1, 0, 0, 0, },
    /*8*/ {0, 0, 7, 13, 22, 30, 36, 45, 50, 53, 57, 55, 52, 47, 45, 46, 50, 54, 55, 53, 49, 44, 35, 30, 24, 18, 10, 6, 1, 0, 0, 0, }
};

//No.147
unsigned short DynamicOptimizeSystem_147_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 3, 4, 1, 5, 8, 2, 4, 3, 6, 11, 7, 8, 20, 21, 751, 38, 19, 15, 7, 8, 10, 4, 3, 3, 4, 9, 1, 2, 5, 2, 0, },
	/*1*/ {0, 0, 0, 0, 2, 1, 2, 8, 5, 8, 6, 6, 10, 19, 14, 30, 67, 661, 42, 24, 17, 15, 9, 8, 10, 7, 9, 3, 2, 1, 0, 0, },
	/*2*/ {0, 3, 4, 1, 5, 8, 2, 4, 3, 6, 11, 7, 8, 20, 21, 751, 38, 19, 15, 7, 8, 10, 4, 3, 3, 4, 9, 1, 2, 5, 2, 0, },
	/*3*/ {0, 0, 0, 3, 2, 2, 8, 3, 6, 5, 9, 11, 11, 22, 36, 760, 26, 21, 11, 11, 8, 7, 6, 4, 9, 1, 3, 3, 0, 0, 0, 0, },
	/*4*/ {0, 1, 12, 1, 1, 8, 14, 3, 2, 2, 3, 11, 17, 9, 40, 702, 64, 11, 13, 15, 6, 2, 2, 2, 5, 17, 1, 2, 4, 15, 0, 0, },
	/*5*/ {0, 3, 4, 1, 5, 8, 2, 4, 3, 6, 11, 7, 8, 20, 21, 751, 38, 19, 15, 7, 8, 10, 4, 3, 3, 4, 9, 1, 2, 5, 2, 0, },
	/*6*/ {0, 0, 0, 0, 2, 1, 2, 8, 5, 8, 6, 6, 10, 19, 14, 30, 67, 661, 42, 24, 17, 15, 9, 8, 10, 7, 9, 3, 2, 1, 0, 0, },
	/*7*/ {0, 3, 4, 1, 5, 8, 2, 4, 3, 6, 11, 7, 8, 20, 21, 751, 38, 19, 15, 7, 8, 10, 4, 3, 3, 4, 9, 1, 2, 5, 2, 0, },
	/*8*/ {0, 1, 12, 1, 1, 8, 14, 3, 2, 2, 3, 11, 17, 9, 40, 702, 64, 11, 13, 15, 6, 2, 2, 2, 5, 17, 1, 2, 4, 15, 0, 0, }
};
unsigned short DynamicOptimizeSystem_147_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {7, 63, 76, 10, 11, 44, 116, 9, 9, 60, 92, 12, 12, 99, 45, 9, 16, 82, 64, 2, 3, 51, 89, 8, },
	/*1*/ {9, 11, 98, 21, 10, 21, 140, 35, 25, 90, 63, 21, 24, 91, 42, 9, 16, 116, 7, 3, 7, 37, 77, 15, },
	/*2*/ {7, 63, 76, 10, 11, 44, 116, 9, 9, 60, 92, 12, 12, 99, 45, 9, 16, 82, 64, 2, 3, 51, 89, 8, },
	/*3*/ {7, 63, 76, 10, 11, 44, 116, 9, 9, 60, 92, 12, 12, 99, 45, 9, 16, 82, 64, 2, 3, 51, 89, 8, },
	/*4*/ {6, 10, 92, 32, 40, 107, 34, 25, 30, 36, 101, 21, 21, 27, 102, 34, 36, 95, 11, 8, 11, 20, 83, 7, },
	/*5*/ {7, 63, 76, 10, 11, 44, 116, 9, 9, 60, 92, 12, 12, 99, 45, 9, 16, 82, 64, 2, 3, 51, 89, 8, },
	/*6*/ {9, 11, 98, 21, 10, 21, 140, 35, 25, 90, 63, 21, 24, 91, 42, 9, 16, 116, 7, 3, 7, 37, 77, 15, },
	/*7*/ {7, 63, 76, 10, 11, 44, 116, 9, 9, 60, 92, 12, 12, 99, 45, 9, 16, 82, 64, 2, 3, 51, 89, 8, },
	/*8*/ {6, 10, 92, 32, 40, 107, 34, 25, 30, 36, 101, 21, 21, 27, 102, 34, 36, 95, 11, 8, 11, 20, 83, 7, }
};

unsigned short DynamicOptimizeSystem_147_y2[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 1, 2, 5, 7, 10, 10, 11, 15, 22, 28, 70, 600, 83, 34, 22, 18, 12, 11, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 1, 2, 4, 7, 11, 15, 20, 26, 41, 117, 561, 68, 38, 24, 19, 15, 10, 6, 3, 2, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 1, 2, 5, 7, 10, 10, 11, 15, 22, 28, 70, 600, 83, 34, 22, 18, 12, 11, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, },
	/*3*/ {0, 3, 2, 5, 4, 5, 7, 0, 0, 0, 13, 1, 0, 15, 32, 839, 3, 13, 0, 4, 12, 0, 0, 2, 12, 2, 4, 10, 0, 0, 0, 0, },
	/*4*/ {0, 2, 9, 2, 2, 8, 12, 4, 4, 3, 4, 13, 15, 12, 48, 678, 72, 15, 12, 16, 6, 4, 3, 4, 6, 13, 2, 2, 5, 10, 0, 0, },
	/*5*/ {0, 0, 0, 0, 1, 2, 5, 7, 10, 10, 11, 15, 22, 28, 70, 600, 83, 34, 22, 18, 12, 11, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 1, 2, 4, 7, 11, 15, 20, 26, 41, 117, 561, 68, 38, 24, 19, 15, 10, 6, 3, 2, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 1, 2, 5, 7, 10, 10, 11, 15, 22, 28, 70, 600, 83, 34, 22, 18, 12, 11, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, },
	/*8*/ {0, 2, 9, 2, 2, 8, 12, 4, 4, 3, 4, 13, 15, 12, 48, 678, 72, 15, 12, 16, 6, 4, 3, 4, 6, 13, 2, 2, 5, 10, 0, 0, }
};
unsigned short DynamicOptimizeSystem_147_hue2[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {14, 78, 54, 3, 4, 27, 142, 14, 10, 45, 99, 18, 18, 112, 18, 5, 14, 70, 88, 5, 3, 36, 99, 14, },
	/*1*/ {15, 22, 87, 14, 3, 9, 160, 49, 30, 81, 58, 27, 31, 89, 30, 5, 13, 113, 13, 4, 3, 36, 75, 20, },
	/*2*/ {14, 78, 54, 3, 4, 27, 142, 14, 10, 45, 99, 18, 18, 112, 18, 5, 14, 70, 88, 5, 3, 36, 99, 14, },
	/*3*/ {14, 78, 54, 3, 4, 27, 142, 14, 10, 45, 99, 18, 18, 112, 18, 5, 14, 70, 88, 5, 3, 36, 99, 14, },
	/*4*/ {7, 10, 90, 31, 37, 108, 34, 23, 29, 37, 99, 21, 20, 25, 102, 34, 37, 98, 12, 7, 11, 23, 85, 9, },
	/*5*/ {14, 78, 54, 3, 4, 27, 142, 14, 10, 45, 99, 18, 18, 112, 18, 5, 14, 70, 88, 5, 3, 36, 99, 14, },
	/*6*/ {15, 22, 87, 14, 3, 9, 160, 49, 30, 81, 58, 27, 31, 89, 30, 5, 13, 113, 13, 4, 3, 36, 75, 20, },
	/*7*/ {14, 78, 54, 3, 4, 27, 142, 14, 10, 45, 99, 18, 18, 112, 18, 5, 14, 70, 88, 5, 3, 36, 99, 14, },
	/*8*/ {7, 10, 90, 31, 37, 108, 34, 23, 29, 37, 99, 21, 20, 25, 102, 34, 37, 98, 12, 7, 11, 23, 85, 9, }
};
unsigned short DynamicOptimizeSystem_147_y3[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 2, 4, 7, 12, 17, 19, 27, 39, 91, 525, 107, 44, 30, 19, 17, 13, 9, 5, 2, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 4, 8, 18, 26, 34, 53, 152, 482, 86, 49, 30, 22, 14, 8, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 2, 4, 7, 12, 17, 19, 27, 39, 91, 525, 107, 44, 30, 19, 17, 13, 9, 5, 2, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 1, 2, 3, 2, 4, 4, 4, 9, 10, 16, 32, 822, 25, 13, 11, 8, 5, 5, 5, 2, 4, 1, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 2, 9, 2, 2, 8, 12, 4, 4, 3, 4, 13, 15, 12, 48, 678, 72, 15, 12, 16, 6, 4, 3, 4, 6, 13, 2, 2, 5, 10, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 2, 4, 7, 12, 17, 19, 27, 39, 91, 525, 107, 44, 30, 19, 17, 13, 9, 5, 2, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 4, 8, 18, 26, 34, 53, 152, 482, 86, 49, 30, 22, 14, 8, 3, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 2, 4, 7, 12, 17, 19, 27, 39, 91, 525, 107, 44, 30, 19, 17, 13, 9, 5, 2, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 2, 9, 2, 2, 8, 12, 4, 4, 3, 4, 13, 15, 12, 48, 678, 72, 15, 12, 16, 6, 4, 3, 4, 6, 13, 2, 2, 5, 10, 0, 0, }
};
unsigned short DynamicOptimizeSystem_147_hue3[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {21, 88, 23, 0, 3, 23, 143, 19, 12, 26, 104, 26, 25, 114, 9, 4, 17, 69, 100, 7, 4, 26, 104, 22, },
	/*1*/ {22, 84, 25, 3, 2, 6, 158, 51, 40, 34, 83, 45, 49, 97, 4, 5, 15, 111, 17, 6, 4, 5, 78, 46, },
	/*2*/ {21, 88, 23, 0, 3, 23, 143, 19, 12, 26, 104, 26, 25, 114, 9, 4, 17, 69, 100, 7, 4, 26, 104, 22, },
	/*3*/ {21, 88, 23, 0, 3, 23, 143, 19, 12, 26, 104, 26, 25, 114, 9, 4, 17, 69, 100, 7, 4, 26, 104, 22, },
	/*4*/ {7, 10, 90, 31, 37, 108, 34, 23, 29, 37, 99, 21, 20, 25, 102, 34, 37, 98, 12, 7, 11, 23, 85, 9, },
	/*5*/ {21, 88, 23, 0, 3, 23, 143, 19, 12, 26, 104, 26, 25, 114, 9, 4, 17, 69, 100, 7, 4, 26, 104, 22, },
	/*6*/ {22, 84, 25, 3, 2, 6, 158, 51, 40, 34, 83, 45, 49, 97, 4, 5, 15, 111, 17, 6, 4, 5, 78, 46, },
	/*7*/ {21, 88, 23, 0, 3, 23, 143, 19, 12, 26, 104, 26, 25, 114, 9, 4, 17, 69, 100, 7, 4, 26, 104, 22, },
	/*8*/ {7, 10, 90, 31, 37, 108, 34, 23, 29, 37, 99, 21, 20, 25, 102, 34, 37, 98, 12, 7, 11, 23, 85, 9, }
};

unsigned short DynamicOptimizeSystem_151_y[][32]=//
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {1, 808, 106, 10, 7, 5, 4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 4, 4, 3, 1, 1, 0, 0, 0, 0, },
	/*1*/ {0, 25, 2, 45, 842, 9, 6, 4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 4, 3, 3, 2, 0, 0, },
	/*2*/ {1, 896, 52, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 2, 1, 0, 0, },
	/*3*/ {0, 0, 1, 928, 10, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 9, 10, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {896, 14, 8, 5, 4, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 4, 4, 5, 4, 2, 1, 0, 0, 0, 0, },
	/*6*/ {22, 558, 355, 8, 5, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 0, 0, 0, },
	/*7*/ {2, 31, 910, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 3, 13, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

/*For TV NTSC colorbar*/
/*US-14*/
unsigned short DynamicOptimizeSystem_160_y[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {143, 10, 13, 8, 9, 11, 14, 11, 15, 7, 6, 9, 15, 15, 175, 25, 6, 6, 5, 10, 6, 6, 17, 9, 6, 6, 8, 7, 10, 277, 107, 13, },
	/*1*/ {37, 71, 33, 9, 14, 9, 10, 12, 17, 9, 15, 7, 7, 12, 18, 159, 45, 6, 6, 5, 10, 7, 12, 13, 8, 6, 7, 9, 9, 193, 190, 18, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_160_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {8, 10, 127, 2, 1, 15, 135, 27, 27, 56, 120, 12, 6, 12, 109, 7, 11, 68, 74, 7, 8, 58, 79, 10, },
	/*1*/ {7, 20, 112, 1, 1, 22, 133, 36, 23, 59, 116, 18, 12, 19, 102, 8, 12, 88, 46, 5, 8, 63, 71, 9, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
/*US-63*/
unsigned short DynamicOptimizeSystem_161_y[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {292, 1, 68, 1, 1, 0, 68, 1, 2, 67, 1, 0, 0, 67, 1, 14, 56, 0, 0, 1, 68, 3, 62, 5, 0, 0, 0, 0, 0, 1, 205, 1, },
	/*1*/ {0, 82, 208, 2, 68, 1, 1, 1, 68, 1, 67, 2, 0, 1, 67, 1, 3, 67, 0, 0, 1, 68, 3, 67, 0, 0, 0, 0, 0, 2, 202, 3, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_161_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {3, 3, 122, 0, 0, 3, 127, 3, 2, 4, 124, 4, 9, 19, 103, 115, 5, 44, 62, 7, 103, 11, 112, 4, },
	/*1*/ {3, 3, 121, 0, 0, 3, 126, 3, 2, 7, 120, 4, 9, 42, 84, 115, 5, 66, 39, 7, 102, 14, 109, 4, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_161_hue_2[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {4, 6, 140, 0, 0, 6, 152, 22, 19, 21, 146, 9, 10, 96, 63, 133, 5, 2, 2, 0, 0, 35, 112, 4, },
	/*1*/ {4, 6, 140, 0, 0, 6, 152, 22, 19, 21, 146, 9, 10, 96, 63, 133, 5, 2, 2, 0, 0, 35, 112, 4, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};

/*US-02*/
unsigned short DynamicOptimizeSystem_162_y[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {242, 7, 101, 1, 1, 1, 92, 1, 3, 100, 1, 0, 0, 91, 1, 20, 83, 1, 0, 1, 91, 2, 96, 7, 0, 0, 0, 0, 0, 0, 40, 1, },
	/*1*/ {9, 73, 156, 11, 102, 1, 1, 1, 92, 2, 102, 1, 1, 1, 90, 2, 4, 99, 1, 1, 1, 91, 2, 102, 0, 0, 0, 0, 0, 0, 40, 1, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_162_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {5, 6, 128, 0, 0, 2, 132, 11, 4, 6, 128, 7, 5, 8, 139, 51, 3, 15, 112, 8, 61, 9, 140, 6, },
	/*1*/ {5, 6, 126, 0, 0, 5, 130, 13, 8, 7, 127, 9, 6, 25, 123, 51, 3, 19, 106, 8, 60, 13, 133, 6, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
};
/*NM 02*/
unsigned short DynamicOptimizeSystem_Gumi_NM02_y[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {253, 2, 101, 2, 1, 1, 87, 1, 13, 90, 1, 1, 80, 10, 2, 102, 2, 1, 1, 85, 4, 0, 111, 0, 0, 0, 0, 0, 0, 2, 31, 2, },
	/*1*/ {253, 2, 101, 2, 1, 1, 87, 1, 13, 90, 1, 1, 80, 10, 2, 102, 2, 1, 1, 85, 4, 0, 111, 0, 0, 0, 0, 0, 0, 2, 31, 2, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_Gumi_NM02_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {5, 5, 125, 0, 0, 6, 129, 8, 3, 4, 129, 5, 3, 47, 105, 55, 2, 14, 107, 10, 68, 4, 147, 6, },
	/*1*/ {5, 5, 125, 0, 0, 6, 129, 8, 3, 4, 129, 5, 3, 47, 105, 55, 2, 14, 107, 10, 68, 4, 147, 6, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
};

unsigned short DynamicOptimizeSystem_162_hue_2[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	{5, 5, 165, 0, 0, 1, 170, 3, 2, 4, 166, 6, 6, 8, 187, 10, 1, 0, 0, 1, 47, 5, 189, 7, },
	{5, 5, 165, 0, 0, 1, 170, 3, 2, 4, 166, 6, 6, 8, 187, 10, 1, 0, 0, 1, 47, 5, 189, 7, },
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
};

/*US-04*/
unsigned short DynamicOptimizeSystem_163_y[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {122, 14, 24, 11, 10, 11, 22, 7, 32, 13, 4, 5, 17, 8, 5, 16, 13, 8, 5, 53, 7, 13, 24, 4, 3, 4, 5, 8, 10, 443, 59, 3, },
	/*1*/ {20, 13, 86, 16, 24, 12, 11, 12, 22, 28, 21, 4, 4, 6, 19, 4, 16, 13, 9, 6, 54, 7, 29, 8, 4, 4, 5, 9, 8, 311, 195, 4, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_163_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {3, 4, 64, 17, 18, 25, 191, 36, 55, 65, 94, 26, 89, 29, 55, 4, 6, 20, 110, 5, 3, 8, 58, 3, },
	/*1*/ {3, 4, 63, 20, 20, 28, 190, 33, 43, 70, 98, 29, 96, 33, 46, 4, 6, 21, 106, 5, 3, 9, 57, 3, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
/*US-13*/
unsigned short DynamicOptimizeSystem_164_y[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {121, 17, 21, 14, 11, 11, 22, 25, 22, 5, 5, 5, 19, 5, 4, 17, 14, 8, 7, 52, 8, 28, 6, 4, 4, 5, 7, 10, 58, 438, 12, 1, },
	/*1*/ {20, 22, 69, 22, 24, 15, 14, 9, 21, 31, 16, 5, 6, 10, 14, 5, 16, 15, 8, 8, 52, 9, 30, 4, 4, 5, 6, 9, 34, 458, 19, 2, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_164_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {3, 6, 66, 15, 16, 33, 207, 36, 36, 65, 65, 14, 84, 52, 50, 8, 6, 22, 120, 6, 3, 17, 56, 4, },
	/*1*/ {3, 6, 63, 20, 18, 36, 202, 35, 39, 76, 62, 16, 86, 64, 32, 6, 5, 28, 108, 6, 3, 18, 52, 4, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};

/*US-4CH Gumi*/
unsigned short DynamicOptimizeSystem_Gumi_US_4CH_y[][32]= //
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {44, 43, 23, 29, 14, 17, 19, 33, 22, 17, 4, 4, 14, 10, 6, 24, 5, 10, 30, 28, 17, 32, 6, 5, 9, 14, 46, 233, 214, 10, 3, 0, },
	/*1*/ {44, 43, 23, 29, 14, 17, 19, 33, 22, 17, 4, 4, 14, 10, 6, 24, 5, 10, 30, 28, 17, 32, 6, 5, 9, 14, 46, 233, 214, 10, 3, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};

unsigned short DynamicOptimizeSystem_Gumi_US_4CH_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {3, 6, 75, 4, 9, 35, 270, 24, 12, 10, 81, 8, 78, 30, 58, 5, 11, 42, 137, 6, 3, 1, 77, 3, },
	/*1*/ {3, 6, 75, 4, 9, 35, 270, 24, 12, 10, 81, 8, 78, 30, 58, 5, 11, 42, 137, 6, 3, 1, 77, 3, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};

/*US-14CH Gumi*/
unsigned short DynamicOptimizeSystem_Gumi_US_14CH_y[][32]= //
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {111, 22, 43, 14, 12, 14, 12, 8, 14, 7, 8, 8, 12, 13, 18, 10, 11, 10, 22, 13, 35, 134, 13, 11, 25, 11, 9, 28, 309, 17, 5, 4, },
	/*1*/ {111, 22, 43, 14, 12, 14, 12, 8, 14, 7, 8, 8, 12, 13, 18, 10, 11, 10, 22, 13, 35, 134, 13, 11, 25, 11, 9, 28, 309, 17, 5, 4, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};

unsigned short DynamicOptimizeSystem_Gumi_US_14CH_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {10, 15, 130, 0, 0, 14, 151, 9, 4, 11, 135, 12, 12, 35, 113, 8, 13, 82, 68, 5, 4, 7, 141, 12, },
	/*1*/ {10, 15, 130, 0, 0, 14, 151, 9, 4, 11, 135, 12, 12, 35, 113, 8, 13, 82, 68, 5, 4, 7, 141, 12, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};

/*US-C*/
unsigned short DynamicOptimizeSystem_165_y[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {103, 26, 25, 13, 11, 12, 22, 6, 31, 15, 5, 5, 7, 17, 5, 16, 13, 9, 5, 51, 11, 10, 25, 4, 4, 5, 6, 7, 24, 395, 93, 2, },
	/*1*/ {19, 8, 77, 26, 25, 12, 12, 12, 23, 25, 23, 5, 4, 6, 20, 5, 15, 14, 9, 5, 53, 9, 20, 15, 4, 4, 6, 7, 9, 288, 218, 3, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_165_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {2, 4, 62, 19, 16, 24, 184, 45, 75, 87, 83, 24, 81, 16, 55, 4, 5, 23, 103, 5, 3, 13, 52, 3, },
	/*1*/ {3, 5, 59, 21, 17, 28, 182, 39, 69, 95, 87, 26, 79, 21, 51, 4, 6, 29, 95, 5, 3, 14, 50, 3, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
};

unsigned short DynamicOptimizeSystem_152_y[][32]=//
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {5, 195, 493, 52, 23, 11, 8, 6, 6, 6, 6, 7, 7, 6, 7, 10, 8, 6, 5, 5, 5, 5, 6, 6, 6, 7, 8, 10, 14, 24, 22, 0, },
	/*1*/ {5, 195, 493, 52, 23, 11, 8, 6, 6, 6, 6, 7, 7, 6, 7, 10, 8, 6, 5, 5, 5, 5, 6, 6, 6, 7, 8, 10, 14, 24, 22, 0, },
	/*2*/ {5, 195, 493, 52, 23, 11, 8, 6, 6, 6, 6, 7, 7, 6, 7, 10, 8, 6, 5, 5, 5, 5, 6, 6, 6, 7, 8, 10, 14, 24, 22, 0, },
	/*3*/ {0, 0, 7, 592, 126, 38, 15, 9, 7, 8, 7, 8, 8, 7, 9, 11, 8, 6, 6, 6, 6, 7, 7, 8, 8, 11, 17, 37, 7, 0, 0, 0, },
	/*4*/ {5, 195, 493, 52, 23, 11, 8, 6, 6, 6, 6, 7, 7, 6, 7, 10, 8, 6, 5, 5, 5, 5, 6, 6, 6, 7, 8, 10, 14, 24, 22, 0, },
	/*5*/ {5, 195, 493, 52, 23, 11, 8, 6, 6, 6, 6, 7, 7, 6, 7, 10, 8, 6, 5, 5, 5, 5, 6, 6, 6, 7, 8, 10, 14, 24, 22, 0, },
	/*6*/ {5, 195, 493, 52, 23, 11, 8, 6, 6, 6, 6, 7, 7, 6, 7, 10, 8, 6, 5, 5, 5, 5, 6, 6, 6, 7, 8, 10, 14, 24, 22, 0, },
	/*7*/ {5, 195, 493, 52, 23, 11, 8, 6, 6, 6, 6, 7, 7, 6, 7, 10, 8, 6, 5, 5, 5, 5, 6, 6, 6, 7, 8, 10, 14, 24, 22, 0, },
	/*8*/ {5, 195, 493, 52, 23, 11, 8, 6, 6, 6, 6, 7, 7, 6, 7, 10, 8, 6, 5, 5, 5, 5, 6, 6, 6, 7, 8, 10, 14, 24, 22, 0, },
};


unsigned short DynamicOptimizeSystem_173_y[][32]=//  hqv flower 22film
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 530, 0, 0, 0, 0, 1, 0, 3, 0, 7, 1, 0, 0, 0, 49, 2, 0, 0, 0, 0, 3, 1, 2, 3, 0, 0, 0, 389, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 530, 0, 0, 0, 0, 1, 0, 3, 0, 7, 1, 0, 0, 0, 49, 2, 0, 0, 0, 0, 3, 1, 2, 3, 0, 0, 0, 389, 0, 0, },
};


unsigned short DynamicOptimizeSystem_173_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 1, 1, 0, 2, 0, 0, 0, 0, 0, 0, 2, 3, 114, 822, 7, 39, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 1, 1, 0, 2, 0, 0, 0, 0, 0, 0, 2, 3, 114, 822, 7, 39, 0, 0, 0, 0, 0, },
};

unsigned short DynamicOptimizeSystem_174_y[][32]=//  hqv move tree
{ //#0	ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5	ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {1, 3, 14, 30, 27, 137, 139, 81, 41, 45, 33, 37, 41, 36, 35, 33, 30, 28, 27, 24, 18, 13, 10, 8, 5, 3, 3, 3, 3, 76, 2, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {1, 3, 14, 30, 27, 137, 139, 81, 41, 45, 33, 37, 41, 36, 35, 33, 30, 28, 27, 24, 18, 13, 10, 8, 5, 3, 3, 3, 3, 76, 2, 0, },
};




unsigned short DynamicOptimizeSystem_174_hue[][24] =
{ //#0	ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5	ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {31, 60, 299, 62, 13, 4, 0, 0, 0, 0, 0, 0, 0, 2, 19, 19, 9, 285, 98, 35, 12, 11, 15, 15, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {31, 60, 299, 62, 13, 4, 0, 0, 0, 0, 0, 0, 0, 2, 19, 19, 9, 285, 98, 35, 12, 11, 15, 15, },
};




unsigned short DynamicOptimizeSystem_175_y[][32]=//  munsli2 high frequence 22 film
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 847, 15, 7, 6, 5, 5, 5, 5, 4, 4, 4, 5, 8, 5, 5, 4, 5, 5, 5, 5, 5, 6, 7, 15, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 812, 11, 8, 7, 6, 6, 5, 5, 5, 5, 5, 5, 5, 7, 8, 5, 5, 5, 5, 5, 5, 5, 6, 6, 7, 9, 18, 5, 0, 0, },
};





unsigned short DynamicOptimizeSystem_176_y[][32]=//  hqv flower 22film
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 525, 34, 78, 66, 43, 40, 36, 28, 17, 9, 7, 6, 4, 4, 4, 5, 7, 10, 33, 20, 11, 5, 1, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 549, 33, 55, 80, 42, 30, 30, 34, 33, 21, 15, 7, 8, 8, 6, 5, 4, 3, 2, 3, 17, 2, 1, 1, 0, 0, 0, 0, 0, 0, },
};


unsigned short DynamicOptimizeSystem_176_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 1, 209, 43, 69, 461, 167, 29, 10, 2, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 2, 214, 41, 78, 460, 157, 27, 10, 2, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};


unsigned short DynamicOptimizeSystem_177_y[][32]=//for_LG_demo  sunrise
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 162, 48, 123, 75, 68, 92, 110, 118, 63, 37, 36, 39, 22, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 114, 83, 38, 115, 60, 59, 73, 94, 104, 83, 47, 29, 29, 37, 19, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};

unsigned short DynamicOptimizeSystem_177_y2[][32]=//for_LG_demo  sunrise
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 98, 8, 7, 33, 129, 121, 62, 68, 78, 78, 51, 43, 39, 50, 50, 44, 15, 7, 3, 3, 2, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 54, 46, 5, 5, 22, 96, 121, 82, 47, 67, 69, 69, 43, 32, 28, 42, 43, 42, 38, 15, 7, 4, 4, 5, 4, 0, 0, 0, 0, 0, },
};

unsigned short DynamicOptimizeSystem_177_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {7, 9, 8, 0, 0, 0, 0, 0, 0, 2, 0, 1, 2, 13, 1, 19, 827, 60, 19, 7, 3, 3, 3, 6, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {7, 11, 6, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 9, 1, 5, 817, 86, 22, 8, 4, 3, 4, 5, },
};




unsigned short DynamicOptimizeSystem_178_y[][32]=//for_LG_demo  tokyo street
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*1*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*2*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*3*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*4*/ {0, 0, 93, 515, 193, 64, 34, 23, 15, 13, 11, 8, 6, 4, 3, 2, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*6*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*7*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*8*/ {0, 0, 93, 515, 193, 64, 34, 23, 15, 13, 11, 8, 6, 4, 3, 2, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_178_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
};




unsigned short DynamicOptimizeSystem_179_y[][32]=//for_LG_demo  boy
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*1*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*2*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*3*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*4*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*5*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*6*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*7*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
	/*8*/ {0, 0, 0, 2, 78, 46, 48, 40, 32, 32, 31, 23, 37, 124, 184, 166, 65, 13, 8, 7, 6, 6, 6, 7, 8, 8, 6, 2, 1, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_179_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 6, 26, 21, 16, 15, 19, 46, 48, 36, 32, 41, 87, 304, 265, 31, 0, 0, 0, 0, 0, 0, 0, },
};

unsigned short DynamicOptimizeSystem_180_y1[][32]= //02:21
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },
	/*1*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },
	/*2*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },
	/*3*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },//
	/*4*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },//
	/*5*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },
	/*6*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },
	/*7*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },//
	/*8*/ {0, 0, 4, 155, 156, 90, 93, 84, 73, 79, 89, 83, 51, 20, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, },//
};

unsigned short DynamicOptimizeSystem_180_y2[][32]= //02:21
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },
	/*1*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },
	/*2*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },
	/*3*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },//
	/*4*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },//
	/*5*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },
	/*6*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },
	/*7*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },//
	/*8*/ {0, 0, 0, 162, 150, 84, 74, 63, 49, 40, 35, 27, 18, 10, 4, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 259, 0, 0, },//
};

unsigned short DynamicOptimizeSystem_180_y3[][32]= //02:21
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 1, 172, 142, 100, 79, 69, 69, 94, 114, 93, 46, 12, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
};

unsigned short DynamicOptimizeSystem_182_y[][32]=//for_LG_demo  boy
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
	/*1*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
	/*2*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
	/*3*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
	/*4*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
	/*5*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
	/*6*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
	/*7*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
	/*8*/ {0, 0, 27, 83, 129, 138, 101, 94, 117, 77, 63, 43, 28, 21, 19, 16, 5, 2, 8, 5, 1, 0, 0, 0, 1, 1, 2, 1, 1, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_182_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },
	/*1*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },
	/*2*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },
	/*3*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },
	/*4*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },
	/*5*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },
	/*6*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },
	/*7*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },
	/*8*/ {23, 41, 101, 297, 420, 33, 6, 4, 1, 0, 0, 0, 0, 0, 1, 7, 3, 6, 9, 8, 5, 4, 5, 12, },

};

unsigned short DynamicOptimizeSystem_183_y[][32]=//little head
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
	/*1*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
	/*2*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
	/*3*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
	/*4*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
	/*5*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
	/*6*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
	/*7*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
	/*8*/ {0, 0, 56, 69, 60, 63, 75, 60, 37, 37, 36, 27, 23, 20, 18, 24, 22, 26, 38, 36, 37, 40, 35, 29, 30, 28, 23, 17, 12, 6, 0, 0, },
};

unsigned short DynamicOptimizeSystem_183_hue[][24] = //little head
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },
	/*1*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },
	/*2*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },
	/*3*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },
	/*4*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },
	/*5*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },
	/*6*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },
	/*7*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },
	/*8*/ {23, 37, 46, 88, 55, 18, 12, 6, 7, 7, 10, 24, 45, 114, 80, 102, 174, 72, 25, 7, 9, 6, 7, 12, },

};

unsigned short DynamicOptimizeSystem_184_y[][32]=//for_LG_demo // big head
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },
	/*1*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },
	/*2*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },
	/*3*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },
	/*4*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },
	/*5*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },
	/*6*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },
	/*7*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },
	/*8*/ {0, 0, 62, 84, 98, 104, 60, 44, 31, 27, 23, 23, 27, 31, 35, 45, 44, 40, 44, 29, 25, 27, 29, 23, 13, 7, 5, 2, 3, 1, 0, 0, },

};
unsigned short DynamicOptimizeSystem_184_hue[][24] = // big head
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
	/*1*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
	/*2*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
	/*3*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
	/*4*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
	/*5*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
	/*6*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
	/*7*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
	/*8*/ {79, 76, 96, 127, 22, 5, 10, 1, 1, 0, 2, 8, 40, 91, 122, 58, 90, 42, 30, 18, 20, 10, 12, 29, },
};



unsigned short DynamicOptimizeSystem_185_y[][32]=// wonmen hand
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
	/*1*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
	/*2*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
	/*3*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
	/*4*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
	/*5*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
	/*6*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
	/*7*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
	/*8*/ {0, 0, 2, 20, 28, 33, 41, 45, 38, 36, 37, 37, 38, 36, 39, 51, 40, 32, 37, 34, 36, 44, 52, 60, 64, 66, 33, 8, 1, 0, 0, 0, },
};
unsigned short DynamicOptimizeSystem_185_hue[][24] =// wonmen hand
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
	/*1*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
	/*2*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
	/*3*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
	/*4*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
	/*5*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
	/*6*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
	/*7*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
	/*8*/ {179, 98, 52, 74, 212, 50, 36, 15, 14, 6, 7, 4, 8, 14, 7, 9, 12, 16, 20, 16, 21, 22, 27, 68, },
};


unsigned short DynamicOptimizeSystem_186_y[][32]=//ugly man
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
	/*1*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
	/*2*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
	/*3*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
	/*4*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
	/*5*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
	/*6*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
	/*7*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
	/*8*/ {0, 0, 61, 83, 69, 51, 36, 25, 19, 13, 9, 10, 11, 15, 19, 29, 30, 34, 39, 35, 31, 24, 31, 53, 63, 74, 63, 35, 20, 3, 0, 0, },
};
unsigned short DynamicOptimizeSystem_186_hue[][24] =//ugly man
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
	/*1*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
	/*2*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
	/*3*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
	/*4*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
	/*5*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
	/*6*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
	/*7*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
	/*8*/ {102, 60, 72, 61, 66, 80, 54, 47, 129, 32, 12, 5, 4, 6, 7, 26, 83, 48, 22, 9, 11, 8, 12, 33, },
};

unsigned short DynamicOptimizeSystem_187_y[][32]=//qtec Makilo file #59
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 9, 23, 36, 48, 78, 113, 119, 43, 39, 41, 43, 44, 41, 36, 31, 27, 22, 18, 15, 13, 13, 12, 13, 15, 15, 18, 63, 0, 0, },
	/*1*/ {0, 0, 0, 9, 23, 36, 48, 78, 113, 119, 43, 39, 41, 43, 44, 41, 36, 31, 27, 22, 18, 15, 13, 13, 12, 13, 15, 15, 18, 63, 0, 0, },
	/*2*/ {0, 0, 0, 9, 23, 36, 48, 78, 113, 119, 43, 39, 41, 43, 44, 41, 36, 31, 27, 22, 18, 15, 13, 13, 12, 13, 15, 15, 18, 63, 0, 0, },
	/*3*/ {0, 0, 0, 9, 23, 36, 48, 78, 113, 119, 43, 39, 41, 43, 44, 41, 36, 31, 27, 22, 18, 15, 13, 13, 12, 13, 15, 15, 18, 63, 0, 0, },
	/*4*/ {0, 0, 0, 0, 1, 23, 41, 56, 96, 138, 94, 46, 47, 50, 51, 46, 39, 33, 27, 21, 18, 16, 15, 15, 16, 18, 22, 59, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 9, 23, 36, 48, 78, 113, 119, 43, 39, 41, 43, 44, 41, 36, 31, 27, 22, 18, 15, 13, 13, 12, 13, 15, 15, 18, 63, 0, 0, },
	/*6*/ {0, 0, 0, 9, 23, 36, 48, 78, 113, 119, 43, 39, 41, 43, 44, 41, 36, 31, 27, 22, 18, 15, 13, 13, 12, 13, 15, 15, 18, 63, 0, 0, },
	/*7*/ {0, 0, 0, 9, 23, 36, 48, 78, 113, 119, 43, 39, 41, 43, 44, 41, 36, 31, 27, 22, 18, 15, 13, 13, 12, 13, 15, 15, 18, 63, 0, 0, },
	/*8*/ {0, 0, 0, 9, 23, 36, 48, 78, 113, 119, 43, 39, 41, 43, 44, 41, 36, 31, 27, 22, 18, 15, 13, 13, 12, 13, 15, 15, 18, 63, 0, 0, },

};
unsigned short DynamicOptimizeSystem_187_hue[][24] =//ugly man
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
	/*1*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
	/*2*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
	/*3*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
	/*4*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
	/*5*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
	/*6*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
	/*7*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
	/*8*/ {236, 193, 146, 231, 103, 14, 8, 5, 3, 2, 2, 4, 5, 0, 1, 3, 9, 4, 14, 1, 1, 1, 1, 3, },
};

unsigned short DynamicOptimizeSystem_188_y[][32] = // LG leaf #44(NTSC) #46(PAL) motion black white
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
    /*0*/ {0, 11, 7, 2, 1, 0, 0, 1, 1, 0, 1, 1, 1, 2, 2, 6, 5, 6, 7, 9, 13, 14, 18, 24, 27, 26, 27, 34, 123, 615, 2, 0, }, // ok
    /*1*/ {1, 14, 9, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 2, 1, 1, 3, 5, 7, 8, 8, 10, 13, 23, 24, 25, 22, 24, 71, 697, 10, 1, }, // ok
    /*2*/ {6, 21, 8, 0, 0, 0, 0, 0, 0, 0, 1, 1, 3, 2, 2, 3, 3, 3, 5, 7, 8, 9, 10, 14, 16, 18, 18, 24, 121, 678, 5, 0, },
    /*3*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },
    /*4*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },
    /*5*/ {28, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 2, 0, 1, 2, 4, 5, 7, 7, 7, 8, 10, 15, 22, 22, 21, 19, 20, 36, 720, 16, 8, }, // ok
    /*6*/ {25, 0, 0, 1, 0, 0, 1, 0, 0, 1, 2, 2, 2, 3, 3, 5, 5, 6, 7, 9, 12, 15, 17, 22, 23, 26, 22, 23, 38, 695, 17, 1, }, // ok
    /*7*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },
    /*8*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },
};

unsigned short DynamicOptimizeSystem_188_hue[][24] = // LG leaf #44(NTSC) #46(PAL) motion black white
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
    /*0*/ {10, 10, 11, 17, 31, 47, 74, 112, 138, 102, 72, 53, 42, 29, 27, 33, 40, 36, 28, 25, 18, 13, 10, 10, },
    /*1*/ {10, 9, 12, 20, 32, 46, 101, 112, 139, 96, 60, 41, 36, 27, 28, 34, 38, 33, 30, 30, 20, 12, 10, 10, },
    /*2*/ {3, 6, 6, 10, 19, 20, 52, 119, 188, 198, 126, 76, 53, 17, 11, 14, 22, 21, 10, 8, 5, 2, 1, 2, },
    /*3*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
    /*4*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
    /*5*/ {13, 11, 13, 19, 34, 53, 79, 111, 133, 84, 63, 49, 39, 29, 26, 33, 40, 36, 32, 33, 22, 14, 12, 12, },
    /*6*/ {14, 11, 13, 19, 33, 43, 72, 116, 152, 110, 65, 43, 35, 25, 23, 27, 33, 29, 28, 30, 25, 15, 13, 14, },
    /*7*/ {4, 47, 191, 7, 1, 0, 1, 0, 2, 321, 72, 7, 15, 165, 14, 19, 114, 2, 0, 1, 1, 1, 1, 2, },
    /*8*/ {4, 47, 191, 7, 1, 0, 1, 0, 2, 321, 72, 7, 15, 165, 14, 19, 114, 2, 0, 1, 1, 1, 1, 2, },
};

unsigned short DynamicOptimizeSystem_188_hue_2[][24] = // LG leaf #44(NTSC) #46(PAL) motion black white, HUE has 2 kind of histogram ratio
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
    /*0*/ {10, 10, 11, 17, 31, 47, 74, 112, 138, 102, 72, 53, 42, 29, 27, 33, 40, 36, 28, 25, 18, 13, 10, 10, },
    /*1*/ {10, 9, 12, 20, 32, 46, 101, 112, 139, 96, 60, 41, 36, 27, 28, 34, 38, 33, 30, 30, 20, 12, 10, 10, },
    /*2*/ {19, 26, 19, 16, 15, 17, 65, 133, 140, 126, 107, 85, 55, 18, 11, 15, 28, 41, 30, 9, 2, 2, 3, 6, },
    /*3*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
    /*4*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
    /*5*/ {13, 11, 13, 19, 34, 53, 79, 111, 133, 84, 63, 49, 39, 29, 26, 33, 40, 36, 32, 33, 22, 14, 12, 12, },
    /*6*/ {14, 11, 13, 19, 33, 43, 72, 116, 152, 110, 65, 43, 35, 25, 23, 27, 33, 29, 28, 30, 25, 15, 13, 14, },
    /*7*/ {4, 47, 191, 7, 1, 0, 1, 0, 2, 321, 72, 7, 15, 165, 14, 19, 114, 2, 0, 1, 1, 1, 1, 2, },
    /*8*/ {4, 47, 191, 7, 1, 0, 1, 0, 2, 321, 72, 7, 15, 165, 14, 19, 114, 2, 0, 1, 1, 1, 1, 2, },
};

unsigned short DynamicOptimizeSystem_189_y[][32] = //LG leaf #72 color scrolling text
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },
	/*1*/ {0, 11, 13, 107, 155, 12, 16, 13, 12, 13, 82, 17, 16, 73, 11, 10, 126, 10, 111, 52, 14, 11, 12, 14, 10, 10, 13, 13, 21, 8, 1, 0, },
	/*2*/ {4, 143, 146, 13, 15, 10, 11, 12, 21, 78, 18, 63, 18, 9, 11, 121, 8, 16, 141, 13, 11, 10, 13, 12, 9, 9, 11, 15, 19, 4, 0, 0, },
	/*3*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },
	/*4*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },
	/*5*/ {294, 7, 16, 8, 9, 9, 14, 83, 14, 12, 74, 8, 7, 7, 122, 10, 7, 149, 19, 8, 9, 8, 12, 6, 7, 7, 10, 10, 17, 21, 1, 0, },
	/*6*/ {25, 113, 147, 11, 18, 10, 12, 8, 17, 81, 12, 36, 50, 10, 8, 124, 12, 11, 141, 21, 11, 10, 12, 12, 9, 9, 11, 11, 15, 13, 2, 0, },
	/*7*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },
	/*8*/ {9, 139, 139, 12, 16, 9, 14, 10, 15, 81, 11, 66, 22, 8, 8, 124, 12, 13, 143, 19, 11, 10, 13, 11, 9, 9, 11, 12, 19, 9, 2, 0, },

};
unsigned short DynamicOptimizeSystem_189_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {2, 32, 209, 7, 2, 1, 1, 2, 7, 308, 110, 6, 10, 149, 14, 18, 104, 5, 1, 0, 0, 0, 0, 0, },
	/*1*/ {2, 31, 203, 7, 4, 2, 2, 5, 13, 299, 120, 7, 11, 141, 14, 17, 105, 4, 1, 0, 0, 0, 0, 0, },
	/*2*/ {2, 24, 209, 7, 3, 2, 3, 6, 13, 278, 133, 7, 9, 142, 22, 26, 96, 3, 1, 1, 1, 0, 0, 1, },
	/*3*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*4*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*5*/ {4, 47, 191, 7, 1, 0, 1, 0, 2, 321, 72, 7, 15, 165, 14, 19, 114, 2, 0, 1, 1, 1, 1, 2, },
	/*6*/ {2, 30, 208, 7, 2, 1, 1, 2, 9, 317, 101, 5, 10, 147, 15, 18, 106, 4, 1, 0, 0, 0, 0, 0, },
	/*7*/ {4, 47, 191, 7, 1, 0, 1, 0, 2, 321, 72, 7, 15, 165, 14, 19, 114, 2, 0, 1, 1, 1, 1, 2, },
	/*8*/ {4, 47, 191, 7, 1, 0, 1, 0, 2, 321, 72, 7, 15, 165, 14, 19, 114, 2, 0, 1, 1, 1, 1, 2, },
};

//NO.191 Reference 1  ColorBar
unsigned short DynamicOptimizeSystem_191_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {12, 124, 8, 8, 129, 0, 0, 60, 78, 0, 118, 1, 0, 101, 2, 1, 116, 1, 0, 0, 103, 0, 84, 0, 0, 0, 0, 0, 0, 43, 0, 0, },
	/*1*/ {12, 124, 8, 8, 129, 0, 0, 60, 78, 0, 118, 1, 0, 101, 2, 1, 116, 1, 0, 0, 103, 0, 84, 0, 0, 0, 0, 0, 0, 43, 0, 0, },
	/*2*/ {0, 81, 3, 3, 130, 1, 1, 130, 4, 8, 125, 0, 0, 132, 2, 76, 56, 0, 1, 132, 0, 1, 0, 0, 1, 0, 0, 0, 15, 86, 0, 0, },
	/*3*/ {11, 7, 123, 12, 143, 0, 0, 0, 138, 0, 111, 0, 0, 3, 94, 0, 111, 0, 0, 0, 98, 0, 97, 0, 0, 0, 0, 0, 0, 44, 0, 0, },
  	/*4*/ {11, 7, 123, 12, 143, 0, 0, 0, 138, 0, 111, 0, 0, 3, 94, 0, 111, 0, 0, 0, 98, 0, 97, 0, 0, 0, 0, 0, 0, 44, 0, 0, },
	/*5*/ {12, 124, 8, 8, 129, 0, 0, 60, 78, 0, 118, 1, 0, 101, 2, 1, 116, 1, 0, 0, 103, 0, 84, 0, 0, 0, 0, 0, 0, 43, 0, 0, },
	/*6*/ {12, 124, 8, 8, 129, 0, 0, 60, 78, 0, 118, 1, 0, 101, 2, 1, 116, 1, 0, 0, 103, 0, 84, 0, 0, 0, 0, 0, 0, 43, 0, 0, },
	/*7*/ {11, 7, 123, 12, 143, 0, 0, 0, 138, 0, 111, 0, 0, 3, 94, 0, 111, 0, 0, 0, 98, 0, 97, 0, 0, 0, 0, 0, 0, 44, 0, 0, },
	/*8*/ {11, 7, 123, 12, 143, 0, 0, 0, 138, 0, 111, 0, 0, 3, 94, 0, 111, 0, 0, 0, 98, 0, 97, 0, 0, 0, 0, 0, 0, 44, 0, 0, }

};
unsigned short DynamicOptimizeSystem_191_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {1, 3, 144, 1, 0, 2, 147, 1, 1, 5, 124, 1, 1, 2, 149, 53, 1, 140, 7, 1, 56, 16, 134, 0, },//ntsc
	/*1*/ {1, 3, 144, 1, 0, 2, 147, 1, 1, 5, 124, 1, 1, 2, 149, 53, 1, 140, 7, 1, 56, 16, 134, 0, },//ntsc
	/*2*/ {1, 5, 159, 0, 0, 0, 167, 0, 1, 160, 4, 1, 1, 160, 2, 1, 1, 146, 16, 0, 1, 35, 128, 0, },//pal
	/*3*/ {1, 128, 10, 0, 0, 106, 33, 0, 0, 124, 15, 0, 1, 131, 26, 55, 1, 121, 14, 0, 65, 154, 4, 0, },//ntsc
	/*4*/ {1, 128, 10, 0, 0, 106, 33, 0, 0, 124, 15, 0, 1, 131, 26, 55, 1, 121, 14, 0, 65, 154, 4, 0, },//ntsc
	/*5*/ {1, 3, 144, 1, 0, 2, 147, 1, 1, 5, 124, 1, 1, 2, 149, 53, 1, 140, 7, 1, 56, 16, 134, 0, },//ntsc
	/*6*/ {1, 3, 144, 1, 0, 2, 147, 1, 1, 5, 124, 1, 1, 2, 149, 53, 1, 140, 7, 1, 56, 16, 134, 0, },//ntsc
	/*7*/ {1, 128, 10, 0, 0, 106, 33, 0, 0, 124, 15, 0, 1, 131, 26, 55, 1, 121, 14, 0, 65, 154, 4, 0, },//ntsc
	/*8*/ {1, 128, 10, 0, 0, 106, 33, 0, 0, 124, 15, 0, 1, 131, 26, 55, 1, 121, 14, 0, 65, 154, 4, 0, },//ntsc
};

//No.192 Reference 2  Monscope
unsigned short DynamicOptimizeSystem_192_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 48, 42, 43, 11, 11, 11, 14, 13, 8, 10, 7, 9, 9, 39, 167, 5, 18, 7, 9, 7, 11, 14, 8, 10, 11, 313, 130, 0, 0, },
	/*1*/ {0, 0, 0, 48, 42, 43, 11, 11, 11, 14, 13, 8, 10, 7, 9, 9, 39, 167, 5, 18, 7, 9, 7, 11, 14, 8, 10, 11, 313, 130, 0, 0, },
	/*2*/ {0, 34, 60, 11, 9, 8, 19, 7, 11, 7, 8, 5, 5, 5, 16, 178, 4, 4, 4, 4, 4, 10, 7, 17, 7, 7, 8, 13, 505, 9, 0, 0, },
	/*3*/ {0, 0, 0, 5, 47, 50, 37, 13, 13, 8, 11, 9, 10, 9, 9, 8, 183, 16, 19, 7, 7, 11, 12, 8, 10, 10, 249, 225, 0, 0, 0, 0, },
	/*4*/ {0, 0, 3, 41, 26, 62, 12, 14, 7, 8, 12, 8, 9, 8, 7, 7, 14, 176, 9, 17, 6, 5, 5, 13, 10, 7, 9, 9, 109, 371, 0, 0, },
	/*5*/ {0, 0, 0, 48, 42, 43, 11, 11, 11, 14, 13, 8, 10, 7, 9, 9, 39, 167, 5, 18, 7, 9, 7, 11, 14, 8, 10, 11, 313, 130, 0, 0, },
	/*6*/ {0, 0, 0, 48, 42, 43, 11, 11, 11, 14, 13, 8, 10, 7, 9, 9, 39, 167, 5, 18, 7, 9, 7, 11, 14, 8, 10, 11, 313, 130, 0, 0, },
	/*7*/ {0, 0, 3, 41, 26, 62, 12, 14, 7, 8, 12, 8, 9, 8, 7, 7, 14, 176, 9, 17, 6, 5, 5, 13, 10, 7, 9, 9, 109, 371, 0, 0, },
	/*8*/ {0, 0, 3, 41, 26, 62, 12, 14, 7, 8, 12, 8, 9, 8, 7, 7, 14, 176, 9, 17, 6, 5, 5, 13, 10, 7, 9, 9, 109, 371, 0, 0, },

};

//No193 lg reference 3
unsigned short DynamicOptimizeSystem_193_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 48, 41, 44, 11, 11, 11, 14, 13, 8, 10, 7, 9, 9, 37, 169, 5, 18, 7, 9, 7, 11, 15, 8, 10, 12, 304, 139, 0, 0, },
	/*1*/ {0, 0, 0, 48, 41, 44, 11, 11, 11, 14, 13, 8, 10, 7, 9, 9, 37, 169, 5, 18, 7, 9, 7, 11, 15, 8, 10, 12, 304, 139, 0, 0, },
	/*2*/ {0, 59, 9, 8, 11, 1, 0, 10, 6, 14, 1, 0, 9, 1, 48, 576, 17, 21, 2, 5, 15, 9, 1, 15, 22, 10, 37, 7, 30, 42, 1, 0, },
	/*3*/ {4, 30, 20, 4, 6, 9, 1, 6, 24, 3, 12, 1, 8, 15, 17, 451, 91, 13, 51, 18, 5, 34, 21, 12, 29, 8, 14, 13, 11, 51, 0, 3, },
	/*4*/ {4, 30, 20, 4, 6, 9, 1, 6, 24, 3, 12, 1, 8, 15, 17, 451, 91, 13, 51, 18, 5, 34, 21, 12, 29, 8, 14, 13, 11, 51, 0, 3, },
	/*5*/ {0, 0, 0, 48, 41, 44, 11, 11, 11, 14, 13, 8, 10, 7, 9, 9, 37, 169, 5, 18, 7, 9, 7, 11, 15, 8, 10, 12, 304, 139, 0, 0, },
	/*6*/ {0, 0, 0, 48, 41, 44, 11, 11, 11, 14, 13, 8, 10, 7, 9, 9, 37, 169, 5, 18, 7, 9, 7, 11, 15, 8, 10, 12, 304, 139, 0, 0, },
	/*7*/ {4, 30, 20, 4, 6, 9, 1, 6, 24, 3, 12, 1, 8, 15, 17, 451, 91, 13, 51, 18, 5, 34, 21, 12, 29, 8, 14, 13, 11, 51, 0, 3, },
	/*8*/ {4, 30, 20, 4, 6, 9, 1, 6, 24, 3, 12, 1, 8, 15, 17, 451, 91, 13, 51, 18, 5, 34, 21, 12, 29, 8, 14, 13, 11, 51, 0, 3, },

};
unsigned short DynamicOptimizeSystem_193_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {63, 0, 0, 0, 0, 4, 29, 0, 0, 11, 35, 137, 365, 58, 1, 0, 0, 0, 44, 62, 9, 22, 43, 109, },//ntsc
	/*1*/ {63, 0, 0, 0, 0, 4, 29, 0, 0, 11, 35, 137, 365, 58, 1, 0, 0, 0, 44, 62, 9, 22, 43, 109, },//ntsc
	/*2*/ {4, 10, 141, 2, 3, 10, 157, 0, 0, 137, 21, 5, 6, 126, 29, 1, 0, 14, 156, 2, 1, 85, 72, 4, },//ntsc
	/*3*/ {4, 25, 135, 2, 2, 69, 96, 0, 0, 76, 79, 5, 4, 88, 66, 1, 1, 79, 88, 3, 1, 73, 86, 5, },//ntsc
	/*4*/ {4, 25, 135, 2, 2, 69, 96, 0, 0, 76, 79, 5, 4, 88, 66, 1, 1, 79, 88, 3, 1, 73, 86, 5, },//ntsc
	/*5*/ {63, 0, 0, 0, 0, 4, 29, 0, 0, 11, 35, 137, 365, 58, 1, 0, 0, 0, 44, 62, 9, 22, 43, 109, },//ntsc
	/*6*/ {63, 0, 0, 0, 0, 4, 29, 0, 0, 11, 35, 137, 365, 58, 1, 0, 0, 0, 44, 62, 9, 22, 43, 109, },//ntsc
	/*7*/ {4, 25, 135, 2, 2, 69, 96, 0, 0, 76, 79, 5, 4, 88, 66, 1, 1, 79, 88, 3, 1, 73, 86, 5, },//ntsc
	/*8*/ {4, 25, 135, 2, 2, 69, 96, 0, 0, 76, 79, 5, 4, 88, 66, 1, 1, 79, 88, 3, 1, 73, 86, 5, },//ntsc

};

//No.194 lg reference 4
unsigned short DynamicOptimizeSystem_194_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 4, 316, 108, 39, 27, 27, 4, 4, 11, 3, 3, 11, 11, 14, 8, 9, 11, 84, 9, 3, 2, 3, 33, 19, 56, 106, 63, 1, 0, },
	/*1*/ {0, 0, 0, 4, 316, 108, 39, 27, 27, 4, 4, 11, 3, 3, 11, 11, 14, 8, 9, 11, 84, 9, 3, 2, 3, 33, 19, 56, 106, 63, 1, 0, },
	/*2*/ {5, 68, 160, 204, 59, 28, 31, 7, 6, 10, 4, 4, 7, 13, 6, 4, 7, 14, 6, 80, 7, 4, 4, 4, 14, 25, 7, 48, 141, 3, 1, 3, },
	/*3*/ {0, 4, 23, 359, 64, 44, 13, 19, 6, 4, 10, 1, 2, 8, 3, 2, 3, 6, 13, 97, 6, 8, 2, 4, 8, 14, 23, 47, 24, 163, 0, 1, },
	/*4*/ {0, 4, 23, 359, 64, 44, 13, 19, 6, 4, 10, 1, 2, 8, 3, 2, 3, 6, 13, 97, 6, 8, 2, 4, 8, 14, 23, 47, 24, 163, 0, 1, },
	/*5*/ {0, 0, 0, 4, 316, 108, 39, 27, 27, 4, 4, 11, 3, 3, 11, 11, 14, 8, 9, 11, 84, 9, 3, 2, 3, 33, 19, 56, 106, 63, 1, 0, },
	/*6*/ {0, 0, 0, 4, 316, 108, 39, 27, 27, 4, 4, 11, 3, 3, 11, 11, 14, 8, 9, 11, 84, 9, 3, 2, 3, 33, 19, 56, 106, 63, 1, 0, },
	/*7*/ {0, 4, 23, 359, 64, 44, 13, 19, 6, 4, 10, 1, 2, 8, 3, 2, 3, 6, 13, 97, 6, 8, 2, 4, 8, 14, 23, 47, 24, 163, 0, 1, },
	/*8*/ {0, 4, 23, 359, 64, 44, 13, 19, 6, 4, 10, 1, 2, 8, 3, 2, 3, 6, 13, 97, 6, 8, 2, 4, 8, 14, 23, 47, 24, 163, 0, 1, },

};
unsigned short DynamicOptimizeSystem_194_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {4, 72, 152, 13, 2, 47, 19, 2, 4, 51, 48, 5, 5, 28, 58, 0, 2, 141, 238, 2, 2, 54, 37, 3, },//ntsc
	/*1*/ {4, 72, 152, 13, 2, 47, 19, 2, 4, 51, 48, 5, 5, 28, 58, 0, 2, 141, 238, 2, 2, 54, 37, 3, },//ntsc
	/*2*/ {13, 22, 111, 14, 10, 36, 62, 33, 38, 77, 48, 29, 28, 47, 44, 16, 13, 242, 28, 3, 3, 38, 29, 3, },//pal
	/*3*/ {4, 65, 168, 7, 1, 46, 19, 2, 1, 69, 31, 3, 4, 26, 60, 0, 2, 133, 249, 2, 1, 67, 24, 3, },//ntsc
	/*4*/ {4, 65, 168, 7, 1, 46, 19, 2, 1, 69, 31, 3, 4, 26, 60, 0, 2, 133, 249, 2, 1, 67, 24, 3, },//ntsc
	/*5*/ {4, 72, 152, 13, 2, 47, 19, 2, 4, 51, 48, 5, 5, 28, 58, 0, 2, 141, 238, 2, 2, 54, 37, 3, },//ntsc
	/*6*/ {4, 72, 152, 13, 2, 47, 19, 2, 4, 51, 48, 5, 5, 28, 58, 0, 2, 141, 238, 2, 2, 54, 37, 3, },//ntsc
	/*7*/ {4, 65, 168, 7, 1, 46, 19, 2, 1, 69, 31, 3, 4, 26, 60, 0, 2, 133, 249, 2, 1, 67, 24, 3, },//ntsc
	/*8*/ {4, 65, 168, 7, 1, 46, 19, 2, 1, 69, 31, 3, 4, 26, 60, 0, 2, 133, 249, 2, 1, 67, 24, 3, },//ntsc

};

//No.195 lg reference 5
unsigned short DynamicOptimizeSystem_195_y[][32]=
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 1, 8, 79, 23, 28, 20, 25, 48, 8, 24, 4, 5, 22, 7, 28, 5, 10, 18, 36, 33, 12, 15, 4, 7, 9, 405, 102, 0, 0, },
	/*1*/ {0, 0, 0, 1, 8, 79, 23, 28, 20, 25, 48, 8, 24, 4, 5, 22, 7, 28, 5, 10, 18, 36, 33, 12, 15, 4, 7, 9, 405, 102, 0, 0, },
	/*2*/ {0, 4, 4, 69, 20, 30, 16, 21, 22, 35, 17, 16, 9, 9, 24, 8, 31, 12, 12, 11, 44, 9, 35, 8, 9, 11, 13, 20, 471, 0, 0, 0, },
	/*3*/ {0, 2, 4, 67, 31, 30, 13, 13, 23, 47, 7, 22, 5, 4, 9, 17, 8, 28, 4, 8, 44, 7, 36, 8, 14, 5, 5, 8, 62, 454, 0, 0, },
	/*4*/ {0, 2, 4, 67, 31, 30, 13, 13, 23, 47, 7, 22, 5, 4, 9, 17, 8, 28, 4, 8, 44, 7, 36, 8, 14, 5, 5, 8, 62, 454, 0, 0, },
	/*5*/ {0, 0, 0, 1, 8, 79, 23, 28, 20, 25, 48, 8, 24, 4, 5, 22, 7, 28, 5, 10, 18, 36, 33, 12, 15, 4, 7, 9, 405, 102, 0, 0, },
	/*6*/ {0, 0, 0, 1, 8, 79, 23, 28, 20, 25, 48, 8, 24, 4, 5, 22, 7, 28, 5, 10, 18, 36, 33, 12, 15, 4, 7, 9, 405, 102, 0, 0, },
	/*7*/ {0, 2, 4, 67, 31, 30, 13, 13, 23, 47, 7, 22, 5, 4, 9, 17, 8, 28, 4, 8, 44, 7, 36, 8, 14, 5, 5, 8, 62, 454, 0, 0, },
	/*8*/ {0, 2, 4, 67, 31, 30, 13, 13, 23, 47, 7, 22, 5, 4, 9, 17, 8, 28, 4, 8, 44, 7, 36, 8, 14, 5, 5, 8, 62, 454, 0, 0, },

};
unsigned short DynamicOptimizeSystem_195_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {5, 87, 0, 0, 1, 38, 303, 2, 1, 5, 85, 2, 92, 90, 0, 0, 0, 5, 180, 1, 1, 1, 87, 4, },//ntsc
	/*1*/ {5, 87, 0, 0, 1, 38, 303, 2, 1, 5, 85, 2, 92, 90, 0, 0, 0, 5, 180, 1, 1, 1, 87, 4, },//ntsc
	/*2*/ {3, 92, 1, 3, 8, 44, 269, 0, 0, 84, 10, 2, 90, 91, 4, 2, 1, 5, 182, 1, 1, 75, 20, 3, },//ntsc
	/*3*/ {5, 89, 0, 0, 1, 29, 294, 1, 2, 11, 81, 2, 94, 92, 0, 0, 0, 3, 186, 1, 0, 41, 50, 5, },//ntsc
	/*4*/ {5, 89, 0, 0, 1, 29, 294, 1, 2, 11, 81, 2, 94, 92, 0, 0, 0, 3, 186, 1, 0, 41, 50, 5, },//ntsc
	/*5*/ {5, 87, 0, 0, 1, 38, 303, 2, 1, 5, 85, 2, 92, 90, 0, 0, 0, 5, 180, 1, 1, 1, 87, 4, },//ntsc
	/*6*/ {5, 87, 0, 0, 1, 38, 303, 2, 1, 5, 85, 2, 92, 90, 0, 0, 0, 5, 180, 1, 1, 1, 87, 4, },//ntsc
	/*7*/ {5, 89, 0, 0, 1, 29, 294, 1, 2, 11, 81, 2, 94, 92, 0, 0, 0, 3, 186, 1, 0, 41, 50, 5, },//ntsc
	/*8*/ {5, 89, 0, 0, 1, 29, 294, 1, 2, 11, 81, 2, 94, 92, 0, 0, 0, 3, 186, 1, 0, 41, 50, 5, },//ntsc

};

unsigned short DynamicOptimizeSystem_196_y[][32]=//LG leaf #40 magenta green circle
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 167, 33, 35, 30, 686, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 167, 33, 35, 30, 686, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {1, 25, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 110, 71, 22, 23, 26, 710, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 167, 33, 35, 30, 686, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 167, 33, 35, 30, 686, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 167, 33, 35, 30, 686, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 167, 33, 35, 30, 686, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 167, 33, 35, 30, 686, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 167, 33, 35, 30, 686, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_196_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*1*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*2*/ {1, 0, 0, 0, 0, 0, 0, 1, 1, 575, 157, 5, 1, 0, 0, 0, 0, 0, 0, 1, 2, 107, 132, 4, },
	/*3*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*4*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*5*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*6*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*7*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
	/*8*/ {1, 0, 0, 0, 0, 0, 0, 0, 3, 679, 47, 5, 1, 0, 1, 1, 1, 0, 0, 1, 4, 164, 74, 5, },
};



unsigned short DynamicOptimizeSystem_197_y[][32]=  //qte 1002  building and street ,(streets)
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 1, 25, 52, 48, 48, 58, 60, 74, 167, 83, 38, 32, 23, 14, 25, 23, 29, 52, 62, 34, 13, 9, 8, 5, 2, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 1, 25, 52, 48, 48, 58, 60, 74, 167, 83, 38, 32, 23, 14, 25, 23, 29, 52, 62, 34, 13, 9, 8, 5, 2, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 1, 25, 52, 48, 48, 58, 60, 74, 167, 83, 38, 32, 23, 14, 25, 23, 29, 52, 62, 34, 13, 9, 8, 5, 2, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 1, 25, 52, 48, 48, 58, 60, 74, 167, 83, 38, 32, 23, 14, 25, 23, 29, 52, 62, 34, 13, 9, 8, 5, 2, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 2, 43, 61, 53, 67, 73, 107, 168, 64, 38, 28, 18, 30, 28, 48, 78, 43, 14, 10, 8, 4, 1, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 1, 25, 52, 48, 48, 58, 60, 74, 167, 83, 38, 32, 23, 14, 25, 23, 29, 52, 62, 34, 13, 9, 8, 5, 2, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 1, 25, 52, 48, 48, 58, 60, 74, 167, 83, 38, 32, 23, 14, 25, 23, 29, 52, 62, 34, 13, 9, 8, 5, 2, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 1, 25, 52, 48, 48, 58, 60, 74, 167, 83, 38, 32, 23, 14, 25, 23, 29, 52, 62, 34, 13, 9, 8, 5, 2, 0, 0, 0, 0, 0, 0, },
	/*8*/ {0, 1, 25, 52, 48, 48, 58, 60, 74, 167, 83, 38, 32, 23, 14, 25, 23, 29, 52, 62, 34, 13, 9, 8, 5, 2, 0, 0, 0, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_197_hue[][24] = //qte 1002  building and street ,(streets)
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },//ntsc
	/*1*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },//ntsc
	/*2*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },//ntsc
	/*3*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },//ntsc
	/*4*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },
	/*5*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },//ntsc
	/*6*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },//ntsc
	/*7*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },//ntsc
	/*8*/ {8, 15, 24, 60, 205, 125, 60, 104, 38, 14, 14, 15, 12, 12, 18, 38, 71, 53, 42, 39, 9, 5, 4, 5, },
};


unsigned short DynamicOptimizeSystem_198_y1[][32]=  //qte 1002  building and street ,(building)
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 35, 60, 59, 96, 132, 139, 98, 112, 68, 59, 26, 19, 12, 12, 10, 12, 10, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 35, 60, 59, 96, 132, 139, 98, 112, 68, 59, 26, 19, 12, 12, 10, 12, 10, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 35, 60, 59, 96, 132, 139, 98, 112, 68, 59, 26, 19, 12, 12, 10, 12, 10, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 35, 60, 59, 96, 132, 139, 98, 112, 68, 59, 26, 19, 12, 12, 10, 12, 10, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 0, 56, 56, 97, 160, 157, 121, 112, 80, 39, 21, 14, 13, 15, 15, 13, 10, 5, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*5*/ {0, 0, 35, 60, 59, 96, 132, 139, 98, 112, 68, 59, 26, 19, 12, 12, 10, 12, 10, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 35, 60, 59, 96, 132, 139, 98, 112, 68, 59, 26, 19, 12, 12, 10, 12, 10, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 35, 60, 59, 96, 132, 139, 98, 112, 68, 59, 26, 19, 12, 12, 10, 12, 10, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 35, 60, 59, 96, 132, 139, 98, 112, 68, 59, 26, 19, 12, 12, 10, 12, 10, 9, 8, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, },

};
unsigned short DynamicOptimizeSystem_198_hue1[][24] =//qte 1002  building and street ,(building)
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, },
	/*1*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, },
	/*2*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, },
	/*3*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, },
	/*5*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, },
	/*6*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, },
	/*7*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 2, 8, 11, 6, 6, 6, 7, 10, 19, 22, 29, 53, 96, 569, 123, 16, 4, 1, 0, 0, 0, }

};

unsigned short DynamicOptimizeSystem_199_y1[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 2, 4, 5, 11, 55, 158, 145, 148, 143, 119, 73, 46, 32, 16, 10, 10, 4, 2, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, },//

};
unsigned short DynamicOptimizeSystem_199_hue1[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 1, 7, 18, 98, 78, 414, 314, 40, 6, 3, 1, 1, 2, 5, 5, 0, 0, 0, 0, 0, 0, 0, },//

};

unsigned short SandM_Chroma_Zone_Plate_y[][32]= //lg movie delay_30p_ver2, wonmen hdmi_hd
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
unsigned short SandM_Chroma_Zone_Plate_hue[][24] =
{ //#0  ntsc 0IRE BLV=HIGH,#1  ntsc 7.5IRE BLV=HIGH, #2 pal  ,#3 SD BLV=HIGH , #4 HD BLV=HIGH
  //#5  ntsc 0IRE BLV=LOW ,#6  ntsc 7.5IRE BLV=LOW , #7 SD BLV=LOW , #8 HD BLV=LOW
	/*0*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*4*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*5*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*6*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*7*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },//
	/*8*/ {0, 0, 0, 444, 41, 3, 1, 0, 0, 0, 0, 0, 0, 2, 6, 496, 0, 0, 0, 0, 0, 0, 0, 0, },//

};
/*#endif*/
#if CB_flag
unsigned short CB_TSB3_CH3_y1[][32]=
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 0, 0, 2, 7, 9, 23, 59, 33, 30, 22, 34, 50, 59, 64, 68, 65, 66, 68, 65, 56, 51, 40, 35, 37, 16, 16, 13, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 2, 7, 9, 23, 59, 33, 30, 22, 34, 50, 59, 64, 68, 65, 66, 68, 65, 56, 51, 40, 35, 37, 16, 16, 13, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 2, 7, 9, 23, 59, 33, 30, 22, 34, 50, 59, 64, 68, 65, 66, 68, 65, 56, 51, 40, 35, 37, 16, 16, 13, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 2, 7, 9, 23, 59, 33, 30, 22, 34, 50, 59, 64, 68, 65, 66, 68, 65, 56, 51, 40, 35, 37, 16, 16, 13, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 2, 7, 9, 23, 59, 33, 30, 22, 34, 50, 59, 64, 68, 65, 66, 68, 65, 56, 51, 40, 35, 37, 16, 16, 13, 0, 0, },
};
unsigned short CB_TSB3_CH3_hue1[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {4, 4, 12, 157, 20, 5, 3, 18, 146, 320, 179, 23, 0, 0, 0, 0, 0, 0, 0, 1, 87, 5, 3, 3, },
	/*1*/ {4, 4, 12, 157, 20, 5, 3, 18, 146, 320, 179, 23, 0, 0, 0, 0, 0, 0, 0, 1, 87, 5, 3, 3, },
	/*2*/ {4, 4, 12, 157, 20, 5, 3, 18, 146, 320, 179, 23, 0, 0, 0, 0, 0, 0, 0, 1, 87, 5, 3, 3, },
	/*3*/ {4, 4, 12, 157, 20, 5, 3, 18, 146, 320, 179, 23, 0, 0, 0, 0, 0, 0, 0, 1, 87, 5, 3, 3, },
	/*4*/ {4, 4, 12, 157, 20, 5, 3, 18, 146, 320, 179, 23, 0, 0, 0, 0, 0, 0, 0, 1, 87, 5, 3, 3, },
};

unsigned short CB_TSB3_CH3_y2[][32]=
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 1, 1, 7, 11, 10, 14, 40, 24, 16, 11, 17, 29, 56, 70, 72, 64, 53, 54, 62, 64, 76, 69, 60, 53, 18, 16, 18, 0, 0, },
	/*1*/ {0, 0, 0, 1, 1, 7, 11, 10, 14, 40, 24, 16, 11, 17, 29, 56, 70, 72, 64, 53, 54, 62, 64, 76, 69, 60, 53, 18, 16, 18, 0, 0, },
	/*2*/ {0, 0, 0, 1, 1, 7, 11, 10, 14, 40, 24, 16, 11, 17, 29, 56, 70, 72, 64, 53, 54, 62, 64, 76, 69, 60, 53, 18, 16, 18, 0, 0, },
	/*3*/ {0, 0, 0, 1, 1, 7, 11, 10, 14, 40, 24, 16, 11, 17, 29, 56, 70, 72, 64, 53, 54, 62, 64, 76, 69, 60, 53, 18, 16, 18, 0, 0, },
	/*4*/ {0, 0, 0, 1, 1, 7, 11, 10, 14, 40, 24, 16, 11, 17, 29, 56, 70, 72, 64, 53, 54, 62, 64, 76, 69, 60, 53, 18, 16, 18, 0, 0, },
};
unsigned short CB_TSB3_CH3_hue2[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {4, 5, 12, 188, 23, 4, 3, 19, 129, 346, 171, 17, 6, 0, 0, 0, 0, 0, 0, 0, 50, 6, 4, 3, },
	/*1*/ {4, 5, 12, 188, 23, 4, 3, 19, 129, 346, 171, 17, 6, 0, 0, 0, 0, 0, 0, 0, 50, 6, 4, 3, },
	/*2*/ {4, 5, 12, 188, 23, 4, 3, 19, 129, 346, 171, 17, 6, 0, 0, 0, 0, 0, 0, 0, 50, 6, 4, 3, },
	/*3*/ {4, 5, 12, 188, 23, 4, 3, 19, 129, 346, 171, 17, 6, 0, 0, 0, 0, 0, 0, 0, 50, 6, 4, 3, },
	/*4*/ {4, 5, 12, 188, 23, 4, 3, 19, 129, 346, 171, 17, 6, 0, 0, 0, 0, 0, 0, 0, 50, 6, 4, 3, },
};

unsigned short CB_TSB3_CH3_y3[][32]=
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 0, 2, 14, 18, 18, 21, 24, 24, 17, 19, 21, 27, 48, 61, 66, 57, 57, 66, 72, 78, 78, 62, 48, 47, 12, 11, 16, 0, 0, },
	/*1*/ {0, 0, 0, 0, 2, 14, 18, 18, 21, 24, 24, 17, 19, 21, 27, 48, 61, 66, 57, 57, 66, 72, 78, 78, 62, 48, 47, 12, 11, 16, 0, 0, },
	/*2*/ {0, 0, 0, 0, 2, 14, 18, 18, 21, 24, 24, 17, 19, 21, 27, 48, 61, 66, 57, 57, 66, 72, 78, 78, 62, 48, 47, 12, 11, 16, 0, 0, },
	/*3*/ {0, 0, 0, 0, 2, 14, 18, 18, 21, 24, 24, 17, 19, 21, 27, 48, 61, 66, 57, 57, 66, 72, 78, 78, 62, 48, 47, 12, 11, 16, 0, 0, },
	/*4*/ {0, 0, 0, 0, 2, 14, 18, 18, 21, 24, 24, 17, 19, 21, 27, 48, 61, 66, 57, 57, 66, 72, 78, 78, 62, 48, 47, 12, 11, 16, 0, 0, },
};
unsigned short CB_TSB3_CH3_hue3[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {3, 4, 12, 268, 42, 8, 4, 18, 112, 311, 146, 28, 0, 0, 0, 0, 0, 0, 0, 0, 25, 4, 3, 3, },
	/*1*/ {3, 4, 12, 268, 42, 8, 4, 18, 112, 311, 146, 28, 0, 0, 0, 0, 0, 0, 0, 0, 25, 4, 3, 3, },
	/*2*/ {3, 4, 12, 268, 42, 8, 4, 18, 112, 311, 146, 28, 0, 0, 0, 0, 0, 0, 0, 0, 25, 4, 3, 3, },
	/*3*/ {3, 4, 12, 268, 42, 8, 4, 18, 112, 311, 146, 28, 0, 0, 0, 0, 0, 0, 0, 0, 25, 4, 3, 3, },
	/*4*/ {3, 4, 12, 268, 42, 8, 4, 18, 112, 311, 146, 28, 0, 0, 0, 0, 0, 0, 0, 0, 25, 4, 3, 3, },
};


unsigned short CB_SONY_CH84_y1[][32]=
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 1, 35, 14, 7, 8, 13, 21, 33, 45, 49, 68, 133, 124, 343, 29, 25, 19, 13, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 1, 35, 14, 7, 8, 13, 21, 33, 45, 49, 68, 133, 124, 343, 29, 25, 19, 13, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 1, 35, 14, 7, 8, 13, 21, 33, 45, 49, 68, 133, 124, 343, 29, 25, 19, 13, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 1, 35, 14, 7, 8, 13, 21, 33, 45, 49, 68, 133, 124, 343, 29, 25, 19, 13, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 1, 35, 14, 7, 8, 13, 21, 33, 45, 49, 68, 133, 124, 343, 29, 25, 19, 13, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};
unsigned short CB_SONY_CH84_hue1[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {5, 7, 22, 347, 197, 8, 13, 1, 0, 0, 0, 0, 3, 1, 0, 0, 0, 0, 363, 12, 4, 2, 2, 2, },
	/*1*/ {5, 7, 22, 347, 197, 8, 13, 1, 0, 0, 0, 0, 3, 1, 0, 0, 0, 0, 363, 12, 4, 2, 2, 2, },
	/*2*/ {5, 7, 22, 347, 197, 8, 13, 1, 0, 0, 0, 0, 3, 1, 0, 0, 0, 0, 363, 12, 4, 2, 2, 2, },
	/*3*/ {5, 7, 22, 347, 197, 8, 13, 1, 0, 0, 0, 0, 3, 1, 0, 0, 0, 0, 363, 12, 4, 2, 2, 2, },
	/*4*/ {5, 7, 22, 347, 197, 8, 13, 1, 0, 0, 0, 0, 3, 1, 0, 0, 0, 0, 363, 12, 4, 2, 2, 2, },
};

unsigned short CB_SONY_CH84_y2[][32]=
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 0, 23, 14, 8, 8, 8, 11, 16, 23, 33, 43, 80, 124, 495, 30, 26, 23, 16, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 23, 14, 8, 8, 8, 11, 16, 23, 33, 43, 80, 124, 495, 30, 26, 23, 16, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 23, 14, 8, 8, 8, 11, 16, 23, 33, 43, 80, 124, 495, 30, 26, 23, 16, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 23, 14, 8, 8, 8, 11, 16, 23, 33, 43, 80, 124, 495, 30, 26, 23, 16, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 23, 14, 8, 8, 8, 11, 16, 23, 33, 43, 80, 124, 495, 30, 26, 23, 16, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, },
};
unsigned short CB_SONY_CH84_hue2[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {2, 3, 25, 419, 254, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 256, 8, 2, 1, 1, 1, },
	/*1*/ {2, 3, 25, 419, 254, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 256, 8, 2, 1, 1, 1, },
	/*2*/ {2, 3, 25, 419, 254, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 256, 8, 2, 1, 1, 1, },
	/*3*/ {2, 3, 25, 419, 254, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 256, 8, 2, 1, 1, 1, },
	/*4*/ {2, 3, 25, 419, 254, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 256, 8, 2, 1, 1, 1, },
};

unsigned short CB_USB_Red_Flower_Bee_y1[][32]=
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 0, 0, 1, 17, 80, 317, 139, 47, 28, 23, 18, 19, 26, 42, 66, 55, 52, 14, 13, 13, 14, 2, 0, 0, 0, 0, 0, 1, 0, },
	/*1*/ {0, 0, 0, 0, 0, 1, 17, 80, 317, 139, 47, 28, 23, 18, 19, 26, 42, 66, 55, 52, 14, 13, 13, 14, 2, 0, 0, 0, 0, 0, 1, 0, },
	/*2*/ {0, 0, 0, 0, 0, 1, 17, 80, 317, 139, 47, 28, 23, 18, 19, 26, 42, 66, 55, 52, 14, 13, 13, 14, 2, 0, 0, 0, 0, 0, 1, 0, },
	/*3*/ {0, 0, 0, 0, 0, 1, 17, 80, 317, 139, 47, 28, 23, 18, 19, 26, 42, 66, 55, 52, 14, 13, 13, 14, 2, 0, 0, 0, 0, 0, 1, 0, },
	/*4*/ {0, 0, 0, 0, 0, 1, 17, 80, 317, 139, 47, 28, 23, 18, 19, 26, 42, 66, 55, 52, 14, 13, 13, 14, 2, 0, 0, 0, 0, 0, 1, 0, },
};
unsigned short CB_USB_Red_Flower_Bee_hue1[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {397, 327, 63, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, },
	/*1*/ {397, 327, 63, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, },
	/*2*/ {397, 327, 63, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, },
	/*3*/ {397, 327, 63, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, },
	/*4*/ {397, 327, 63, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, },
};

unsigned short CB_USB_Red_Flower_Bee_y2[][32]=
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 0, 3, 8, 24, 80, 325, 136, 43, 25, 21, 17, 18, 26, 41, 62, 53, 51, 13, 13, 13, 13, 2, 0, 0, 0, 0, 0, 1, 0, },
	/*1*/ {0, 0, 0, 0, 3, 8, 24, 80, 325, 136, 43, 25, 21, 17, 18, 26, 41, 62, 53, 51, 13, 13, 13, 13, 2, 0, 0, 0, 0, 0, 1, 0, },
	/*2*/ {0, 0, 0, 0, 3, 8, 24, 80, 325, 136, 43, 25, 21, 17, 18, 26, 41, 62, 53, 51, 13, 13, 13, 13, 2, 0, 0, 0, 0, 0, 1, 0, },
	/*3*/ {0, 0, 0, 0, 3, 8, 24, 80, 325, 136, 43, 25, 21, 17, 18, 26, 41, 62, 53, 51, 13, 13, 13, 13, 2, 0, 0, 0, 0, 0, 1, 0, },
	/*4*/ {0, 0, 0, 0, 3, 8, 24, 80, 325, 136, 43, 25, 21, 17, 18, 26, 41, 62, 53, 51, 13, 13, 13, 13, 2, 0, 0, 0, 0, 0, 1, 0, },
};
unsigned short CB_USB_Red_Flower_Bee_hue2[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {399, 332, 56, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19, },
	/*1*/ {399, 332, 56, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19, },
	/*2*/ {399, 332, 56, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19, },
	/*3*/ {399, 332, 56, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19, },
	/*4*/ {399, 332, 56, 78, 108, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19, },
};

#endif

unsigned short BitmapDevodeOffset_y_1[][32] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 3, 52, 0, 0, 220, 173, 80, 73, 74, 70, 53, 40, 9, 5, 5, 6, 8, 11, 13, 15, 3, 14, 10, 5, 6, 12, 25, 2, 0, 0, 0, },
	/*1*/ {0, 3, 52, 0, 0, 220, 173, 80, 73, 74, 70, 53, 40, 9, 5, 5, 6, 8, 11, 13, 15, 3, 14, 10, 5, 6, 12, 25, 2, 0, 0, 0, },
	/*2*/ {0, 3, 52, 0, 0, 220, 173, 80, 73, 74, 70, 53, 40, 9, 5, 5, 6, 8, 11, 13, 15, 3, 14, 10, 5, 6, 12, 25, 2, 0, 0, 0, },
	/*3*/ {0, 3, 52, 0, 0, 220, 173, 80, 73, 74, 70, 53, 40, 9, 5, 5, 6, 8, 11, 13, 15, 3, 14, 10, 5, 6, 12, 25, 2, 0, 0, 0, },
	/*4*/ {0, 3, 52, 0, 0, 220, 173, 80, 73, 74, 70, 53, 40, 9, 5, 5, 6, 8, 11, 13, 15, 3, 14, 10, 5, 6, 12, 25, 2, 0, 0, 0, },
};
unsigned short BitmapDevodeOffset_hue_1[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 1, 5, 10, 27, 371, 435, 38, 19, 5, 7, 13, 36, 22, 2, 0, 1, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 1, 5, 10, 27, 371, 435, 38, 19, 5, 7, 13, 36, 22, 2, 0, 1, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 1, 5, 10, 27, 371, 435, 38, 19, 5, 7, 13, 36, 22, 2, 0, 1, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 1, 5, 10, 27, 371, 435, 38, 19, 5, 7, 13, 36, 22, 2, 0, 1, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 1, 5, 10, 27, 371, 435, 38, 19, 5, 7, 13, 36, 22, 2, 0, 1, 0, 0, 0, 0, 0, },
};

unsigned short BitmapDevodeOffset_y_2[][32] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 0, 0, 206, 176, 83, 79, 69, 52, 39, 31, 9, 6, 6, 8, 11, 21, 28, 43, 5, 21, 18, 8, 11, 18, 35, 3, 0, 0, 0, },
	/*1*/ {0, 0, 0, 0, 0, 206, 176, 83, 79, 69, 52, 39, 31, 9, 6, 6, 8, 11, 21, 28, 43, 5, 21, 18, 8, 11, 18, 35, 3, 0, 0, 0, },
	/*2*/ {0, 0, 0, 0, 0, 206, 176, 83, 79, 69, 52, 39, 31, 9, 6, 6, 8, 11, 21, 28, 43, 5, 21, 18, 8, 11, 18, 35, 3, 0, 0, 0, },
	/*3*/ {0, 0, 0, 0, 0, 206, 176, 83, 79, 69, 52, 39, 31, 9, 6, 6, 8, 11, 21, 28, 43, 5, 21, 18, 8, 11, 18, 35, 3, 0, 0, 0, },
	/*4*/ {0, 0, 0, 0, 0, 206, 176, 83, 79, 69, 52, 39, 31, 9, 6, 6, 8, 11, 21, 28, 43, 5, 21, 18, 8, 11, 18, 35, 3, 0, 0, 0, },
};
unsigned short BitmapDevodeOffset_hue_2[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 2, 10, 16, 44, 369, 345, 31, 12, 8, 11, 20, 71, 48, 3, 0, 1, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 2, 10, 16, 44, 369, 345, 31, 12, 8, 11, 20, 71, 48, 3, 0, 1, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 2, 10, 16, 44, 369, 345, 31, 12, 8, 11, 20, 71, 48, 3, 0, 1, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 2, 10, 16, 44, 369, 345, 31, 12, 8, 11, 20, 71, 48, 3, 0, 1, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 2, 10, 16, 44, 369, 345, 31, 12, 8, 11, 20, 71, 48, 3, 0, 1, 0, 0, 0, 0, 0, },
};

unsigned short BitmapDevodeOffset_y_3[][32] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 48, 0, 0, 268, 202, 68, 57, 40, 14, 8, 5, 5, 5, 5, 6, 12, 25, 26, 36, 7, 27, 22, 10, 14, 25, 48, 2, 0, 0, 0, },
	/*1*/ {0, 0, 48, 0, 0, 268, 202, 68, 57, 40, 14, 8, 5, 5, 5, 5, 6, 12, 25, 26, 36, 7, 27, 22, 10, 14, 25, 48, 2, 0, 0, 0, },
	/*2*/ {0, 0, 48, 0, 0, 268, 202, 68, 57, 40, 14, 8, 5, 5, 5, 5, 6, 12, 25, 26, 36, 7, 27, 22, 10, 14, 25, 48, 2, 0, 0, 0, },
	/*3*/ {0, 0, 48, 0, 0, 268, 202, 68, 57, 40, 14, 8, 5, 5, 5, 5, 6, 12, 25, 26, 36, 7, 27, 22, 10, 14, 25, 48, 2, 0, 0, 0, },
	/*4*/ {0, 0, 48, 0, 0, 268, 202, 68, 57, 40, 14, 8, 5, 5, 5, 5, 6, 12, 25, 26, 36, 7, 27, 22, 10, 14, 25, 48, 2, 0, 0, 0, },
};
unsigned short BitmapDevodeOffset_hue_3[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {0, 0, 0, 3, 11, 21, 54, 356, 337, 29, 10, 10, 14, 26, 75, 39, 2, 1, 1, 0, 0, 0, 0, 0, },
	/*1*/ {0, 0, 0, 3, 11, 21, 54, 356, 337, 29, 10, 10, 14, 26, 75, 39, 2, 1, 1, 0, 0, 0, 0, 0, },
	/*2*/ {0, 0, 0, 3, 11, 21, 54, 356, 337, 29, 10, 10, 14, 26, 75, 39, 2, 1, 1, 0, 0, 0, 0, 0, },
	/*3*/ {0, 0, 0, 3, 11, 21, 54, 356, 337, 29, 10, 10, 14, 26, 75, 39, 2, 1, 1, 0, 0, 0, 0, 0, },
	/*4*/ {0, 0, 0, 3, 11, 21, 54, 356, 337, 29, 10, 10, 14, 26, 75, 39, 2, 1, 1, 0, 0, 0, 0, 0, },
};

unsigned short LGPTFatoryMultiC34_y[][32] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {15, 53, 124, 8, 20, 8, 3, 10, 21, 4, 14, 4, 3, 11, 19, 60, 285, 28, 19, 10, 38, 14, 16, 13, 12, 7, 8, 13, 23, 24, 87, 10, },
	/*1*/ {15, 53, 124, 8, 20, 8, 3, 10, 21, 4, 14, 4, 3, 11, 19, 60, 285, 28, 19, 10, 38, 14, 16, 13, 12, 7, 8, 13, 23, 24, 87, 10, },
	/*2*/ {15, 53, 124, 8, 20, 8, 3, 10, 21, 4, 14, 4, 3, 11, 19, 60, 285, 28, 19, 10, 38, 14, 16, 13, 12, 7, 8, 13, 23, 24, 87, 10, },
	/*3*/ {15, 53, 124, 8, 20, 8, 3, 10, 21, 4, 14, 4, 3, 11, 19, 60, 285, 28, 19, 10, 38, 14, 16, 13, 12, 7, 8, 13, 23, 24, 87, 10, },
	/*4*/ {15, 53, 124, 8, 20, 8, 3, 10, 21, 4, 14, 4, 3, 11, 19, 60, 285, 28, 19, 10, 38, 14, 16, 13, 12, 7, 8, 13, 23, 24, 87, 10, },
};
unsigned short LGPTFatoryMultiC34_hue[][24] =
{ //#0  ntsc 0 IRE ,#1  ntsc 7.5 IRE , #2 cvbs pal  ,#3 hdmi_sd , #4 hdmi_hd
	/*0*/ {2, 8, 26, 13, 4, 7, 58, 15, 31, 45, 111, 184, 247, 94, 41, 16, 21, 31, 5, 3, 4, 18, 3, 2, },
	/*1*/ {2, 8, 26, 13, 4, 7, 58, 15, 31, 45, 111, 184, 247, 94, 41, 16, 21, 31, 5, 3, 4, 18, 3, 2, },
	/*2*/ {2, 8, 26, 13, 4, 7, 58, 15, 31, 45, 111, 184, 247, 94, 41, 16, 21, 31, 5, 3, 4, 18, 3, 2, },
	/*3*/ {2, 8, 26, 13, 4, 7, 58, 15, 31, 45, 111, 184, 247, 94, 41, 16, 21, 31, 5, 3, 4, 18, 3, 2, },
	/*4*/ {2, 8, 26, 13, 4, 7, 58, 15, 31, 45, 111, 184, 247, 94, 41, 16, 21, 31, 5, 3, 4, 18, 3, 2, },
};

unsigned short LGBirdDemoMovie_ChromaRTNR_y[32] =
	{0, 0, 8, 5, 5, 3, 5, 5, 28, 34, 7, 11, 16, 10, 12, 46, 286, 29, 24, 29, 21, 21, 21, 109, 42, 13, 16, 23, 86, 71, 0, 0, };

unsigned short LGBirdDemoMovie_ChromaRTNR_hue[24] =
	{12, 16, 38, 104, 477, 85, 12, 1, 0, 0, 0, 0, 0, 1, 14, 20, 42, 19, 54, 62, 13, 6, 5, 8, };

/*LG internal TV signal "E-52"*/
unsigned short LGTVPALBGE52_y[32] =
	{2, 15, 8, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 27, 443, 463, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, };
/*LG internal TV signal "E-52"*/
unsigned short LGTVPALBGE52_hue[24] =
	{118, 5, 5, 8, 119, 27, 144, 37, 36, 24, 25, 25, 157, 20, 15, 14, 18, 16, 152, 9, 6, 3, 3, 3, };


/*info. from VD scalerVideo.c*/
//extern unsigned char SMD_flag_from_scalerVideo; // replaced by scalerVideo_Get_VD_MiddleWare(VD_STATUS_SMD_IEGSM)
/**/

#define blend_ratio 4
#define frame_print 60
#define SST_debug 0



//******************************** ID PATTERN FOR DEMO************************************************8


#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
void IoReg_Mask32(unsigned int addr, unsigned int andMask, unsigned int orMask) {
	rtd_outl(addr, ((rtd_inl(addr) & (andMask)) | (orMask)));
}
void IoReg_SetBits(unsigned int addr, unsigned int Mask) {
	rtd_outl(addr, (rtd_inl(addr) | Mask));
}
void  IoReg_ClearBits(unsigned int addr, unsigned int Mask) {
	rtd_outl(addr, ((rtd_inl(addr) & ~(Mask))));
}
void IoReg_WriteByte0(unsigned int addr, unsigned char val) {
	rtd_outl(addr, (rtd_inl(addr) & 0xffffff00) | (val & 0x000000ff));
}
#endif

#define pthread_mutex_lock(a)  do {} while(0)
#define pthread_mutex_unlock(a) do {} while(0)

#define rtdf_outb 			IoReg_WriteByte0
#define rtdf_outl 				rtd_outl
//#define rtd_outw 				IoReg_WriteWord0
#define rtdf_inl				rtd_inl

//#ifndef Original_DCR
//#define Original_DCR
//#endif
#define WEIGHTED_LEFT_BOUND 0
#define WEIGHTED_RIGHT_BOUND 100

//yuan1024 rtnr n field avg
unsigned char VD_noise_status_Num = 1;

typedef enum _SEG{
    Segment_A,
    Segment_B,
    Segment_C,
    Segment_D,
    Segment_E,
    Segment_F,
    Segment_G,
    Segment_MAX,
}SEG;

//=========================================================
//====== For DCC User Curve =====================================
//=========================================================

typedef enum _HISTOGRAM_TYPE{
    HistType_dark,
    HistType_darkmiddle,
    HistType_darklight,
    HistType_middle,
    HistType_light,
    HistType_middlelight,
    HistType_darkmiddlelight,
    HistType_MAX,i
}HISTOGRAM_TYPE;

char	UserCurRatio=0;//tDCC_UserCurve[8];//0-32


typedef enum _PICTURE_MODE1 {
	COLORSTD_DEFAULT = 0,
	PICTURE_MODE1_AUTO_VIEW,
	PICTURE_MODE1_DYNAMIC,
	PICTURE_MODE1_STANDARD,
	PICTURE_MODE1_MILD,
	PICTURE_MODE1_MOVIE,
	PICTURE_MODE1_ECO,
	PICTURE_MODE1_GAME,
	PICTURE_MODE1_PC,
	PICTURE_MODE1_MAX,
} PICTURE_MODE1;

typedef enum _PICTURE_MODE2 {
	PICTURE_MODE2_USER = 0,
	PICTURE_MODE2_VIVID,
	PICTURE_MODE2_STD,
	PICTURE_MODE2_GENTLE,
	PICTURE_MODE2_MOVIE,
	PICTURE_MODE2_SPORT,
	PICTURE_MODE2_GAME,
	PICTURE_MODE2_MAX,
} PICTURE_MODE2;
//=========================================================


#if 0
unsigned int tDCC_SCurve_Coef_Dark[9] =
{
   //S_th   S_index,  S_low,    S_high,   DCL_W,   DCL_B,     DCC_level,       ratio,       reserved,
	 0x0,	0x0,	0x0,	0x0,   0x0,    0x0,		  0x0,		 0x0,		0x0,//Dark
};
unsigned int tDCC_SCurve_Coef_Middle[9] =
{
   //S_th   S_index,  S_low,    S_high,   DCL_W,   DCL_B,     	  DCC_level,     ratio,       reserved,
	 0x0,	0x0,	0x0,	0x0,   0x0,    0x0,		  0x0,		 0x0,		0x0,//Middle
};

unsigned int tDCC_SCurve_Coef_Light[9] =
{
   //S_th	 S_index,  S_low,	 S_high,   DCL_W,	DCL_B,	   DCC_level,	  ratio,	   reserved,
	 0x0,	0x0,	0x0,	0x0,   0x0,    0x0, 	  0x0,		 0x0,		0x0,//High
};
#endif

//=========================================================


//#define VIP_DEBUG_ENABLE
#ifdef VIP_DEBUG_ENABLE
  #define VIP_DEBUG_PRINTF	printk
#else
  #define VIP_DEBUG_PRINTF(x,y...)
#endif

#ifdef IO_GPIO_DEBUG
  #define IO_GPIO_DEBUG_PRINTF(format, args...) 		//printf(format, ##args)
#else //#ifdef IO_GPIO_DEBUG
  #define IO_GPIO_DEBUG_PRINTF(format, args...)
#endif //#ifdef IO_GPIO_DEBUG

// oliver-
//#define SCALERVIP_IOMGR_ERROR(format, args...)  printf(format, ##args)
#define SCALERVIP_IOMGR_ERROR(format, args...)

#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
#define GPIO_CR GPIOPWM_GPIO_FCR_reg
#define GPIO_DATA GPIOPWM_GPIO_FDATA_reg
#define GPIO_PWM GPIOPWM_PWM_DB_CTRL_reg   //todo: spec is different in Atlantic, need checking
#define GPIO_PWM_DUTY GPIOPWM_PWM0_DUTY_SET_reg

#define GPIO_CR_ST GPIOPWM_GPIO_ACR_reg
#define GPIO_DATA_ST GPIOPWM_GPIO_ADATA_reg
#define GPIO_PWM_ST GPIOPWM_ST_PWM0_B0_reg	 //todo: spec is different in Atlantic, need checking
#define GPIO_PWM_DUTY_ST GPIOPWM_ST_PWM0_AD0_reg
#endif

//==========================================================
//				IC PWM Setting Start
//==========================================================
#define _PWM_TOTAL_NUM		10

#define _PWM_0_DUTY_MIN		0
#define _PWM_0_DUTY_MAX		100

#define _PWM_1_DUTY_MIN		0
#define _PWM_1_DUTY_MAX		100

#define _PWM_2_DUTY_MIN		0
#define _PWM_2_DUTY_MAX		100

#define _PWM_3_DUTY_MIN		0
#define _PWM_3_DUTY_MAX		100

#define _PWM_4_DUTY_MIN		0
#define _PWM_4_DUTY_MAX		100

#define _PWM_5_DUTY_MIN		0
#define _PWM_5_DUTY_MAX		100

#define _PWM_6_DUTY_MIN		0
#define _PWM_6_DUTY_MAX		100

#define _PWM_7_DUTY_MIN		0
#define _PWM_7_DUTY_MAX		100

#define _PWM_ST0_DUTY_MIN		0
#define _PWM_ST0_DUTY_MAX		100

#define _PWM_ST1_DUTY_MIN		0
#define _PWM_ST1_DUTY_MAX		100

//0x1801_2104[31],  PWMx_CTRL.PWM0L
//set PWM output wave form
#define _PWM_ACTIVE_HIGH		0
#define _PWM_ACTIVE_LOW		1

#define _PWM_0_L_ACTIVE		_PWM_ACTIVE_HIGH
#define _PWM_1_L_ACTIVE		_PWM_ACTIVE_HIGH
#define _PWM_2_L_ACTIVE		_PWM_ACTIVE_HIGH
#define _PWM_3_L_ACTIVE		_PWM_ACTIVE_HIGH
#define _PWM_4_L_ACTIVE		_PWM_ACTIVE_HIGH
#define _PWM_5_L_ACTIVE		_PWM_ACTIVE_HIGH
#define _PWM_6_L_ACTIVE		_PWM_ACTIVE_HIGH
#define _PWM_7_L_ACTIVE		_PWM_ACTIVE_HIGH
#define _PWM_ST0_L_ACTIVE	_PWM_ACTIVE_HIGH
#define _PWM_ST1_L_ACTIVE	_PWM_ACTIVE_HIGH

//0x1801_2104[30],  PWMx_CTRL.PWM0_CK
//set PWM output stage
#define _PWM_FIRST_STAGE_OUTPUT		0
#define _PWM_SECOND_STAGE_OUTPUT	1

#define _PWM_0_STAGE_OUTPUT			_PWM_SECOND_STAGE_OUTPUT
#define _PWM_1_STAGE_OUTPUT			_PWM_SECOND_STAGE_OUTPUT
#define _PWM_2_STAGE_OUTPUT			_PWM_SECOND_STAGE_OUTPUT
#define _PWM_3_STAGE_OUTPUT			_PWM_SECOND_STAGE_OUTPUT
#define _PWM_4_STAGE_OUTPUT			_PWM_SECOND_STAGE_OUTPUT
#define _PWM_5_STAGE_OUTPUT			_PWM_SECOND_STAGE_OUTPUT
#define _PWM_6_STAGE_OUTPUT			_PWM_SECOND_STAGE_OUTPUT
#define _PWM_7_STAGE_OUTPUT			_PWM_SECOND_STAGE_OUTPUT
#define _PWM_ST0_STAGE_OUTPUT		_PWM_SECOND_STAGE_OUTPUT
#define _PWM_ST1_STAGE_OUTPUT		_PWM_SECOND_STAGE_OUTPUT

//0x1801_2104[29],  PWMx_CTRL.PWM0_EN
//set PWM output enable
#define _PWM_OUTPUT_DISABLE		0
#define _PWM_OUTPUT_ENABLE		1

#define _PWM_0_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_1_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_2_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_3_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_4_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_5_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_6_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_7_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_ST0_ENABLE			_PWM_OUTPUT_ENABLE
#define _PWM_ST1_ENABLE			_PWM_OUTPUT_ENABLE

//0x1801_2104[28],  PWMx_CTRL.PWM0_VS_RST_EN
//set PWM reset by DVS
#define _PWM_RESET_BY_DVS_DISABLE	0
#define _PWM_RESET_BY_DVS_ENABLE		1

#define _PWM_0_DVS_RESET_ENABLE		_PWM_RESET_BY_DVS_DISABLE
#define _PWM_1_DVS_RESET_ENABLE		_PWM_RESET_BY_DVS_DISABLE
#define _PWM_2_DVS_RESET_ENABLE		_PWM_RESET_BY_DVS_DISABLE
#define _PWM_3_DVS_RESET_ENABLE		_PWM_RESET_BY_DVS_DISABLE
#define _PWM_4_DVS_RESET_ENABLE		_PWM_RESET_BY_DVS_DISABLE
#define _PWM_5_DVS_RESET_ENABLE		_PWM_RESET_BY_DVS_DISABLE
#define _PWM_6_DVS_RESET_ENABLE		_PWM_RESET_BY_DVS_DISABLE
#define _PWM_7_DVS_RESET_ENABLE		_PWM_RESET_BY_DVS_DISABLE
#define _PWM_ST0_DVS_RESET_ENABLE	_PWM_RESET_BY_DVS_DISABLE
#define _PWM_ST1_DVS_RESET_ENABLE	_PWM_RESET_BY_DVS_DISABLE

//0x1801_2104[27],  PWMx_CTRL.PWM0_DUT_8B
//set PWM reset by DVS
#define _PWM_08BIT_OUTPUT		1
#define _PWM_12BIT_OUTPUT		0

#define _PWM_0_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_1_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_2_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_3_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_4_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_5_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_6_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_7_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_ST0_BIT_OUTPUT	_PWM_12BIT_OUTPUT
#define _PWM_ST1_BIT_OUTPUT	_PWM_12BIT_OUTPUT

//0x1801_2104[4],  PWMx_CTRL.Open_drain_mod_sel
//Open drain mode selection
#define _PWM_NORMAL_MODE				0
#define _PWM_OPEN_DRAIN_MODE			1

#define _PWM_0_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_1_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_2_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_3_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_4_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_5_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_6_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_7_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_ST0_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE
#define _PWM_ST1_OPEN_DRAIN_MOD_SEL	_PWM_NORMAL_MODE

//0x1801_2104[0],  PWMx_CTRL.PWM_WIDTH_SEL
//Global control (for duty mode)
#define _PWM_DUTY_ACTIVE		0
#define _PWM_DUTY_INACTIVE	1

#define _PWM_0_WIDTH_SEL		_PWM_DUTY_ACTIVE
#define _PWM_1_WIDTH_SEL		_PWM_DUTY_ACTIVE
#define _PWM_2_WIDTH_SEL		_PWM_DUTY_ACTIVE
#define _PWM_3_WIDTH_SEL		_PWM_DUTY_ACTIVE
#define _PWM_4_WIDTH_SEL		_PWM_DUTY_ACTIVE
#define _PWM_5_WIDTH_SEL		_PWM_DUTY_ACTIVE
#define _PWM_6_WIDTH_SEL		_PWM_DUTY_ACTIVE
#define _PWM_7_WIDTH_SEL		_PWM_DUTY_ACTIVE
#define _PWM_ST0_WIDTH_SEL	_PWM_DUTY_ACTIVE
#define _PWM_ST1_WIDTH_SEL	_PWM_DUTY_ACTIVE

//0x1801_2108[31],  PWMx_Timing_CTRL.PWM0_CNT_MODE
#define _PWM_DUTY_MODE			0
#define _PWM_COUNTER_MODE		1

#define _PWM_0_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_1_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_2_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_3_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_4_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_5_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_6_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_7_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_ST0_CNT_MODE			_PWM_COUNTER_MODE
#define _PWM_ST1_CNT_MODE			_PWM_COUNTER_MODE

//0x1801_2108[30],  PWMx_Timing_CTRL.PWM0_CK_SEL_HS
#define _PWM_REF_CK_SEL			0
#define _PWM_REF_DHS				1

#define _PWM_0_CK_SEL_HS			_PWM_REF_CK_SEL
#define _PWM_1_CK_SEL_HS			_PWM_REF_CK_SEL
#define _PWM_2_CK_SEL_HS			_PWM_REF_CK_SEL
#define _PWM_3_CK_SEL_HS			_PWM_REF_CK_SEL
#define _PWM_4_CK_SEL_HS			_PWM_REF_CK_SEL
#define _PWM_5_CK_SEL_HS			_PWM_REF_CK_SEL
#define _PWM_6_CK_SEL_HS			_PWM_REF_CK_SEL
#define _PWM_7_CK_SEL_HS			_PWM_REF_CK_SEL
#define _PWM_ST0_CK_SEL_HS		_PWM_REF_CK_SEL
#define _PWM_ST1_CK_SEL_HS		_PWM_REF_CK_SEL

//0x1801_2108[29],  PWMx_Timing_CTRL.PWM0_CK_SEL
#define _PWM_CK_CRYSTAL			0
#define _PWM_CK_PLL_OUTPUT		1

#define _PWM_0_CK_SEL				_PWM_CK_CRYSTAL
#define _PWM_1_CK_SEL				_PWM_CK_CRYSTAL
#define _PWM_2_CK_SEL				_PWM_CK_CRYSTAL
#define _PWM_3_CK_SEL				_PWM_CK_CRYSTAL
#define _PWM_4_CK_SEL				_PWM_CK_CRYSTAL
#define _PWM_5_CK_SEL				_PWM_CK_CRYSTAL
#define _PWM_6_CK_SEL				_PWM_CK_CRYSTAL
#define _PWM_7_CK_SEL				_PWM_CK_CRYSTAL
#define _PWM_ST0_CK_SEL			_PWM_CK_CRYSTAL
#define _PWM_ST1_CK_SEL			_PWM_CK_CRYSTAL

//0x1801_2108[27:24],  PWMx_Timing_CTRL.PWM0_ CYCLE_MAX
#define _PWM_0_CYCLE_MAX			0
#define _PWM_1_CYCLE_MAX			0
#define _PWM_2_CYCLE_MAX			0
#define _PWM_3_CYCLE_MAX			0
#define _PWM_4_CYCLE_MAX			0
#define _PWM_5_CYCLE_MAX			0
#define _PWM_6_CYCLE_MAX			0
#define _PWM_7_CYCLE_MAX			0
#define _PWM_ST0_CYCLE_MAX		0
#define _PWM_ST1_CYCLE_MAX		0

//0x1801_2108[13:12],  PWMx_Timing_CTRL.PWM0_M
#define _PWM_0_M					0
#define _PWM_1_M					0
#define _PWM_2_M					0
#define _PWM_3_M					0
#define _PWM_4_M					0
#define _PWM_5_M					0
#define _PWM_6_M					0
#define _PWM_7_M					0
#define _PWM_M_MAX					3

//0x1801_2108[11:0],  PWMx_Timing_CTRL.PWM0_N
#define _PWM_0_N					0
#define _PWM_1_N					0
#define _PWM_2_N					0
#define _PWM_3_N					0
#define _PWM_4_N					0
#define _PWM_5_N					0
#define _PWM_6_N					0
#define _PWM_7_N					0
#define _PWM_N_MAX					0xFFF

//0x1801_1258[4:0],  ST_PWM0_AD0.PWM0CSD
//#define _PMM_PWM_CLOCK_SOURCE_DIVISOR		0
#define _PMM_PWM_ST0_CLOCK_SOURCE_DIVISOR	0
#define _PMM_PWM_ST1_CLOCK_SOURCE_DIVISOR	0
#define _PMM_PWM_CLOCK_SOURCE_DIVISOR_MAX	0x1F //max value = 2^0x1f

#define MAIN_PWM_TOTAL_NUM			(GPIO_TYPE_PWM7 + 1)
#define PMM_PWM_TOTAL_NUM			2
#define PWM_TOTAL_NUM					(GPIO_TYPE_ST_PWM1 + 1)
//==========================================================
//				IC PWM Setting End
//==========================================================

//static unsigned int*	 PQA_TABLE_OFFSET_TEMP = NULL;
//static unsigned int PQA_RUN[PQA_INPUT_TYPE_MAX] = {0};

//static unsigned short PQA_Input_Level[PQA_INPUT_ITEM_MAX];
//static unsigned short PQA_Input_rate[PQA_INPUT_ITEM_MAX];

#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
/* DCTI Coef */
#define COLOR_DLCTI_DM_DCTI_OPTIONS_reg          (0xb802a01c)
#define COLOR_DLCTI_DM_DCTI_1ST_VALUE_reg        (0xb802a020)
#define COLOR_DLCTI_DM_DCTI_2ND_VALUE_reg        (0xb802a024)
#define COLOR_DLCTI_DS_DCTI_OPTIONS_reg          (0xb802a028)
#define COLOR_DLCTI_DS_DCTI_1ST_VALUE_reg        (0xb802a02c)
#define COLOR_DLCTI_DS_DCTI_2ND_VALUE_reg        (0xb802a030)
#endif
// use new table in pq misc, elieli
#if 0
static  unsigned char tDCTI_COEF[11][6] =
 {
//	unsigned char Prevent_PE,  unsigned char F_Gain, unsigned char F_th, unsigned char S_DCTI_Enable, unsigned char S_Gain, unsigned char S_Th
		{0x01, 0x00, 0x00, 0x00, 0x00, 0x00},	// 1
		{0x01, 0x03, 0x01, 0x00, 0x00, 0x00},	// 2
		{0x00, 0x06, 0x19, 0x00, 0x00, 0x00},	// 3  th 01->19 JZ
		{0x00, 0x09, 0x01, 0x00, 0x00, 0x00},	// 4
		{0x00, 0x0C, 0x01, 0x00, 0x00, 0x00},	// 5
		{0x00, 0x0F, 0x02, 0x00, 0x00, 0x00},	// 6
		{0x00, 0x03, 0x02, 0x01, 0x03, 0x10},	// 7
		{0x00, 0x06, 0x02, 0x01, 0x06, 0x20},	// 8
		{0x00, 0x0A, 0x10, 0x01, 0x0A, 0x30},	// 9
		{0x00, 0x0F, 0x1F, 0x01, 0x0F, 0x3F},	// 10
		{0x00, 0x1F, 0x1F, 0x00, 0x00, 0x00},      // 11, Color Bar
 };


 unsigned char INEWDCTI_COEF[10][10] =
 {
//	unsigned char data_sel,  unsigned char maxlen, unsigned char psmth, unsigned char lpmode, unsigned char engdiv, unsigned char offdiv, unsigned char uvgain, unsigned char dcti_mode, unsigned char cul_sel, unsigned char dcti_en
		{0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x08, 0x00, 0x00, 0x01},  // 1 SD HDMI
		{0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x10, 0x00, 0x00, 0x01},	// 2 SD Video
		{0x00, 0x00, 0x00, 0x00, 0x01, 0x03, 0x20, 0x00, 0x00, 0x01},	// 3 HD
		{0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x01},	// 4 ColorBar
		{0x01, 0x07, 0x00, 0x01, 0x01, 0x03, 0x16, 0x00, 0x00, 0x01},	// 5
		{0x01, 0x07, 0x00, 0x01, 0x01, 0x03, 0x16, 0x00, 0x00, 0x01},	// 6
		{0x01, 0x02, 0x00, 0x01, 0x01, 0x03, 0x10, 0x00, 0x00, 0x01},      // 7
		{0x01, 0x07, 0x00, 0x01, 0x01, 0x03, 0x30, 0x00, 0x00, 0x01},	// 8
		{0x01, 0x07, 0x00, 0x01, 0x01, 0x03, 0x16, 0x00, 0x00, 0x01},	// 9
		{0x01, 0x07, 0x00, 0x01, 0x01, 0x03, 0x16, 0x00, 0x00, 0x01},	// 10
 };
/*
DRV_VipIDcti_t gVipIDcti[] =
{
	{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},	// 0
	{0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00},	// 1
	{0x01, 0x01, 0x03, 0x01, 0x00, 0x00, 0x00},	// 2
	{0x00, 0x01, 0x06, 0x19, 0x00, 0x00, 0x00},	// 3  th 01->19 JZ
	{0x00, 0x01, 0x09, 0x01, 0x00, 0x00, 0x00},	// 4
	{0x00, 0x01, 0x0C, 0x01, 0x00, 0x00, 0x00},	// 5
	{0x00, 0x01, 0x0F, 0x02, 0x00, 0x00, 0x00},	// 6
	{0x00, 0x01, 0x03, 0x02, 0x01, 0x03, 0x10},	// 7
	{0x00, 0x01, 0x06, 0x02, 0x01, 0x06, 0x20},	// 8
	{0x00, 0x01, 0x0A, 0x10, 0x01, 0x0A, 0x30},	// 9
	{0x00, 0x01, 0x0F, 0x1F, 0x01, 0x0F, 0x3F},	// 10
	{0x00, 0x01, 0x1F, 0x1F, 0x00, 0x00, 0x00},      // 11, Color Bar
};
*/

#endif

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
//unsigned int	*reg_HistCnt;	// histogram
static unsigned int	*reg_HistCnt_Sub;
#endif

static unsigned char* RTNR_Y_Table = NULL;
static unsigned char* RTNR_C_Table = NULL;
static unsigned char* DNR_Table = NULL;

unsigned int databaseDCCsize=10;

// Hawaii add for new AutoView 20131001
unsigned char AutoView_flag;

// Hawaii add for Edge Peaking 20131022
unsigned short *Edge_Peaking_Table = NULL;
static unsigned short* Edge_AutoPk_data = NULL; //share memory start point

static unsigned int*	 COEFF_BY_Y_REG = NULL;

static unsigned char* PWM_table_tv057= NULL;

#if SCALERVIP_TEST
static unsigned char* 	DNR_LEVEL_TABLE=&tDNRLevel[0][0][0];

static unsigned int*	 NR_TABLE32 = &tNR32[0][0];
static unsigned char* NR_TABLE8 = &tNR8[0][0];
#else
static unsigned char* 	DNR_LEVEL_TABLE=NULL;


static unsigned int*	 NR_TABLE32 = NULL;
static unsigned char* NR_TABLE8 = NULL;
#endif

//unsigned char 	SceneChange=0, SceneChange_NR=0;
unsigned char 	SubSceneChange=0;

//unsigned char 	Main_Set_SC=0;
unsigned int 	Total_HistCnt_Sub=0;


static unsigned int RTNR_MAD_count_Y_sum_avg = 0;

static unsigned char AUTO_NR_style = 1;
unsigned char DNR_Auto_lvl_SdHd = 0; //20120302 for MPEG NR setting SD/HD Auto level related with RTNR_MAD_count_Y_sum_avg
unsigned char pre_DNR_Auto_lvl_SdHd = 255;
unsigned char VD_noise_level = 0;
unsigned char pre_VD_noise_level = 255;
unsigned char rate_Lerp_NR = 10;
unsigned char DNR_Flag = 0;
unsigned char Level_Max = 10;

unsigned char AutoNR_Level_bound = 0;

//static unsigned int  DNR_TABLE_32[5] = {DNR_T0_32, DNR_T1_32, DNR_T2_32, DNR_T3_32, DNR_T4_32};
//static unsigned int DNR_TABLE_8[5] = {DNR_T0, DNR_T1, DNR_T2, DNR_T3, DNR_T4};
#if 0 //Replase by PQA adaptive control Flow
static unsigned int MPEGNR_TABLE_8[5] = {MPEGNR_T0, MPEGNR_T1, MPEGNR_T2, MPEGNR_T3, MPEGNR_T4};
#endif

//=============== Mpeg NR =================================
//static unsigned int       mean_local_var_th=0x0100;
static unsigned int       MpegRatioSum=0, MpegCounter_H=0;
static unsigned int        MpegRatio_ave=0, MpegCounter_H_ave=0;
static unsigned char        ContainStill_Count=0;
static unsigned char        MpegRatioSum_Count=0;
static unsigned char        Field_Count=0;//count for every MpegPeriod fields
static unsigned int       NoiseSum_spatial=0;
static unsigned char        MpgIdx_X=0,MpgIdx_Y=0;
static unsigned int       MpegEnable_flag=0;
static unsigned char       	NL_mpg=0, NL_mpg_sharp;
unsigned char 		NR_HW_Dering_Level_isr = 0;   // New for At  // Erin '100308
static SCALERVIP_MPEGNR scalerVip_mpegNR=0;

//flora, add for Sirius
#define MpegPeriod	9
#define MpegIdxPeriod	(MpegPeriod/3)
static unsigned char        MpgIdx_X_arr[4]={0,0,0,0};
static unsigned char        XSTEP_NUM=1;
static unsigned int       array_xstep[3]={0x1000,0x1c71,0x2aab};
static unsigned int       xstep_idx_detect=0;
static unsigned int       xstep_idx_apply=0;
static unsigned char 	    kernel_quality_init=0;
//========================================================
//static unsigned char CircleCnt = 0; CSFC mark from 20140429
static unsigned char PictureMode; // picture mode

//=============== Skin Tone Detection =================
unsigned char        skin_tone_for_panasonic=0;
unsigned char        skin_tone_begin=0;
unsigned char        skin_detected=0;
unsigned char        dcc_first_setting = 1;
unsigned char        start_to_detected = 0;
unsigned int		regDev, enter_cnt=0;
unsigned char		bld_f0, bld_f1, bld_f2, blend_factor;
unsigned char		pre_curve[15];
unsigned char		user_curve[15];
unsigned char		skin_tone_found;
unsigned char		new_skin_tone_flag=0;
unsigned char		skin_tone_huu_bin_ratio=0;

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
//-- Start New for AT Erin '100308
_clues *SmartPic_clue=NULL;
#endif


//========= User Defined Curve & Pure Color  Detection ==========

//========= erroe distribution Detection ==========
unsigned char error_dist=0;
//-- End New for AT Erin '100308

static unsigned char		scalerVipBrightness = 0;
static unsigned char		scalerVipContrast = 0;

static unsigned char TableNRSpatial = 0;
unsigned int  hue_hist_2[24];

//=========hsinyi icm hue hsitogram========
unsigned char icm_hue_cnt_begin =0;
unsigned char icm_hue_cnt_result =0;
unsigned char huehist_flag=0;
//=================================

static unsigned char TableNR_MPEGNR_H;
static unsigned char TableNR_MPEGNR_V;

//=================================
unsigned char TableNR_SNR_Y;
unsigned char TableNR_SNR_C;
//==========planck add for TV AutoNR=======
static unsigned char TableNRTemporal;
static unsigned char TableNR_RTNR_Y;
static unsigned char TableNR_RTNR_C;
unsigned char VIP_FACTORY_UnShpMask;
unsigned char VIP_FACTORY_SCALEPK;
unsigned char VIP_FACTORY_SHP1D2D_EGSM;

unsigned short scalerVip_ICM_Global_Sat=0;

unsigned char scalerVip_Scaler_FIR_H=0;
unsigned char scalerVip_Scaler_FIR_V=0;

unsigned char scalerVip_Scaler_FIR_H_8tap=0;
unsigned char scalerVip_Scaler_FIR_V_6tap=0;


unsigned int scalerVip_PEAKING_POS_RANGE_MAX = 0;
unsigned int scalerVip_PEAKING_NEG_RANGE_MAX = 0;
unsigned char scalerVip_PEAKING_CORING = 0;
unsigned char scalerVip_PEAKING_LEVEL = 0;

unsigned char TableNR_HMCNR;
unsigned char TableNR_VerticalNR;

#define SU_PK_COEF_COL_MAX	6
static unsigned char egsm_on2off=0;
static unsigned char egsm_off2on=0;
static unsigned char shp2D_on2off=0;
static unsigned char shp2D_off2on=0;
//===================================

unsigned int Previous_TV_signal_Status;
unsigned char Previous_TV_noise_level;
unsigned int Previous_TV_DNR_level;
unsigned int TV_AutoNR_On_Off=0;

unsigned int AUTO_DNR_RTNR_Leve=0;
unsigned int AUTO_DNR_SNR_Leve=0;

unsigned int Previous_DNR_AUTOMODE_CaseLevel=0;
unsigned char AUTOMODE_status=0;
unsigned char AUTOMODE_on_off=0;

unsigned char HDMICOLORBAR_on_off=0;
unsigned char COLORBAR_on_off=0;

//=============== for MEMC Info jzl 20151231 =================

SET_MEMC_SCALER_VIP_INFO setScalerVIPInfo = {0};

//=============== for MEMC info ==============================
#define complement2(arg) (((~arg)&0x7FF)+1)

//===============================================================//
//DCC table, Elsie 20131210
//===============================================================//
//static unsigned int dcc_histogram_write_cnt = 0;



//==================== SmartFit =================
unsigned int Smartfit_Frame_Sum = 0;

//=====================================================
//==================== new RTNR adaptive table =================
//=====================================================
#ifdef ISR_NEW_RTNR_ENABLE
//Ypbpr/HDMI
static unsigned char New_RTNR_Coef_1[8][8] = {
		/*edge		0	1	2	3	4	5	6	7	*/
		/*sad  */
		/*	0  */{	0,	1,	2,	3,	4,	5,	7,	7},
		/*	1  */{	1,	1,	2,	3,	5,	6,	7,	7},
		/*	2  */{	2,	2,	3,	4,	5,	7,	7,	7},
		/*	3  */{	2,	3,	4,	5,	6,	7,	7,	7},
		/*	4  */{	4,	6,	6,	6,	6,	7,	7,	7},
		/*	5  */{	5,	5,	7,	7,	7,	7,	7,	7},
		/*	6  */{	7,	7,	7,	7,	7,	7,	7,	7},
		/*	7  */{	7,	7,	7,	7,	7,	7,	7,	7},
};

static unsigned char TV_AutoNr_RTNR_Coef_A[8][8]={
			/*edge		0	1	2	3	4	5	6	7	*/
			/*sad  */
			/*	0  */{	1,	1,	3,	4,	5,	6,	7,	7},
			/*	1  */{	1,	1,	3,	5,	6,	7,	7,	7},
			/*	2  */{	2,	2,	4,	5,	6,	7,	7,	7},
			/*	3  */{	4,	5,	5,	6,	6,	7,	7,	7},
			/*	4  */{	6,	6,	6,	6,	6,	7,	7,	7},
			/*	5  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	6  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	7  */{	7,	7,	7,	7,	7,	7,	7,	7},

			};
static unsigned char TV_AutoNr_RTNR_Coef_B[8][8]={
			/*edge		0	1	2	3	4	5	6	7	*/
			/*sad  */
			/*	0  */{	2,	2,	3,	3,	5,	6,	7,	7},
			/*	1  */{	2,	2,	4,	5,	6,	7,	7,	7},
			/*	2  */{	3,	4,	4,	5,	6,	7,	7,	7},
			/*	3  */{	4,	5,	5,	6,	6,	7,	7,	7},
			/*	4  */{	5,	6,	6,	6,	6,	7,	7,	7},
			/*	5  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	6  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	7  */{	7,	7,	7,	7,	7,	7,	7,	7},

			};

// CVBS
static unsigned char CVBS_AutoNr_RTNR_Coef_A[8][8]={
			/*edge		0	1	2	3	4	5	6	7	*/
			/*sad  */
			/*	0  */{	0,	1,	2,	4,	5,	6,	7,	7},
			/*	1  */{	1,	2,	3,	5,	6,	7,	7,	7},
			/*	2  */{	2,	3,	4,	5,	6,	7,	7,	7},
			/*	3  */{	4,	5,	5,	6,	6,	7,	7,	7},
			/*	4  */{	6,	6,	6,	6,	6,	7,	7,	7},
			/*	5  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	6  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	7  */{	7,	7,	7,	7,	7,	7,	7,	7},
			};
static unsigned char CVBS_AutoNr_RTNR_Coef_B[8][8]={
			/*edge		0	1	2	3	4	5	6	7	*/
			/*sad  */
			/*	0  */{	1,	2,	3,	5,	6,	7,	7,	7},
			/*	1  */{	2,	2,	4,	5,	6,	7,	7,	7},
			/*	2  */{	3,	3,	4,	5,	6,	7,	7,	7},
			/*	3  */{	4,	4,	5,	6,	7,	7,	7,	7},
			/*	4  */{	5,	6,	6,	7,	7,	7,	7,	7},
			/*	5  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	6  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	7  */{	7,	7,	7,	7,	7,	7,	7,	7},
			};
static unsigned char CVBS_AutoNr_RTNR_Coef_C[8][8]={
			/*edge		0	1	2	3	4	5	6	7	*/
			/*sad  */
			/*	0  */{	2,	2,	3,	3,	5,	6,	7,	7},
			/*	1  */{	2,	2,	4,	5,	6,	7,	7,	7},
			/*	2  */{	3,	4,	4,	5,	6,	7,	7,	7},
			/*	3  */{	4,	5,	5,	6,	6,	7,	7,	7},
			/*	4  */{	5,	6,	6,	6,	6,	7,	7,	7},
			/*	5  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	6  */{	7,	7,	7,	7,	7,	7,	7,	7},
			/*	7  */{	7,	7,	7,	7,	7,	7,	7,	7},
			};

#endif
//==========================================================================
//==========================================================================

//=======================
static unsigned int andMASK_Table1[32]=	{
							0xfffffffe, 0xfffffffc, 0xfffffff8, 0xfffffff0,
							0xffffffe0, 0xffffffc0, 0xffffff80, 0xffffff00,
							0xfffffe00, 0xfffffc00, 0xfffff800, 0xfffff000,
							0xffffe000, 0xffffc000, 0xffff8000, 0xffff0000,
							0xfffe0000, 0xfffc0000, 0xfff80000, 0xfff00000,
							0xffe00000, 0xffc00000, 0xff800000, 0xff000000,
							0xfe000000, 0xfc000000, 0xf8000000, 0xf0000000,
							0xe0000000, 0xc0000000, 0x80000000, 0x00000000
							};
static unsigned int andMASK_Table2[32]=	{
							0x00000000, 0x00000001, 0x00000003, 0x00000007,
							0x0000000f, 0x0000001f, 0x0000003f, 0x0000007f,
							0x000000ff, 0x000001ff, 0x000003ff, 0x000007ff,
							0x00000fff, 0x00001fff, 0x00003fff, 0x00007fff,
							0x0000ffff, 0x0001ffff, 0x0003ffff, 0x0007ffff,
							0x000fffff, 0x001fffff, 0x003fffff, 0x007fffff,
							0x00ffffff, 0x01ffffff, 0x03ffffff, 0x07ffffff,
							0x0fffffff, 0x1fffffff, 0x3fffffff, 0x7fffffff
							};
unsigned int PQA_Sort_Tmp[2][PQA_ITEM_MAX];
//=======================


//=================================================================================//
//  Auto MA enable/disable setting, VIP Page1
//=================================================================================//
static unsigned char TVAutoNR_Mode= 0;//default setting, final level depend by vip table
//=================================================================================//
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
extern _system_setting_info *system_info_structure_table;
extern _RPC_system_setting_info	*RPC_system_info_structure_table;
extern SLR_VIP_TABLE *g_Share_Memory_VIP_TABLE_Struct_isr;
extern SLR_VIP_TABLE_CUSTOM_TV001 *g_Share_Memory_VIP_TABLE_Custom_Struct_isr;
extern _clues *SmartPic_clue;
extern _RPC_clues *RPC_SmartPic_clue;
extern unsigned char *DCR_TABLE;
extern VIP_table_crc_value *vip_table_crc_isr;
#else
static unsigned char *DCR_TABLE;
static unsigned int	*reg_HistCnt_Sub;
_clues *SmartPic_clue=NULL;
_system_setting_info		 	*system_info_structure_table=NULL;
_RPC_system_setting_info		 *RPC_system_info_structure_table=NULL;
SLR_VIP_TABLE		             *g_Share_Memory_VIP_TABLE_Struct_isr= NULL;
SLR_VIP_TABLE_CUSTOM_TV001	 *g_Share_Memory_VIP_TABLE_Custom_Struct_isr= NULL;
VIP_table_crc_value_ISR *vip_table_crc_isr = NULL;
#endif

unsigned char					 *g_Dynamic_Peaking_Display_TABLE= NULL;

Stop_Polling_t	 Stop_Polling;
Start_Print_info_t Start_Print={1};//for scalerDi.cpp ROSprintrf( %0) issue !!!
static unsigned char Noisereduction_Vfilter= 0; //yuan1024 ::VNR::TV005
static unsigned char Noisereduction_Vfilter_ON= 0; //yuan1024 ::VNR::TV005

RPC_TV003_Table *TV003_share_memory_struct=NULL;

//=================================================================================//
//	TG45_Flag
//=================================================================================//
//static unsigned char TG45_Flag = 0;
unsigned char TG45_Flag = VIP_TG45_FLAG_NUM;
static unsigned char pre_TG45_Flag = 0;
//=================================================================================//

//=================================================================================//
static unsigned char AutoNR_Enable= TRUE;
static unsigned char AutoNR_Enable_by_Low_Mid_High= FALSE;
static unsigned char DNR_log = 0;
static unsigned char RTNR_log = 0;
static unsigned char SNR_log = 0;
static unsigned char INR_log = 0;

static unsigned char DEBUG_AUTO_NR = 0;
static unsigned char DEBUG_VD_NOISE = 0;
static unsigned char DEBUG_RTNR_MAD = 0;
static unsigned char DEBUG_HISTOGRAM_MEAN = 0;
//static unsigned char DNR_TABLE_SECET = 0;
//===========================

//======= ISR function varable Define ========
//static unsigned char TVnoise_Mode= TRUE; // TRUE-> sharp, FALSE-> Blur
//===================================

//======= RTNR K force =======
static unsigned char RTNR_K_force_level = 0;
static unsigned char RTNR_K_force_offset = 0;
//=======================

//========Debug define========
#define TV_AUTONR_Debug  TRUE
//========================
unsigned char Enable_Hist_MAD_Calculate = 1;
unsigned char colorless_flag = 0;
unsigned short hue_hist_ratio[24]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned short Y_hist_ratio[TV006_VPQ_chrm_bin]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned short Pre_Hue_hist_ratio[24] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned short Pre_Y_hist_ratio[32] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned int RTNR_MAD_count_Y_avg=0,RTNR_MAD_count_U_avg=0,RTNR_MAD_count_V_avg=0;
unsigned int RTNR_MAD_count_Y2_avg=0,RTNR_MAD_count_U2_avg=0,RTNR_MAD_count_V2_avg=0;
unsigned int RTNR_MAD_count_Y3_avg=0,RTNR_MAD_count_U3_avg=0,RTNR_MAD_count_V3_avg=0;
unsigned int hmcnr_sttistic[11];
unsigned short center=0,L1=0,R1=0,others=0;


unsigned int sat_hist_ratio[32]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned int sat_hist[32]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned int sat_ratio_mean_value;
unsigned char correctionBit1_Duty = 5;
unsigned char nonAuto_RTNR_Y_LEVEL, nonAuto_RTNR_C_LEVEL;
unsigned char correctionBit1_duty_debug = 0;
unsigned char DCC_Limit_range_dark_extend = 0; //0~16
unsigned char DCC_Limit_range_light_extend = 0; //0~16
unsigned char DCC_SCurve_Turning_Point_Smooth = 0;

//for T2 2644
#define hist_dcc_new_sony_log_flag 0
#define printf_log_flag 0
#define meanSat_meanValue_printf_log_flag 0
#define SC_detect_printf_log_flag 0
#define base_curve_benchmark 1024
#define limit_range_up_b 940


#define limit_range_low_b 64
#if 0 //Replase by PQA adaptive control Flow
static unsigned char RTNR_LEVEL_SDHD_SONY, SPNR_LEVEL_SDHD_SONY, RTNR_LEVEL_SDHD_OFFSET_byMotionCompare;
#else
/*static unsigned char RTNR_LEVEL_SDHD_OFFSET_byMotionCompare*/;
#endif
unsigned int edge_motion_count, edge_motion_count_ave, total_motion_count, total_motion_count_ave, noise_flat_motion_count, noise_flatl_motion_count_ave;


unsigned short 	*intelligent_picture_table=NULL;
unsigned char Sharpness_OSD_update = _FALSE;
//unsigned char Sony_DCC_API_ON = 0, TV_002_style_ON = 0;
//unsigned char Sony_Radio_Caculator_flag, Sony_Radio_Caculator_RTNR_offset=0;
unsigned int Noise_Stastic_Count;

//========RTNR level compute========
unsigned char DNR_motion_lvl_SdHd;
//========profile block motion========
MOTION_NOISE_TYPE MAD_motion_status = MOTION_NOISE_TYPE_STILL;
MOTION_NOISE_TYPE block_motion_status = MOTION_NOISE_TYPE_STILL;
unsigned char block_motion_count_H = 0;
unsigned char block_motion_count_V = 0;
unsigned char block_noise_count_H = 0;
unsigned char block_noise_count_V = 0;

//========Fade detection========
unsigned char Fade_flag = 0;

//========3D mode========
unsigned char is3DLRmode = FALSE;

extern void  IoReg_D_domain_SetBits(unsigned int addr, unsigned int Mask);
extern void  IoReg_D_domain_ClearBits(unsigned int addr, unsigned int Mask);

/*******************************************************************************
* Program
******************************************************************************/

extern unsigned int scalerInfo_getPanelInfo_3DPanelType(void);
extern unsigned char scalerInfo_check_is_3dMode(void);
extern unsigned char VODMA_3D_Check_Is_Idma3dMode(void);

unsigned char BusyCheckRegBit(unsigned int addr, unsigned int value, unsigned int timeoutcnt)
{
	do {
		if(scaler_rtd_inl(addr) & value) {
			return TRUE;
		}
	} while(timeoutcnt-- != 0);

	return FALSE;
}


void drif_color_Edge_Noise_level(unsigned char ch, _rtnr_enl *ENL)
{
	if(ch==1)//sub
	{
	//  scalerDrvPrint("\n drif_color_enl() SUB!\n");
	 return ;
	}
	else//main
	{
	//  scalerDrvPrint("\n enl()\n");
		di_im_di_rtnr_et_count_y_RBUS im_di_rtnr_et_count_y_reg;
		di_im_di_rtnr_et_sum_y_RBUS im_di_rtnr_et_sum_y_reg;
//		di_im_di_rtnr_et_sum_u_RBUS im_di_rtnr_et_sum_u_reg;
//		di_im_di_rtnr_et_sum_v_RBUS im_di_rtnr_et_sum_v_reg;
		im_di_rtnr_et_count_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_COUNT_Y_reg);
		im_di_rtnr_et_sum_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_Y_reg);
		//im_di_rtnr_et_sum_u_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_U_reg);
		//im_di_rtnr_et_sum_v_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_V_reg);

		(ENL->ENL_Y)=  (im_di_rtnr_et_sum_y_reg.cp_temporal_same_et_sad_sum_y)/(im_di_rtnr_et_count_y_reg.cp_temporal_same_et_cnt_y+1);
		//(ENL->ENL_U)=  (im_di_rtnr_et_sum_u_reg.cp_temporal_same_et_sad_sum_u)/(im_di_rtnr_et_count_y_reg.cp_temporal_same_et_cnt_y+1);
		//(ENL->ENL_V)=  (im_di_rtnr_et_sum_v_reg.cp_temporal_same_et_sad_sum_v)/(im_di_rtnr_et_count_y_reg.cp_temporal_same_et_cnt_y+1);

		//  if(abc_cnt>=30)
		//  {
		//   scalerDrvPrint("\n******\nVIP: cnt=%d, ENL_Y=%d, ENL_U=%d, ENL_V=%d \n\n******\n", abc_cnt, ENL_Y,ENL_U,ENL_V);
		//   abc_cnt = 0;
		//  }
		//  abc_cnt++;
	}
}

void drvif_color_ClueGather( unsigned char ch, _clues* clueA)
{
	_rtnr_enl VIP_ENL={0};

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use rtd_t_inl in kernel
	clueA->film_motion_next_h_t = rtd_t_inl(di_im_di_si_film_motion_next_h_t_RBUS, DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg).film_motionstatus_699_680;
	clueA->film_motion_next_h_m = rtd_t_inl(di_im_di_si_film_motion_next_h_m_RBUS, DI_IM_DI_SI_FILM_MOTION_NEXT_H_M_reg).film_motionstatus_679_660;
	clueA->film_motion_next_h_b =	rtd_t_inl(di_im_di_si_film_motion_next_h_b_RBUS, DI_IM_DI_SI_FILM_MOTION_NEXT_H_B_reg).film_motionstatus_659_640;

	clueA->film_motion_pre_h_t = rtd_t_inl(di_im_di_si_film_motion_pre_h_t_RBUS, DI_IM_DI_SI_FILM_MOTION_PRE_H_T_reg).film_motionstatus_539_520;
	clueA->film_motion_pre_h_m = rtd_t_inl(di_im_di_si_film_motion_pre_h_m_RBUS, DI_IM_DI_SI_FILM_MOTION_PRE_H_M_reg).film_motionstatus_519_500 ;
	clueA->film_motion_pre_h_b =	rtd_t_inl(di_im_di_si_film_motion_pre_h_b_RBUS, DI_IM_DI_SI_FILM_MOTION_PRE_H_B_reg).film_motionstatus_499_480;

	clueA->film_motion_next_v_l = rtd_t_inl(di_im_di_si_film_motion_next_v_l_RBUS, DI_IM_DI_SI_FILM_MOTION_NEXT_V_L_reg).film_motionstatus_639_620;
	clueA->film_motion_next_v_m = rtd_t_inl(di_im_di_si_film_motion_next_v_m_RBUS, DI_IM_DI_SI_FILM_MOTION_NEXT_V_M_reg).film_motionstatus_619_600;
	clueA->film_motion_next_v_r = rtd_t_inl(di_im_di_si_film_motion_next_v_r_RBUS, DI_IM_DI_SI_FILM_MOTION_NEXT_V_R_reg).film_motionstatus_599_580;

	clueA->film_motion_pre_v_l= rtd_t_inl(di_im_di_si_film_motion_pre_v_l_RBUS, DI_IM_DI_SI_FILM_MOTION_PRE_V_L_reg).film_motionstatus_479_460 ;
	clueA->film_motion_pre_v_m= rtd_t_inl(di_im_di_si_film_motion_pre_v_m_RBUS, DI_IM_DI_SI_FILM_MOTION_PRE_V_M_reg).film_motionstatus_459_440;
	clueA->film_motion_pre_v_r= rtd_t_inl(di_im_di_si_film_motion_pre_v_r_RBUS, DI_IM_DI_SI_FILM_MOTION_PRE_V_R_reg).film_motionstatus_439_420;

	clueA->film_motion_next_c = rtd_t_inl(di_im_di_si_film_motion_next_c_RBUS, DI_IM_DI_SI_FILM_MOTION_NEXT_C_reg).film_motionstatus_579_560;
	clueA->film_motion_pre_c	= rtd_t_inl(di_im_di_si_film_motion_pre_c_RBUS, DI_IM_DI_SI_FILM_MOTION_PRE_C_reg).film_motionstatus_419_400;

	clueA->ma_total_fm_sum = rtd_t_inl(di_im_di_si_ma_total_fm_sum_RBUS,DI_IM_DI_SI_MA_TOTAL_FM_SUM_reg).total_frame_motion_sum;
	clueA->ma_large_fm_pixel = rtd_t_inl(di_im_di_si_ma_large_fm_pixel_RBUS,DI_IM_DI_SI_MA_LARGE_FM_PIXEL_reg).large_frame_motion_pixel;
	clueA->ma_large_fm_sum	= rtd_t_inl(di_im_di_si_ma_large_fm_sum_RBUS,DI_IM_DI_SI_MA_LARGE_FM_SUM_reg).large_frame_motion_sum;
#else
	di_im_di_si_film_motion_next_h_t_RBUS next_h_t;
	di_im_di_si_film_motion_next_h_m_RBUS next_h_m;
	di_im_di_si_film_motion_next_h_b_RBUS next_h_b;

	di_im_di_si_film_motion_pre_h_t_RBUS pre_h_t;
	di_im_di_si_film_motion_pre_h_m_RBUS pre_h_m;
	di_im_di_si_film_motion_pre_h_b_RBUS pre_h_b;

	di_im_di_si_film_motion_next_v_l_RBUS next_v_l;
	di_im_di_si_film_motion_next_v_m_RBUS next_v_m;
	di_im_di_si_film_motion_next_v_r_RBUS next_v_r;

	di_im_di_si_film_motion_pre_v_l_RBUS pre_v_l;
	di_im_di_si_film_motion_pre_v_m_RBUS pre_v_m;
	di_im_di_si_film_motion_pre_v_r_RBUS pre_v_r;

	di_im_di_si_film_motion_next_c_RBUS next_c;
	di_im_di_si_film_motion_pre_c_RBUS pre_c;

	di_im_di_si_ma_total_fm_sum_RBUS total_fm_sum;
	di_im_di_si_ma_large_fm_pixel_RBUS large_fm_pixel;
	di_im_di_si_ma_large_fm_sum_RBUS large_fm_sum;

	next_h_t.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	next_h_m.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	next_h_b.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);

	pre_h_t.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	pre_h_m.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	pre_h_b.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);

	next_v_l.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	next_v_m.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	next_v_r.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);

	pre_v_l.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	pre_v_m.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	pre_v_r.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);

	next_c.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	pre_c.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);

	total_fm_sum.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	large_fm_pixel.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);
	large_fm_sum.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_NEXT_H_T_reg);

	clueA->film_motion_next_h_t = next_h_t.film_motionstatus_699_680;
	clueA->film_motion_next_h_m = next_h_m.film_motionstatus_679_660;
	clueA->film_motion_next_h_b = next_h_b.film_motionstatus_659_640;

	clueA->film_motion_pre_h_t = pre_h_t.film_motionstatus_539_520;
	clueA->film_motion_pre_h_m = pre_h_m.film_motionstatus_519_500;
	clueA->film_motion_pre_h_b = pre_h_b.film_motionstatus_499_480;

	clueA->film_motion_next_v_l = next_v_l.film_motionstatus_639_620;
	clueA->film_motion_next_v_m = next_v_m.film_motionstatus_619_600;
	clueA->film_motion_next_v_r = next_v_r.film_motionstatus_599_580;

	clueA->film_motion_pre_v_l = pre_v_l.film_motionstatus_479_460;
	clueA->film_motion_pre_v_m = pre_v_m.film_motionstatus_459_440;
	clueA->film_motion_pre_v_r = pre_v_r.film_motionstatus_439_420;

	clueA->film_motion_next_c = next_c.film_motionstatus_579_560;
	clueA->film_motion_pre_c = pre_c.film_motionstatus_419_400;

	clueA->ma_total_fm_sum = total_fm_sum.total_frame_motion_sum;
	clueA->ma_large_fm_pixel = large_fm_pixel.large_frame_motion_pixel;
	clueA->ma_large_fm_sum = large_fm_sum.large_frame_motion_sum;
#endif

	drif_color_Edge_Noise_level(ch, &VIP_ENL);
	clueA->rtnr_noise = VIP_ENL.ENL_Y;
}

/**
 * Detect color histogram
 *
 * @param	en_test: debug mode
 * @return	void
 */
void scalerVIP_colorHistDetect(unsigned int en_test)
{
	static unsigned int DarkSum = 0;
	static unsigned int BritSum = 0;
	static unsigned char flag_g_PureColor = 0;
	color_d_vc_global_ctrl_RBUS d_vc_global_ctrl_Reg;

	unsigned char it = 0;
	unsigned int Sum_Hist = 0;
	unsigned char en_DumpHist = 0;
	unsigned int ratio_Hist = 0;
	unsigned char th_HistChk = 0;
	unsigned char th_HistChk_in = 0;
	unsigned char th_HistChk_out = 0;
	unsigned char en_HistTest = 0;
	//unsigned char flag_PureColor = 0;
	unsigned int tmp_max = 0;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	//scalerDrvPrint( "enter scalerVIP_colorHistDetect\n" );
	d_vc_global_ctrl_Reg.regValue = scaler_rtd_inl(COLOR_D_VC_Global_CTRL_reg);

	//----dump histogram data and calculate sumation-----
	//en_DumpHist = (en_test<<28)>>31; //bit 3
	en_DumpHist = (en_test & _BIT3)>>3; //bit 3

	for ( it=0 ; it<32 ; it++ ) {
		Sum_Hist += reg_HistCnt[it];
		//if ( en_DumpHist == 1 ) {
		//	scalerDrvPrint( "Hist BIN%d=%d\n", it, reg_HistCnt[it] );
		//}
	}

	//if ( en_DumpHist == 1 ) {
	//	scalerDrvPrint( "Hist Sum=%d\n", Sum_Hist );
	//}

	DarkSum = (reg_HistCnt[0]<<2)+(reg_HistCnt[1]<<1)+reg_HistCnt[2]+reg_HistCnt[3];
	BritSum = (reg_HistCnt[31]<<2)+(reg_HistCnt[30]<<1)+reg_HistCnt[29]+reg_HistCnt[28];


	//th_HistChk_in = (en_test<<16)>>24;//bit8~15
	th_HistChk_in = 80;
	//th_HistChk_out = (en_test<<8)>>24;//bit16~23
	th_HistChk_out = 75;
	//en_HistTest = (en_test<<27)>>31;//bit 4
	en_HistTest = (en_test & _BIT4)>>4;//bit 4

	//-----set th----
	if ( flag_g_PureColor ==0 )
		th_HistChk = th_HistChk_in;
	else
		th_HistChk = th_HistChk_out;

	//scalerDrvPrint( "=============th_HistChk_in=%d================\n", th_HistChk_in );

	for ( it=7 ; it<22 ; it++ ) {
		if ( Sum_Hist != 0 ) {
			ratio_Hist = (reg_HistCnt[it]+reg_HistCnt[it+1]) * 100 / Sum_Hist;
			//scalerDrvPrint( "=============RatioHist=%d================\n", ratio_Hist );
		}
		if ( ratio_Hist > tmp_max )
			tmp_max = ratio_Hist;
	}

	if ( tmp_max>th_HistChk && Sum_Hist )
		flag_g_PureColor = 1;
	else
		flag_g_PureColor = 0;
}


unsigned char scalerVIP_Saturation_Detection(void)//modify for mac3 icm
{
	unsigned int m_nRatio=0;
	unsigned char m_nCount=2,nIndex;
	unsigned char Saturation_detect_flag = 0,sat_thl=98;

	for(nIndex = 0 ;nIndex <m_nCount;nIndex++)
		m_nRatio += (SmartPic_clue->Sat_Main_His_Ratio)[nIndex];

	if(m_nRatio > sat_thl)
	{
		Saturation_detect_flag = 1;
	}
	else
	{
		Saturation_detect_flag = 0;
	}
	return Saturation_detect_flag;

	return 0 ;

}

unsigned char VD_noise_Status_sum_avg()
{
	static unsigned int VD_noise_count_Status_sum_avg = 0;
	static unsigned char VD_noise_count_Status_value[255] = {0};  //store value
	unsigned char countt;
	static unsigned int counter_noise = 0;
	static unsigned char VD_noise_flag = 1;
	static unsigned int VD_noise_count_Status_sum = 0;

	if ((counter_noise < (VD_noise_status_Num+1)) && VD_noise_flag)
	{
		VD_noise_count_Status_value[counter_noise % (VD_noise_status_Num+1)] = (unsigned char)VDPQ_rtd_inl(VDTOP_NOISE_STATUS_reg);
		VD_noise_count_Status_sum = VD_noise_count_Status_sum + VD_noise_count_Status_value[counter_noise % (VD_noise_status_Num+1)];
		VD_noise_count_Status_sum_avg = VD_noise_count_Status_sum /(counter_noise+1);
		//ROSPrintf(" yuan1024VD_noise_count_Status_sum_avg222222222222  = %d  %d\n",VD_noise_count_Status_sum_avg, VD_noise_count_Status_sum);
	}
	else
	{
		countt = counter_noise % (VD_noise_status_Num+1);

		if(VD_noise_count_Status_sum > VD_noise_count_Status_value[countt])
			VD_noise_count_Status_sum = VD_noise_count_Status_sum - VD_noise_count_Status_value[countt];
		else
			VD_noise_count_Status_sum = 0;

		VD_noise_count_Status_value[countt] = (unsigned char)VDPQ_rtd_inl(VDTOP_NOISE_STATUS_reg);

		VD_noise_count_Status_sum = ( VD_noise_count_Status_sum + VD_noise_count_Status_value[countt]);
		VD_noise_count_Status_sum_avg = VD_noise_count_Status_sum / (VD_noise_status_Num+1);
		VD_noise_flag = 0;
	}

	counter_noise ++;
	#if 0
	if(counter_noise % 60 == 0)
	{
		ROSPrintf("-----------------yuan1024-----------------------\n");
		ROSPrintf(" yuan1024 VD_noise_status_Num  =%d\n",VD_noise_status_Num+1);
		ROSPrintf(" yuan1024 VD_noise_count_Status_sum_avg  = %d\n",VD_noise_count_Status_sum_avg);
		ROSPrintf(" yuan1024 TV_Auto_NR_LEVEL = %d\n",VD_noise_level);
		ROSPrintf("-----------------yuan1024-----------------------\n");


	}
	#endif

	return VD_noise_count_Status_sum_avg;

}



void drvif_color_Print_NR_log(unsigned int current_Signal_Status, unsigned char NR_Item)
{
	di_im_di_rtnr_control_RBUS di_im_di_rtnr_control_RBUS_reg;

	di_im_di_rtnr_y_16_k0_k7_RBUS	im_di_rtnr_y_16_k0_k7_reg;
	di_im_di_rtnr_c_k_RBUS	di_im_di_rtnr_c_k_RBUS_reg;

	di_im_di_rtnr_y_16_th0_th3_RBUS im_di_rtnr_y_16_th0_th3_reg;
	di_im_di_rtnr_y_16_th4_th7_RBUS im_di_rtnr_y_16_th4_th7_reg;
	di_im_di_rtnr_c_th0_th3_RBUS im_di_rtnr_c_th0_th3_reg;
	di_im_di_rtnr_c_th4_th6_RBUS im_di_rtnr_c_th4_th6_reg;

	di_im_di_rtnr_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

	im_di_rtnr_y_16_k0_k7_reg.regValue = rtd_inl(DI_IM_DI_RTNR_Y_16_K0_K7_reg);
	di_im_di_rtnr_c_k_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_C_K_reg);

	im_di_rtnr_y_16_th0_th3_reg.regValue = rtd_inl(DI_IM_DI_RTNR_Y_16_TH0_TH3_reg);
	im_di_rtnr_y_16_th4_th7_reg.regValue = rtd_inl(DI_IM_DI_RTNR_Y_16_TH4_TH7_reg);
	im_di_rtnr_c_th0_th3_reg.regValue = rtd_inl(DI_IM_DI_RTNR_C_TH0_TH3_reg);
	im_di_rtnr_c_th4_th6_reg.regValue = rtd_inl(DI_IM_DI_RTNR_C_TH4_TH6_reg);


	if((DNR_log == TRUE)&&(NR_Item==0))	//DNR
	{
		if(DNR_Flag == 1)
		{
			//ROSPrintf("oo---DNR_Auto_level = %d\n", DNR_Auto_lvl_SdHd); //DNR_Auto_level); 20120131
			//ROSPrintf("\n----------------------------------DNR_TV_Auto------------------------------------------------------------- \n");
			//ROSPrintf("oo---Average_MAD_avg = %d ---oo\n", RTNR_MAD_count_Y_sum_avg); //Average_rtnr_noise_ave =%d , rtnr_noise_ave
			//ROSPrintf("oo---DCC_Histogram_Mean_value = %d---oo\n", DCC_Histogram_Mean_value);
			//ROSPrintf("oo---LEVEL = %d---oo\n", DNR_Auto_lvl_SdHd);
			//ROSPrintf("\n");
			//ROSPrintf("-----------------yuan1024-----------------------\n");
			//ROSPrintf(" yuan1024 VD_noise_status_Num  =%d\n",VD_noise_status_Num+1);
			//ROSPrintf(" yuan1024 VD_noise_count_Status_sum_avg  = %d\n",VD_noise_count_Status_sum_avg);
			//ROSPrintf(" yuan1024 VD_noise_count_Status_sum_avg  = %d\n",VD_noise_Status_sum_avg());
			//ROSPrintf(" yuan1024 TV_Auto_NR_LEVEL = %d\n",VD_noise_level);
			//ROSPrintf("-----------------yuan1024-----------------------\n");

		}
		else
		{
			//current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
			//ROSPrintf("oo---DNR_TV_Auto---oo\n");
			//ROSPrintf("\n----------------------------------DNR_TV_Auto------------------------------------------------------------- \n");
			//ROSPrintf("oo---VD_noise_vlue = %d---oo\n", current_Signal_Status);
			//ROSPrintf("oo---TV_Auto_NR_LEVEL = %d---oo\n", VD_noise_level );
			//ROSPrintf("oo---DCC_Histogram_Mean_value = %d---oo\n", DCC_Histogram_Mean_value);
			//ROSPrintf("\n");
			//ROSPrintf("-----------------yuan1024-----------------------\n");
			//ROSPrintf(" yuan1024 VD_noise_status_Num  =%d\n",VD_noise_status_Num+1);
//			ROSPrintf(" yuan1024 VD_noise_count_Status_sum_avg  = %d\n",VD_noise_count_Status_sum_avg);
			//ROSPrintf(" yuan1024 VD_noise_count_Status_sum_avg  = %d\n",VD_noise_Status_sum_avg());
			//ROSPrintf(" yuan1024 TV_Auto_NR_LEVEL = %d\n",VD_noise_level);
			//ROSPrintf("-----------------yuan1024-----------------------\n");

		}
	}



	if((RTNR_log  == TRUE)&&(NR_Item==1)) // RTNR
	{
/*
		RTD_Log(LOGGER_INFO,"\n--------------------------------Print_NR_log_RTNR--------------------------------------------------------------\n");
		RTD_Log(LOGGER_INFO,"[Print_NR_log_RTNR_Y ]::: RTNR_Y_enable = %d \n", di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_RTNR_Y ]::: YTH[2]= %d, YTH[1] = %d, YTH[0] = %d, k_value_Y = 0x%x \n", di_im_di_rtnr_y_th_RBUS_reg.cp_temporalthly3, di_im_di_rtnr_y_th_RBUS_reg.cp_temporalthly2, di_im_di_rtnr_y_th_RBUS_reg.cp_temporalthly1, di_im_di_rtnr_k_RBUS_reg.regValue & 0x0000ffff);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_RTNR_C ]::: RTNR_C_enable = %d \n", di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_RTNR_C ]::: CTH[2]= %d, CTH[1] = %d, CTH[0] = %d, k_value_C = 0x%x \n",	di_im_di_rtnr_c_th_RBUS_reg.cp_temporalthlc3, di_im_di_rtnr_c_th_RBUS_reg.cp_temporalthlc2, di_im_di_rtnr_c_th_RBUS_reg.cp_temporalthlc1, (di_im_di_rtnr_k_RBUS_reg.regValue & 0xffff0000) >> 16);
*/
		//ROSPrintf("\n--------------------------------Print_NR_log_RTNR--------------------------------------------------------------\n");
		//ROSPrintf("[Print_NR_log_RTNR_Y ]::: RTNR_Y_enable = %d \n", di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable);
		//ROSPrintf("[Print_NR_log_RTNR_Y ]::: YTH[6]= %d, YTH[5] = %d, YTH[4] = %d, YTH[3] = %d \n", im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly6, im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly5, im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly4, im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly3);
		//ROSPrintf("[Print_NR_log_RTNR_Y ]::: YTH[2]= %d, YTH[1] = %d, YTH[0] = %d, k_value_Y = %x \n", im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly2, im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly1, im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly0, im_di_rtnr_y_16_k0_k7_reg.regValue);
		//ROSPrintf("[Print_NR_log_RTNR_C ]::: RTNR_C_enable = %d \n", di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable);
		//ROSPrintf("[Print_NR_log_RTNR_C ]::: CTH[6]= %d, CTH[5] = %d, CTH[4] = %d, CTH[3] = %d \n", im_di_rtnr_c_th4_th6_reg.cp_temporalthlc6, im_di_rtnr_c_th4_th6_reg.cp_temporalthlc5, im_di_rtnr_c_th4_th6_reg.cp_temporalthlc4, im_di_rtnr_c_th0_th3_reg.cp_temporalthlc3);
		//ROSPrintf("[Print_NR_log_RTNR_C ]::: CTH[2]= %d, CTH[1] = %d, CTH[0] = %d, k_value_C = %x \n",	im_di_rtnr_c_th0_th3_reg.cp_temporalthlc2, im_di_rtnr_c_th0_th3_reg.cp_temporalthlc1, im_di_rtnr_c_th0_th3_reg.cp_temporalthlc0, di_im_di_rtnr_c_k_RBUS_reg.regValue);
	}


	nr_dch1_cp_ctrl_RBUS dch1_CP_Ctrl_reg;
	nr_dch1_spatial_thl_RBUS dch1_Spatial_Thl_reg;
	nr_dch1_spatial_thl2_RBUS dch1_Spatial_Thl2_reg;
	nr_dch1_spatial_weight_RBUS dch1_Spatial_Weight_Reg;
	nr_dch1_local_var2_RBUS nr_dch1_local_var2_RBUS_Reg;

	dch1_CP_Ctrl_reg.regValue = rtd_inl(NR_DCH1_CP_Ctrl_reg);
	dch1_Spatial_Thl_reg.regValue = rtd_inl(NR_DCH1_Spatial_Thl_reg);
	dch1_Spatial_Thl2_reg.regValue = rtd_inl(NR_DCH1_Spatial_Thl2_reg);
	dch1_Spatial_Weight_Reg.regValue = rtd_inl(NR_DCH1_Spatial_Weight_reg);
	nr_dch1_local_var2_RBUS_Reg.regValue= rtd_inl(NR_DCH1_Local_Var2_reg);


	if((SNR_log == TRUE)&&(NR_Item==2)) // SNR
	{
/*
		RTD_Log(LOGGER_INFO,"\n-------------------------------Print_NR_log_SNR---------------------------------------------------------------\n");
		RTD_Log(LOGGER_INFO,"[Print_NR_log_SNR_Y_1 ]::: CP_SpatialEnanble_Y =%d\n",dch1_CP_Ctrl_reg.cp_spatialenabley);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_SNR_Y_2 ]::: CP_SResultWeight =%d, FilterSizeY  = %d, CP_SpatialThlY = %d, CP_SpatialThlYx2 = %d, CP_SpatialThlYx4 = %d \n",dch1_CP_Ctrl_reg.cp_sresultweight, dch1_CP_Ctrl_reg.cp_zoranfiltersizey,dch1_Spatial_Thl_reg.cp_spatialthly, dch1_Spatial_Thl_reg.cp_spatialthlyx2, dch1_Spatial_Thl2_reg.cp_spatialthlyx4);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_SNR_Y_3 ]::: CP_Sw_Edge_Thl =%d, CP_En_Sw_Edge_Thl= %d, CP_Weight1Y = %d, CP_Weight2Y = %d \n",nr_dch1_local_var2_RBUS_Reg.cp_sw_edge_thl, nr_dch1_local_var2_RBUS_Reg.cp_en_sw_edge_thl, dch1_Spatial_Weight_Reg.cp_weight1y,  dch1_Spatial_Weight_Reg.cp_weight2y);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_SNR_C_1 ]::: CP_SpatialEnanble_C =%d\n",dch1_CP_Ctrl_reg.cp_spatialenablec);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_SNR_C_2 ]::: CP_SpatialThlC = %d, CP_SpatialThlCx2 = %d, CP_SpatialThlCx4 = %d \n",dch1_Spatial_Thl_reg.cp_spatialthlc, dch1_Spatial_Thl_reg.cp_spatialthlcx2, dch1_Spatial_Thl2_reg.cp_spatialthlcx4);
*/
		//ROSPrintf("\n-------------------------------Print_NR_log_SNR---------------------------------------------------------------\n");
		//ROSPrintf("[Print_NR_log_SNR_Y_1 ]::: CP_SpatialEnanble_Y =%d\n",dch1_CP_Ctrl_reg.cp_spatialenabley);
		//ROSPrintf("[Print_NR_log_SNR_Y_2 ]::: CP_SResultWeight =%d, FilterSizeY  = %d, CP_SpatialThlY = %d, CP_SpatialThlYx2 = %d, CP_SpatialThlYx4 = %d \n",dch1_CP_Ctrl_reg.cp_sresultweight, dch1_CP_Ctrl_reg.cp_zoranfiltersizey,dch1_Spatial_Thl_reg.cp_spatialthly, dch1_Spatial_Thl_reg.cp_spatialthlyx2, dch1_Spatial_Thl2_reg.cp_spatialthlyx4);
		//ROSPrintf("[Print_NR_log_SNR_Y_3 ]::: CP_Sw_Edge_Thl =%d, CP_En_Sw_Edge_Thl= %d, CP_Weight1Y = %d, CP_Weight2Y = %d \n",nr_dch1_local_var2_RBUS_Reg.cp_sw_edge_thl, nr_dch1_local_var2_RBUS_Reg.cp_en_sw_edge_thl, dch1_Spatial_Weight_Reg.cp_weight1y,  dch1_Spatial_Weight_Reg.cp_weight2y);
		//ROSPrintf("[Print_NR_log_SNR_C_1 ]::: CP_SpatialEnanble_C =%d\n",dch1_CP_Ctrl_reg.cp_spatialenablec);
		//ROSPrintf("[Print_NR_log_SNR_C_2 ]::: CP_SpatialThlC = %d, CP_SpatialThlCx2 = %d, CP_SpatialThlCx4 = %d \n",dch1_Spatial_Thl_reg.cp_spatialthlc, dch1_Spatial_Thl_reg.cp_spatialthlcx2, dch1_Spatial_Thl2_reg.cp_spatialthlcx4);
	}

	nr_dch1_impulse_thl_RBUS dch1_Impulse_Thl_reg;
	dch1_Impulse_Thl_reg.regValue = rtd_inl(NR_DCH1_Impulse_Thl_reg);
	nr_dch1_impulse_smooththl_RBUS dch1_Impulse_SmoothThl_reg;
	dch1_Impulse_SmoothThl_reg.regValue = rtd_inl(NR_DCH1_Impulse_SmoothThl_reg);


	if((INR_log == TRUE)&&(NR_Item==3)) // INR
	{
/*
		RTD_Log(LOGGER_INFO,"\n-------------------------------Print_NR_log_INR---------------------------------------------------------------\n");
		RTD_Log(LOGGER_INFO,"[Print_NR_log_INR_1 ]::: CP_ImpulseEnanble =%d\n",dch1_CP_Ctrl_reg.cp_impulseenable);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_INR_2 ]::: CP_ImpulseWindow =%d, CP_IResultWeight = %d\n",dch1_CP_Ctrl_reg.cp_impulsewindow, dch1_CP_Ctrl_reg.cp_iresultweight);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_INR_3 ]::: CP_IPixelDiffThlY	=%d, CP_ImpulseThlY	= %d, CP_ImpulseThlYx2 = %d, CP_ImpulseSmoothThlY= %d \n",dch1_Impulse_Thl_reg.cp_ipixeldiffthly, dch1_Impulse_Thl_reg.cp_impulsethly, dch1_Impulse_SmoothThl_reg.cp_impulsethlyx2, dch1_Impulse_SmoothThl_reg.cp_impulsesmooththly);
		RTD_Log(LOGGER_INFO,"[Print_NR_log_INR_4 ]::: CP_IPixelDiffThlC	=%d, CP_ImpulseThlC	= %d, CP_ImpulseThlCx2 = %d, CP_ImpulseSmoothThlC= %d \n",dch1_Impulse_Thl_reg.cp_ipixeldiffthlc, dch1_Impulse_Thl_reg.cp_impulsethlc, dch1_Impulse_SmoothThl_reg.cp_impulsethlcx2, dch1_Impulse_SmoothThl_reg.cp_impulsesmooththlc);
*/
		//ROSPrintf("\n-------------------------------Print_NR_log_INR---------------------------------------------------------------\n");
		//ROSPrintf("[Print_NR_log_INR_1 ]::: CP_ImpulseEnanble =%d\n",dch1_CP_Ctrl_reg.cp_impulseenable);
		//ROSPrintf("[Print_NR_log_INR_2 ]::: CP_ImpulseWindow =%d, CP_IResultWeight = %d\n",dch1_CP_Ctrl_reg.cp_impulsewindow, dch1_CP_Ctrl_reg.cp_iresultweight);
		//ROSPrintf("[Print_NR_log_INR_3 ]::: CP_IPixelDiffThlY	=%d, CP_ImpulseThlY	= %d, CP_ImpulseThlYx2 = %d, CP_ImpulseSmoothThlY= %d \n",dch1_Impulse_Thl_reg.cp_ipixeldiffthly, dch1_Impulse_Thl_reg.cp_impulsethly, dch1_Impulse_SmoothThl_reg.cp_impulsethlyx2, dch1_Impulse_SmoothThl_reg.cp_impulsesmooththly);
		//ROSPrintf("[Print_NR_log_INR_4 ]::: CP_IPixelDiffThlC	=%d, CP_ImpulseThlC	= %d, CP_ImpulseThlCx2 = %d, CP_ImpulseSmoothThlC= %d \n",dch1_Impulse_Thl_reg.cp_ipixeldiffthlc, dch1_Impulse_Thl_reg.cp_impulsethlc, dch1_Impulse_SmoothThl_reg.cp_impulsethlcx2, dch1_Impulse_SmoothThl_reg.cp_impulsesmooththlc);

	}

}

//====================================================
#define Field_count_check 5
#define Adap_newRTNR_Count_Num 5
#define MAD_th 5


	//=============()e
	//+++++++++++++vertical lpf
	unsigned int Gray_solution_table[5][6] =
	{
//		en,		hfd_statistic_max	hfd_statistic_min	vfir_weight_max	vfir_weight_min
		{1,		20000,			4000,			5,				9,				},	//NTSC
		{1,		20000,			4000,			5,				9,				},	//PAL
		{1,		20000,			4000,			5,				9,				},	//SD
		{1,		20000,			4000,			5,				9,				},	//HD
		{1,		20000,			4000,			5,				9,				},	//VGA
	};

unsigned char drvif_color_check_source_remmping(unsigned char display)
{
	unsigned char which_source = 255;
	unsigned char remmping_source = 255;

	which_source = (RPC_system_info_structure_table->VIP_source);

	if(which_source==VIP_QUALITY_TV_NTSC||which_source==VIP_QUALITY_CVBS_NTSC)
		remmping_source = 0;
	else if(which_source==VIP_QUALITY_TV_PAL||which_source==VIP_QUALITY_CVBS_PAL)
		remmping_source = 1;
	else if(((which_source>=VIP_QUALITY_YPbPr_480I) && (which_source<=VIP_QUALITY_YPbPr_576P))||
		    ((which_source>=VIP_QUALITY_HDMI_480I) 	&& (which_source<=VIP_QUALITY_HDMI_576P) )||
			((which_source>=VIP_QUALITY_DTV_480I) 	&& (which_source<=VIP_QUALITY_DTV_576P)  )||
			((which_source>=VIP_QUALITY_PVR_480I) 	&& (which_source<=VIP_QUALITY_PVR_576P)  ))
	{
		remmping_source = 2;
	}
	else if(((which_source>=VIP_QUALITY_YPbPr_720P) && (which_source<=VIP_QUALITY_YPbPr_1080P))||
			((which_source>=VIP_QUALITY_HDMI_720P) 	&& (which_source<=VIP_QUALITY_HDMI_1080P))||
			((which_source>=VIP_QUALITY_DTV_720P) 	&& (which_source<=VIP_QUALITY_DTV_1080P))||
			((which_source>=VIP_QUALITY_PVR_720P) 	&& (which_source<=VIP_QUALITY_PVR_1080P)))
	{
		remmping_source = 3;
	}
	else
	{
		remmping_source = 2;
	}

    return(remmping_source);
}


void drvif_color_inewdcti_set(unsigned char display, unsigned char data_sel,  unsigned char maxlen, unsigned char psmth, unsigned char lpmode, unsigned char engdiv, unsigned char offdiv, unsigned char uvgain, unsigned char dcti_mode, unsigned char cur_sel, unsigned char dcti_en)
{
	idcti_i_dcti_ctrl_1_RBUS ich1_newdcti_reg;

	if (display == SLR_MAIN_DISPLAY)
	{

		ich1_newdcti_reg.regValue=scaler_rtd_inl(IDCTI_I_DCTI_CTRL_1_reg);


		if(ich1_newdcti_reg.data_sel < data_sel)
			ich1_newdcti_reg.data_sel++;
		else if(ich1_newdcti_reg.data_sel > data_sel)
			ich1_newdcti_reg.data_sel--;

		if(ich1_newdcti_reg.maxlen < maxlen)
			ich1_newdcti_reg.maxlen++;
		else if(ich1_newdcti_reg.maxlen > maxlen)
			ich1_newdcti_reg.maxlen--;

		if(ich1_newdcti_reg.psmth < psmth)
			ich1_newdcti_reg.psmth++;
		else if(ich1_newdcti_reg.psmth > psmth)
			ich1_newdcti_reg.psmth--;


		if(ich1_newdcti_reg.lp_mode < lpmode)
			ich1_newdcti_reg.lp_mode++;
		else if(ich1_newdcti_reg.lp_mode > lpmode)
			ich1_newdcti_reg.lp_mode--;

		if(ich1_newdcti_reg.engdiv < engdiv)
			ich1_newdcti_reg.engdiv++;
		else if(ich1_newdcti_reg.engdiv > engdiv)
			ich1_newdcti_reg.engdiv--;



		if(ich1_newdcti_reg.offdiv < offdiv)
			ich1_newdcti_reg.offdiv++;
		else if(ich1_newdcti_reg.offdiv > offdiv)
			ich1_newdcti_reg.offdiv--;

		if(ich1_newdcti_reg.uvgain < uvgain)
			ich1_newdcti_reg.uvgain++;
		else if(ich1_newdcti_reg.uvgain > uvgain)
			ich1_newdcti_reg.uvgain--;

		if(ich1_newdcti_reg.dcti_mode < dcti_mode)
			ich1_newdcti_reg.dcti_mode++;
		else if(ich1_newdcti_reg.dcti_mode > dcti_mode)
			ich1_newdcti_reg.dcti_mode--;

		if(ich1_newdcti_reg.cur_sel < cur_sel)
			ich1_newdcti_reg.cur_sel++;
		else if(ich1_newdcti_reg.cur_sel > cur_sel)
			ich1_newdcti_reg.cur_sel--;

		if(ich1_newdcti_reg.dcti_en < dcti_en)
			ich1_newdcti_reg.dcti_en++;
		else if(ich1_newdcti_reg.dcti_en > dcti_en)
			ich1_newdcti_reg.dcti_en--;


		scaler_rtd_outl(IDCTI_I_DCTI_CTRL_1_reg, ich1_newdcti_reg.regValue);

	}

}

//JZ Mac3
void drvif_color_inewdcti_table_isr(DRV_VipNewIDcti_Table* ptr,unsigned char offset_gain)
{
	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
	{
		ROSPrintf("1.offset_gain=%d\n",offset_gain);
	}

	if(!ptr)
		return;

//Ctl1
	idcti_i_dcti_ctrl_1_RBUS ich1_newdcti_reg_1;
	ich1_newdcti_reg_1.regValue= scaler_rtd_inl(IDCTI_I_DCTI_CTRL_1_reg);

	ich1_newdcti_reg_1.data_sel = ptr->VipNewIDcti_ctl1.data_sel;
	ich1_newdcti_reg_1.maxlen = ptr->VipNewIDcti_ctl1.maxlen;
	ich1_newdcti_reg_1.psmth = ptr->VipNewIDcti_ctl1.psmth;
	ich1_newdcti_reg_1.lp_mode = ptr->VipNewIDcti_ctl1.lp_mode;
	ich1_newdcti_reg_1.engdiv = ptr->VipNewIDcti_ctl1.engdiv;
	ich1_newdcti_reg_1.offdiv= ptr->VipNewIDcti_ctl1.offdiv;

	ich1_newdcti_reg_1.uvgain= ((ptr->VipNewIDcti_ctl1.uvgain)+offset_gain)>127?127:((ptr->VipNewIDcti_ctl1.uvgain)+offset_gain);

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
	{
		ROSPrintf("2.uvgain=%d, offset_gain=%d\n",(ptr->VipNewIDcti_ctl1.uvgain),offset_gain);
	}

	/*
	if(ich1_newdcti_reg_1.uvgain>127)
	{
		ich1_newdcti_reg_1.uvgain = 127;
	}
	*/
	ich1_newdcti_reg_1.dcti_mode= ptr->VipNewIDcti_ctl1.dcti_mode;
	ich1_newdcti_reg_1.uvalign_en= ptr->VipNewIDcti_ctl1.uvalign_en;
	ich1_newdcti_reg_1.cur_sel = ptr->VipNewIDcti_ctl1.cur_sel;
	ich1_newdcti_reg_1.dcti_en = ptr->VipNewIDcti_ctl1.dcti_en;

	scaler_rtd_outl(IDCTI_I_DCTI_CTRL_1_reg, ich1_newdcti_reg_1.regValue);

//Ctl2
	idcti_i_dcti_ctrl_2_RBUS ich1_newdcti_reg_2;
	ich1_newdcti_reg_2.regValue= scaler_rtd_inl(IDCTI_I_DCTI_CTRL_2_reg);

	ich1_newdcti_reg_2.uvsync_en= ptr->VipNewIDcti_ctl2.uvsync_en;
	ich1_newdcti_reg_2.tran_mode= ptr->VipNewIDcti_ctl2.tran_mode;
	ich1_newdcti_reg_2.rate_steep= ptr->VipNewIDcti_ctl2.rate_steep;
	ich1_newdcti_reg_2.th_steep= ptr->VipNewIDcti_ctl2.th_steep;
	ich1_newdcti_reg_2.th_coring= ptr->VipNewIDcti_ctl2.th_coring;
	ich1_newdcti_reg_2.steep_mode= ptr->VipNewIDcti_ctl2.steep_mode;
	ich1_newdcti_reg_2.hp_mode = ptr->VipNewIDcti_ctl2.hp_mode;
	ich1_newdcti_reg_2.vlp_mode= ptr->VipNewIDcti_ctl2.vlp_mode;
	ich1_newdcti_reg_2.median_mode= ptr->VipNewIDcti_ctl2.median_mode;
	ich1_newdcti_reg_2.blending_mode = ptr->VipNewIDcti_ctl2.blending_mode;

	scaler_rtd_outl(IDCTI_I_DCTI_CTRL_2_reg, ich1_newdcti_reg_2.regValue);

//Ctl3
	idcti_i_dcti_ctrl_3_RBUS ich1_newdcti_reg_3;
	ich1_newdcti_reg_3.regValue= scaler_rtd_inl(IDCTI_I_DCTI_CTRL_3_reg);

	ich1_newdcti_reg_3.maxminlen= ptr->VipNewIDcti_ctl3.maxminlen;
	ich1_newdcti_reg_3.rate_tran= ptr->VipNewIDcti_ctl3.rate_tran;
	ich1_newdcti_reg_3.th_tran= ptr->VipNewIDcti_ctl3.th_tran;
	ich1_newdcti_reg_3.region_mode= ptr->VipNewIDcti_ctl3.region_mode;
	ich1_newdcti_reg_3.rate_smooth= ptr->VipNewIDcti_ctl3.rate_smooth;
	ich1_newdcti_reg_3.th_smooth= ptr->VipNewIDcti_ctl3.th_smooth;

	scaler_rtd_outl(IDCTI_I_DCTI_CTRL_3_reg, ich1_newdcti_reg_3.regValue);

//Ctl4
	idcti_i_dcti_ctrl_4_RBUS ich1_newdcti_reg_4;
	ich1_newdcti_reg_4.regValue= scaler_rtd_inl(IDCTI_I_DCTI_CTRL_4_reg);

	ich1_newdcti_reg_4.rate_align_weight= ptr->VipNewIDcti_ctl4.rate_align_weight;
	ich1_newdcti_reg_4.rate_align= ptr->VipNewIDcti_ctl4.rate_align;
	ich1_newdcti_reg_4.th_align= ptr->VipNewIDcti_ctl4.th_align;
	ich1_newdcti_reg_4.align_mingain= ptr->VipNewIDcti_ctl4.align_mingain;
	ich1_newdcti_reg_4.th_gtran= ptr->VipNewIDcti_ctl4.th_gtran;

	scaler_rtd_outl(IDCTI_I_DCTI_CTRL_4_reg, ich1_newdcti_reg_4.regValue);

//Ctl5
	idcti_i_dcti_ctrl_5_RBUS ich1_newdcti_reg_5;
	ich1_newdcti_reg_5.regValue= scaler_rtd_inl(IDCTI_I_DCTI_CTRL_5_reg);

	ich1_newdcti_reg_5.statistic_en= ptr->VipNewIDcti_ctl5.statistic_en;
	ich1_newdcti_reg_5.th_uvmindiff= ptr->VipNewIDcti_ctl5.th_uvmindiff;
	ich1_newdcti_reg_5.rate_stair2= ptr->VipNewIDcti_ctl5.rate_stair2;
	ich1_newdcti_reg_5.rate_stair1= ptr->VipNewIDcti_ctl5.rate_stair1;
	ich1_newdcti_reg_5.th_stair= ptr->VipNewIDcti_ctl5.th_stair;
	ich1_newdcti_reg_5.th_align_weight= ptr->VipNewIDcti_ctl5.th_align_weight;

	scaler_rtd_outl(IDCTI_I_DCTI_CTRL_5_reg, ich1_newdcti_reg_5.regValue);

//Ctl6
	idcti_i_dcti_ctrl_6_RBUS ich1_newdcti_reg_6;
	ich1_newdcti_reg_6.regValue= scaler_rtd_inl(IDCTI_I_DCTI_CTRL_6_reg);

	ich1_newdcti_reg_6.statistic_hist= ptr->VipNewIDcti_ctl6.statistic_hist;
	ich1_newdcti_reg_6.rate_engsync= ptr->VipNewIDcti_ctl6.rate_engsync;
	ich1_newdcti_reg_6.rate_uvmindiff= ptr->VipNewIDcti_ctl6.rate_uvmindiff;
	ich1_newdcti_reg_6.th_engsync= ptr->VipNewIDcti_ctl6.th_engsync;

	scaler_rtd_outl(IDCTI_I_DCTI_CTRL_6_reg, ich1_newdcti_reg_6.regValue);

//Ctl7
	idcti_i_dcti_ctrl_7_RBUS ich1_newdcti_reg_7;
	ich1_newdcti_reg_7.regValue= scaler_rtd_inl(IDCTI_I_DCTI_CTRL_7_reg);

	ich1_newdcti_reg_7.debug_shiftbit= ptr->VipNewIDcti_ctl7.debug_shiftbit;
	ich1_newdcti_reg_7.debug_mode= ptr->VipNewIDcti_ctl7.debug_mode;
	ich1_newdcti_reg_7.high_bound= ptr->VipNewIDcti_ctl7.high_bound;
	ich1_newdcti_reg_7.low_bound= ptr->VipNewIDcti_ctl7.low_bound;

	scaler_rtd_outl(IDCTI_I_DCTI_CTRL_7_reg, ich1_newdcti_reg_7.regValue);


}


//JZ Mac3
void drvif_color_dnewdcti_table_isr(DRV_VipNewDDcti_Table* ptr, unsigned char offset_gain)
{
	if(!ptr)
		return;

//ctl1
	color_sharp_shp_dcti_ctrl_1_RBUS dm_dcti_REG_1;
	color_d_vc_global_ctrl_RBUS d_vc_global_ctrl_Reg;

	dm_dcti_REG_1.regValue= scaler_rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_1_reg);
	d_vc_global_ctrl_Reg.regValue= scaler_rtd_inl(COLOR_D_VC_Global_CTRL_reg);

	dm_dcti_REG_1.data_sel = ptr->VipNewDDcti_ctl1.data_sel;
	dm_dcti_REG_1.maxlen = ptr->VipNewDDcti_ctl1.maxlen;
	dm_dcti_REG_1.psmth = ptr->VipNewDDcti_ctl1.psmth;
	dm_dcti_REG_1.lpmode = ptr->VipNewDDcti_ctl1.lp_mode;
	dm_dcti_REG_1.engdiv = ptr->VipNewDDcti_ctl1.engdiv;
	dm_dcti_REG_1.offdiv= ptr->VipNewDDcti_ctl1.offdiv;
	dm_dcti_REG_1.uvgain= ptr->VipNewDDcti_ctl1.uvgain;
	dm_dcti_REG_1.dcti_mode= ptr->VipNewDDcti_ctl1.dcti_mode;
	dm_dcti_REG_1.uvalign_en= ptr->VipNewDDcti_ctl1.uvalign_en;
	dm_dcti_REG_1.cur_sel = ptr->VipNewDDcti_ctl1.cur_sel;

	scaler_rtd_outl(COLOR_SHARP_SHP_DCTI_CTRL_1_reg, dm_dcti_REG_1.regValue);
	scaler_rtd_outl(COLOR_D_VC_Global_CTRL_reg, d_vc_global_ctrl_Reg.regValue);

//ctl2
	color_sharp_shp_dcti_ctrl_2_RBUS dm_dcti_REG_2;
	dm_dcti_REG_2.regValue= scaler_rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_2_reg);

	dm_dcti_REG_2.uvsync_en= ptr->VipNewDDcti_ctl2.uvsync_en;
	dm_dcti_REG_2.tran_mode= ptr->VipNewDDcti_ctl2.tran_mode;
	dm_dcti_REG_2.rate_steep= ptr->VipNewDDcti_ctl2.rate_steep;
	dm_dcti_REG_2.th_steep= ptr->VipNewDDcti_ctl2.th_steep;
	dm_dcti_REG_2.th_coring= ptr->VipNewDDcti_ctl2.th_coring;
	dm_dcti_REG_2.steep_mode= ptr->VipNewDDcti_ctl2.steep_mode;
	dm_dcti_REG_2.hp_mode = ptr->VipNewDDcti_ctl2.hp_mode;
	dm_dcti_REG_2.vlp_mode= ptr->VipNewDDcti_ctl2.vlp_mode;
	dm_dcti_REG_2.median_mode= ptr->VipNewDDcti_ctl2.median_mode;
	dm_dcti_REG_2.blending_mode = ptr->VipNewDDcti_ctl2.blending_mode;

	scaler_rtd_outl(COLOR_SHARP_SHP_DCTI_CTRL_2_reg, dm_dcti_REG_2.regValue);

//ctl3
	color_sharp_shp_dcti_ctrl_3_RBUS dm_dcti_REG_3;
	dm_dcti_REG_3.regValue= scaler_rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_3_reg);

	dm_dcti_REG_3.maxminlen= ptr->VipNewDDcti_ctl3.maxminlen;
	dm_dcti_REG_3.rate_tran= ptr->VipNewDDcti_ctl3.rate_tran;
	dm_dcti_REG_3.th_tran= ptr->VipNewDDcti_ctl3.th_tran;
	dm_dcti_REG_3.region_mode= ptr->VipNewDDcti_ctl3.region_mode;
	dm_dcti_REG_3.rate_smooth= ptr->VipNewDDcti_ctl3.rate_smooth;
	dm_dcti_REG_3.th_smooth= ptr->VipNewDDcti_ctl3.th_smooth;

	scaler_rtd_outl(COLOR_SHARP_SHP_DCTI_CTRL_3_reg, dm_dcti_REG_3.regValue);

//ctl4
	color_sharp_shp_dcti_ctrl_4_RBUS dm_dcti_REG_4;
	dm_dcti_REG_4.regValue= scaler_rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_4_reg);

	dm_dcti_REG_4.rate_align_weight= ptr->VipNewDDcti_ctl4.rate_align_weight;
	dm_dcti_REG_4.rate_align= ptr->VipNewDDcti_ctl4.rate_align;
	dm_dcti_REG_4.th_align= ptr->VipNewDDcti_ctl4.th_align;
	dm_dcti_REG_4.align_mingain= ptr->VipNewDDcti_ctl4.align_mingain;
	dm_dcti_REG_4.th_gtran= ptr->VipNewDDcti_ctl4.th_gtran;

	scaler_rtd_outl(COLOR_SHARP_SHP_DCTI_CTRL_4_reg, dm_dcti_REG_4.regValue);

//ctl5
	color_sharp_shp_dcti_ctrl_5_RBUS dm_dcti_REG_5;
	dm_dcti_REG_5.regValue= scaler_rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_5_reg);

	dm_dcti_REG_5.th_uvmindiff= ptr->VipNewDDcti_ctl5.th_uvmindiff;
	dm_dcti_REG_5.rate_stair2= ptr->VipNewDDcti_ctl5.rate_stair2;
	dm_dcti_REG_5.rate_stair1= ptr->VipNewDDcti_ctl5.rate_stair1;
	dm_dcti_REG_5.th_stair= ptr->VipNewDDcti_ctl5.th_stair;
	dm_dcti_REG_5.th_align_weight= ptr->VipNewDDcti_ctl5.th_align_weight;

	scaler_rtd_outl(COLOR_SHARP_SHP_DCTI_CTRL_5_reg, dm_dcti_REG_5.regValue);

//ctl6
	color_sharp_shp_dcti_ctrl_6_RBUS dm_dcti_REG_6;
	dm_dcti_REG_6.regValue= scaler_rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_6_reg);

	dm_dcti_REG_6.rate_engsync= ptr->VipNewDDcti_ctl6.rate_engsync;
	dm_dcti_REG_6.rate_uvmindiff= ptr->VipNewDDcti_ctl6.rate_uvmindiff;
	dm_dcti_REG_6.th_engsync= ptr->VipNewDDcti_ctl6.th_engsync;

	scaler_rtd_outl(COLOR_SHARP_SHP_DCTI_CTRL_6_reg, dm_dcti_REG_6.regValue);

//ctl7
	color_sharp_shp_dcti_ctrl_7_RBUS dm_dcti_REG_7;
	dm_dcti_REG_7.regValue= scaler_rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_7_reg);
	dm_dcti_REG_7.debug_shiftbit= ptr->VipNewDDcti_ctl7.debug_shiftbit;
	dm_dcti_REG_7.debug_mode= ptr->VipNewDDcti_ctl7.debug_mode;

	scaler_rtd_outl(COLOR_SHARP_SHP_DCTI_CTRL_7_reg, dm_dcti_REG_7.regValue);
}

//=====================================================
void drvif_color_DCTI_for_ColorBar(unsigned char color_bar_flag,unsigned char colorbar_score)
{
	static unsigned char pre_status=0, pre_offset_gain=0,pre_i_table_select=0,pre_d_table_select;
	char which_source=(RPC_system_info_structure_table->VIP_source);
	unsigned char i_table_select=0 , d_table_select=0, status=0, offset_gain=0;

	DRV_VipNewIDcti_Table* I_DCTI_Table = NULL;
	DRV_VipNewDDcti_Table* D_DCTI_Table = NULL;
	DRV_VipNewDcti_auto_adjust *VipNewDcti_auto_adjust = NULL;

	if((which_source>=VIP_QUALITY_TV_NTSC && which_source<=VIP_QUALITY_TV_PAL) )
		return; // rf don't enter color bar detected
	if((color_bar_flag==true) || (DynamicOptimizeSystem[191]==1)||(DynamicOptimizeSystem[193]==1)||(DynamicOptimizeSystem[194]==1)||(DynamicOptimizeSystem[192]==1)||(DynamicOptimizeSystem[196]==1))//change 132 -->192 for color bar condition//for_LG_demo
 	{

 		/*
 		if((which_source>=VIP_QUALITY_CVBS_NTSC) && (which_source<=VIP_QUALITY_TV_PAL))
		{
			i_table_select = 8;
			d_table_select = 8;
		}

		else if((which_source>=VIP_QUALITY_TV_NTSC) && (which_source<=VIP_QUALITY_TV_PAL))
		{
			i_table_select = 9;
			d_table_select = 9;
		}
		*/

		if((which_source>=VIP_QUALITY_HDMI_480I && which_source<=VIP_QUALITY_HDMI_576P)||(which_source>=VIP_QUALITY_YPbPr_480I && which_source<=VIP_QUALITY_YPbPr_576P))
		{
			i_table_select = 8;
			d_table_select = 8;
		}
		/*
		else if((which_source>=VIP_QUALITY_HDMI_720P && which_source<=VIP_QUALITY_HDMI_1080P)||(which_source>=VIP_QUALITY_YPbPr_720P && which_source<=VIP_QUALITY_YPbPr_1080P))
		{
			i_table_select = 8;
			d_table_select = 8;
		}
		*/
		else
		{
			i_table_select = system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.iDcti_table_select;
			d_table_select = system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.dDcti_table_select;
		}
	}
	else
	{
		i_table_select = system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.iDcti_table_select;
		d_table_select = system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.dDcti_table_select;
	}



	i_table_select = (i_table_select>=DCTI_TABLE_LEVEL_MAX)?(DCTI_TABLE_LEVEL_MAX-1):i_table_select;
	d_table_select = (d_table_select>=DCTI_TABLE_LEVEL_MAX)?(DCTI_TABLE_LEVEL_MAX-1):d_table_select;

	VipNewDcti_auto_adjust = &(system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.auto_adjust_Table[i_table_select]);
	if(VipNewDcti_auto_adjust->VipNewDcti_auto_setting.table_mode_flag == 1 )
	{
		offset_gain = 0;
		i_table_select = drvif_color_DCTI_auto_compute(VipNewDcti_auto_adjust,colorbar_score);
	}
	else
	{
		offset_gain = drvif_color_DCTI_auto_compute(VipNewDcti_auto_adjust,colorbar_score);
	}

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
	{
		ROSPrintf("I_DCTI_Table=%d,offset_gain=%d,colorbar_score=%d\n ",I_DCTI_Table,offset_gain,colorbar_score);
		ROSPrintf("i_table_select=%d\n ",i_table_select);
	}

	if((pre_offset_gain!=offset_gain) || (pre_i_table_select!=i_table_select) || (pre_d_table_select!=d_table_select))
	{
		//ROSPrintf("pre_offset_gain=%d,offset_gain=%d\n ",pre_offset_gain,offset_gain);
		//ROSPrintf("pre_i_table_select=%d,i_table_select=%d\n ",pre_i_table_select,i_table_select);
		//ROSPrintf("pre_d_table_select=%d,d_table_select=%d\n ",pre_d_table_select,d_table_select);
		status=1;
	}
	else
	{
		status=0;
	}

	if(status==pre_status)
	{
		return;
	}
	else
	{
		//ROSPrintf("status=%d,pre_status=%d\n ",status,pre_status);
	}

	pre_status = status;
	pre_offset_gain = offset_gain;
	pre_i_table_select = i_table_select;
	pre_d_table_select = d_table_select;


	I_DCTI_Table = &(system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.iDcti_Table[i_table_select]);
	D_DCTI_Table = &(system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.dDcti_Table[d_table_select]);


	if(system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.iDcti_table_select<DCTI_TABLE_LEVEL_MAX)	//bypass=255
		drvif_color_inewdcti_table_isr(I_DCTI_Table,offset_gain);
	if(system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.dDcti_table_select<DCTI_TABLE_LEVEL_MAX)	//bypass=255
		drvif_color_dnewdcti_table_isr(D_DCTI_Table,offset_gain);

	#if 0
		static unsigned int print_cnt_JZ = 0;
		if(print_cnt_JZ % 100 == 0)
		ROSPrintf("[DCTI] vd= %d,dd=%d, ii=%d, fg=%d, src=%d\n",
		vdcti_level, dcti_level, idcti_level,color_bar_flag,which_source);
		print_cnt_JZ ++;
	#endif
}

unsigned char drvif_color_DCTI_auto_compute(DRV_VipNewDcti_auto_adjust* ptr,unsigned char colorbar_score)
{
	int i =0,score=0;
	unsigned char low_bound=0,up_bound=0,output_level=0;
	unsigned char index=0;

	low_bound = ptr->VipNewDcti_auto_setting.low_bound;
	up_bound = ptr->VipNewDcti_auto_setting.up_bound;
	score = colorbar_score - low_bound;
	if(score<0)
	{
		score=0;
	}

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
	{
		ROSPrintf("score=%d, up_bound=%d\n",score,up_bound);
	}

	if( score <= up_bound )
	{
		for(i=0;i<DCTI_TABLE_LEVEL_MAX;i++)
		{
			if(score>=(ptr->th_table[i]))
			{
				index = i ;
			}

			if(i<(DCTI_TABLE_LEVEL_MAX-1))
			{
				if((ptr->th_table[i+1])<(ptr->th_table[i]))
				{
					if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
					{
						ROSPrintf("Warring!!!,th[%d]=%d > th[%d]=%d\n",i,i+1,(ptr->th_table[i]),(ptr->th_table[i+1]));
					}
					return 0;
				}
			}

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
			{
				ROSPrintf("check i=%d,index=%d \n",i,index);
			}
		}

		if(index==9)
		{
			output_level = ptr->level_table[9];
		}
		else if (index==0)
		{
			if((ptr->th_table[0])==0)
			{
				output_level = (ptr->level_table[0]);
			}
			else
			{
				if( score<=(ptr->th_table[0]) )
				{
					if((ptr->level_table[0])==0)
					{
						output_level = (ptr->level_table[0]);
					}
					else
					{
						output_level = ((score-0)*((ptr->level_table[0])-0))/((ptr->th_table[0])-0);
					}

				}
				else
				{
					output_level = (ptr->level_table[0])+((score-(ptr->th_table[0]))*((ptr->level_table[1])-(ptr->level_table[index])))/((ptr->th_table[1])-(ptr->th_table[0]));
				}
			}
		}
		else
		{
			if(((ptr->th_table[index])-(ptr->th_table[index-1]))==0)
			{
				output_level = ptr->level_table[index];
			}
			else
			{
				output_level = (ptr->level_table[index])+(((score-(ptr->level_table[index]))*((ptr->level_table[index+1])-(ptr->level_table[index])))/((ptr->th_table[index+1])-(ptr->th_table[index])));
			}

		}
	}
	else
	{
		output_level = ptr->level_table[DCTI_TABLE_LEVEL_9];

	}

	return output_level;

}

void drvif_color_DELAY_for_ColorBar(unsigned char color_bar_flag,unsigned char colorbar_score)
{
	unsigned char which_source=(RPC_system_info_structure_table->VIP_source);
	static unsigned int ori_uv_delay =0;
	SLR_VIP_TABLE *m_Share_Memory_VIP_TABLE_Struct= scaler_GetShare_Memory_VIP_TABLE_Struct();
	if(m_Share_Memory_VIP_TABLE_Struct==NULL){
		return;
	}

	unsigned char m_nDelayValue=m_Share_Memory_VIP_TABLE_Struct->VIP_QUALITY_Coef[which_source][VIP_QUALITY_FUNCTION_UV_DELAY];
	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);
	static unsigned char pre_source =255;

	color_dlcti_uv_delay_RBUS uv_delay_reg;
	uv_delay_reg.regValue=rtd_inl(COLOR_DLCTI_UV_Delay_reg);

	if(pre_source !=cur_source)
	{
		ori_uv_delay = uv_delay_reg.regValue;

	}
	pre_source = cur_source;

	if((color_bar_flag)==true )
 	{


		if(which_source==VIP_QUALITY_CVBS_NTSC)
		{

			uv_delay_reg.u_delay=25>>4;
			uv_delay_reg.v_delay=25%16;
		}

	}
	else
	{
		uv_delay_reg.u_delay=m_nDelayValue>>4;
		uv_delay_reg.v_delay=m_nDelayValue%16;
	}

	if (which_source==VIP_QUALITY_HDMI_480I)
	{
		if((color_bar_flag)==true )
			uv_delay_reg.regValue = 5;
		else
			uv_delay_reg.regValue = ori_uv_delay;
	}



	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
	{
		ROSPrintf("u_delay = %d\n ",uv_delay_reg.u_delay);
		ROSPrintf("v_delay = %d\n ",uv_delay_reg.v_delay);
	}



	rtd_outl(COLOR_DLCTI_UV_Delay_reg,uv_delay_reg.regValue);




}

int drvif_Get_Purecolor_Weighting()
{
	return pure_color_weighting;
}



void scalerVIP_NetFlix_Smooth_TimingChange_for_RTNR()
{
	di_im_di_rtnr_control_RBUS im_di_rtnr_control_reg;
	im_di_rtnr_control_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

	_RPC_clues* RPC_SmartPic_clue=NULL;
	RPC_SmartPic_clue = scaler_GetShare_Memory_RPC_SmartPic_Clue_Struct();

	if(RPC_SmartPic_clue == NULL) {
		if(MA_print_count%360==0)
			ROSPrintf("scalerVIP_NetFlix_Smooth_TimingChange_for_RTNR Share Memory PQ data ERROR,SmartPic_clue = %x, \n",RPC_SmartPic_clue);
		return;
	}

	if(RPC_SmartPic_clue->S_NetFlix_info.NetFlix_smooth_Toggle_info.TimingChange_flag_for_RTNR==1)
	{
		im_di_rtnr_control_reg.cp_rtnr_y_enable = 0;
		im_di_rtnr_control_reg.cp_rtnr_c_enable = 0;
		RPC_SmartPic_clue->S_NetFlix_info.NetFlix_smooth_Toggle_info.TimingChange_flag_for_RTNR =0;
	}
	else
	{
		im_di_rtnr_control_reg.cp_rtnr_y_enable = 1;
		im_di_rtnr_control_reg.cp_rtnr_c_enable = 1;
	}
}

/*======== checksum========*/
unsigned int checksum_vip(const void *buf, unsigned int size)
{
	const unsigned char *p;
	p = (const unsigned char *)buf;

	unsigned int sum = 0;
	unsigned char tmp;

	while (size--)
	{
		tmp = *p++;
		if( tmp== 0)  tmp = 1;
		sum += tmp;
	}
	return sum;
}

void scalerVIP_check_VIPTable_crc(VIP_table_crc_value_ISR * crc_value, SLR_VIP_TABLE * vip_table)
{
	SLR_VIP_TABLE *g_Share_Memory_VIP_TABLE_Struct_isr;
	g_Share_Memory_VIP_TABLE_Struct_isr = vip_table;

	crc_value->VIP_QUALITY_Coef = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->VIP_QUALITY_Coef,
		sizeof(unsigned char)*VIP_QUALITY_SOURCE_NUM*VIP_QUALITY_Coef_MAX);
	crc_value->VIP_QUALITY_Extend_Coef = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->VIP_QUALITY_Extend_Coef,
		sizeof(unsigned char)*VIP_QUALITY_SOURCE_NUM*VIP_QUALITY_Extend_Coef_MAX);
	crc_value->VIP_QUALITY_Extend2_Coef = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->VIP_QUALITY_Extend2_Coef,
		sizeof(unsigned char)*VIP_QUALITY_SOURCE_NUM*VIP_QUALITY_Extend2_Coef_MAX);
	crc_value->VIP_QUALITY_Extend3_Coef = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->VIP_QUALITY_Extend3_Coef,
		sizeof(unsigned char)*VIP_QUALITY_SOURCE_NUM*VIP_QUALITY_Extend3_Coef_MAX);
	crc_value->VIP_QUALITY_3Dmode_Coef = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->VIP_QUALITY_3Dmode_Coef,
		sizeof(unsigned char)*VIP_QUALITY_3DSOURCE_NUM*VIP_QUALITY_3Dmode_Coef_MAX);
	crc_value->VIP_QUALITY_Extend4_Coef = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->VIP_QUALITY_Extend4_Coef,
		sizeof(unsigned char)*VIP_QUALITY_SOURCE_NUM*VIP_QUALITY_Extend4_Coef_MAX);
	crc_value->SD_H_table = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->SD_H_table,
		sizeof(unsigned char)*UZD_Idx_TBL_Max*VIP_ScalingDown_FIR_Level_Max);
	crc_value->SD_V_table = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->SD_V_table,
		sizeof(unsigned char)*UZD_Idx_TBL_Max*VIP_ScalingDown_FIR_Level_Max);
	crc_value->DCR_TABLE = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->DCR_TABLE,
		sizeof(unsigned char)*t_DCR_TABLE_ROW_MAX*t_DCR_TABLE_COL_MAX);
	crc_value->ICM_by_timing_picmode = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->ICM_by_timing_picmode,
		sizeof(unsigned char)*VIP_TABLE_PICTURE_MODE_MAX*VIP_TABLE_TIMIMG_MAX);
	crc_value->D_EDGE_Smooth_Coef = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->D_EDGE_Smooth_Coef,
		sizeof(DRV_DEdgeSmooth_Coef)*t_D_EDGE_Smooth_Coef_MAX);
	crc_value->Auto_Function_Array1 = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Auto_Function_Array1,
		sizeof(unsigned char)*Auto_Function_Array_MAX);
	crc_value->Auto_Function_Array2 = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Auto_Function_Array2,
		sizeof(unsigned char)*Auto_Function_Array_MAX);
	crc_value->Auto_Function_Array3 = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Auto_Function_Array3,
		sizeof(unsigned char)*Auto_Function_Array_MAX);
	crc_value->Auto_Function_Array4 = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Auto_Function_Array4,
		sizeof(unsigned char)*Auto_Function_Array_MAX);
	crc_value->Auto_Function_Array5 = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Auto_Function_Array5,
		sizeof(unsigned char)*Auto_Function_Array_MAX);
	crc_value->DrvSetting_Skip_Flag = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->DrvSetting_Skip_Flag,
		sizeof(unsigned char)*DrvSetting_Skip_Flag_item_Max);
	crc_value->VD_ConBriHueSat = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->VD_ConBriHueSat,
		sizeof(VIP_VD_ConBriHueSat)*t_VD_ConBriHueSat_MAX);

	crc_value->Idomain_MBPKTable = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Idomain_MBPKTable, sizeof(VIP_MBPK_Table)*MBPK_table_num);
	crc_value->Tone_Mapping_LUT_R = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Tone_Mapping_LUT_R, sizeof(unsigned short)*Tone_Mapping_Table_MAX*Tone_Mapping_size);


	crc_value->ODtable_Coeff = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->ODtable_Coeff,
		sizeof(unsigned int)*t_ODtable_Coeff_ROW_MAX*t_ODtable_Coeff_COL_MAX);
	crc_value->CDS_ini = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->CDS_ini, sizeof(VIP_CDS_Table)*Sharp_table_num);
	crc_value->I_EDGE_Smooth_Coef = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->I_EDGE_Smooth_Coef,
		sizeof(DRV_IEdgeSmooth_Coef)*t_I_EDGE_Smooth_Coef_MAX);
	crc_value->YUV2RGB_CSMatrix_Table = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->YUV2RGB_CSMatrix_Table,
		sizeof(VIP_YUV2RGB_CSMatrix_Table)*YUV2RGB_TBL_Num);
	crc_value->tICM_ini = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->tICM_ini,
		sizeof(unsigned short)*VIP_ICM_TBL_X*VIP_ICM_TBL_Y*VIP_ICM_TBL_Z);
	crc_value->tICM_H_7axis = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->tICM_H_7axis, sizeof(ICM_H_7axis_table)*VIP_ICM_TBL_X);
	crc_value->tGAMMA = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->tGAMMA, sizeof(VIP_Gamma)*t_GAMMA_MAX);
	crc_value->DCC_Control_Structure = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->DCC_Control_Structure, sizeof(VIP_DCC_Control_Structure));
	crc_value->Ddomain_SHPTable = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Ddomain_SHPTable,
		sizeof(VIP_Sharpness_Table)*Sharp_table_num);
	crc_value->Manual_NR_Table = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->Manual_NR_Table,
		sizeof(DRV_NR_Item)*PQA_TABLE_MAX*DRV_NR_Level_MAX);
	crc_value->PQA_Table = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->PQA_Table,
		sizeof(unsigned int)*PQA_TABLE_MAX*PQA_MODE_MAX*PQA_ITEM_MAX*PQA_LEVEL_MAX);
	crc_value->PQA_Input_Table = checksum_vip(&g_Share_Memory_VIP_TABLE_Struct_isr->PQA_Input_Table,
		sizeof(unsigned int)*PQA_I_TABLE_MAX*PQA_I_ITEM_MAX*PQA_I_LEVEL_MAX);
	crc_value->checkSum = checksum_vip(crc_value, sizeof(VIP_table_crc_value_ISR)-sizeof(unsigned int));
}
/*========================*/


void scalerVIP_HDR_apply(void)
{
	/* dm clk will be reset every line, skip this function*/
	return;
#if 0
	if(system_info_structure_table->HDR_info.HDR_Setting_Status == 1 &&
		system_info_structure_table->HDR_info.Ctrl_Item[TV006_HDR_HDR10_set] == 0){
		dolby_v_top_top_d_buf_RBUS top_d_buf_reg;
		dm_hdr_double_buffer_ctrl_RBUS dm_double_buffer_ctrl_reg;

		top_d_buf_reg.regValue = rtd_inl(DOLBY_V_TOP_TOP_D_BUF_reg);
		dm_double_buffer_ctrl_reg.regValue = rtd_inl(DM_HDR_Double_Buffer_CTRL_reg);

		#if 0
		static unsigned char apply_check = 0;
		static unsigned char apply_check_conut = 0;
		if (apply_check)
		{
			if (top_d_buf_reg.dolby_double_apply == 0 &&
				dm_double_buffer_ctrl_reg.dm_db_apply == 0 &&
				apply_check_conut > 5)
			{
				apply_check = 0;
				apply_check_conut = 0;
				system_info_structure_table->HDR_info.HDR_Setting_Status = 0;
			}
			apply_check_conut++;
			return;
		}
		#endif

		vodma_vodma_line_st_RBUS vodma_line_st_reg;
		vodma_line_st_reg.regValue = rtd_inl(VODMA_VODMA_LINE_ST_reg);
		unsigned int vo_vend = (rtd_inl(VODMA_VODMA_V1VGIP_VACT1_reg) >> 16) & 0xfff;
		unsigned short lineCnt = vodma_line_st_reg.line_cnt;
		unsigned int protect_cnt = 0;
		vodma_vodma_v1sgen_RBUS vodma_vodma_v1sgen_RBUS_reg;
		unsigned char line_access_region = 17;	//default case
		vodma_vodma_v1sgen_RBUS_reg.regValue = rtd_inl(VODMA_VODMA_V1SGEN_reg);
		if (vodma_vodma_v1sgen_RBUS_reg.h_thr >= 3980)	//4k case
		{
			line_access_region = 30;
		}

		//unsigned int time_str = rtd_inl(0xb801b6a8);
		while(((lineCnt < (vo_vend + 1)) ||
			(lineCnt > (vo_vend + line_access_region))) &&
			(protect_cnt < 0x062500))
		{
			vodma_line_st_reg.regValue = rtd_inl(VODMA_VODMA_LINE_ST_reg);
			lineCnt = vodma_line_st_reg.line_cnt;
			protect_cnt++;
		}
		//unsigned int time_end = rtd_inl(0xb801b6a8);

		#if 0	//counter debug
		//force_BG, b8028300[1] = 1
		color_dcc_d_dcc_fwused_1_RBUS dcc_fwused_1_reg;
		dcc_fwused_1_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_1_reg);
		if (protect_cnt > dcc_fwused_1_reg.ThreeSEGXIndex0)
			dcc_fwused_1_reg.ThreeSEGXIndex0 = protect_cnt;
		rtd_outl(COLOR_DCC_D_DCC_FWUSED_1_reg, dcc_fwused_1_reg.regValue);
		#endif

		//HDR10 apply
		top_d_buf_reg.dolby_double_apply = 1;
		rtd_outl(DOLBY_V_TOP_TOP_D_BUF_reg, top_d_buf_reg.regValue);

		dm_double_buffer_ctrl_reg.dm_db_apply = 1;
		rtd_outl(DM_HDR_Double_Buffer_CTRL_reg, dm_double_buffer_ctrl_reg.regValue);

		system_info_structure_table->HDR_info.HDR_Setting_Status = 0;


		//ROSPrintf("roger_ST protect_cnt = %d\n", protect_cnt);

		//vodma_line_st_reg.regValue = rtd_inl(VODMA_VODMA_LINE_ST_reg);
		//unsigned short lineCnt2 = vodma_line_st_reg.line_cnt;
		//ROSPrintf("roger_HA protect_cnt = %d\n", protect_cnt);
		//ROSPrintf("roger_HA vo_vend = %d\n", vo_vend);
		//ROSPrintf("roger_HA lineCnt = %d\n", lineCnt);
		//ROSPrintf("roger_HA lineCnt2 = %d\n", lineCnt2);
		//ROSPrintf("roger_HA time_str = %d\n", time_str);
		//ROSPrintf("roger_HA time_end = %d\n", time_end);
		//ROSPrintf("roger_HA time = %d\n", (time_end - time_str) / 90);
	}
#endif
}
#if 0
void scalerVIP_HDR_clk_reset(_system_setting_info* system_info_structure_table)
{
	dolby_v_top_top_pic_size_RBUS top_pic_size_reg;
	dolby_v_top_top_pic_sta_RBUS top_pic_sta_reg;
	vodma_vodma_v1_dsize_RBUS vodma_v1_dsize_reg;
	dolby_v_top_top_d_buf_RBUS top_d_buf_reg;

	static unsigned char hdr_clk_reset_cnt = 0;
	static unsigned char pr_cnt = 0;

	unsigned char hdr_clk_reset_cnt_th = 2;
	unsigned char h_offset = 3;

	if(Rest_dm_clk_flag == 1 && (DOLBY_V_TOP_TOP_CTL_get_dolby_mode(rtd_inl(DOLBY_V_TOP_TOP_CTL_reg)) != 0)) {
		if (hdr_clk_reset_cnt >= hdr_clk_reset_cnt_th) {
			/* reset v top setting from clk reset status*/
			top_pic_size_reg.regValue = rtd_inl(DOLBY_V_TOP_TOP_PIC_SIZE_reg);
			top_pic_sta_reg.regValue = rtd_inl(DOLBY_V_TOP_TOP_PIC_STA_reg);
			vodma_v1_dsize_reg.regValue = rtd_inl(VODMA_VODMA_V1_DSIZE_reg);

			ROSPrintf("top_pic_size_reg.dolby_hsize=%d, top_pic_sta_reg.dolby_h_den_sta=%d\n", top_pic_size_reg.dolby_hsize, top_pic_sta_reg.dolby_h_den_sta);

			top_pic_size_reg.dolby_hsize = vodma_v1_dsize_reg.p_y_len;
			top_pic_sta_reg.dolby_h_den_sta = (rtd_inl(VODMA_VODMA_V1VGIP_HACT_reg) & 0x00000FFF) + h_offset; //0x008f;

			rtd_outl(DOLBY_V_TOP_TOP_PIC_SIZE_reg, top_pic_size_reg.regValue);
			rtd_outl(DOLBY_V_TOP_TOP_PIC_STA_reg, top_pic_sta_reg.regValue);

			top_d_buf_reg.regValue = rtd_inl(DOLBY_V_TOP_TOP_D_BUF_reg);
			top_d_buf_reg.dolby_double_apply = 1;
			rtd_outl(DOLBY_V_TOP_TOP_D_BUF_reg, top_d_buf_reg.regValue);

			Rest_dm_clk_flag = 0;
			hdr_clk_reset_cnt = 0;
		} else {
			hdr_clk_reset_cnt++;
			ROSPrintf("cnt=%d\n", hdr_clk_reset_cnt);
		}
	} else {
		if(pr_cnt >= 30) {
			/*ROSPrintf("HDR_clk_reset=%d, dolbyMode=%d\n",
			Rest_dm_clk_flag, (DOLBY_V_TOP_TOP_CTL_get_dolby_mode(rtd_inl(DOLBY_V_TOP_TOP_CTL_reg)) != 0));*/
			pr_cnt = 0;
		} else {
			pr_cnt++;
		}
	}
}
#endif
char scalerVIP_PQ_IP_Enable_Monitor(SLR_VIP_TABLE* VIP_TBL, _RPC_clues* RPC_SmartPic_clue, _clues* SmartPic_clue, _RPC_system_setting_info* RPC_sysInfoTBL, _system_setting_info* sysInfoTBL, unsigned int MA_print_count)
{
	extern unsigned char set_PS_in_ISR;
	extern VIP_PQ_ByPass_Struct PQ_ByPass_Struct[VIP_PQ_ByPass_TBL_Max];
	unsigned char tbl_idx, i;
	char ret;
	unsigned short v_len, v_sta, line_cnt;
	//VIP_PQ_ByPass_Struct *pPQ_ByPass_Struct;
	VIP_PQ_ByPass_Struct pPQ_ByPass_Struct;
	unsigned char isIMode_Flag;


	if(RPC_sysInfoTBL == NULL){
		printk("[%s:%d] Warning here!! RPC_system_info=NULL! \n",__FILE__, __LINE__);
		return -1;
	}

	if (set_PS_in_ISR == 1) {
		set_PS_in_ISR = 0;

		tbl_idx = RPC_sysInfoTBL->PQ_ByPass_Ctrl.table_idx;

		memcpy((unsigned char*)&pPQ_ByPass_Struct, (unsigned char*)&(PQ_ByPass_Struct[tbl_idx]), sizeof(VIP_PQ_ByPass_Struct));

		isIMode_Flag = Scaler_DispGetStatus(SLR_MAIN_DISPLAY, SLR_DISP_INTERLACE);
		if (isIMode_Flag == 1) {
			;
			pPQ_ByPass_Struct.VIP_PQ_ByPass_TBL[PQ_ByPass_I_DI_IP_Enable] = 0;
			pPQ_ByPass_Struct.VIP_PQ_ByPass_TBL[PQ_ByPass_I_DI] = 0;
		}

		for (i=0; i<VIP_PQ_ByPass_ITEMS_Max; i++) {
			if (pPQ_ByPass_Struct.VIP_PQ_ByPass_TBL[i] == 1)
				drvif_color_set_PQ_ByPass(i);
		}
		printk("scalerVIP_PQ_IP_Enable_Monitor, tbl_idx=%d, isIMode_Flag=%d,\n", tbl_idx, isIMode_Flag);

	}

	return 0;
}

//*************************************************************
//== DCC, DCR, AUTO_NR and RTK_DEMO MODE=======
//*************************************************************
void scalerVIP_colorMaAutoISR(SCALER_CHANNEL_NUM channel)
{

	//IoReg_SetBits(0xb802b000,_BIT4);

	SLR_VIP_TABLE* Share_Memory_VIP_TABLE_Struct = NULL;
	_clues* SmartPic_clue=NULL;
	_RPC_clues* RPC_SmartPic_clue=NULL;
	_system_setting_info* system_info_structure_table = NULL;
	_RPC_system_setting_info* RPC_system_info_structure_table = NULL;
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
	_VIP_NetFlix_smooth_Toggle_info* VCPU_smooth_Toggle_info = NULL;
#endif
	SLR_VIP_TABLE_CUSTOM_TV002* custom_TBL_TV002 = NULL;
	unsigned int en_test;
	//unsigned char black_white_detected;
	//unsigned char flag_chessboard=0;
	static unsigned char isEvenFrame = 0;
	char InputSourceDetFlag;
	//unsigned char isColorBar_flag = 0;	//Elsie 20130521
	static unsigned char preSource = 255;
	DRV_RPC_AutoMA_Flag *AutoMA_Struct = NULL;
	unsigned char DCTI_auto_table_select=0;
	DRV_VipNewDcti_auto_adjust *VipNewDcti_auto_adjust_table = NULL;
	di_im_di_control_RBUS im_di_control_reg;
	di_im_di_film_new_function_main_RBUS di_im_di_film_new_function_main_reg;
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
	unsigned int pwCopyTemp = 0;
#endif

	MA_print_count++;//for debug print
	//if(MA_print_count%300==0)
		//printk("=========Enter scalerVIP_colorMaAutoISR ============\n");


#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
	if(m_film_clear && !(smooth_toggle_update_flag_get_enable(SLR_MAIN_DISPLAY))){
		di_im_di_film_new_function_main_reg.regValue = rtd_inl(DI_IM_DI_FILM_NEW_FUNCTION_MAIN_reg);
		im_di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
		m_film_clear = 0;
		im_di_control_reg.film_enable = m_film;// write_enable[16]

		/* henry @ mac5 161219 DI write enable bit */
		//im_di_control_reg.regValue = im_di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_5_mask;
		im_di_control_reg.write_enable_5 = 1;
		di_im_di_film_new_function_main_reg.fw_film_en = g_fw_film_en;
		m_film = 0;
		rtd_outl(DI_IM_DI_CONTROL_reg, im_di_control_reg.regValue);
		rtd_outl(DI_IM_DI_FILM_NEW_FUNCTION_MAIN_reg, di_im_di_film_new_function_main_reg.regValue);
	}

/*
	if(MA_print_count%300==0)
	{
		ROSPrintf("\n scalerVIP_colorMaAutoISR Start(%d)\n",MA_print_count);
		ROSPrintf("\n scalerVIP_colorMaAutoISR Start ( %d )\n",MA_print_count);
		ROSPrintf("\n sizeof _system_setting_info ( %d )\n",sizeof(_system_setting_info));
		ROSPrintf("\n sizeof SLR_VIP_TABLE ( %d )\n",sizeof(SLR_VIP_TABLE));
		ROSPrintf("\n sizeof _clues ( %d )\n",sizeof(_clues));
		ROSPrintf("\n VIP_system_info_structure ( %d )\n",SCALERIOC_VIP_system_info_structure);
	}
*/

	if(MA_print_count%360==0)
	{
		Scaler_color_print_scalerinfo();
	}
#endif
//******************************************************************
//******************Pattern detector debug !!**************************
//******************************************************************
//--------------------------------------------------------------------------//
	Share_Memory_VIP_TABLE_Struct = scaler_GetShare_Memory_VIP_TABLE_Struct();
	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();
	RPC_SmartPic_clue = scaler_GetShare_Memory_RPC_SmartPic_Clue_Struct();
	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();
	RPC_system_info_structure_table = scaler_GetShare_Memory_RPC_system_setting_info_Struct();
	void *VIP_customer_TBL = scalerVIP_Get_Share_Memory_VIP_TABLE_Custom_Struct();

	if((Share_Memory_VIP_TABLE_Struct == NULL) || (SmartPic_clue == NULL)|| (RPC_SmartPic_clue == NULL) || (system_info_structure_table == NULL) || (VIP_customer_TBL==NULL) || (RPC_system_info_structure_table==NULL))
	{
		if(MA_print_count%360==0)
		{
			ROSPrintf("\n====Share Memory PQ data ERROR====\n\n");
			ROSPrintf(" Mem0 = %x\n, Mem1 = %x\n",Share_Memory_VIP_TABLE_Struct, SmartPic_clue);
			ROSPrintf(" Mem2 = %x\n, Mem3 = %x\n",system_info_structure_table,VIP_customer_TBL);
			ROSPrintf(" Mem4 = %x\n, Mem5 = %x\n",RPC_system_info_structure_table, RPC_SmartPic_clue);
			ROSPrintf("\n===============================\n\n");
		}
		return;
	}

	/* VIP IP Enable Monitor */
	scalerVIP_PQ_IP_Enable_Monitor(Share_Memory_VIP_TABLE_Struct, RPC_SmartPic_clue, SmartPic_clue, RPC_system_info_structure_table, system_info_structure_table, MA_print_count);


	//int decode_bit_rate = Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.decode_bit_rate);
	//int inputplugin_bit_rate = Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.inputplugin_bit_rate);
	color_dcc_d_dcc_fwused_1_RBUS dcc_fwused_1_reg;
	dcc_fwused_1_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_1_reg);
	if((MA_print_count%120==0)&&(dcc_fwused_1_reg.VipInfo == 1)){
		printk(KERN_EMERG "==== biteRate : =====\n decode_bit_rate = %d\n, inputplugin_bit_rate = %d\n, YouTube_TargetWid = %d\n, YouTube_TargetLen=%d\n, YouTube_BitRate=%d\n"
			, Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.decode_bit_rate)
			, Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.inputplugin_bit_rate)
			, Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.YouTube_TargetWid)
			, Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.YouTube_TargetLen)
			, Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.YouTube_BitRate));
	}

#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
/*
	if(MA_print_count%360==0)
	{
		Scaler_color_print_scalerinfo_isr();
	}
*/

	//get VCPU smoothtoggle info
	VCPU_smooth_Toggle_info = &(RPC_SmartPic_clue->S_NetFlix_info.NetFlix_smooth_Toggle_info);

	if( (VCPU_smooth_Toggle_info->m_film_clear) && !(VCPU_smooth_Toggle_info->smooth_toggle_update_flag) ){
		di_im_di_film_new_function_main_reg.regValue = rtd_inl(DI_IM_DI_FILM_NEW_FUNCTION_MAIN_reg);
		im_di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
#if 0 // mark for non-used function in kernel, CSFC 20160728
		extern FILM_FW_ShareMem_ISR *g_Share_Memory_FILM_FW_isr;
		if (g_Share_Memory_FILM_FW_isr) {
			SMOOTH_TOGGLE_INFO* imdSmoothInfo = dvrif_memory_share_imdSmoothInfo();
			g_Share_Memory_FILM_FW_isr->smooth_toggle_film = imdSmoothInfo[channel].IMD_SMOOTH_MODE_CURR;		//smooth_toggle_film change timming
		}
#endif
		VCPU_smooth_Toggle_info->m_film_clear = 0;
		im_di_control_reg.film_enable = VCPU_smooth_Toggle_info->m_film;// write_enable[16]

		/* henry @ mac5 161219 DI write enable bit */
		//im_di_control_reg.regValue = im_di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_5_mask;
		im_di_control_reg.write_enable_5 = 1;

		di_im_di_film_new_function_main_reg.fw_film_en = VCPU_smooth_Toggle_info->g_fw_film_en;
		VCPU_smooth_Toggle_info->m_film = 0;
		rtd_outl(DI_IM_DI_CONTROL_reg, im_di_control_reg.regValue);
		rtd_outl(DI_IM_DI_FILM_NEW_FUNCTION_MAIN_reg, di_im_di_film_new_function_main_reg.regValue);
	}
#endif


#ifdef ENABLE_VIP_TABLE_CHECKSUM
/*======== checksum========*/
	color_dcc_d_dcc_fwused_1_RBUS dcc_fwused_1_reg;
	dcc_fwused_1_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_1_reg);
	VIP_table_crc_value_ISR video_vip_table_crc;

	static unsigned char vit_table_checksum_flag = 1;
	if(vit_table_checksum_flag)
	{

		scalerVIP_check_VIPTable_crc(&video_vip_table_crc, Share_Memory_VIP_TABLE_Struct);
		ROSPrintf("[%s %d] VIP_table_checksum: share_memory %x, video_fw %x\n", __FILE__, __LINE__, vip_table_crc_isr->checkSum, video_vip_table_crc.checkSum);
		vit_table_checksum_flag = 0;
	}

	if( (dcc_fwused_1_reg.VipInfo == 1) && (MA_print_count%360==0))
	{
		scalerVIP_check_VIPTable_crc(&video_vip_table_crc, Share_Memory_VIP_TABLE_Struct);
		ROSPrintf("[%s %d] VIP_table_checksum: share_memory %x, video_fw %x\n", __FILE__, __LINE__, vip_table_crc_isr->checkSum, video_vip_table_crc.checkSum);
	}
/*========================*/
#endif


#if 0
	if(MA_print_count%360==0)
	{
		ROSPrintf("  Input_src_Type= %d \n",system_info_structure_table->Input_src_Type);
		ROSPrintf("  Input_src_Form= %d \n",system_info_structure_table->Input_src_Form);
		ROSPrintf("  Input_VO_Form= %d \n",system_info_structure_table->Input_VO_Form);
		ROSPrintf("  Input_TVD_Form= %d \n",system_info_structure_table->Input_TVD_Form);
		ROSPrintf(" vdc_color_standard = %d \n",system_info_structure_table->vdc_color_standard);
		ROSPrintf("  Timing= %d \n",system_info_structure_table->Timing);
		ROSPrintf("  HDMI_video_format= %d \n",system_info_structure_table->HDMI_video_format);
		ROSPrintf("  VIP_source= %d \n",system_info_structure_table->VIP_source);
	}
#endif
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
	g_IsNot4KVO = !((system_info_structure_table->Input_src_Form == _SRC_FROM_VO) && (Scaler_DispGetInputInfoByDisp(SLR_MAIN_DISPLAY, SLR_INPUT_CAP_WID) > 3072));
#endif
	vd_pwr_ok = scalerVIP_check_vdc_hw_pwr();
	scalerVIP_NetFlix_smoothtoggle_enable(RPC_SmartPic_clue,RPC_system_info_structure_table);//if AP have infomation, have to change status from AP, CSFC 20140704

	scaler_Set_VIP_info_structure(channel,SmartPic_clue);//set information!!priority first!!CSFC 20150319
	AutoMA_Struct = &(system_info_structure_table->S_RPC_AutoMA_Flag);

if (g_IsNot4KVO || (MA_print_count&0x3f) == 0)
	scalerVIP_Set_Start_Print_Info();
	scalerVIP_Set_Stop_Polling();
	if(Start_Print.Delay_Time ==0)
	{
		Start_Print.Delay_Time =1;
	}

	#if 0
	if(MA_print_count%360==0)
	{
		ROSPrintf("[Young]ISR flag \n");
		ROSPrintf(" %d  ,%d  ,%d  ,%d  ,%d  ,\n",AutoMA_Struct->AutoMA_En,AutoMA_Struct->AutoMA1_En,AutoMA_Struct->AutoMA2_En,AutoMA_Struct->AutoMA3_En,AutoMA_Struct->AutoMA4_En);
		ROSPrintf(" %d  ,%d  ,%d  ,%d  ,%d  ,\n",AutoMA_Struct->AutoMA_API_CTRL.DI_MiddleWare_Function_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_SMD_weake_move_Detecte_En,AutoMA_Struct->AutoMA_API_CTRL.compute_PQA_level_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Profile_Block_Motion_En,AutoMA_Struct->AutoMA_API_CTRL.noise_estimation_MAD_et_En);
		ROSPrintf(" %d  ,%d  ,%d  ,%d  ,%d  ,\n",AutoMA_Struct->AutoMA_API_CTRL.Y_U_V_Mad_Calculate_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_ET_Y_MOTION_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_FMV_HMCbin_hist_ratio_Cal_En,AutoMA_Struct->AutoMA_API_CTRL.drvif_color_ClueGather_En,AutoMA_Struct->AutoMA_API_CTRL.skin_tone_Level_detect_En);
		ROSPrintf(" %d  ,%d  ,%d  ,%d  ,%d  ,\n",AutoMA_Struct->AutoMA_API_CTRL.pure_color_detect_En,AutoMA_Struct->AutoMA_API_CTRL.motion_purecolor_concentric_circles_detect_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_rtnr_noise_measure_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_color_noise_mpeg_detect_En,AutoMA_Struct->AutoMA_API_CTRL.DI_detect_Champagnet_En);
		ROSPrintf(" %d  ,%d  ,%d  ,%d  ,%d  ,\n",AutoMA_Struct->AutoMA_API_CTRL.motion_concentric_circles_detect_En,AutoMA_Struct->AutoMA_API_CTRL.motion_purecolor_concentric_circles_detect_En,AutoMA_Struct->AutoMA_API_CTRL.motion_move_concentric_circles_detect_En,AutoMA_Struct->AutoMA_API_CTRL.drvif_color_colorbar_dectector_by_SatHueProfile_En,AutoMA_Struct->AutoMA_API_CTRL.black_white_pattern_detect_En);
		ROSPrintf(" %d  ,%d  ,%d  ,%d  ,%d  ,\n",AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Fade_Detection_En,AutoMA_Struct->AutoMA_API_CTRL.histogram_new_III_dcc_EN,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_DCR_EN,AutoMA_Struct->AutoMA_API_CTRL.p_film_detection_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_PQ_Adaptive_Table_En);
		ROSPrintf(" %d  ,%d  ,%d  ,%d  ,%d  ,\n",AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_MA_IEdgeSmooth_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Dynamic_Vertical_NR_En,AutoMA_Struct->AutoMA_API_CTRL.drvif_color_DCTI_for_ColorBar_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_color_noise_mpeg_apply_En,AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_RTNR_correctionbit_period_En);

	}
	#endif

	//ini setting
	if(system_info_structure_table->ISR_Printf_Flag.Delay_Time==0)
		system_info_structure_table->ISR_Printf_Flag.Delay_Time=200;



	#if 0
	if(MA_print_count%360==0)
	{
		ROSPrintf("\n==== system_info_structure_table->HDR_flag == %d  ===	\n",system_info_structure_table->HDR_flag );
	}
	if(system_info_structure_table->HDR_flag == 1)
	{
		AutoMA_Struct->AutoMA2_En =FALSE ;
		AutoMA_Struct->AutoMA5_En = FALSE;
		AutoMA_Struct->AutoMA6_En = FALSE;


		AutoMA_Struct->AutoMA_API_CTRL.DI_MiddleWare_Function_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_SMD_weake_move_Detecte_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Profile_Block_Motion_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_FMV_HMCbin_hist_ratio_Cal_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.drvif_color_ClueGather_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.skin_tone_Level_detect_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.pure_color_detect_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.DI_detect_Champagnet_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.motion_concentric_circles_detect_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.motion_purecolor_concentric_circles_detect_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.motion_move_concentric_circles_detect_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.drvif_color_colorbar_dectector_by_SatHueProfile_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.black_white_pattern_detect_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Fade_Detection_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_DCR_EN = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.p_film_detection_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_MA_IEdgeSmooth_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Dynamic_Vertical_NR_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.drvif_color_DCTI_for_ColorBar_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_color_noise_mpeg_apply_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_RTNR_correctionbit_period_En = FALSE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_DI_Dynamic_VDNoise_FrameMotion_En = FALSE;
	}
	else
	{
		AutoMA_Struct->AutoMA2_En =TRUE ;
		AutoMA_Struct->AutoMA5_En = TRUE;
		AutoMA_Struct->AutoMA6_En = TRUE;

		AutoMA_Struct->AutoMA_API_CTRL.DI_MiddleWare_Function_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_SMD_weake_move_Detecte_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Profile_Block_Motion_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_FMV_HMCbin_hist_ratio_Cal_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.drvif_color_ClueGather_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.skin_tone_Level_detect_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.pure_color_detect_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.DI_detect_Champagnet_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.motion_concentric_circles_detect_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.motion_purecolor_concentric_circles_detect_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.motion_move_concentric_circles_detect_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.drvif_color_colorbar_dectector_by_SatHueProfile_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.black_white_pattern_detect_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Fade_Detection_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_DCR_EN = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.p_film_detection_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_MA_IEdgeSmooth_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Dynamic_Vertical_NR_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.drvif_color_DCTI_for_ColorBar_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_color_noise_mpeg_apply_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_RTNR_correctionbit_period_En = TRUE;
		AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_DI_Dynamic_VDNoise_FrameMotion_En = TRUE;
	}
	#endif
//--------------------------------------------------------------------------//

#if 0 //VIP_100_4 project
scalerVIP_100_4_Bright_Plus();
#endif

#if 1
	//scalerVIP_HDR_apply();
	//scalerVIP_HDR_clk_reset(system_info_structure_table);
#else
	/*unsigned int lineCnt_in = rtd_inl(VODMA_VODMA_LINE_ST_reg) & 0xfff;
	unsigned int vo_vend = (rtd_inl(VODMA_VODMA_V1VGIP_VACT1_reg) >> 16) & 0xfff;*/
	dolby_v_top_top_d_buf_RBUS top_d_buf_reg;
	dm_hdr_double_buffer_ctrl_RBUS dm_double_buffer_ctrl_reg;

	if(system_info_structure_table->HDR_info.HDR_Setting_Status == 1){
		/*// front porch
		if (lineCnt_in < (vo_vend-1)) {
			 //ROSPrintf("\n== OFF lineCnt_in =%d ,vend	=%d \n", lineCnt_in, (vo_vend - 1));
		}else*/
		{
			top_d_buf_reg.regValue = rtd_inl(DOLBY_V_TOP_TOP_D_BUF_reg);
			top_d_buf_reg.dolby_double_apply = 1;

			dm_double_buffer_ctrl_reg.regValue = rtd_inl(DM_HDR_Double_Buffer_CTRL_reg);
			dm_double_buffer_ctrl_reg.dm_db_apply = 1;

			rtd_outl(DOLBY_V_TOP_TOP_D_BUF_reg, top_d_buf_reg.regValue);
			rtd_outl(DM_HDR_Double_Buffer_CTRL_reg, dm_double_buffer_ctrl_reg.regValue);

			system_info_structure_table->HDR_info.HDR_Setting_Status = 0;

		}
	}
#endif

//*********************************************************************************************
//***************** ISR Detector Information start*****************************************
//*********************************************************************************************

//---------------------------------------------------------------------------------------//
// === source and mode information
//---------------------------------------------------------------------------------------//
	SmartPic_clue->Remmping_Src_Timing_index = drvif_color_check_source_remmping(SLR_MAIN_DISPLAY);
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
// === DI SIS Initial and Update
//---------------------------------------------------------------------------------------//
if(g_IsNot4KVO) {
	if(AutoMA_Struct->AutoMA_API_CTRL.DI_MiddleWare_Function_En==TRUE)
	{
	scalerVIP_DI_MiddleWare_StatusInit(RPC_system_info_structure_table->VIP_source);
	scalerVIP_DI_MiddleWare_HistUpdate((SmartPic_clue->Y_Main_Hist));
	scalerVIP_DI_MiddleWare_StatusUpdate();
	scalerVIP_DI_MiddleWare_SetStatus(STATUS_FADING, SmartPic_clue->Fade_flag);
	scalerVIP_DI_MiddleWare_SetStatus(STATUS_STILL_CONCENTRIC_CIRCLES, (SmartPic_clue->neckin_concentric_flag)); // Sony W1 CG NO.13
	scalerVIP_DI_MiddleWare_SetStatus(STATUS_MOVING_CAN, scalerVideo_Get_VD_MiddleWare(VD_STATUS_MOVING_CAN));   // 20151014, willy, use API to get VD status
	//scalerVIP_DI_MiddleWare_SetStatus(STATUS_MOVING_CAN, MovingCan_From_ScalerVideo); // flag from scalerVideo
	}
	if (Start_Print.DI_1==TRUE)
	{
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_HMC, debug_print_delay_time);
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_HMCNR, debug_print_delay_time);
	}
	if (Start_Print.DI_2==TRUE)
	{
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_SPAN, debug_print_delay_time);
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_SLOWMOTION, debug_print_delay_time);
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_MOTION, debug_print_delay_time);
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_SMD, debug_print_delay_time);
	}
	if (Start_Print.Snr==TRUE)
	{
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_NOISE, debug_print_delay_time);
	}
	//for debug
	if((system_info_structure_table->ISR_Printf_Flag.Flag1 & _BIT0) != 0)
	{
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_PAN, system_info_structure_table->ISR_Printf_Flag.Delay_Time);
	}
	if(AutoMA_Struct->AutoMA2_En ==TRUE){

		switch(RPC_system_info_structure_table->VIP_source)
		{
			case VIP_QUALITY_CVBS_NTSC:
			case VIP_QUALITY_CVBS_PAL:
			case VIP_QUALITY_YPbPr_480I:
			//case VIP_QUALITY_YPbPr_576I:
			case VIP_QUALITY_HDMI_480I:
			case VIP_QUALITY_HDMI_576I:
				if( DynamicOptimizeSystem[139] != 1 )
					scalerVIP_DI_MiddleWare_PAN_Apply(); // rord, 20151005, for code flow issue

				scalerVIP_DI_MiddleWare_HMC_Apply();
 				break;



 			case VIP_QUALITY_HDMI_1080I:
				scalerVIP_DI_MiddleWare_PAN_Apply(); // rord, 20151005, for code flow issue
				scalerVIP_DI_MiddleWare_HMC_Apply();

			default:

 				break;

		}

	//mark scalerVIP_DI_MiddleWare_FILM_Apply due to HQV film 2:2 is fail 20170209
	/*
	if(!(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV006 && !system_info_structure_table->PQ_demo_flag)) //20150819 remove mark due to HD 2:2 fail if do scalerVIP_DI_MiddleWare_FILM_Apply
	{
		scalerVIP_DI_MiddleWare_FILM_Apply();
	}
	*/

//	crt_sys_dclkss_RBUS dclkss_reg;
/* //rord.tsao mark 2015/0710
	di_im_di_hmc_pan_control_RBUS di_im_di_hmc_pan_control_reg;
	di_im_di_hmc_pan_control_reg.regValue = rtd_inl(DI_IM_DI_HMC_PAN_CONTROL_reg);
	unsigned char hmcnr_fw_en = ((di_im_di_hmc_pan_control_reg.dummy18024660_31_24 & 0x80)>>7); // bit31
	switch(RPC_system_info_structure_table->VIP_source)
	{
		case VIP_QUALITY_CVBS_NTSC:
		case VIP_QUALITY_CVBS_PAL:
		case VIP_QUALITY_YPbPr_480I:
		case VIP_QUALITY_YPbPr_576I:
		case VIP_QUALITY_HDMI_480I:
		case VIP_QUALITY_HDMI_576I:
			scalerVIP_DI_MiddleWare_HMCNR_Apply(hmcnr_fw_en);

		break;
		case VIP_QUALITY_HDMI_1080I:
			scalerVIP_DI_MiddleWare_HMCNR_Apply(hmcnr_fw_en);
			break;

		default:
			scalerVIP_DI_MiddleWare_HMCNR_Apply(hmcnr_fw_en);
			break;

	}
*/
	//scalerVIP_DI_MiddleWare_MCNR_Ctrl(0);

	scalerVIP_DI_MiddleWare_MCNR_Ctrl2(0);

	//scalerVIP_BTR_Detecte();
	scalerVIP_SMD_weake_move_Detecte();

	scalerVIP_DI_MiddleWare_ZOOMMOTION_Apply(16);
	scalerVIP_DI_MiddleWare_SLOWMOTION_Apply(16);
	scalerVIP_DI_MiddleWare_FADING_Apply(5);
	scalerVIP_DI_MiddleWare_SPECIAL_Apply((SmartPic_clue->Remmping_Src_Timing_index));
	scalerVIP_DI_MiddleWare_SMD_Apply();
	}
} else {
	scalerVIP_DI_MiddleWare_StatusInit(RPC_system_info_structure_table->VIP_source);
}
#if 0
	//============= DI detect test ================= //
	if((MA_print_count%Start_Print.Delay_Time==0)&&(Start_Print.ID_Pattern_139==TRUE))
	{
		ROSPrintf("STATUS_MOTION=%d,S_Noise=%d,S_Noise_R=%d,T_Noise=%d,T_Noise_R=%d,\n",
			scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION),scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL),
			scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE),scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_TEMPORAL_NOISE_LEVEL),
			scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_TEMPORAL_NOISE_RELIABLE));
	}

	/*if((MA_print_count%Start_Print.Delay_Time==0)&&(Start_Print.Reverse_5==TRUE))
	{
		scalerVIP_DI_MiddleWare_DebugMode(STATUS_NOISE, Start_Print.Delay_Time);
	}*/


	/*if((MA_print_count%Start_Print.Delay_Time==0)&&(Start_Print.ID_Pattern_147==TRUE))
	{
		ROSPrintf("input_src_form=%d,Input_src_Type=%d,Input_TVD_Form=%d,T_Noise=%d,Input_VO_Form=%d,\n",
			system_info_structure_table->Input_src_Form, system_info_structure_table->Input_src_Type, system_info_structure_table->Input_TVD_Form
			,system_info_structure_table->Input_VO_Form);
	}*/
#endif
//============= DI detect test ================= //

#if 0
if ((MA_print_count % 30) == 0)
{
	ROSPrintf("[SIS System-1]MOTION:%d, HMC: %d, PAN: %d:%d, VPAN: %d, ZOOM: %d, SLOW:%d\n", scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION), scalerVIP_DI_MiddleWare_GetStatus(STATUS_HMC),
		scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN), (scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN_LEVEL)-16), scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN),
		scalerVIP_DI_MiddleWare_GetStatus(STATUS_ZOOMMOTION),	scalerVIP_DI_MiddleWare_GetStatus(STATUS_SLOWMOTION));

	ROSPrintf("[SIS System-2]FADE:%d, HF:%d/%d, FILM: %d, SCC:%d\n", scalerVIP_DI_MiddleWare_GetStatus(STATUS_FADING), scalerVIP_DI_MiddleWare_GetStatus(STATUS_HIGHFREQUENCY_LEVEL), HIGHFREQUENCY_SCALE,
		scalerVIP_DI_MiddleWare_GetStatus(STATUS_FILM), scalerVIP_DI_MiddleWare_GetStatus(STATUS_STILL_CONCENTRIC_CIRCLES));

	ROSPrintf("[SIS System-3]NR_SPT_R: %d, NR_SPT_LV: %d, NR_TMP_R: %d, NR_TMP_LV: %d\n", scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE),
		scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL), scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_TEMPORAL_NOISE_RELIABLE),
		scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_TEMPORAL_NOISE_LEVEL));
}

if (scalerVIP_DI_MiddleWare_GetStatus(STATUS_SCENECHANGE))
{
	ROSPrintf("[SIS System] Scene Change Detected!!\n");
	scalerVIP_DI_MiddleWare_DebugMode(STATUS_SCENECHANGE, 1);
}
#endif

//for LG demo BW not enough, default disable!! sync. from Mac3 CSFC 20150312
#if 0//LG_Demo_flag
	od_od_cap_status_RBUS od_cap_status_reg;
	od_od_cap_ctl0_RBUS cap_ctl0_reg;
	od_od_ctrl0_RBUS od_ctrl0_reg;

	od_ctrl0_reg.regValue = rtd_inl(OD_OD_CTRL0_reg);
	od_cap_status_reg.regValue = rtd_inl(OD_OD_CAP_STATUS_reg);

	if ((od_cap_status_reg.cap_fifo_overflow == 1)&&(od_ctrl0_reg.od_ctrl==1))
	{
		rtd_clearbits(OD_OD_CAP_CTL0_reg, _BIT24);
		rtd_setbits(OD_OD_CAP_CTL0_reg, _BIT24);

		rtd_setbits(OD_OD_CAP_STATUS_reg, _BIT2);

		ROSPrintf("[OD] Bandwidth capture error, workaround solution!!!\n");
	}

	cap_ctl0_reg.regValue = rtd_inl(OD_OD_CAP_CTL0_reg);
	if(cap_ctl0_reg.cap_en==0)
		rtd_setbits(OD_OD_CAP_CTL0_reg, _BIT24);
#endif


//---------------------------------------------------------------------------------------//
// === Check DI DMA error flag and disable OD
// NOTE: need to check and fix, CSFC mark 20140429
//---------------------------------------------------------------------------------------//
//if ((MA_print_count % 20) == 0)
	//scalerVIP_OD_CheckBandwidth();

//====== Custom Lead =========
//---------------------------------------------------------------------------------------//
	if(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV015)
	{
#ifdef ISR_TV015_DI_FUNCTION_ENABLE
	    scalerVIP_TV015_Lead();
#endif
	}




//---------------------------------------------------------------------------------------//
//==read profile (Elsie 20130521 seperated from still motion judge)==
//---------------------------------------------------------------------------------------//
if (g_IsNot4KVO) {
#ifdef ISR_AMBILIGHT_ENABLE
	if(m_AmbilightMode == 1)
		SmartPic_clue->Profile_Cal_INFO.ProfileFlag_Y = 0;
	else
#endif
	{
		#if 1 //new
		scalerVIP_scalerColor_profile();
		#else //old
		SmartPic_clue->Profile_Cal_INFO.ProfileFlag_Y = scalerVIP_ReadProfile(SmartPic_clue);
		#endif
	}
}

	if (BlackDetection_en)
		scalerVIP_PF_BlackDetection();


//---------------------------------------------------------------------------------------//
//==NR detector
//---------------------------------------------------------------------------------------//
	if(system_info_structure_table->Input_src_Form == _SRC_FROM_VDC && vd_pwr_ok)
		SmartPic_clue->VD_Signal_Status_value_avg = VD_noise_Status_sum_avg();  //yuan1024
		//drvif_color_compute_noise_level(SLR_MAIN_DISPLAY); //CSFC mark from 20140429, need sync. to new PQA table
	else
		SmartPic_clue->VD_Signal_Status_value_avg = 0;
if (g_IsNot4KVO || (MA_print_count&0xf) == 0) {

	if(AutoMA_Struct->AutoMA_API_CTRL.compute_PQA_level_En==TRUE)
	{
		scalerVIP_compute_PQA_level(Share_Memory_VIP_TABLE_Struct, SmartPic_clue, system_info_structure_table);
	}
}
//---------------------------------------------------------------------------------------//
//================= Noise estimation (20131105 jimmy.lin) =========================//
//---------------------------------------------------------------------------------------//
if (g_IsNot4KVO) {
#ifdef ISR_AMBILIGHT_ENABLE
	if( (m_AmbilightMode != 1 )&&(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Profile_Block_Motion_En==TRUE)) // profile unavailable
#else
	if(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Profile_Block_Motion_En==TRUE) // profile unavailable
#endif
	{
		//Return : MOTION_NOISE_TYPE
		SmartPic_clue->block_motion_status = scalerVIP_Profile_Block_Motion(SmartPic_clue);
	}
}
	//Return:MOTION_NOISE_TYPE
	if((RPC_system_info_structure_table->Project_ID != VIP_Project_ID_TV003 )&& (AutoMA_Struct->AutoMA_API_CTRL.noise_estimation_MAD_et_En==TRUE))//for TV003, not need use this function
	{
		if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_MOTION_RTNR]==1)
		SmartPic_clue->MAD_motion_status = scalerVIP_noise_estimation_MAD_et((SmartPic_clue->SCALER_DISP_INFO.IphActWid_H), (SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V));
		else
			SmartPic_clue->MAD_motion_status =0;

	}
//---------------------------------------------------------------------------------------//
if (g_IsNot4KVO) {
	if(Enable_Hist_MAD_Calculate)
	{
		if (AutoMA_Struct->AutoMA_API_CTRL.Y_U_V_Mad_Calculate_En==TRUE)
		scalerVIP_Y_U_V_Mad_Calculate(Share_Memory_VIP_TABLE_Struct, SmartPic_clue, system_info_structure_table, RPC_system_info_structure_table);
		/* use "scalerVIP_ET_Y_MOTION_En" to control HDR setting status, elieli*/
		/*if (AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_ET_Y_MOTION_En==TRUE)
		scalerVIP_ET_Y_MOTION();*/
	}
}
scalerVIP_HMCNR_statistic();
//---------------------------------------------------------------------------------------//
//=====Y, Hue, Sat Histogram detector information====
//---------------------------------------------------------------------------------------//
		scalerVIP_YHist_HueHist_Ratio_Calculate();
		scalerVIP_Sat_Hist_Calculate();
		SmartPic_clue->saturationflag = scalerVIP_Saturation_Detection(); //remove this for video book sony screen flash on/off
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//=====DI FMV HMC MV Histogram detector information====
//---------------------------------------------------------------------------------------//
if(g_IsNot4KVO) {
	if (AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_FMV_HMCbin_hist_ratio_Cal_En==TRUE)
	scalerVIP_FMV_HMCbin_hist_ratio_Cal(Share_Memory_VIP_TABLE_Struct, SmartPic_clue, system_info_structure_table);
}
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//=====Motion detector=====
//=====only for interlace signal motion detector =======
//---------------------------------------------------------------------------------------//
if(g_IsNot4KVO) {
	di_im_di_rtnr_control_RBUS im_di_rtnr_control_reg;
	im_di_rtnr_control_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);
	if(im_di_rtnr_control_reg.cp_rtnr_progressive != 1)
	{
		//if(system_info_structure_table->Input_src_Form == _SRC_FROM_VDC)
		//	SmartPic_clue->di_motion_status = scalerVideo_MotionDecision();
		//else
			SmartPic_clue->di_motion_status = scalerVideo_MotionDecision();
	}
	if(AutoMA_Struct->AutoMA_API_CTRL.drvif_color_ClueGather_En ==TRUE)
		drvif_color_ClueGather(channel, SmartPic_clue);//for getting MAD et and film motion information
}
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//==read from input source detection (Jimmy 20140213 added for Sirius) ==
//== This function can detector status for ( SD in -> HD out )
//== NOTE : Need to fix and test this function, CSFC mark on 20140429 ==
//---------------------------------------------------------------------------------------//
unsigned int high_freq_step=3400000;
switch(RPC_system_info_structure_table->VIP_source)
{

	case VIP_QUALITY_DTV_576I:
		scalerVIP_DI_GMV_AVG_for_film();
		break;
	case VIP_QUALITY_HDMI_1080I:
	case VIP_QUALITY_DTV_1080I:
	case VIP_QUALITY_YPbPr_1080I:
	case VIP_QUALITY_PVR_1080I:
		InputSourceDetFlag = scalerVIP_ReadSrcDet(2, 20, 0);

		//printk("\n h0: %d ,h1 %d ,h2 %d ",Step_Hist[0],Step_Hist[1],Step_Hist[2]);
		//if(rtd_inl(0xb802e4f4)==14)
		//	printk("\n step_count: %d ,average %d  ",step_count);
		if (Scaler_access_Project_TV002_Style(0, 0) == Project_TV002_OFF) {
			if(step_count<BadUpScalingThreshold)
			{
					// sd2hd by player
				scalerVIP_color_DRV_SNR_Veritcal_NR(&vlpf_table[1]);
				BadUpScalingThreshold = BADUP_SCALING_LEAVE;
			}
			else
			{
				//ROSPrintf("\n SD2HD: 0 ,step_count %d  ",step_count);
				scalerVIP_color_DRV_SNR_Veritcal_NR(&vlpf_table[0]);

			}
		}
		scalerVIP_Teeth_detcted();
		break;
	case VIP_QUALITY_HDMI_1080P:
	case VIP_QUALITY_YPbPr_1080P:
		InputSourceDetFlag = scalerVIP_ReadSrcDet(2, 20, 0);

		break;

	default:

		break;

}

	//if( InputSourceDetFlag == SUCCESS )
		//scalerVIP_Input_Source_Detection(2);
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//==skin tone detector
//---------------------------------------------------------------------------------------//
if(g_IsNot4KVO) {
		//skin_tone_detect(_CHANNEL1, scaler_disp_info[_CHANNEL1].DispWid, scaler_disp_info[_CHANNEL1].DispLen);
		SmartPic_clue->skintoneflag=skin_tone_found;
		if (AutoMA_Struct->AutoMA_API_CTRL.skin_tone_Level_detect_En==TRUE)
		skin_tone_Level_detect(_CHANNEL1,
			Scaler_DispGetInputInfoByDisp(SLR_MAIN_DISPLAY, SLR_INPUT_DISP_WID),
			Scaler_DispGetInputInfoByDisp(SLR_MAIN_DISPLAY, SLR_INPUT_DISP_LEN));
} else
	SmartPic_clue->skintoneflag = 0;
//---------------------------------------------------------------------------------------//

//=======================================================
//===  Pure Color Detection== < if pure_color ==1, DCC.DCL_B.DCL_W all off >
//=======================================================
	//if(Sony_DCC_API_ON || TV_057_style_ON)
	//	pure_color = pure_color_detect_Sony(0, scaler_disp_info[SLR_MAIN_DISPLAY].DispWid, scaler_disp_info[SLR_MAIN_DISPLAY].DispLen);
	//else
		//pure_color = pure_color_detect_Sony(0, scaler_disp_info[SLR_MAIN_DISPLAY].DispWid, scaler_disp_info[SLR_MAIN_DISPLAY].DispLen);//for_LG_demo
if(g_IsNot4KVO) {
          if (AutoMA_Struct->AutoMA_API_CTRL.pure_color_detect_En==TRUE)
		SmartPic_clue->PureColor = pure_color_detect(0, SmartPic_clue->SCALER_DISP_INFO.DispWid, SmartPic_clue->SCALER_DISP_INFO.DispLen);

		if ((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Dcc_2==TRUE))
		{
			ROSPrintf("==== pure_color =%d=====\n",(SmartPic_clue->PureColor));
			ROSPrintf("==== Saturation_detect_flag =%d=====\n",SmartPic_clue->saturationflag);
		}
}
//---------------------------------------------------------------------------------------//
//==Color Histogram Detector==
//---------------------------------------------------------------------------------------//
		en_test = 0;
		if (AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_colorHistDetect_En==TRUE)
		scalerVIP_colorHistDetect(en_test);
//---------------------------------------------------------------------------------------//


//---------------------------------------------------------------------------------------//
//==Profile Motion detector==
//---------------------------------------------------------------------------------------//
	if (Profile_Motion_Detect_ON)
	{
		if ((SmartPic_clue->Profile_Cal_INFO.ProfileFlag_Y) == 1)
			scalerVIP_Profile_Motion_Detect(channel, SmartPic_clue);
	}
//---------------------------------------------------------------------------------------//

	if(TV_05_style_ON == 0)
	{
		if(AutoMA_Struct->AutoMA6_En)// RTK demo mode
		{
			still_piccture_auto_clean =1;
		}
		else
		{
			still_piccture_auto_clean =0;
		}
	}

//*********************************************************************************************
//~~~~~ ISR Detector Information end~~~~
//*********************************************************************************************



//*********************************************************************************************
//***************************** detection ******************************************************
//*********************************************************************************************
	scalerVIP_rtnr_noise_measure();

//---------------------------------------------------------------------------------------//
//============AUTO MA 5 : MPEG NR Function (detection)===========
//---------------------------------------------------------------------------------------//
if(g_IsNot4KVO) {
	if(AutoMA_Struct->AutoMA5_En==TRUE) {
		scalerVIP_color_noise_mpeg_detect();
		scalerVIP_color_noise_mpeg_v_detect();
	}
}
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//============RTNR_Adaptive_detect===========
//---------------------------------------------------------------------------------------//
	//scalerVIP_newRTNR_Adaptive_detect(_CHANNEL1,&motion_level_flag,&Pan_flag,&BigSmoothArea_flag); // CSFC, mark from 20140429
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//===  chessboard detection, jason9.ccc  '100119 =======
//---------------------------------------------------------------------------------------//
	//flag_chessboard = drvif_color_chessboard_detection(16, 3, 80, 10, 12); // CSFC, mark from 20140429
//threshld	(16, th1-> bigger=>looser, th2-> smaller=>looser, th3-> bigger=>looser, th4-> smaller=>looser)
//-----------------------------------------------------------------------------------------------
if (g_IsNot4KVO) {
//---------------------------------------------------------------------------------------//
//=== DI detect champange ====
//---------------------------------------------------------------------------------------//
      if (AutoMA_Struct->AutoMA_API_CTRL.DI_detect_Champagnet_En==TRUE)
	 SmartPic_clue->Champagne_flag = DI_detect_Champagne(SmartPic_clue->SCALER_DISP_INFO.DispWid, SmartPic_clue->SCALER_DISP_INFO.DispLen);
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//===concentric circles detection===
//---------------------------------------------------------------------------------------//
	//if (AutoMA_Struct->AutoMA_API_CTRL.motion_concentric_circles_detect_En==TRUE)
	SmartPic_clue->neckin_concentric_flag = motion_concentric_circles_detect(SmartPic_clue->SCALER_DISP_INFO.DispWid, SmartPic_clue->SCALER_DISP_INFO.DispLen);
	if (AutoMA_Struct->AutoMA_API_CTRL.motion_purecolor_concentric_circles_detect_En==TRUE)
	SmartPic_clue->PureColor_neckin_concentric_flag = motion_purecolor_concentric_circles_detect(SmartPic_clue->SCALER_DISP_INFO.DispWid, SmartPic_clue->SCALER_DISP_INFO.DispLen);

	if (AutoMA_Struct->AutoMA_API_CTRL.motion_move_concentric_circles_detect_En==TRUE)
	SmartPic_clue->Motion_concentric_flag = motion_move_concentric_circles_detect(SmartPic_clue->SCALER_DISP_INFO.DispWid, SmartPic_clue->SCALER_DISP_INFO.DispLen);

//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//================colorbar detection (Elsie 20130521)=============(modify CSFC 201501)
//---------------------------------------------------------------------------------------//
	//isColorBar_flag = scalerVIP_ColorbarDetector();
	//SmartPic_clue->Colorbar_flag = drvif_color_colorbar_dectector(SmartPic_clue);
	DCTI_auto_table_select = system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.iDcti_table_select;
	VipNewDcti_auto_adjust_table = &(system_info_structure_table->PQ_Setting_Info.I_D_Dcti_INFO.auto_adjust_Table[DCTI_auto_table_select]);
	if (AutoMA_Struct->AutoMA_API_CTRL.drvif_color_colorbar_dectector_by_SatHueProfile_En==TRUE)
	SmartPic_clue->colorbar_score= drvif_color_colorbar_dectector_by_SatHueProfile(SmartPic_clue);//20141226, CSFC
	if((SmartPic_clue->colorbar_score)>(VipNewDcti_auto_adjust_table->VipNewDcti_auto_setting.low_bound))
	{
		if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
		{
			ROSPrintf(" low_bound=%d !!\n",(VipNewDcti_auto_adjust_table->VipNewDcti_auto_setting.low_bound));
			ROSPrintf(" Enable DCTI enhance for colobar !!\n");
		};

		SmartPic_clue->Colorbar_flag = true;
	}
	else
	{
		SmartPic_clue->Colorbar_flag = false;
	}

//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//==================black-white detection (only CVBS)=======================
//---------------------------------------------------------------------------------------//
	if (AutoMA_Struct->AutoMA_API_CTRL.black_white_pattern_detect_En==TRUE)
	SmartPic_clue->CVBS_black_white_falg= black_white_pattern_detect();
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//================= Fade Detection (20131105 jimmy.lin) ==========================//
//---------------------------------------------------------------------------------------//
	if(((SmartPic_clue->Profile_Cal_INFO.ProfileFlag_Y)==SUCCESS)&&(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Fade_Detection_En==TRUE))
	{
		SmartPic_clue->Fade_flag = scalerVIP_Fade_Detection();
		//if( Fade_flag ) ROSPrintf( "[ScalerVIP] Fade detected\n" );
	}
}

//*********************************************************************************************
//~~~~~~end detection~~~~~~
//*********************************************************************************************


//*********************************************************************************************
//**************** Some Basic algo. function  *********************************
//*********************************************************************************************

//---------------------------------------------------------------------------------------//
//== DCC ==
//---------------------------------------------------------------------------------------//
	if (Stop_Polling.Stop_Dcc==FALSE) //Stop_polling =TRUE : STOP DCC ,
	{
		extern unsigned char bSkipHistIIR;

		if(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV006 && RPC_system_info_structure_table->PQ_demo_flag == 0)
		{
			bSkipHistIIR = 1;
			if (system_info_structure_table->DCC_FW_ONOFF)
				scalerDCC_tv006_apply_dcc(channel, 7);
		}
		else if (AutoMA_Struct->AutoMA_API_CTRL.histogram_new_III_dcc_EN==TRUE)
		{
			bSkipHistIIR = 0;
			if(COLOR_HISTOGRAM_LEVEL ==128){
				histogram_new_III_dcc(channel,7, 7);
			} else {
			histogram_new_III_dcc(channel,5, 7);
		}
	}
	}
//---------------------------------------------------------------------------------------//

#if 0
//scalerVIP_DI_Dynamic_Status_Adjust_by_Global_Motion(motion_level_flag);
// VD save initial register value when source change, willy 20150715
if(system_info_structure_table->Input_src_Form == _SRC_FROM_VDC && vd_pwr_ok)
{
    scalerVideo_NoistStatusUpdate(); // move to VGIPISR?
}

if (g_IsNot4KVO) {
//if(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV006 &&
//   ( (RPC_system_info_structure_table->VIP_source==VIP_QUALITY_CVBS_NTSC)||
//   (RPC_system_info_structure_table->VIP_source==VIP_QUALITY_CVBS_PAL)) ){
if(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV006 ){

    scalerVIP_Identify_Pattern_forLGM2();
    scalerVIP_Set_Parameter_forLGM2(1);
}
else
{
    scalerVIP_Identify_Pattern_forLG_K2L();
    scalerVIP_Set_Parameter_forLG_K2L();
}
}
#endif

//---------------------------------------------------------------------------------------//
//=== DCR Function ===
//---------------------------------------------------------------------------------------//
if (g_IsNot4KVO) {
if((Stop_Polling.Stop_Dcr== FALSE)&&(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_DCR_EN==TRUE)) //Stop_polling =TRUE : STOP  DCR,
{
	//if(MA_print_count%250==0)
	//	printk(KERN_EMERG "scalerVIP_DCR_EN\n");

	if((TV_05_style_ON == 0)&&(system_info_structure_table->RTK_DCR_Enable==1))
	{
		scalerVIP_DCR();
	}
}
}
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//=== film detector ===
//---------------------------------------------------------------------------------------//
#if 0 //mark for non use
if((Stop_Polling.Stop_Film_Mode_Detector==FALSE)&&(AutoMA_Struct->AutoMA_API_CTRL.p_film_detection_En==TRUE)) //Stop_polling[4] =TRUE : STOP  Film_Mode
{
	p_film_detection();
}
#endif
//---------------------------------------------------------------------------------------//

//*********************************************************************************************
//~~~ end some basic function ~~~~
//*********************************************************************************************



//*********************************************************************************************
//***************************** Apply : inherit from detection  block *********************************
//*********************************************************************************************
//---------------------------------------------------------------------------------------//
//====== RTNR correction bit period ======
//---------------------------------------------------------------------------------------//
	if((AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_RTNR_correctionbit_period_En==TRUE)) //Stop_polling =TRUE : STOP  Auto NR function ,
		scalerVIP_RTNR_correctionbit_period();
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//====== // for TV002 PQ function ======
//---------------------------------------------------------------------------------------//
	if (Scaler_access_Project_TV002_Style(0, 0) == Project_TV002_Style_1) {
		/* BP, DBC and Zero-D*/
		custom_TBL_TV002 = Scaler_get_tv002_Custom_struct();
		Scaler_scalerVIP_Brightness_Plus_Function_TV002(Share_Memory_VIP_TABLE_Struct, SmartPic_clue, system_info_structure_table, custom_TBL_TV002, MA_print_count);
		Scaler_scalerVIP_DBC_CTRL_TV002(custom_TBL_TV002, system_info_structure_table, SmartPic_clue, MA_print_count);
		//Scaler_scalerVIP_ZERO_D_CTRL_TV002(custom_TBL_TV002, system_info_structure_table, SmartPic_clue, MA_print_count);
		/* ID */
		Scaler_scalerVIP_ID_TV002(Share_Memory_VIP_TABLE_Struct, RPC_SmartPic_clue, SmartPic_clue, RPC_system_info_structure_table, system_info_structure_table, MA_print_count);
		Scaler_scalerVIP_ID_Apply_TV002(Share_Memory_VIP_TABLE_Struct,RPC_system_info_structure_table, system_info_structure_table, SmartPic_clue, MA_print_count);
	}


//---------------------------------------------------------------------------------------//
//======== Auto NR function ===========
//---------------------------------------------------------------------------------------//

if (g_IsNot4KVO || (MA_print_count&0xf) == 0) {
	if((Stop_Polling.Stop_Auto_Nr==FALSE)&&(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_PQ_Adaptive_Table_En==TRUE)) //Stop_polling =TRUE : STOP  Auto NR function ,
	{
		// set rtnrC running flag for scalerVideo.c "void LG_XCRemove_by_RTNR_C(UINT8 format, UINT8 MA_motion)", reset condition,  elieli
		scalerVIP_Reset_PQA_TBL_ContentCheck_Flag(&(SmartPic_clue->PQA_ISR_Cal_Info.ContentCheck_Flag[0]));

		scalerVIP_PQ_Adaptive_Table(PQA_MODE_WRITE, Share_Memory_VIP_TABLE_Struct, SmartPic_clue, system_info_structure_table);
		scalerVIP_PQ_Adaptive_Table(PQA_MODE_OFFSET, Share_Memory_VIP_TABLE_Struct, SmartPic_clue, system_info_structure_table);
		if((RPC_SmartPic_clue->S_NetFlix_info.Netflix_Enable)==1)	//Netflix
		{
			scalerVIP_NetFlix_Smooth_TimingChange_for_RTNR();
		}
/* Replase by PQA adaptive control Flow
	if(AutoNR_Enable == TRUE && AutoMA_Struct->AutoMA4_En==TRUE)//if OSD DNR=4, AutoNR_Enable=TRUE
		drvif_color_DNRAUTO(SLR_MAIN_DISPLAY, AUTO_NR_style, VD_noise_level, DNR_Auto_lvl_SdHd);
*/
//scalerVIP_CorrectionBit1_Ctrl(AutoNR_Enable, VD_noise_level, RTNR_LEVEL_SDHD_SONY, nonAuto_RTNR_Y_LEVEL, nonAuto_RTNR_C_LEVEL, SmartPic_clue->Fade_flag);
//scalerVIP_RTNR_SceneChange_Policy(TRUE, AutoNR_Enable, VD_noise_level, RTNR_LEVEL_SDHD_SONY, nonAuto_RTNR_Y_LEVEL, nonAuto_RTNR_C_LEVEL);
	}
}
	//if(MA_print_count%250==0)
		//ROSPrintf("PQA_CC=%d,%d\n",SmartPic_clue->PQA_ISR_Cal_Info.ContentCheck_Flag[0],SmartPic_clue->PQA_ISR_Cal_Info.ContentCheck_Flag[1]);

//---------------------------------------------------------------------------------------//
//=============Motion Adaptive I edge smooth for CVBS moving scene===================//
//---------------------------------------------------------------------------------------//
if (g_IsNot4KVO) {
	if(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_MA_IEdgeSmooth_En==TRUE)
	scalerVIP_MA_IEdgeSmooth(SmartPic_clue->neckin_concentric_flag); // Lydia 140314
}
//---------------------------------------------------------------------------------------//

//-------------------------------------------------------------------------------------------//
//===================IEGSM line mode check====================================//
//------------------------------------------------------------------------------------------//
//    scalerVIP_IEedgeSmooth_Linemode_check(); //Lydia 140925
if (g_IsNot4KVO) {
	if(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_Dynamic_Vertical_NR_En==TRUE)
		if (Scaler_access_Project_TV002_Style(0, 0) == Project_TV002_OFF)
				scalerVIP_Dynamic_Vertical_NR();
}
//---------------------------------------------------------------------------------------//
//====================AUTO MA 1 start for DCTI=================================
//---------------------------------------------------------------------------------------//
if (g_IsNot4KVO) {
if((Stop_Polling.Stop_Dcti_for_colorbar==FALSE)&&(AutoMA_Struct->AutoMA_API_CTRL.drvif_color_DCTI_for_ColorBar_En==TRUE)) //Stop_polling =TRUE : STOP  DCTI_for colorbar
{
	if(AutoMA_Struct->AutoMA1_En)
	{
		//drvif_color_DELAY_for_ColorBar(SmartPic_clue->Colorbar_flag,SmartPic_clue->colorbar_score);
		//drvif_color_DCTI_for_ColorBar(SmartPic_clue->Colorbar_flag,SmartPic_clue->colorbar_score);
	}
}
}
//---------------------------------------------------------------------------------------//

//---------------------------------------------------------------------------------------//
//====================Auto MA 5 application: for MPEG NR====================
//---------------------------------------------------------------------------------------//
if(g_IsNot4KVO) {
	if((Stop_Polling.Stop_Noise_Mpeg==FALSE)&&(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_color_noise_mpeg_apply_En==TRUE)) //Stop_polling =TRUE : STOP  noise_mpeg,
	{
		//Elsie 20130425: detect/apply seperation
		if(AutoMA_Struct->AutoMA5_En)
		{
			if(RPC_system_info_structure_table->Project_ID != VIP_Project_ID_TV003)//for TV003, Need to remove when bug fix!!
			{
				scalerVIP_color_noise_mpeg_apply();
				scalerVIP_color_noise_mpeg_v_apply();
			}
		}
	}
}
//---------------------------------------------------------------------------------------//
    if(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV015)
    {
#ifdef ISR_TV015_DI_FUNCTION_ENABLE
		scalerVIP_TV015_Adjust();
#endif
    }

//---------------------------------------------------------------------------------------//
//====== DI Dynamic VDNoise adjustment ======
//---------------------------------------------------------------------------------------//
if((Stop_Polling.Stop_VD_Noise==FALSE)&&(AutoMA_Struct->AutoMA_API_CTRL.scalerVIP_DI_Dynamic_VDNoise_FrameMotion_En==TRUE)) //Stop_polling =TRUE : STOP  Dynamic VD_Noise
{
    if( (RPC_system_info_structure_table->VIP_source==VIP_QUALITY_TV_NTSC) ||
        (RPC_system_info_structure_table->VIP_source==VIP_QUALITY_TV_NTSC443) ||
        (RPC_system_info_structure_table->VIP_source==VIP_QUALITY_TV_PAL) ||
        (RPC_system_info_structure_table->VIP_source==VIP_QUALITY_TV_SECAN) ||
        (RPC_system_info_structure_table->VIP_source==VIP_QUALITY_TV_PAL_M)  )
        /*
    if( Scaler_InputSrcGetMainChType()==_SRC_CVBS ||
        Scaler_InputSrcGetMainChType()==_SRC_TV ||
        Scaler_InputSrcGetMainChType()==_SRC_SV||
        Scaler_InputSrcGetMainChType()==_SRC_SCART)
        */
{
    	if (vd_pwr_ok)
            scalerVIP_DI_Dynamic_VDNoise_FrameMotion();
}
}
//---------------------------------------------------------------------------------------//
//====== DI Dynamic Status adjustment ======
//---------------------------------------------------------------------------------------//


//---------------------------------------------------------------------------------------//
//====== Set Info to MEMC  jzl 20151231======

	scalerVIP_Set_Info_toMEMC();
#ifdef CONFIG_RTK_KDEV_MEMC_INTERRUPT
	scalerVIP_Set_MEMC_Info_toVCPU();
#endif
//---------------------------------------------------------------------------------------//

#if 1

	if (g_IsNot4KVO) {
		if (Scaler_access_Project_TV002_Style(0, 0) == Project_TV002_OFF) {
			if(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV006 ) {
				scalerVIP_Identify_Pattern_forLGM2();
				scalerVIP_Set_Parameter_forLGM2(1);
			} else {
				/*Mac5p fix me : use identify LG for demo in stead of ori code*/
				scalerVIP_Identify_Pattern_forLGM2();
			 	scalerVIP_Set_Parameter_forLGM2(1);
			        //scalerVIP_Identify_Pattern_forLG_K2L();
			        //scalerVIP_Set_Parameter_forLG_K2L();
			}
		} else {
			memset(&DynamicOptimizeSystem[0], 0, sizeof(DynamicOptimizeSystem));
		}
	}
#endif
//scalerVIP_DI_MCNR_RTNR_bottom_fresh_line_patch(system_info_structure_table->Input_src_Form != _SRC_FROM_VO);// only merlin need

#if 0//CB_flag
			scalerVIP_Identify_Pattern_forCB();
			scalerVIP_Set_Parameter_forCB();
#endif
	#ifdef CONFIG_HW_SUPPORT_MEMC
	scalerVIP_IP_OnOff_By_MEMC_Film(system_info_structure_table); //rord.tsao 2016/0325
	#endif

	scalerVIP_Dynamic_DeXCXL_CTRL(RPC_system_info_structure_table, Share_Memory_VIP_TABLE_Struct);

	static unsigned char isTNRXC = 1;

	if(preSource != (RPC_system_info_structure_table->VIP_source))
	{
		isTNRXC = (rtd_inl(DI_IM_DI_TNR_XC_CONTROL_reg) & _BIT0);
	}

	if(RPC_SmartPic_clue->SceneChange)
	{
		rtd_clearbits(DI_IM_DI_TNR_XC_CONTROL_reg, _BIT0);	//disable TNR XC when SceneChange

		if(RPC_system_info_structure_table->VIP_source==VIP_QUALITY_CVBS_SECAN)
			rtd_setbits(DI_IM_DI_TNR_XC_CONTROL_reg, _BIT0);

	}
/*	for LG-PAL_SceneChange, marked by nick187 @ 2014/03/15
	else
	{
		rtd_maskl(DI_IM_DI_TNR_XC_CONTROL_reg, 0xfffffffe, isTNRXC);
	}
*/

	//for smoothtoogle sharpness change
	scalerVIP_VO_resolution_change_hack();
//*********************************************************************************************
// ~~~ end apply ~~~~
//*********************************************************************************************

//*****update pre data ********
	pre_VD_noise_level = VD_noise_level;
	pre_DNR_Auto_lvl_SdHd  = DNR_Auto_lvl_SdHd;
	pre_TG45_Flag = TG45_Flag;

	isEvenFrame = (isEvenFrame+1) % 2;
	preSource = (RPC_system_info_structure_table->VIP_source);

	#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
	RPC_system_info_structure_table->SCPU_ISRIINFO_TO_VCPU.AutoMA_Running_flag = 1;
	#else
	RPC_system_info_structure_table->SCPU_ISRIINFO_TO_VCPU.AutoMA_Running_flag = 0;
	#endif
/*
	if(MA_print_count%360==0)
	{
		ROSPrintf("scalerVIP_colorMaAutoISR End\n");
	}
*/
}



#ifdef ISR_TV015_DI_FUNCTION_ENABLE
void scalerVIP_TV015_Lead(void)
{
	//====== ambilight sensor =========
	//m_AmbilightMode = 1;
	//scalerVIP_AmbiLight(_CHANNEL1);
}
void scalerVIP_TV015_Adjust(void)
{
	// IESM mess direction de_dot H crawing
	scalerVIP_IESM_Mess_Direction_de_Dot();

	//DI  chroma error for Grayscale dot crawing  de cvbs adc limitation
	scalerVIP_DI_Chroma_Error_de_DotCrawing();

}
void scalerVIP_DI_Chroma_Error_de_DotCrawing(void)
{
	if(RPC_system_info_structure_table->VIP_source == VIP_QUALITY_CVBS_NTSC || RPC_system_info_structure_table->VIP_source == VIP_QUALITY_CVBS_PAL)
	{
		di_im_di_framesobel_statistic_RBUS FrameSobel_statistic_Reg;
		FrameSobel_statistic_Reg.regValue = scaler_rtd_inl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg);
		if((SmartPic_clue->Sat_Main_His_Ratio)[0] >=994)
			FrameSobel_statistic_Reg.chromaerror_en = 0;
		else
			FrameSobel_statistic_Reg.chromaerror_en = 1;
		scaler_rtd_outl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg, FrameSobel_statistic_Reg.regValue);
	}
}

void scalerVIP_IESM_Mess_Direction_de_Dot(void)
{
	iedge_smooth_prelpf_ctrl_RBUS smooth_prelpf_ctrl_reg;
	smooth_prelpf_ctrl_reg.regValue = scaler_rtd_inl(IEDGE_SMOOTH_PRELPF_CTRL_reg);
	if(smooth_prelpf_ctrl_reg.prelpf_snr_sel > 1)
		scalerVIP_IESM_mess_direction_en(FALSE);
	else
		scalerVIP_IESM_mess_direction_en(TRUE);
}
void scalerVIP_IESM_mess_direction_en(unsigned char nEnable)
{
	iedge_smooth_edgesmooth_mess_direction1_RBUS edgesmooth_mess_direction1_reg;
	edgesmooth_mess_direction1_reg.regValue = scaler_rtd_inl(IEDGE_SMOOTH_EDGESMOOTH_MESS_DIRECTION1_reg);
	edgesmooth_mess_direction1_reg.mess_direction_en =nEnable;
	scaler_rtd_outl(IEDGE_SMOOTH_EDGESMOOTH_MESS_DIRECTION1_reg,edgesmooth_mess_direction1_reg.regValue);
}
#endif

#ifdef ISR_AMBILIGHT_ENABLE
void scalerVIP_AmbiLight(unsigned char display)
{
	// using profile to get YUV data for ambilight sensor, elieli
		static unsigned char color_flag = 0;
		//ROSPrintf(" color_flag =%d,=%d\n",color_flag,flag_profile_read_status);
		if(color_flag == 0)
			flag_profile_read_status = drvif_color_dragon_profile_dectector_ambilight(display, &Profile_Y_H[0], &Profile_Y_V[0], &PF_Trans_Sum, 30, 13, 3);	// Erin tmp 100310
		else if(color_flag == 1)
			flag_profile_read_status = drvif_color_dragon_profile_dectector_ambilight(display, &Profile_U_H[0], &Profile_U_V[0], &PF_Trans_Sum, 30, 13, 3);
		else if(color_flag == 2)
			flag_profile_read_status = drvif_color_dragon_profile_dectector_ambilight(display, &Profile_V_H[0], &Profile_V_V[0], &PF_Trans_Sum, 30, 13, 3);

		//ROSPrintf("color_flag=%d,=%d\n",color_flag,flag_profile_read_status);

		if(color_flag == flag_profile_read_status)
		{
			color_flag = (flag_profile_read_status>=2)? 0: flag_profile_read_status+1;
			if(color_flag == 0)
			{
				scalerVIP_yuv2rgb_convert();
				Profile_RGB_data_flag_H = 1;
				Profile_RGB_data_flag_V = 1;
			}
		}
	//==============================================

}
#endif

//Elsie 20130425: seperated from Auto MA
//********************************************************************************
//***** DCR Function ********
void scalerVIP_DCR(void)
{
/* ========================== ===================*/
/* === Get DCR Table form VIP Table ====================== */
/* ============================================== */
	scalerVIP_setDcrTable();
	scalerVIP_Set_DCR_BackLightMappingRange();

/* ========================== ======*/
/* === DCR Driver ====================== */
/* =================================*/
	if(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV003){
		scalerVIP_DCR_TV003();
	}

	/*m_nTV057_New_DCR==1       use Panasonic DCR*/
	if(m_nTV057_New_DCR){//panasonic DCR from Mac1 20130624
		scalerVIP_DCR_TV057();
	}

	/*m_nTPV_New_DCR >=0   use TPV DCR*/
	if(m_nTPV_New_DCR>0){
		scalerVIP_DCR_TV015();
	} else { // default TV001 DCR

		scalerVIP_DCR_OLD();
	}

//********************************************************************************
}

void scalerVIP_DCR_TV057(void)
{
#if 1
	if((MA_print_count % 300) == 0)
	{
		ROSPrintf("===PANASONIC_New_DCR===\n");
	}

#endif

	unsigned char  APL=0,YMax=0,APL_osd0=0,APL_lowerbound=0,YMAX_lowerbound=0,APL_lowerbound_osd0=0;
	unsigned char interpolation_value=0,interpolation_value_osd0=0;
	unsigned char Set_PWMValue=0,breakflag=0;
	unsigned char i,j;
	short his_mean_value_scale16_235=0;
	unsigned char peak_mean_diff=0;
	unsigned char APLflag=0;
	unsigned char  OSDBL_ratio=0;

	his_mean_value_scale16_235=scalerVIP_get_Mean_and_Peak_Value_in_SmartFit();//0~100
#if 0
	if((MA_print_count % 300) == 0)
	{
			ROSPrintf("[Young]his_mean_value_scale16_235=%d\n", his_mean_value_scale16_235);
		ROSPrintf("[Young]========scalerVIP_DCR=========\n");
		for(i=0;i<DCR_NUM_OSD;i++)//to find the APL curve PWM value
		{
			ROSPrintf("\n");
			for(j=0;j<DCR_NUM_APL;j++)
				ROSPrintf("%d\t", PWM_table_tv057[i*12+j]);
		}
		ROSPrintf("\n");
	}
#endif

	peak_mean_diff= ABS((SmartPic_clue->Hist_Peak_White_IRE_Value),(SmartPic_clue->Hist_Y_Mean_Value));
	APLflag=((SmartPic_clue->Hist_Y_MAX_bin_ratio)>=99) && (peak_mean_diff<=5);
	if(APLflag )//choose APL Curve or YMAX curve
	{
		for(i=0;i<DCR_NUM_OSD;i++)//to find the APL curve PWM value
		{
			for(j=0;j<DCR_NUM_APL;j++)
			{
				if( (m_BL_LV_From_User<=OSD_LEVEL[i]) && (his_mean_value_scale16_235<=(APL_LEVEL[j])) )
				{
				#if 0
					if((MA_print_count % 300) == 0)
					{
						ROSPrintf("[PANA_DCR]i=%d--j=%d\n", i, j);
					}
				#endif

				/*
					APL= Duty_APL_OSD[i][j];
					APL_lowerbound=Duty_APL_OSD[i][((j-1)<0)?0:(j-1)];

					APL_osd0= Duty_APL_OSD[((i-1)<0)?0:(i-1)][j];
					APL_lowerbound_osd0=Duty_APL_OSD[((i-1)<0)?0:(i-1)][((j-1)<0)?0:(j-1)];*/

					APL= PWM_table_tv057[i*12+j];
					APL_lowerbound=PWM_table_tv057[i*12+(((j-1)<0)?0:(j-1))];

					APL_osd0= PWM_table_tv057[(((i-1)<0)?0:(i-1))*12+j];
					APL_lowerbound_osd0=PWM_table_tv057[(((i-1)<0)?0:(i-1))*12+(((j-1)<0)?0:(j-1))];

					//ROSPrintf("m_nPANASONIC_New_DCR---Duty_APL[%d]=%d-----APL=%d-------\n",i,Duty_APL[i],APL);
					//======interpolation duty==========

					if( (i==0) && (j==0))
					{
						Set_PWMValue=APL;
					}
					else if(i==0)
					{

						interpolation_value=((APL-APL_lowerbound)*(his_mean_value_scale16_235-APL_LEVEL[((j-1)<0)?0:(j-1)])/(APL_LEVEL[j]-APL_LEVEL[((j-1)<0)?0:(j-1)]))+APL_lowerbound;
						Set_PWMValue=interpolation_value;

					}
					else if(j==0)
					{
						interpolation_value=APL;
						interpolation_value_osd0=APL_osd0;
						Set_PWMValue=(interpolation_value-interpolation_value_osd0)*(m_BL_LV_From_User-OSD_LEVEL[((i-1)<0)?0:(i-1)])/(OSD_LEVEL[i]-OSD_LEVEL[((i-1)<0)?0:(i-1)])+interpolation_value_osd0;
					}
					else
					{
						interpolation_value=((APL-APL_lowerbound)*(his_mean_value_scale16_235-APL_LEVEL[j-1])/(APL_LEVEL[j]-APL_LEVEL[j-1]))+APL_lowerbound;
						interpolation_value_osd0=((APL_osd0-APL_lowerbound_osd0)*(his_mean_value_scale16_235-APL_LEVEL[j-1])/(APL_LEVEL[j]-APL_LEVEL[j-1]))+APL_lowerbound_osd0;
						Set_PWMValue=(interpolation_value-interpolation_value_osd0)*(m_BL_LV_From_User-OSD_LEVEL[i-1])/(OSD_LEVEL[i]-OSD_LEVEL[i-1])+interpolation_value_osd0;
					}
					//setPWM=(interpolation_value-interpolation_value_osd0)*(m_BL_LV_From_User-OSD_LEVEL[((i-1)<0)?0:(i-1)])/(OSD_LEVEL[i]-OSD_LEVEL[((i-1)<0)?0:(i-1)])+interpolation_value_osd0;

					breakflag=1;
					break;

				}

			}
			if(breakflag==1)
				break;
		}
	} else {
		// for YMAX interpolation
		for(i=0;i<DCR_NUM_APL;i++) {
			if((SmartPic_clue->Hist_Peak_White_IRE_Value)<=(APL_LEVEL[i])) {
					YMax = Duty_YMax[i];
					YMAX_lowerbound=Duty_YMax[((i-1)<0)?0:(i-1)];
					if(i==0)
						Set_PWMValue=YMax;
					else
						Set_PWMValue=((YMax-YMAX_lowerbound)*((SmartPic_clue->Hist_Peak_White_IRE_Value)-APL_LEVEL[((i-1)<0)?0:(i-1)])/(APL_LEVEL[i]-APL_LEVEL[((i-1)<0)?0:(i-1)]))+YMAX_lowerbound;
					break;
			}
		}
			OSDBL_ratio=m_BL_LV_From_User*255/100;//ratio
			Set_PWMValue=OSDBL_ratio*(Set_PWMValue-37)/255+37;
	}
#if 0
		if((MA_print_count % 300) == 0)
		{

			ROSPrintf("[PANA_DCR]-APL=%d--APL_lowerbound=%d, interpolation_value=%d-\n", APL, APL_lowerbound,interpolation_value);
			ROSPrintf("[PANA_DCR]-APL_osd0=%d--APL_lowerbound_osd0=%d-\n", APL_osd0, APL_lowerbound_osd0);
			ROSPrintf("[PANA_DCR]-YMax=%d--YMAX_lowerbound=%d, Set_PWMValue=%d-APLflag=%d\n", YMax, YMAX_lowerbound,Set_PWMValue,APLflag);
			ROSPrintf("[PANA_DCR]---Mean_value=%d---DCC_Histogram_MAX_ratio=%d,peak_mean_diff=%d----\n",DCC_Histogram_Mean_value,DCC_Histogram_MAX_ratio,peak_mean_diff);
		}

#endif
	//Set_PWMValue=((Set_PWMValue*100)*10)/996;//PWMvalue scale to Dutyvalue
	Set_PWMValue = Set_PWMValue &0xFF;

	drvif_color_ma_DCR_TV057(Set_PWMValue);

}



void scalerVIP_DCR_TV003(void)
{
	unsigned char frames_num = 10;
	static unsigned char frames_count = 0;
	static unsigned short TV_003_APL[10] = {0};
	static unsigned short TV_003_PeakLevel[10] = {0};
	static unsigned short TV_003_APL_avg_sum = 0;
	static unsigned short TV_003_PeakLevel_sum = 0;
	unsigned char TV_003_APL_avg = 0, TV_003_PeakLevel_avg = 0, nMappingValue;
	unsigned char i=0;

	unsigned char PeakLevel_low = TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_PeakLevel_low*100>>8;		//range 0~255 to 0~100
	unsigned char PeakLevel_high = TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_PeakLevel_high*100>>8;//range 0~255 to 0~100
	unsigned char PeakLevel_thl = TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_PeakLevel_thl;
	unsigned char APL_low = TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_APL_low;
	unsigned char APL_high = TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_APL_high;
	unsigned char APL_thl = TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_APL_thl;

	if(TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_En)
	{
		unsigned char  APL=0;
		unsigned int  PeakLevel=SmartPic_clue->Hist_Y_Mean_Value;
		APL = scalerVIP_get_Mean_and_Peak_Value_in_SmartFit_003(TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_H_rate, TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_V_rate);

		//PeakLevel range 0~100
		if(PeakLevel < PeakLevel_low)
			PeakLevel = 0;
		else if(PeakLevel > PeakLevel_high)
			PeakLevel = 100;
		else
			PeakLevel = (((PeakLevel - PeakLevel_low) * 100) + ((PeakLevel_high-PeakLevel_low)>>1))/(PeakLevel_high-PeakLevel_low);

		//APL range 0~100
		if(APL < APL_low)
			APL = 0;
		else if(APL > APL_high)
			APL = 100;
		else
			APL = (((APL - APL_low) * 100) + ((APL_high-APL_low)>>1))/(APL_high-APL_low);

		if(frames_count < frames_num)
		{
			TV_003_APL[MA_print_count%frames_num] = APL;
			TV_003_PeakLevel[MA_print_count%frames_num] = PeakLevel;
			TV_003_APL_avg_sum = TV_003_APL_avg_sum + APL;
			TV_003_PeakLevel_sum = TV_003_PeakLevel_sum + PeakLevel;
			frames_count++;
		}
		else
		{
			TV_003_APL_avg_sum = 0;
			TV_003_PeakLevel_sum = 0;
			//TV_003_APL_avg_sum = TV_003_APL_avg_sum - TV_003_APL[MA_print_count%frames_num] + APL;
			//TV_003_PeakLevel_sum = TV_003_PeakLevel_sum - TV_003_PeakLevel[MA_print_count%frames_num] + PeakLevel;
			TV_003_APL[MA_print_count%frames_num] = APL;
			TV_003_PeakLevel[MA_print_count%frames_num] = PeakLevel;
			for(i=0; i<frames_num; i++)
			{
				TV_003_APL_avg_sum += TV_003_APL[i];
				TV_003_PeakLevel_sum += TV_003_PeakLevel[i];
			}
		}

		if(frames_count == 0)
			return;
#if 0
		if(MA_print_count%60==0)
		{
			ROSPrintf("PeakLevel_low = %d, PeakLevel_high = %d\n",PeakLevel_low, PeakLevel_high);
			ROSPrintf("APL = %d, PeakLevel = %d, DCC_Histogram_Mean_value = %d\n",APL, PeakLevel, DCC_Histogram_Mean_value);
			ROSPrintf("TV_003_APL_avg_sum = %d, TV_003_PeakLevel_sum = %d\n",TV_003_APL_avg_sum, TV_003_PeakLevel_sum);
			ROSPrintf("TV_003_APL = ");
			for(i=0; i<frames_num; i++)
				ROSPrintf("%d	",TV_003_APL[i]);
			ROSPrintf("\n");
		}
#endif
		TV_003_APL_avg = TV_003_APL_avg_sum / frames_count;
		TV_003_PeakLevel_avg = TV_003_PeakLevel_sum / frames_count;
#if 0
		if(MA_print_count%60==0)
			ROSPrintf("TV_003_APL_avg = %d, TV_003_PeakLevel_avg = %d\n",TV_003_APL_avg, TV_003_PeakLevel_avg);
#endif
		if(TV_003_PeakLevel_avg < PeakLevel_thl && TV_003_APL_avg < APL_thl)
			nMappingValue = TV_003_APL_avg*255/APL_thl;
		else
			nMappingValue = 255;
#if 0
		if(MA_print_count%60==0)
			ROSPrintf("nMappingValue= %d\n",nMappingValue);
#endif
//		scalerVIP_IoGpio_SetPwmDuty(m_PIN_BL_ADJ, nMappingValue);
		TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_nMappingValue = nMappingValue;

		return;
	}
	else
	{
		frames_count = 0;
		TV_003_APL_avg_sum = 0;
		TV_003_PeakLevel_sum = 0;
		TV003_share_memory_struct->TV003_Active_Backlight.TV003_ABL_nMappingValue = 255;
		return;
	}
}

void scalerVIP_DCR_TV015(void)
{

#if DCR_DEBUG_TPV
	if((MA_print_count % 300) == 0) {
		ROSPrintf("m_nTPV_New_DCR = %d\n",m_nTPV_New_DCR);
		ROSPrintf("m_DCR_On_Off = %d\n",m_DCR_On_Off);
		ROSPrintf("m_bDefault_OFF = %d\n",m_bDefault_OFF);
	}
#endif

	if( !m_bDefault_OFF && !m_DCR_On_Off && m_nTPV_New_DCR >0){ // Default On & OSD SET OFF

		short nMappingValue;
		if(m_isIncreaseMode)
			nMappingValue = (m_BL_LV_From_User-0)*(m_BL_LV_Act_Max - m_BL_LV_Act_Min)/(100-0)+ m_BL_LV_Act_Min;
		else
			nMappingValue = m_BL_LV_Act_Max - ((m_BL_LV_From_User-0)*(m_BL_LV_Act_Max - m_BL_LV_Act_Min)/(100-0)+ m_BL_LV_Act_Min);

		//Set Pwm Duty
		nMappingValue&= 0xFF;
		if(BL_prev != m_BL_LV_From_User)
		    scalerVIP_IoGpio_SetPwmDuty(m_PIN_BL_ADJ, nMappingValue);

		BL_current = m_BL_LV_From_User;
		BL_prev = BL_current;
	} else {
		if(m_nTPV_New_DCR == 1 )
		{
			scalerVIP_DCR_TPV();
		}
		else if(m_nTPV_New_DCR == 2 )
		{
			scalerVIP_DCR_TPV_TV();
		}
		else if(m_nTPV_New_DCR == 3 )
		{
			scalerVIP_DCR_TPV_2694A();
		}
		else if(m_nTPV_New_DCR == 4 )
		{
			scalerVIP_DCR_TPV_TV_2694A();
		}
	}

}



unsigned char  scalerVIP_get_Mean_and_Peak_Value_in_SmartFit(void)//sync form panasonic, can be use for pattern Recognize
{
	//=======================use smartfit to get mean value 20121228=====================

	vgip_vgip_chn1_act_hsta_width_RBUS vgip_chn1_act_hsta_width_reg;
	vgip_vgip_chn1_act_vsta_length_RBUS vgip_chn1_act_vsta_length_reg;

//find the input position start &end
	vgip_chn1_act_hsta_width_reg.regValue  = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg);
	vgip_chn1_act_vsta_length_reg.regValue = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_VSTA_Length_reg);

	unsigned short Hstart =14+ vgip_chn1_act_hsta_width_reg.ch1_ih_act_sta;
	unsigned short Hend = vgip_chn1_act_hsta_width_reg.ch1_ih_act_wid;
	unsigned short Vstart = 20+vgip_chn1_act_vsta_length_reg.ch1_iv_act_sta;
	unsigned short Vend = vgip_chn1_act_vsta_length_reg.ch1_iv_act_len;


//unsigned short Hstart=500,Hend=10,Vstart=10,Vend=10;
	smartfit_auto_h_boundary_RBUS auto_h_boundary_reg;
	smartfit_auto_v_boundary_RBUS auto_v_boundary_reg;
	smartfit_auto_r_g_b_margin_RBUS auto_r_g_b_margin_reg;
	smartfit_auto_adj_RBUS auto_adj_reg;
	auto_h_boundary_reg.regValue     = scaler_rtd_inl(SMARTFIT_AUTO_H_BOUNDARY_reg);
	auto_v_boundary_reg.regValue     = scaler_rtd_inl(SMARTFIT_AUTO_V_BOUNDARY_reg);
	auto_r_g_b_margin_reg.regValue  =scaler_rtd_inl(SMARTFIT_AUTO_R_G_B_MARGIN_reg);
	auto_adj_reg.regValue                 = scaler_rtd_inl(SMARTFIT_AUTO_ADJ_reg);

	//H & V boundary setting
		auto_h_boundary_reg.hb_sta = Hstart;
		auto_h_boundary_reg.hb_end= Hend;
		auto_v_boundary_reg.vb_sta=Vstart;
		auto_v_boundary_reg.vb_end=Vend;

		scaler_rtd_outl(SMARTFIT_AUTO_H_BOUNDARY_reg, auto_h_boundary_reg.regValue);
		scaler_rtd_outl(SMARTFIT_AUTO_V_BOUNDARY_reg, auto_v_boundary_reg.regValue);

	//Color Source Select for Detection //20070713 SmartFit YUV definition's wrong on ver.FIB !! Notice whether spec. been changed?

			auto_r_g_b_margin_reg.color_sel=0x02;//auto_r_g_b_margin_reg.color_sel=0x1;


	//MIN color measured, Accumulation Mode, Start Auto-Function Tracking Function
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
		auto_adj_reg.force_flip_ = 1;
#else
                auto_adj_reg.force_flip = 1;
#endif
		auto_adj_reg.sum_max	 = 1;
		auto_adj_reg.now_af	 = 1;
		auto_adj_reg.diff_en =0;


	smartfit_auto_field_RBUS auto_field_reg;
	smartfit_auto_result_phase_m_RBUS auto_result_phase_m_reg;
	smartfit_auto_result_phase_l_RBUS auto_result_phase_l_reg;
	auto_field_reg.regValue = scaler_rtd_inl(SMARTFIT_AUTO_FIELD_reg);

	unsigned long long SUM;
	unsigned  int  PxlNum,Hlength,vlength,PxlNum2;
	unsigned  int  PEAK = 0;

//	if(Scaler_DispGetInputInfo(SLR_INPUT_CHANNEL))
//		auto_field_reg.adj_source = 1;//sub(channel 2)
//	else
		auto_field_reg.adj_source = 0;//main(channel 1)

	scaler_rtd_outl(SMARTFIT_AUTO_FIELD_reg,auto_field_reg.regValue);

	auto_r_g_b_margin_reg.diff_th = 0;
	scaler_rtd_outl(SMARTFIT_AUTO_R_G_B_MARGIN_reg,auto_r_g_b_margin_reg.regValue);


			auto_result_phase_m_reg.regValue =  scaler_rtd_inl(SMARTFIT_AUTO_RESULT_PHASE_M_reg);
			auto_result_phase_l_reg.regValue =  scaler_rtd_inl(SMARTFIT_AUTO_RESULT_PHASE_L_reg);

			SUM = ( ( (unsigned long long)(auto_result_phase_m_reg.acc_41_32) ) <<32) + (unsigned long long)(auto_result_phase_l_reg.acc_31_0);
			Hlength=Hend-Hstart+1;
			vlength=Vend-Vstart+1;
			PxlNum2=Hlength*vlength;
			PxlNum = (Hend-Hstart+1)*(Vend-Vstart+1);
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
			do_div(SUM, PxlNum2);
			PEAK=SUM;
#else
			PEAK = (SUM)/(PxlNum2); //PEAK value 64~940 TG45:
#endif

	scaler_rtd_outl(SMARTFIT_AUTO_ADJ_reg, auto_adj_reg.regValue);
	#if 0
		if((MA_print_count % 300) == 0)
		{
			//ROSPrintf("[Young]***,Hstart=%d,Hend=%d,Vstart=%d,Vend=%d***\n",Hstart,Hend,Vstart,Vend);
			//ROSPrintf("[Young]***Hlength=%d,vlength=%d***\n",Hlength,vlength);
			//ROSPrintf("[Young]***PxlNum=%d ,PxlNum2=%d ,***\n",PxlNum,PxlNum2);
			//ROSPrintf("[Young]***SUM=%d ***\n",SUM);
			ROSPrintf("[Young]***PEAK=%d ,***\n",PEAK);
		}
	#endif
//=======================use smartfit to get mean value 20121228=====================

	short his_mean_value_scale16_235=0;

	his_mean_value_scale16_235=((PEAK-58)*100/860);//shift the input value to 0~100

	if(his_mean_value_scale16_235<0)
		his_mean_value_scale16_235=0;
	if(his_mean_value_scale16_235>100)
		his_mean_value_scale16_235=100;

	Smartfit_Mean_value=his_mean_value_scale16_235;
	Smartfit_Frame_Sum = (unsigned int)(SUM >> 4); // scale to 32 bits
	return his_mean_value_scale16_235;
}

unsigned char  scalerVIP_get_Mean_and_Peak_Value_in_SmartFit_003(unsigned char H_rate, unsigned char V_rate)
{
	//=======================use smartfit to get mean value 20121228=====================
	unsigned short Hstart = 0;
	unsigned short Hend = 0;
	unsigned short H_rate_offset = 0;
	unsigned short H_rate_wid = 0;
	unsigned short Vstart = 0;
	unsigned short Vend = 0;
	unsigned short V_rate_offset = 0;
	unsigned short V_rate_len = 0;

	unsigned short VGIP_H_sta = 0;
	unsigned short VGIP_H_wid = 0;
	unsigned short VGIP_V_sta = 0;
	unsigned short VGIP_V_len = 0;

	vgip_vgip_chn1_act_hsta_width_RBUS vgip_chn1_act_hsta_width_reg;
	vgip_vgip_chn1_act_vsta_length_RBUS vgip_chn1_act_vsta_length_reg;
	vgip_vgip_chn1_delay_RBUS vgip_chn1_delay_reg;

//find the input position start &end
	vgip_chn1_act_hsta_width_reg.regValue  = rtd_inl(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg);
	vgip_chn1_act_vsta_length_reg.regValue = rtd_inl(VGIP_VGIP_CHN1_ACT_VSTA_Length_reg);
	vgip_chn1_delay_reg.regValue = rtd_inl(VGIP_VGIP_CHN1_DELAY_reg);


	VGIP_H_sta = vgip_chn1_act_hsta_width_reg.ch1_ih_act_sta + vgip_chn1_delay_reg.ch1_ihs_dly+2;
	VGIP_H_wid = vgip_chn1_act_hsta_width_reg.ch1_ih_act_wid;
	VGIP_V_sta = vgip_chn1_act_vsta_length_reg.ch1_iv_act_sta + vgip_chn1_delay_reg.ch1_ivs_dly;
	VGIP_V_len = vgip_chn1_act_vsta_length_reg.ch1_iv_act_len;

//unsigned short Hstart=500,Hend=10,Vstart=10,Vend=10;
	smartfit_auto_h_boundary_RBUS auto_h_boundary_reg;
	smartfit_auto_v_boundary_RBUS auto_v_boundary_reg;
	smartfit_auto_r_g_b_margin_RBUS auto_r_g_b_margin_reg;
	smartfit_auto_adj_RBUS auto_adj_reg;
	auto_h_boundary_reg.regValue     = rtd_inl(SMARTFIT_AUTO_H_BOUNDARY_reg);
	auto_v_boundary_reg.regValue     = rtd_inl(SMARTFIT_AUTO_V_BOUNDARY_reg);
	auto_r_g_b_margin_reg.regValue  = rtd_inl(SMARTFIT_AUTO_R_G_B_MARGIN_reg);
	auto_adj_reg.regValue                 = rtd_inl(SMARTFIT_AUTO_ADJ_reg);

	//H & V boundary setting
#if 1
		H_rate_wid = ((VGIP_H_wid*H_rate)/100);
		H_rate_offset =  ((VGIP_H_wid - H_rate_wid)+1)>>1;
		Hstart = VGIP_H_sta + H_rate_offset;
		Hend = Hstart + H_rate_wid;
#if 0
		if(MA_print_count%60==0)
		{
			ROSPrintf("VGIP_H_sta = %d,	VGIP_H_wid = %d\n", VGIP_H_sta, VGIP_H_wid);
			ROSPrintf("H_rate_wid = %d,	H_rate_offset = %d\n", H_rate_wid, H_rate_offset);
			ROSPrintf("Hstart = %d,	Hend = %d\n", Hstart, Hend);
		}
#endif
		V_rate_len = ((VGIP_V_len*V_rate)/100);
		V_rate_offset =  ((VGIP_V_len - V_rate_len)+1)>>1;
		Vstart = VGIP_V_sta + V_rate_offset;
		Vend = Vstart + V_rate_len;
#if 0
		if(MA_print_count%60==0)
		{
			ROSPrintf("VGIP_V_sta = %d,	VGIP_V_len = %d\n", VGIP_V_sta, VGIP_V_len);
			ROSPrintf("V_rate_len = %d,	V_rate_offset = %d\n", V_rate_len, V_rate_offset);
			ROSPrintf("Vstart = %d,	Vend = %d\n", Vstart, Vend);
		}
#endif
		auto_h_boundary_reg.hb_sta = Hstart;
		auto_h_boundary_reg.hb_end= Hend;
		auto_v_boundary_reg.vb_sta=Vstart;
		auto_v_boundary_reg.vb_end=Vend;
#endif

	rtd_outl(SMARTFIT_AUTO_H_BOUNDARY_reg, auto_h_boundary_reg.regValue);
	rtd_outl(SMARTFIT_AUTO_V_BOUNDARY_reg, auto_v_boundary_reg.regValue);

	//Color Source Select for Detection //20070713 SmartFit YUV definition's wrong on ver.FIB !! Notice whether spec. been changed?

	auto_r_g_b_margin_reg.color_sel=0x02;//auto_r_g_b_margin_reg.color_sel=0x1;

	//MIN color measured, Accumulation Mode, Start Auto-Function Tracking Function
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
	auto_adj_reg.force_flip_ = 1;
#else
        auto_adj_reg.force_flip = 1;
#endif
	auto_adj_reg.sum_max	 = 1;
	auto_adj_reg.now_af	 = 1;
	auto_adj_reg.diff_en =0;


	smartfit_auto_field_RBUS auto_field_reg;
	smartfit_auto_result_phase_m_RBUS auto_result_phase_m_reg;
	smartfit_auto_result_phase_l_RBUS auto_result_phase_l_reg;
	auto_field_reg.regValue = rtd_inl(SMARTFIT_AUTO_FIELD_reg);

	unsigned long long SUM;
	unsigned  int  PxlNum,Hlength,vlength,PxlNum2;
	unsigned  int  PEAK = 0;

//	if(Scaler_DispGetInputInfo(SLR_INPUT_CHANNEL))
//		auto_field_reg.adj_source = 1;//sub(channel 2)
//	else
		auto_field_reg.adj_source = 0;//main(channel 1)

	rtd_outl(SMARTFIT_AUTO_FIELD_reg,auto_field_reg.regValue);

	auto_r_g_b_margin_reg.diff_th = 0;
	rtd_outl(SMARTFIT_AUTO_R_G_B_MARGIN_reg,auto_r_g_b_margin_reg.regValue);


	auto_result_phase_m_reg.regValue =  rtd_inl(SMARTFIT_AUTO_RESULT_PHASE_M_reg);
	auto_result_phase_l_reg.regValue =  rtd_inl(SMARTFIT_AUTO_RESULT_PHASE_L_reg);

	SUM = ( ( (unsigned long long)(auto_result_phase_m_reg.acc_41_32) ) <<32) + (unsigned long long)(auto_result_phase_l_reg.acc_31_0);
#if 0
	if(MA_print_count%60==0)
		ROSPrintf("SUM_ = %d\n", (auto_result_phase_l_reg.acc_31_0));
#endif
	smartfit_auto_result_hsta_end_RBUS auto_result_hsta_end_reg;
	smartfit_auto_result_vsta_end_RBUS auto_result_vsta_end_reg;
	auto_result_hsta_end_reg.regValue  = rtd_inl(SMARTFIT_AUTO_RESULT_HSTA_END_reg);
	auto_result_vsta_end_reg.regValue = rtd_inl(SMARTFIT_AUTO_RESULT_VSTA_END_reg);

	Hstart = auto_result_hsta_end_reg.hx_sta;
	Hend = auto_result_hsta_end_reg.hx_end;
	Vstart = auto_result_vsta_end_reg.vx_sta;
	Vend = auto_result_vsta_end_reg.vx_end;

	Hlength=Hend-Hstart+1;
	vlength=Vend-Vstart+1;
	PxlNum2=Hlength*vlength;
	PxlNum = (Hend-Hstart)*(Vend-Vstart);
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
	do_div(SUM, PxlNum2);
	PEAK=SUM;
#else
	PEAK = (SUM)/(PxlNum2); //PEAK value 64~940 TG45:
#endif


	rtd_outl(SMARTFIT_AUTO_ADJ_reg, auto_adj_reg.regValue);
	#if 0
//		if((MA_print_count % 300) == 0)
//		{
			printf("[Young]***,Hstart=%d,Hend=%d,Vstart=%d,Vend=%d***\n",Hstart,Hend,Vstart,Vend);
			printf("[Young]***Hlength=%d,vlength=%d***\n",Hlength,vlength);
			printf("[Young]***PxlNum=%d ,PxlNum2=%d ,***\n",PxlNum,PxlNum2);
			printf("[Young]***SUM=%d ***\n",SUM);
			printf("[Young]***PEAK=%d ,***\n",PEAK);
//		}
	#endif
//=======================use smartfit to get mean value 20121228=====================
#if 0
	if(MA_print_count%60==0)
		ROSPrintf("(PEAK>>2) = %d\n", (PEAK>>2));
#endif

	return (PEAK>>2);
}

//============================Elsie 20130425: color mpeg========================

static unsigned int counter_ratio_sum = 0;

int scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[9][8]={
	{0,0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,0}
};
int scalerVIP_color_noise_mpeg_h_detect__HisCntHor[8]={0,0,0,0,0,0,0,0};
int scalerVIP_color_noise_mpeg_h_detect__a_scaling[9]={0x1000,0x1000,0x1000,0,0,0,0,0,0};//{0x1000,0x1000,0x1000,0x1555,0x1555,0x1555,0x2aab,0x2aab,0x2aab};//{0x1000,0x1555,0,0x2000,0x2aab,0,0,0,0};//
int scalerVIP_color_noise_mpeg_h_detect__amax1p[3][9]={{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0}};
int scalerVIP_color_noise_mpeg_h_detect__a2[3][9]={{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0}};
int scalerVIP_color_noise_mpeg_h_detect__a3[3][9]={{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0}};
int scalerVIP_color_noise_mpeg_h_detect__x3L=0x2000;// minimum detail
int scalerVIP_color_noise_mpeg_h_detect__x3R=0x3000;// maximum detail
int scalerVIP_color_noise_mpeg_h_detect__xwidth=1920;
int scalerVIP_color_noise_mpeg_h_detect__xheight=1080;
int scalerVIP_color_noise_mpeg_h_detect__x_requires_ver=0;
int scalerVIP_color_noise_mpeg_h_detect__x_pipeline=0;
int scalerVIP_color_noise_mpeg_h_detect__x_ub_ub=18;
int scalerVIP_color_noise_mpeg_h_detect__yen=0;
int scalerVIP_color_noise_mpeg_h_detect__yub=0;// higher means more detail
int scalerVIP_color_noise_mpeg_h_detect__yub2=0;// higher means more blocking effect
int scalerVIP_color_noise_mpeg_h_detect__y_scaling=0;
int scalerVIP_color_noise_mpeg_h_detect__y_turn=8;// winning turn
int scalerVIP_color_noise_mpeg_h_detect__y_max1p=0;// the bin with the largest number
int scalerVIP_color_noise_mpeg_h_detect__z_mad=0;
int scalerVIP_color_noise_mpeg_h_detect__z_mad_pre=-88;
int scalerVIP_color_noise_mpeg_h_detect__z_mad_wait=0;
int scalerVIP_color_noise_mpeg_h_detect__z_scaling=0;
int scalerVIP_color_noise_mpeg_h_detect__z_turn=8;
int scalerVIP_color_noise_mpeg_detect_y=0;
int scalerVIP_color_noise_mpeg_detect_x_by_motion_en=1;
int scalerVIP_color_noise_mpeg_detect_y_by_motion=0;
//#define mpegnr_h_170705h 1
#if 1//mpegnr_h_170705h
#define Min(a, b)   ( ((a) < (b)) ? (a) : (b) )
unsigned int RTNR_MAD_count_Y3_count=0;
unsigned int MCNR_GMV_Ratio = 0;
void scalerVIP_color_noise_mpeg_detect(void){
	int i=0;
	int z=0;
	int z_max1=0;
	int z_max2=0;
	//int z_max2p=0;
	int x2=0;// block effect level detected
	int x20=0;// block effect ratio * 256
	int x2L=0x800;
	int y2L=0;
	int x2R=0x2000;
	int y2R=256;
	int x2div=0x80;
	int x3=0;
	int y3L=48;
	int y3R=12;
	int x3div=0x80;
	int ratio_W1=0x500;
	int ratio_W2=0x800;
	int ratio_W1_=0;
	int ratio_W2_=0;
	int x2_=0;
	int x3L_=0;
	int x3R_=0;
	int x3_=0;
	int x2L_= 0;
	int x2R_= 0;
	int z_mad_d=0;
	static int static_cnt = 180;
	static int is_static_cnt_tsin_ku = 0;

	mpegnr_ich1_cnthor0_RBUS ich1_CntHor0_reg;
	mpegnr_ich1_cnthor1_RBUS ich1_CntHor1_reg;
	mpegnr_ich1_cnthor2_RBUS ich1_CntHor2_reg;
	mpegnr_ich1_cnthor3_RBUS ich1_CntHor3_reg;
	mpegnr_ich1_cnthor4_RBUS ich1_CntHor4_reg;
	mpegnr_ich1_cnthor5_RBUS ich1_CntHor5_reg;
	mpegnr_ich1_cnthor6_RBUS ich1_CntHor6_reg;
	mpegnr_ich1_cnthor7_RBUS ich1_CntHor7_reg;
	di_im_di_rtnr_control_RBUS di_im_di_rtnr_control_r;
	nr_dch1_mpegnr1_RBUS	nr_dch1_mpegnr1_r;
	int scalerVIP_color_noise_mpeg_detect_y_ =0;


	_system_setting_info *VIP_system_info_structure_table = (_system_setting_info*)Scaler_GetShareMemVirAddr(SCALERIOC_VIP_system_info_structure);
	unsigned char PQA_table_select = scaler_GetShare_Memory_system_setting_info_Struct()->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_table_select;
	unsigned int *pPQA_InputMAD_MPEG = &(scaler_GetShare_Memory_VIP_TABLE_Struct()->PQA_Input_Table[PQA_table_select][I_MPEG_MAD][0]);
	if(VIP_system_info_structure_table ==NULL || pPQA_InputMAD_MPEG ==NULL ){
		return;
	}
	scalerVIP_color_noise_mpeg_h_detect__z_turn=scalerVIP_color_noise_mpeg_h_detect__z_turn<8?scalerVIP_color_noise_mpeg_h_detect__z_turn+1:0;
	scalerVIP_color_noise_mpeg_h_detect__z_scaling=scalerVIP_color_noise_mpeg_h_detect__a_scaling[scalerVIP_color_noise_mpeg_h_detect__z_turn];
	// different resolution (default 1920*1080)
	scalerVIP_color_noise_mpeg_h_detect__xwidth=VIP_system_info_structure_table->I_Width;
	scalerVIP_color_noise_mpeg_h_detect__xheight=VIP_system_info_structure_table->I_Height;
	di_im_di_rtnr_control_r.regValue=IoReg_Read32(DI_IM_DI_RTNR_CONTROL_reg);
	ich1_CntHor0_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor0_reg);
	ich1_CntHor1_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor1_reg);
	ich1_CntHor2_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor2_reg);
	ich1_CntHor3_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor3_reg);
	ich1_CntHor4_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor4_reg);
	ich1_CntHor5_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor5_reg);
	ich1_CntHor6_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor6_reg);
	ich1_CntHor7_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor7_reg);
	if(di_im_di_rtnr_control_r.cp_rtnr_progressive==1){
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[0]=ich1_CntHor0_reg.cp_cnthor0;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[1]=ich1_CntHor1_reg.cp_cnthor1;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[2]=ich1_CntHor2_reg.cp_cnthor2;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[3]=ich1_CntHor3_reg.cp_cnthor3;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[4]=ich1_CntHor4_reg.cp_cnthor4;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[5]=ich1_CntHor5_reg.cp_cnthor5;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[6]=ich1_CntHor6_reg.cp_cnthor6;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[7]=ich1_CntHor7_reg.cp_cnthor7;
	}else{
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[0]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][0]+ich1_CntHor0_reg.cp_cnthor0;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[1]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][1]+ich1_CntHor1_reg.cp_cnthor1;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[2]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][2]+ich1_CntHor2_reg.cp_cnthor2;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[3]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][3]+ich1_CntHor3_reg.cp_cnthor3;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[4]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][4]+ich1_CntHor4_reg.cp_cnthor4;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[5]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][5]+ich1_CntHor5_reg.cp_cnthor5;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[6]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][6]+ich1_CntHor6_reg.cp_cnthor6;
		scalerVIP_color_noise_mpeg_h_detect__HisCntHor[7]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][7]+ich1_CntHor7_reg.cp_cnthor7;
	}
	scalerVIP_color_noise_mpeg_h_detect__a_scaling[3]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[4]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[5]=0;
	scalerVIP_color_noise_mpeg_h_detect__a_scaling[6]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[7]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[8]=0;
	switch((RPC_system_info_structure_table->VIP_source)){
		case VIP_QUALITY_HDMI_4k2kI_30:
		case VIP_QUALITY_HDMI_4k2kP_30:
		case VIP_QUALITY_HDMI_4k2kP_60:
		case VIP_QUALITY_DTV_4k2kI_30:
		case VIP_QUALITY_DTV_4k2kP_30:
		case VIP_QUALITY_DTV_4k2kP_60:
		case VIP_QUALITY_PVR_4k2kI_30:
		case VIP_QUALITY_PVR_4k2kP_30:
		case VIP_QUALITY_PVR_4k2kP_60:
			scalerVIP_color_noise_mpeg_h_detect__a_scaling[3]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[4]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[5]=0x1555;
			scalerVIP_color_noise_mpeg_h_detect__a_scaling[6]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[7]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[8]=0x2aab;
		break;
		case VIP_QUALITY_HDMI_720P:
		case VIP_QUALITY_YPbPr_720P:
		case VIP_QUALITY_DTV_720P:
		case VIP_QUALITY_PVR_720P:
			scalerVIP_color_noise_mpeg_h_detect__a_scaling[3]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[4]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[5]=0x1c71;
		break;
		case VIP_QUALITY_HDMI_1080I:
		case VIP_QUALITY_HDMI_1080P:
		case VIP_QUALITY_YPbPr_1080I:
		case VIP_QUALITY_YPbPr_1080P:
		case VIP_QUALITY_PVR_1080I:
		case VIP_QUALITY_PVR_1080P:
			scalerVIP_color_noise_mpeg_h_detect__a_scaling[3]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[4]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[5]=0x1555;
			scalerVIP_color_noise_mpeg_h_detect__a_scaling[6]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[7]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[8]=0x2aab;
		break;
		case VIP_QUALITY_DTV_1080I:
		case VIP_QUALITY_DTV_1080P:
			scalerVIP_color_noise_mpeg_h_detect__a_scaling[3]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[4]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[5]=0x1555;
			scalerVIP_color_noise_mpeg_h_detect__a_scaling[6]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[7]=scalerVIP_color_noise_mpeg_h_detect__a_scaling[8]=0x2aab;
		break;
		case VIP_QUALITY_YPbPr_480I:
		case VIP_QUALITY_YPbPr_576I:
		case VIP_QUALITY_HDMI_480I:
		case VIP_QUALITY_HDMI_576I:
			//
		break;
		case VIP_QUALITY_YPbPr_480P:
		case VIP_QUALITY_YPbPr_576P:
		case VIP_QUALITY_HDMI_480P:
		case VIP_QUALITY_HDMI_576P:
			//
		break;
		case VIP_QUALITY_DTV_480P:
		case VIP_QUALITY_DTV_576P:
		case VIP_QUALITY_PVR_480P:
		case VIP_QUALITY_PVR_576P:
			//
		break;
		case VIP_QUALITY_DTV_480I:
		case VIP_QUALITY_DTV_576I:
		case VIP_QUALITY_PVR_480I:
		case VIP_QUALITY_PVR_576I:
			//
		break;
		case VIP_QUALITY_CVBS_NTSC:
		case VIP_QUALITY_CVBS_PAL:
			//
		break;
		default:
			//
		break;
	}

	nr_dch1_mpegnr1_r.regValue=IoReg_Read32(NR_DCH1_MPEGNR1_reg);

	do{
		if(
			(scalerVIP_color_noise_mpeg_h_detect__z_scaling<0x800)
			||(!scalerVIP_color_noise_mpeg_h_detect__x_pipeline&&scalerVIP_color_noise_mpeg_h_detect__z_turn%3!=2)
		){
			for(i=2;i>=0;i--){
				scalerVIP_color_noise_mpeg_h_detect__amax1p[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]=0;
				scalerVIP_color_noise_mpeg_h_detect__a2[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]=0;
				scalerVIP_color_noise_mpeg_h_detect__a3[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]=0;
			}
			break;
		}
			//*
		if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
			printk(
				KERN_INFO "\n[histhor_ori] %d %06x %06x %06x %06x %06x %06x %06x %06x[/histhor_ori]"
				,scalerVIP_color_noise_mpeg_h_detect__z_scaling
				,ich1_CntHor0_reg.cp_cnthor0
				,ich1_CntHor1_reg.cp_cnthor1
				,ich1_CntHor2_reg.cp_cnthor2
				,ich1_CntHor3_reg.cp_cnthor3
				,ich1_CntHor4_reg.cp_cnthor4
				,ich1_CntHor5_reg.cp_cnthor5
				,ich1_CntHor6_reg.cp_cnthor6
				,ich1_CntHor7_reg.cp_cnthor7
			);
		}
		if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
			printk(
				KERN_INFO "\n[histhor] %d %06x %06x %06x %06x %06x %06x %06x %06x[/histhor]"
				,scalerVIP_color_noise_mpeg_h_detect__z_scaling
				,scalerVIP_color_noise_mpeg_h_detect__HisCntHor[0]
				,scalerVIP_color_noise_mpeg_h_detect__HisCntHor[1]
				,scalerVIP_color_noise_mpeg_h_detect__HisCntHor[2]
				,scalerVIP_color_noise_mpeg_h_detect__HisCntHor[3]
				,scalerVIP_color_noise_mpeg_h_detect__HisCntHor[4]
				,scalerVIP_color_noise_mpeg_h_detect__HisCntHor[5]
				,scalerVIP_color_noise_mpeg_h_detect__HisCntHor[6]
				,scalerVIP_color_noise_mpeg_h_detect__HisCntHor[7]
			);
		}
			//*/
		scalerVIP_color_noise_mpeg_h_detect__y_max1p=0;
		z_max1=scalerVIP_color_noise_mpeg_h_detect__HisCntHor[0];
		z_max2=0;
		for(i=1;i<8;i++){
			z=scalerVIP_color_noise_mpeg_h_detect__HisCntHor[i];
			if(z>z_max1){
				z_max2=z_max1;
				scalerVIP_color_noise_mpeg_h_detect__y_max1p=i;
				z_max1=z;
			}
			else if(z>z_max2){
				z_max2=z;
			}
		}
#if 1
		if((scalerVIP_color_noise_mpeg_detect_x_by_motion_en == 1) && !(nr_dch1_mpegnr1_r.cp_mpglowerbound&0x08) ){

			MCNR_GMV_Ratio = 100 - scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio();//MCNR_GMV_Ratio : 100 -> 0 ( still -> motion )
			if(RTNR_MAD_count_Y3_count > (RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio)){
				RTNR_MAD_count_Y3_count = RTNR_MAD_count_Y3_count - (((RTNR_MAD_count_Y3_count - (RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio))>>3) + 1);
			}
			else if(((RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio) > (RTNR_MAD_count_Y3_count+10))) {
				RTNR_MAD_count_Y3_count = RTNR_MAD_count_Y3_count + ((((RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio) - RTNR_MAD_count_Y3_count)>>3) + 1) ;
			}

			scalerVIP_color_noise_mpeg_h_detect__z_mad=RTNR_MAD_count_Y3_count;
			if(scalerVIP_color_noise_mpeg_h_detect__z_mad_pre<=-88){
				scalerVIP_color_noise_mpeg_h_detect__z_mad_wait=0;
			}else{
				z_mad_d=scalerVIP_color_noise_mpeg_h_detect__z_mad-scalerVIP_color_noise_mpeg_h_detect__z_mad_pre;
				scalerVIP_color_noise_mpeg_h_detect__z_mad_wait=scalerVIP_color_noise_mpeg_h_detect__z_mad_wait+5-z_mad_d;
			}
			scalerVIP_color_noise_mpeg_h_detect__z_mad_pre=scalerVIP_color_noise_mpeg_h_detect__z_mad;
			if(scalerVIP_color_noise_mpeg_h_detect__z_mad_wait<0){
				scalerVIP_color_noise_mpeg_h_detect__z_mad_wait=0;
			}
			RTNR_MAD_count_Y3_count=RTNR_MAD_count_Y3_count+scalerVIP_color_noise_mpeg_h_detect__z_mad_wait;

			if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L00]){
				ratio_W1 = 0x500;
				ratio_W2 = 0x800;
			}else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L01]){
				ratio_W1 = 0x480;
				ratio_W2 = 0x780;
			}else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L02]){
				ratio_W1 = 0x400;
				ratio_W2 = 0x700;
			}else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L03]){
				ratio_W1 = 0x380;
				ratio_W2 = 0x680;
			}else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L04]){
				ratio_W1 = 0x300;
				ratio_W2 = 0x600;
			}else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L05]){
				ratio_W1 = 0x300;
				ratio_W2 = 0x580;
			}else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L06]){
				ratio_W1 = 0x300;
				ratio_W2 = 0x500;
			}else{
				ratio_W1 = 0x300;
				ratio_W2 = 0x500;
			}
			if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
				printk(
					KERN_INFO "\n[motion]%d %d %d %08x, [/motion]"
					,RTNR_MAD_count_Y3_avg
					,MCNR_GMV_Ratio
					,RTNR_MAD_count_Y3_count
					,z_max2>0?(z_max1<<8)/z_max2:0
					);
			}

			//scalerVIP_color_noise_mpeg_detect_y = (scalerVIP_color_noise_mpeg_detect_y*scalerVIP_color_noise_mpeg_detect_y_by_motion)>>5;

		}
#endif
		if((nr_dch1_mpegnr1_r.cp_mpglowerbound&0x08) ){
			x20 = ratio_W2;
		} else {
			x20=z_max2>0?(z_max1<<8)/z_max2:0;
		}

		if(x2L==x2R){
			scalerVIP_color_noise_mpeg_detect_y_by_motion=x2L;
		}else if(ratio_W1==ratio_W2){
			scalerVIP_color_noise_mpeg_detect_y_by_motion=(x2L+x2R)>>1;
		}else if(x20<=ratio_W1){
			scalerVIP_color_noise_mpeg_detect_y_by_motion=x2L;
		}else if(x20>=ratio_W2){
			scalerVIP_color_noise_mpeg_detect_y_by_motion=x2R;
		}else{
			x2div=1;//ratio_W2-ratio_W1>x2L-x2R?(abs_value((ratio_W2-ratio_W1)/(x2L-x2R))+1)>>1:1;
			ratio_W1_=((ratio_W1+(x2div>>1))/x2div)|0;
			ratio_W2_=((ratio_W2+(x2div>>1))/x2div)|0;
			x2_=((x20+(x2div>>1))/x2div)|0;
			scalerVIP_color_noise_mpeg_detect_y_by_motion=(x2L*(ratio_W2_-x2_)+x2R*(x2_-ratio_W1_)+((ratio_W2_-ratio_W1_)>>1))/(ratio_W2_-ratio_W1_);
		}

		if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
			printk(
				KERN_INFO "\n[x2,x3] %d ,%d, %d [/x2,x3]"
				,(z_max1-z_max2)
				,scalerVIP_color_noise_mpeg_detect_y_by_motion
				,-z_max1-z_max2
				);
		}

		x2=Min(z_max1-z_max2,scalerVIP_color_noise_mpeg_detect_y_by_motion);
		x3=-z_max1-z_max2;
		for(i=0;i<8;i++){
			x3=x3+scalerVIP_color_noise_mpeg_h_detect__HisCntHor[i];
		}
		for(i=2;i>0;i--){
			scalerVIP_color_noise_mpeg_h_detect__amax1p[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]=scalerVIP_color_noise_mpeg_h_detect__amax1p[i-1][scalerVIP_color_noise_mpeg_h_detect__z_turn];
			scalerVIP_color_noise_mpeg_h_detect__a2[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]=scalerVIP_color_noise_mpeg_h_detect__a2[i-1][scalerVIP_color_noise_mpeg_h_detect__z_turn];
			scalerVIP_color_noise_mpeg_h_detect__a3[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]=scalerVIP_color_noise_mpeg_h_detect__a3[i-1][scalerVIP_color_noise_mpeg_h_detect__z_turn];
		}
		x2=(x2*1920/scalerVIP_color_noise_mpeg_h_detect__xwidth*1080/scalerVIP_color_noise_mpeg_h_detect__xheight)|0;
		x3=(x3*320/scalerVIP_color_noise_mpeg_h_detect__xwidth*1080/scalerVIP_color_noise_mpeg_h_detect__xheight)|0;// 320 = 1920 / 6
		if(di_im_di_rtnr_control_r.cp_rtnr_progressive==0){
			x2=x2>>1;
			x3=x3>>1;
		}
		scalerVIP_color_noise_mpeg_h_detect__amax1p[0][scalerVIP_color_noise_mpeg_h_detect__z_turn]=scalerVIP_color_noise_mpeg_h_detect__y_max1p;
		scalerVIP_color_noise_mpeg_h_detect__a2[0][scalerVIP_color_noise_mpeg_h_detect__z_turn]=x2;
		scalerVIP_color_noise_mpeg_h_detect__a3[0][scalerVIP_color_noise_mpeg_h_detect__z_turn]=x3;
			/*
			printk(
				KERN_EMERG "\n[mpegnr_h] %d %d %d %d %d %d %d[/mpegnr_h]",
				scalerVIP_color_noise_mpeg_h_detect__z_turn,
				scalerVIP_color_noise_mpeg_h_detect__y_turn,
				(scalerVIP_color_noise_mpeg_h_detect__z_turn!=scalerVIP_color_noise_mpeg_h_detect__y_turn?1:0)|(scalerVIP_color_noise_mpeg_h_detect__y_turn<9?2:0),
				scalerVIP_color_noise_mpeg_h_detect__z_scaling,
				x2,
				scalerVIP_color_noise_mpeg_h_detect__a2[1][scalerVIP_color_noise_mpeg_h_detect__y_turn],
				scalerVIP_color_noise_mpeg_h_detect__a2[scalerVIP_color_noise_mpeg_h_detect__y_turn>scalerVIP_color_noise_mpeg_h_detect__z_turn?2:0][scalerVIP_color_noise_mpeg_h_detect__y_turn]
			);
			//*/
		if(
			scalerVIP_color_noise_mpeg_h_detect__y_max1p!=scalerVIP_color_noise_mpeg_h_detect__amax1p[1][scalerVIP_color_noise_mpeg_h_detect__z_turn] ||
			scalerVIP_color_noise_mpeg_h_detect__y_max1p!=scalerVIP_color_noise_mpeg_h_detect__amax1p[2][scalerVIP_color_noise_mpeg_h_detect__z_turn]
		){
			if(scalerVIP_color_noise_mpeg_h_detect__y_turn==scalerVIP_color_noise_mpeg_h_detect__z_turn){
				scalerVIP_color_noise_mpeg_h_detect__yen=0;
				for(i=0;i<3;i++){
					scalerVIP_color_noise_mpeg_h_detect__a2[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]=0;
				}
			}
			break;
		}
		if(scalerVIP_color_noise_mpeg_h_detect__z_turn!=scalerVIP_color_noise_mpeg_h_detect__y_turn&&scalerVIP_color_noise_mpeg_h_detect__y_turn<9){
			if(
				x2<x3div+scalerVIP_color_noise_mpeg_h_detect__a2[1][scalerVIP_color_noise_mpeg_h_detect__y_turn]
				&&x2<x3div+scalerVIP_color_noise_mpeg_h_detect__a2[scalerVIP_color_noise_mpeg_h_detect__y_turn>scalerVIP_color_noise_mpeg_h_detect__z_turn?2:0][scalerVIP_color_noise_mpeg_h_detect__y_turn]
			){break;}
		}
		scalerVIP_color_noise_mpeg_h_detect__y_turn=scalerVIP_color_noise_mpeg_h_detect__z_turn;
		for(i=2;i>0;i--){
			if(x2>scalerVIP_color_noise_mpeg_h_detect__a2[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]){x2=scalerVIP_color_noise_mpeg_h_detect__a2[i][scalerVIP_color_noise_mpeg_h_detect__z_turn];}
			if(x3<scalerVIP_color_noise_mpeg_h_detect__a3[i][scalerVIP_color_noise_mpeg_h_detect__z_turn]){x3=scalerVIP_color_noise_mpeg_h_detect__a3[i][scalerVIP_color_noise_mpeg_h_detect__z_turn];}
		}
		if(scalerVIP_color_noise_mpeg_h_detect__a_scaling[scalerVIP_color_noise_mpeg_h_detect__y_turn]>0x1000){
			x3=(x3*scalerVIP_color_noise_mpeg_h_detect__a_scaling[scalerVIP_color_noise_mpeg_h_detect__y_turn])>>12;
		}
		if(y3L==y3R){
			scalerVIP_color_noise_mpeg_h_detect__yub=y3L;
		}else if(scalerVIP_color_noise_mpeg_h_detect__x3L==scalerVIP_color_noise_mpeg_h_detect__x3R){
			scalerVIP_color_noise_mpeg_h_detect__yub=(y3L+y3R)>>1;
		}else if(x3<=scalerVIP_color_noise_mpeg_h_detect__x3L){
			scalerVIP_color_noise_mpeg_h_detect__yub=y3L;
		}else if(x3>=scalerVIP_color_noise_mpeg_h_detect__x3R){
			scalerVIP_color_noise_mpeg_h_detect__yub=y3R;
		}else{
			// x3div=(abs_value(y3L-y3R)+1)>>1;
			x3L_=((scalerVIP_color_noise_mpeg_h_detect__x3L+(x3div>>1))/x3div)|0;
			x3R_=((scalerVIP_color_noise_mpeg_h_detect__x3R+(x3div>>1))/x3div)|0;
			x3_=((x3+(x3div>>1))/x3div)|0;
			scalerVIP_color_noise_mpeg_h_detect__yub=(y3L*(x3R_-x3_)+y3R*(x3_-x3L_)+((x3R_-x3L_)>>1))/(x3R_-x3L_);
		}
		if(y2L==y2R){
			scalerVIP_color_noise_mpeg_h_detect__yub2=y2L;
		}else if(x2L==x2R){
			scalerVIP_color_noise_mpeg_h_detect__yub2=(y2L+y2R)>>1;
		}else if(x2<=x2L){
			scalerVIP_color_noise_mpeg_h_detect__yub2=y2L;
		}else if(x2>=x2R){
			scalerVIP_color_noise_mpeg_h_detect__yub2=y2R;
		}else{
			x2div=((y2L<y2R?y2R-y2L:(y2L-y2R))+1)>>1;
			x2L_=((x2L+(x2div>>1))/x2div)|0;
			x2R_=((x2R+(x2div>>1))/x2div)|0;
			x2_=((x2+(x2div>>1))/x2div)|0;
			scalerVIP_color_noise_mpeg_h_detect__yub2=(y2L*(x2R_-x2_)+y2R*(x2_-x2L_)+((x2R_-x2L_)>>1))/(x2R_-x2L_);
		}
		scalerVIP_color_noise_mpeg_h_detect__yen=1;
		if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
			printk(
				KERN_INFO "\n[yub]%d ,%d, [/yub]"
				,scalerVIP_color_noise_mpeg_h_detect__yub
				,scalerVIP_color_noise_mpeg_h_detect__yub2
				);
		}

	if(di_im_di_rtnr_control_r.cp_rtnr_progressive!=1){
		for(i=0;i<8;i++){
			scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][i]=scalerVIP_color_noise_mpeg_h_detect__HisCntHor[i]-scalerVIP_color_noise_mpeg_h_detect__HisCntHor_pre[scalerVIP_color_noise_mpeg_h_detect__z_turn][i];
		}
	}

		scalerVIP_color_noise_mpeg_detect_y_=(scalerVIP_color_noise_mpeg_h_detect__yub*scalerVIP_color_noise_mpeg_h_detect__yub2)>>8;
		if(scalerVIP_color_noise_mpeg_detect_y_>scalerVIP_color_noise_mpeg_h_detect__x_ub_ub){
			scalerVIP_color_noise_mpeg_detect_y_=scalerVIP_color_noise_mpeg_h_detect__x_ub_ub;
		}
	if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
			printk(
					KERN_INFO "\n[pre_mpeg_detect_y]%d %d %d %d %d %d [/pre_mpeg_detect_y]"
				,scalerVIP_color_noise_mpeg_detect_y
				,scalerVIP_color_noise_mpeg_detect_y_
				,RTNR_MAD_count_Y3_count
					,static_cnt
					,scalerVIP_color_noise_mpeg_h_detect__z_mad_pre
					,scalerVIP_color_noise_mpeg_h_detect__z_mad
				);
	}

		if(scalerVIP_color_noise_mpeg_h_detect__z_mad != 0){
		static_cnt = 180;
		scalerVIP_color_noise_mpeg_detect_y = scalerVIP_color_noise_mpeg_detect_y_;
	} else {
			if(static_cnt>=-999 ){
				static_cnt -=3;
				is_static_cnt_tsin_ku=0;
				if(static_cnt>0){
					is_static_cnt_tsin_ku=1;
				}else
				if(static_cnt<-30){
					static_cnt+=30;
					is_static_cnt_tsin_ku=1;
				}
				if(is_static_cnt_tsin_ku){
			if(scalerVIP_color_noise_mpeg_detect_y_>scalerVIP_color_noise_mpeg_detect_y){
				scalerVIP_color_noise_mpeg_detect_y=scalerVIP_color_noise_mpeg_detect_y+1;
			}
			//else if(scalerVIP_color_noise_mpeg_detect_y_<scalerVIP_color_noise_mpeg_detect_y){
			//	scalerVIP_color_noise_mpeg_detect_y=scalerVIP_color_noise_mpeg_detect_y-1;
			//}
				}
			if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
				printk(
					KERN_INFO "\n[mpeg_detect_y]%d [/mpeg_detect_y]"
					,scalerVIP_color_noise_mpeg_detect_y
					);
			}
		}
			if(static_cnt <=-999)
				static_cnt =-999;


			}
	}while(false);

#if 0
	if((scalerVIP_color_noise_mpeg_detect_x_by_motion_en == 1) && !(nr_dch1_mpegnr1_r.cp_mpglowerbound&0x08) ){

		MCNR_GMV_Ratio = 100 - scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio();//MCNR_GMV_Ratio : 100 -> 0 ( still -> motion )
		if(RTNR_MAD_count_Y3_count > (RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio)){
			RTNR_MAD_count_Y3_count = RTNR_MAD_count_Y3_count - (((RTNR_MAD_count_Y3_count - (RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio))>>3) + 1);
		}
		else if(((RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio) > (RTNR_MAD_count_Y3_count+10))) {
			RTNR_MAD_count_Y3_count = RTNR_MAD_count_Y3_count + ((((RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio) - RTNR_MAD_count_Y3_count)>>3) + 1) ;
		}

		if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L00])
			scalerVIP_color_noise_mpeg_detect_y_by_motion = 0;
		else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L01])
			scalerVIP_color_noise_mpeg_detect_y_by_motion = 5 ;
		else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L02])
			scalerVIP_color_noise_mpeg_detect_y_by_motion = 10;
		else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L03])
			scalerVIP_color_noise_mpeg_detect_y_by_motion = 20;
		else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L04])
			scalerVIP_color_noise_mpeg_detect_y_by_motion = 25;
		else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L05])
			scalerVIP_color_noise_mpeg_detect_y_by_motion = 32;
		else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L06])
			scalerVIP_color_noise_mpeg_detect_y_by_motion = 32;
		else
			scalerVIP_color_noise_mpeg_detect_y_by_motion = 32;

		if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
			printk(
				KERN_INFO "\n[motion]%d %d %d %d, [/motion]"
				,RTNR_MAD_count_Y3_avg
				,MCNR_GMV_Ratio
				,RTNR_MAD_count_Y3_count
				,scalerVIP_color_noise_mpeg_detect_y_by_motion
				);
		}

		scalerVIP_color_noise_mpeg_detect_y = (scalerVIP_color_noise_mpeg_detect_y*scalerVIP_color_noise_mpeg_detect_y_by_motion)>>5;


	}
#endif

}
#else
static unsigned int counter_ratio_sum = 0;

void scalerVIP_color_noise_mpeg_detect(void)
{

	_RPC_clues* RPC_SmartPic_clue=NULL;
	RPC_SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();

	if((RPC_SmartPic_clue->S_NetFlix_info.Netflix_Enable) ==1)
	{
		if((RPC_SmartPic_clue->S_NetFlix_info.NetFlix_smooth_Toggle_info.MPEG_BLK_init)==1)
		{
			RPC_SmartPic_clue->S_NetFlix_info.NetFlix_smooth_Toggle_info.MPEG_BLK_init=0;
			return;
		}

	}


	unsigned short   temp = 0;
	unsigned int   MaxValue = 0, SecondMaxValue;
	unsigned short   MaxValue_V, SecondMaxValue_V;
	unsigned char   i, RTNR_Pro;
	unsigned int  MpegRatio, MpegRatio_V;
	unsigned int 	MA_data[3]={0}, RTNR_TempMAD_count_Y;
	unsigned short  width,height;

	// oliver-, not define in darwin.
	mpegnr_ich1_cnthor0_RBUS ich1_CntHor0_reg;
	mpegnr_ich1_cnthor1_RBUS ich1_CntHor1_reg;
	mpegnr_ich1_cnthor2_RBUS ich1_CntHor2_reg;
	mpegnr_ich1_cnthor3_RBUS ich1_CntHor3_reg;
	mpegnr_ich1_cnthor4_RBUS ich1_CntHor4_reg;
	mpegnr_ich1_cnthor5_RBUS ich1_CntHor5_reg;
	mpegnr_ich1_cnthor6_RBUS ich1_CntHor6_reg;
	mpegnr_ich1_cnthor7_RBUS ich1_CntHor7_reg;

	unsigned short      MpgHorStart = 0;
	unsigned short      MpgHorEnd = 0;
	unsigned short      MpgVerStart = 0;
	unsigned short      MpgVerEnd = 0;
	unsigned short      th1,th2,th3,th4;
	unsigned int		counter_H = 0, counter_ratio = 0;

	/*
	if(MA_print_count%60==0)
	{
	ROSPrintf("2.[mpeg_data_reset]ucMode_Curr=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].ucMode_Curr);
	}
	*/
	mpegnr_ich1_hist_blking_hor_range_RBUS ich1_Hist_Blking_Hor_Range_reg;
	mpegnr_ich1_hist_blking_ver_range_RBUS ich1_Hist_Blking_Ver_Range_reg;

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use rtd_t_inl in kernel
	MA_data[0] = rtd_t_inl(di_im_di_si_ma_total_fm_sum_RBUS,DI_IM_DI_SI_MA_TOTAL_FM_SUM_reg).total_frame_motion_sum;
	MA_data[1] = rtd_t_inl(di_im_di_si_ma_large_fm_pixel_RBUS,DI_IM_DI_SI_MA_LARGE_FM_PIXEL_reg).large_frame_motion_pixel;
	MA_data[2] = rtd_t_inl(di_im_di_si_ma_large_fm_sum_RBUS,DI_IM_DI_SI_MA_LARGE_FM_SUM_reg).large_frame_motion_sum;
	RTNR_TempMAD_count_Y = rtd_t_inl(di_im_di_rtnr_mad_y_counter_RBUS,DI_IM_DI_RTNR_MAD_Y_COUNTER_reg).cp_temporal_mad_countery;
	RTNR_Pro = rtd_t_inl(di_im_di_rtnr_control_RBUS,DI_IM_DI_RTNR_CONTROL_reg).cp_rtnr_progressive;
#else
	di_im_di_si_ma_total_fm_sum_RBUS ma_total_fm_sum;
	di_im_di_si_ma_large_fm_pixel_RBUS ma_large_fm_pixel;
	di_im_di_si_ma_large_fm_sum_RBUS ma_large_fm_sum;
	di_im_di_rtnr_mad_y_counter_RBUS rtnr_mad_y_counter;
	di_im_di_rtnr_control_RBUS rtnr_control;

	ma_total_fm_sum.regValue = rtd_inl(DI_IM_DI_SI_MA_TOTAL_FM_SUM_reg);
	ma_large_fm_pixel.regValue = rtd_inl(DI_IM_DI_SI_MA_LARGE_FM_PIXEL_reg);
	ma_large_fm_sum.regValue = rtd_inl(DI_IM_DI_SI_MA_LARGE_FM_SUM_reg);
	rtnr_mad_y_counter.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);
	rtnr_control.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

	MA_data[0] = ma_total_fm_sum.total_frame_motion_sum;
	MA_data[1] = ma_large_fm_pixel.large_frame_motion_pixel;
	MA_data[2] = ma_large_fm_sum.large_frame_motion_sum;
	RTNR_TempMAD_count_Y = rtnr_mad_y_counter.cp_temporal_mad_countery;
	RTNR_Pro = rtnr_control.cp_rtnr_progressive;
#endif

	//MPEG block effect detection///////////////////////////////////////////////////////
	//horizotal mpeg detection th
	ich1_Hist_Blking_Hor_Range_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_Hist_Blking_Hor_Range_reg);
	MpgHorStart = ich1_Hist_Blking_Hor_Range_reg.cp_histhorstart ;
	MpgHorEnd = ich1_Hist_Blking_Hor_Range_reg.cp_histhorend;
	// scaler_rtd_outl(MPEGNR_ICH1_HIST_BLKING_HOR_RANGE_reg, ich1_Hist_Blking_Hor_Range_reg.regValue);

	ich1_Hist_Blking_Ver_Range_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_Hist_Blking_Ver_Range_reg);
	MpgVerStart = ich1_Hist_Blking_Ver_Range_reg.cp_histverstart ;
	MpgVerEnd = ich1_Hist_Blking_Ver_Range_reg.cp_histverend;
	// scaler_rtd_outl(MPEGNR_ICH1_HIST_BLKING_HOR_RANGE_reg, ich1_Hist_Blking_Ver_Range_reg.regValue);

	// //scalervip_printf(AutoMADebugMsg,"o---MpgHorStart=%d, MpgHorEnd=%d---o\n",MpgHorStart,MpgHorEnd);
	// //scalervip_printf(AutoMADebugMsg,"o---MpgVerStart=%d, MpgVerEnd=%d---o\n",MpgVerStart,MpgVerEnd);

	width=MpgHorEnd-MpgHorStart;
	height=MpgVerEnd-MpgVerStart;
	th4=(width*height)>>9;//300
	th3=width*height/1152;//300
	th2=th3/3;
	th1=th3/30;

	if(xstep_idx_detect==1)
	{
		th4 =th4*9/16;
		th3 =th3*9/16;
		th2 =th2*9/16;
		th1 =th1*9/16;

	}
	else if(xstep_idx_detect==2)
	{
		th4 =th4*3/8;
		th3 =th3*3/8;
		th2 =th2*3/8;
		th1 =th1*3/8;

	}


	//read horizontal counter to get MpgIdx_X
	//horizontal
	MaxValue = 0;
	SecondMaxValue = 0;
	ich1_CntHor0_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor0_reg);
	ich1_CntHor1_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor1_reg);
	ich1_CntHor2_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor2_reg);
	ich1_CntHor3_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor3_reg);
	ich1_CntHor4_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor4_reg);
	ich1_CntHor5_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor5_reg);
	ich1_CntHor6_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor6_reg);
	ich1_CntHor7_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CntHor7_reg);
	for(i=0;i<8;i++)//read hor 8 counters
	{
		switch(i)
		{
		case 0:
			temp=ich1_CntHor0_reg.cp_cnthor0;
			break;
		case 1:
			temp=ich1_CntHor1_reg.cp_cnthor1;
			break;
		case 2:
			temp=ich1_CntHor2_reg.cp_cnthor2;
			break;
		case 3:
			temp=ich1_CntHor3_reg.cp_cnthor3;
			break;
		case 4:
			temp=ich1_CntHor4_reg.cp_cnthor4;
			break;
		case 5:
			temp=ich1_CntHor5_reg.cp_cnthor5;
			break;
		case 6:
			temp=ich1_CntHor6_reg.cp_cnthor6;
			break;
		case 7:
			temp=ich1_CntHor7_reg.cp_cnthor7;
			break;
		}
		if(MaxValue <= temp)
		{
			SecondMaxValue = MaxValue;
			MaxValue = temp;
			MpgIdx_X = i;
		}
		else if(SecondMaxValue <= temp)
		{
			SecondMaxValue = temp;
		}
#if 0 // mark for always big weight, 20170704
		counter_H= counter_H + temp;
#endif
	}

#if 0 // mark for smooth MpegRatio, 20170704

	if( (SecondMaxValue<th1) || (SecondMaxValue==0) )
		MpegRatio=0;
	else if(SecondMaxValue<th2)
		MpegRatio=(((MaxValue<<6)/SecondMaxValue)/8);
	else if(SecondMaxValue<th3)
		MpegRatio=(((MaxValue<<6)/SecondMaxValue)/4);
	else if(SecondMaxValue<th4)
		MpegRatio=(((MaxValue<<6)/SecondMaxValue)/2);
	else
		MpegRatio=(MaxValue<<6)/SecondMaxValue;
#else
	counter_H = MaxValue-SecondMaxValue;
	if( (SecondMaxValue<th1) || (SecondMaxValue==0) ){
		MpegRatio=0;
	}else if(SecondMaxValue<th2){
		MpegRatio=(16*(SecondMaxValue-th1))/(th2-th1);
	}else if(SecondMaxValue<th3){
		MpegRatio=16+(16*(SecondMaxValue-th2))/(th3-th2);
	}else if(SecondMaxValue<th4){
		MpegRatio=32+(32*(SecondMaxValue-th3))/(th4-th3);
	}else{
		MpegRatio=64;
	}
	MpegRatio=MpegRatio*(MaxValue-SecondMaxValue)/SecondMaxValue/64;

#endif

	if( (MA_print_count%debug_print_delay_time==0) && (Start_Print.Mpeg_Nr==TRUE) )
	{
		//ROSPrintf("\nField_Count=%d", Field_Count);
		//ROSPrintf("\nxstep=%d", array_xstep[xstep_idx_detect]);
		//ROSPrintf("\nth1 = %d, th2 = %d, th3 = %d th4 = %d\n", th1, th2, th3, th4);
		printk(KERN_EMERG "\nMaxValue = %d, SecondMaxValue = %d, MpegRatio = %d, MpgIdx_X = %d\n", MaxValue, SecondMaxValue, MpegRatio, MpgIdx_X);
	}

	if( (Field_Count%MpegIdxPeriod)==1 )
	{
		MpgIdx_X_arr[(Field_Count/MpegIdxPeriod)%4] =	MpgIdx_X;
		if(Start_Print.Mpeg_Nr==TRUE)
		{
			printk(KERN_EMERG "\nField_Count=%d\n", Field_Count);
			printk(KERN_EMERG "MpegIdxPeriod=%d\n", MpegIdxPeriod);
			printk(KERN_EMERG "MpgIdx_X=%d\n", MpgIdx_X);
		}
	}

	MpegRatioSum+=MpegRatio;//sony demo
	MpegRatioSum_Count++;//sony demo
	Field_Count++;//sony demo
	MpegCounter_H+=counter_H;

#if 1
	if(Start_Print.Mpeg_Nr==TRUE)
	{

		if(MA_print_count%MpegPeriod==0)//sony demo
		{
			printk(KERN_EMERG "o--- scalerVIP_color_noise_mpeg Debug print ---o\n");
			printk(KERN_EMERG "o---MpegCounter_H = %d, counter_H = %d---o\n", MpegCounter_H, counter_H);
#if 0
			ROSPrintf("o---MpgHorStart = %d, MpgHorEnd = %d, MpgVerStart = %d,MpgVerEnd = %d  ---o\n", MpgHorStart, MpgHorEnd, MpgVerStart, MpgVerEnd);
			ROSPrintf("o---th1 = %d, th2 = %d, th3 = %d---o\n", th1, th2, th3);
			ROSPrintf("o---cp_cnthor0 = %d, cp_cnthor1 = %d, cp_cnthor2 = %d, cp_cnthor3=%d---o\n", ich1_CntHor0_reg.cp_cnthor0, ich1_CntHor0_reg.cp_cnthor1, ich1_CntHor2_reg.cp_cnthor2, ich1_CntHor2_reg.cp_cnthor3);
			ROSPrintf("o---cp_cnthor4 = %d, cp_cnthor5 = %d, cp_cnthor6 = %d, cp_cnthor7=%d---o\n", ich1_CntHor4_reg.cp_cnthor4, ich1_CntHor4_reg.cp_cnthor5, ich1_CntHor6_reg.cp_cnthor6, ich1_CntHor6_reg.cp_cnthor7);
			ROSPrintf("o---MaxValue = %d, SecondMaxValue = %d, MpegRatio = %d, MpgIdx_X = %d---o\n", MaxValue, SecondMaxValue, MpegRatio, MpgIdx_X);
			ROSPrintf("o---scalerVip_mpegNR = %d, TableNR_MPEGNR_H = %d, TableNR_MPEGNR_V = %d---o\n", scalerVip_mpegNR, TableNR_MPEGNR_H, TableNR_MPEGNR_V);
#endif
		}
	}
#endif

	//MpegRatioSum+=MpegRatio;//sony demo original
	//MpegRatioSum_Count++;//sony demo original

	//Field_Count++;//sony demo original

	//adjust register for every MpegPeriod input fields///////////////////////////////////////////////////////////////////
	if(th3!=0)
		counter_ratio = (counter_H*10/th3);//ratio of total pixel

	counter_ratio_sum = counter_ratio_sum+counter_ratio;

#if 0
	if(MA_print_count%MpegPeriod==0)
	{
		ROSPrintf("o---MpgHorStart = %d, MpgHorEnd = %d, MpgVerStart = %d,MpgVerEnd = %d  ---o\n", MpgHorStart, MpgHorEnd, MpgVerStart, MpgVerEnd);
		ROSPrintf("o---MpgHor = %d,MpgVer = %d, Sum_total = %d  ---o\n", (MpgHorEnd-MpgHorStart), (MpgVerEnd-MpgVerStart), (MpgHorEnd-MpgHorStart)*(MpgVerEnd-MpgVerStart));
		ROSPrintf("o---counter_H = %d, counter_ratio = %d  ---o\n", counter_H,counter_ratio);
		ROSPrintf("o---counter_ratio_sum = %d,MpegRatioSum=%d---o\n", counter_ratio_sum,MpegRatioSum);
		ROSPrintf("o---MpegRatioSum_Count = %d---o\n", MpegRatioSum_Count);
	}
#endif
}
#endif

int scalerVIP_color_noise_mpeg_v_detect__VisCntVer[8]={0,0,0,0,0,0,0,0};
int scalerVIP_color_noise_mpeg_v_detect__a_scaling[9]={0x1000,0x1000,0x1000,0x1e00,0x1e00,0x1e00,0x2000,0x2000,0x2000};//{0x1000,0x1000,0x1000,0,0,0,0,0,0};//{0x1000,0,0,0x2000,0,0x1e00,0,0x2400,0};//
int scalerVIP_color_noise_mpeg_v_detect__amax1p[3][9]={{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0}};
int scalerVIP_color_noise_mpeg_v_detect__a2[3][9]={{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0}};
int scalerVIP_color_noise_mpeg_v_detect__a3[3][9]={{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0}};
int scalerVIP_color_noise_mpeg_v_detect__x3L=0x2000;// minimum detail
int scalerVIP_color_noise_mpeg_v_detect__x3R=0x3000;// maximum detail
int scalerVIP_color_noise_mpeg_v_detect__xwidth=1920;
int scalerVIP_color_noise_mpeg_v_detect__xheight=1080;
int scalerVIP_color_noise_mpeg_v_detect__x_pipeline=0;
int scalerVIP_color_noise_mpeg_v_detect__x_requires_hor=1;
int scalerVIP_color_noise_mpeg_v_detect__yen=0;
int scalerVIP_color_noise_mpeg_v_detect__yub=0;// higher means more detail
int scalerVIP_color_noise_mpeg_v_detect__yub2=0;// higher means more blocking effect
int scalerVIP_color_noise_mpeg_v_detect__y_scaling=0;
int scalerVIP_color_noise_mpeg_v_detect__y_turn=8;// winning turn
int scalerVIP_color_noise_mpeg_v_detect__y_max1p=0;// the bin with the largest number
int scalerVIP_color_noise_mpeg_v_detect__z_scaling=0;
int scalerVIP_color_noise_mpeg_v_detect__z_turn=8;
int scalerVIP_color_noise_mpeg_v_detect_y=0;
void scalerVIP_color_noise_mpeg_v_detect(void){
	int i=0,j=0,k=0;
	int z=0;
	int z_max1=0;
	int z_max2=0;
	//int z_max2p=0;
	int x2=0;// block effect level detected
	int x2L=0x800;
	int y2L=0;
	int x2R=0x2000;
	int y2R=256;
	int x2div=0x80;
	int x3=0;
	int y3L=48;
	int y3R=12;
	int x3div=0x80;
	int x2L_=0;
	int x2R_=0;
	int x2_=0;


	nr_dch1_mpegnr1_RBUS	nr_dch1_mpegnr1_r;
	nr_dch1_viscntver0_RBUS nr_dch1_viscntver0_r;
	nr_dch1_viscntver1_RBUS nr_dch1_viscntver1_r;
	nr_dch1_viscntver2_RBUS nr_dch1_viscntver2_r;
	nr_dch1_viscntver3_RBUS nr_dch1_viscntver3_r;
	nr_dch1_viscntver4_RBUS nr_dch1_viscntver4_r;
	nr_dch1_viscntver5_RBUS nr_dch1_viscntver5_r;
	nr_dch1_viscntver6_RBUS nr_dch1_viscntver6_r;
	nr_dch1_viscntver7_RBUS nr_dch1_viscntver7_r;
	di_im_di_rtnr_control_RBUS di_im_di_rtnr_control_r;


	_system_setting_info *VIP_system_info_structure_table = (_system_setting_info*)Scaler_GetShareMemVirAddr(SCALERIOC_VIP_system_info_structure);
	scalerVIP_color_noise_mpeg_v_detect__z_turn=scalerVIP_color_noise_mpeg_v_detect__z_turn<8?scalerVIP_color_noise_mpeg_v_detect__z_turn+1:0;
	scalerVIP_color_noise_mpeg_v_detect__z_scaling=scalerVIP_color_noise_mpeg_v_detect__a_scaling[scalerVIP_color_noise_mpeg_v_detect__z_turn];

	//debug for resolution detector!if enable -> disable the V_MPEG resolution detector
	nr_dch1_mpegnr1_r.regValue=IoReg_Read32(NR_DCH1_MPEGNR1_reg);

	// different resolution (default 1920*1080)
	scalerVIP_color_noise_mpeg_v_detect__xwidth=VIP_system_info_structure_table->I_Width;
	scalerVIP_color_noise_mpeg_v_detect__xheight=VIP_system_info_structure_table->I_Height;
	nr_dch1_viscntver0_r.regValue=IoReg_Read32(NR_DCH1_VisCntVer0_reg);
	scalerVIP_color_noise_mpeg_v_detect__VisCntVer[0]=nr_dch1_viscntver0_r.cp_viscntver0;
	nr_dch1_viscntver1_r.regValue=IoReg_Read32(NR_DCH1_VisCntVer1_reg);
	scalerVIP_color_noise_mpeg_v_detect__VisCntVer[1]=nr_dch1_viscntver1_r.cp_viscntver1;
	nr_dch1_viscntver2_r.regValue=IoReg_Read32(NR_DCH1_VisCntVer2_reg);
	scalerVIP_color_noise_mpeg_v_detect__VisCntVer[2]=nr_dch1_viscntver2_r.cp_viscntver2;
	nr_dch1_viscntver3_r.regValue=IoReg_Read32(NR_DCH1_VisCntVer3_reg);
	scalerVIP_color_noise_mpeg_v_detect__VisCntVer[3]=nr_dch1_viscntver3_r.cp_viscntver3;
	nr_dch1_viscntver4_r.regValue=IoReg_Read32(NR_DCH1_VisCntVer4_reg);
	scalerVIP_color_noise_mpeg_v_detect__VisCntVer[4]=nr_dch1_viscntver4_r.cp_viscntver4;
	nr_dch1_viscntver5_r.regValue=IoReg_Read32(NR_DCH1_VisCntVer5_reg);
	scalerVIP_color_noise_mpeg_v_detect__VisCntVer[5]=nr_dch1_viscntver5_r.cp_viscntver5;
	nr_dch1_viscntver6_r.regValue=IoReg_Read32(NR_DCH1_VisCntVer6_reg);
	scalerVIP_color_noise_mpeg_v_detect__VisCntVer[6]=nr_dch1_viscntver6_r.cp_viscntver6;
	nr_dch1_viscntver7_r.regValue=IoReg_Read32(NR_DCH1_VisCntVer7_reg);
	scalerVIP_color_noise_mpeg_v_detect__VisCntVer[7]=nr_dch1_viscntver7_r.cp_viscntver7;
	di_im_di_rtnr_control_r.regValue=IoReg_Read32(DI_IM_DI_RTNR_CONTROL_reg);
	if(di_im_di_rtnr_control_r.cp_rtnr_progressive==0){
		scalerVIP_color_noise_mpeg_v_detect__xheight=scalerVIP_color_noise_mpeg_v_detect__xheight<<1;
	}
	do{

		if(
			(scalerVIP_color_noise_mpeg_v_detect__z_scaling<0x800)
			||(!scalerVIP_color_noise_mpeg_v_detect__x_pipeline&&scalerVIP_color_noise_mpeg_v_detect__z_turn%3!=2)
		){
			for(i=2;i>=0;i--){
				scalerVIP_color_noise_mpeg_v_detect__amax1p[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]=0;
				scalerVIP_color_noise_mpeg_v_detect__a2[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]=0;
				scalerVIP_color_noise_mpeg_v_detect__a3[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]=0;
			}
			break;
		}
			/*
		if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x80)) {//MPEG_dummy, b8025550[24:31], bit31
				printk(
				KERN_INFO "\n[V_MPEG][vistver] %d %06x %06x %06x %06x %06x %06x %06x %06x[/vistver]"
				,scalerVIP_color_noise_mpeg_v_detect__xheight
				,scalerVIP_color_noise_mpeg_v_detect__VisCntVer[0]
				,scalerVIP_color_noise_mpeg_v_detect__VisCntVer[1]
				,scalerVIP_color_noise_mpeg_v_detect__VisCntVer[2]
				,scalerVIP_color_noise_mpeg_v_detect__VisCntVer[3]
				,scalerVIP_color_noise_mpeg_v_detect__VisCntVer[4]
				,scalerVIP_color_noise_mpeg_v_detect__VisCntVer[5]
				,scalerVIP_color_noise_mpeg_v_detect__VisCntVer[6]
				,scalerVIP_color_noise_mpeg_v_detect__VisCntVer[7]
			);
		}
			//*/
		scalerVIP_color_noise_mpeg_v_detect__y_max1p=0;
		z_max1=scalerVIP_color_noise_mpeg_v_detect__VisCntVer[0];
		z_max2=0;
		for(i=1;i<8;i++){
			z=scalerVIP_color_noise_mpeg_v_detect__VisCntVer[i];
			if(z>z_max1){
				z_max2=z_max1;
				scalerVIP_color_noise_mpeg_v_detect__y_max1p=i;
				z_max1=z;
			}
			else if(z>z_max2){
				z_max2=z;
			}
		}
		x2=z_max1-z_max2;//block effect
		x3=-z_max1-z_max2;//detail
		for(i=0;i<8;i++){
			x3=x3+scalerVIP_color_noise_mpeg_v_detect__VisCntVer[i];
		}
		for(i=2;i>0;i--){
			scalerVIP_color_noise_mpeg_v_detect__amax1p[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]=scalerVIP_color_noise_mpeg_v_detect__amax1p[i-1][scalerVIP_color_noise_mpeg_v_detect__z_turn];
			scalerVIP_color_noise_mpeg_v_detect__a2[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]=scalerVIP_color_noise_mpeg_v_detect__a2[i-1][scalerVIP_color_noise_mpeg_v_detect__z_turn];
			scalerVIP_color_noise_mpeg_v_detect__a3[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]=scalerVIP_color_noise_mpeg_v_detect__a3[i-1][scalerVIP_color_noise_mpeg_v_detect__z_turn];
		}
		x2=(x2*1920/scalerVIP_color_noise_mpeg_v_detect__xwidth*1080/scalerVIP_color_noise_mpeg_v_detect__xheight)|0;
		x3=(x3*320/scalerVIP_color_noise_mpeg_v_detect__xwidth*1080/scalerVIP_color_noise_mpeg_v_detect__xheight)|0;// 320 = 1920 / 6
		scalerVIP_color_noise_mpeg_v_detect__amax1p[0][scalerVIP_color_noise_mpeg_v_detect__z_turn]=scalerVIP_color_noise_mpeg_v_detect__y_max1p;
		scalerVIP_color_noise_mpeg_v_detect__a2[0][scalerVIP_color_noise_mpeg_v_detect__z_turn]=x2;
		scalerVIP_color_noise_mpeg_v_detect__a3[0][scalerVIP_color_noise_mpeg_v_detect__z_turn]=x3;
			/*
			printk(
				KERN_EMERG "\n[mpegnr_v] %d %d %d %d %d %d %d[/mpegnr_v]",
				scalerVIP_color_noise_mpeg_v_detect__z_turn,
				scalerVIP_color_noise_mpeg_v_detect__y_turn,
				(scalerVIP_color_noise_mpeg_v_detect__z_turn!=scalerVIP_color_noise_mpeg_v_detect__y_turn?1:0)|(scalerVIP_color_noise_mpeg_v_detect__y_turn<9?2:0),
				scalerVIP_color_noise_mpeg_v_detect__z_scaling,
				x2,
				scalerVIP_color_noise_mpeg_v_detect__a2[1][scalerVIP_color_noise_mpeg_v_detect__y_turn],
				scalerVIP_color_noise_mpeg_v_detect__a2[scalerVIP_color_noise_mpeg_v_detect__y_turn>scalerVIP_color_noise_mpeg_v_detect__z_turn?2:0][scalerVIP_color_noise_mpeg_v_detect__y_turn]
			);
			//*/
		if(
			scalerVIP_color_noise_mpeg_v_detect__y_max1p!=scalerVIP_color_noise_mpeg_v_detect__amax1p[1][scalerVIP_color_noise_mpeg_v_detect__z_turn] ||
			scalerVIP_color_noise_mpeg_v_detect__y_max1p!=scalerVIP_color_noise_mpeg_v_detect__amax1p[2][scalerVIP_color_noise_mpeg_v_detect__z_turn]
		){
			if(scalerVIP_color_noise_mpeg_v_detect__y_turn==scalerVIP_color_noise_mpeg_v_detect__z_turn){
				scalerVIP_color_noise_mpeg_v_detect__yen=0;
				for(i=0;i<3;i++){
					scalerVIP_color_noise_mpeg_v_detect__a2[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]=0;
				}
			}
			break;
		}
		if(scalerVIP_color_noise_mpeg_v_detect__z_turn!=scalerVIP_color_noise_mpeg_v_detect__y_turn&&scalerVIP_color_noise_mpeg_v_detect__y_turn<9){
			if(
				x2<x3div+scalerVIP_color_noise_mpeg_v_detect__a2[1][scalerVIP_color_noise_mpeg_v_detect__y_turn]
				&&x2<x3div+scalerVIP_color_noise_mpeg_v_detect__a2[scalerVIP_color_noise_mpeg_v_detect__y_turn>scalerVIP_color_noise_mpeg_v_detect__z_turn?2:0][scalerVIP_color_noise_mpeg_v_detect__y_turn]
			){break;}
		}
		scalerVIP_color_noise_mpeg_v_detect__y_turn=scalerVIP_color_noise_mpeg_v_detect__z_turn;
		for(i=2;i>0;i--){
			if(x2>scalerVIP_color_noise_mpeg_v_detect__a2[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]){x2=scalerVIP_color_noise_mpeg_v_detect__a2[i][scalerVIP_color_noise_mpeg_v_detect__z_turn];}
			if(x3<scalerVIP_color_noise_mpeg_v_detect__a3[i][scalerVIP_color_noise_mpeg_v_detect__z_turn]){x3=scalerVIP_color_noise_mpeg_v_detect__a3[i][scalerVIP_color_noise_mpeg_v_detect__z_turn];}
		}
		if(y3L==y3R){
			scalerVIP_color_noise_mpeg_v_detect__yub=y3L;
		}else if(scalerVIP_color_noise_mpeg_v_detect__x3L==scalerVIP_color_noise_mpeg_v_detect__x3R){
			scalerVIP_color_noise_mpeg_v_detect__yub=(y3L+y3R)>>1;
		}else if(x3<=scalerVIP_color_noise_mpeg_v_detect__x3L){
			scalerVIP_color_noise_mpeg_v_detect__yub=y3L;
		}else if(x3>=scalerVIP_color_noise_mpeg_v_detect__x3R){
			scalerVIP_color_noise_mpeg_v_detect__yub=y3R;
		}else{
			// x3div=(abs_value(y3L-y3R)+1)>>1;
			int x3L_=((scalerVIP_color_noise_mpeg_v_detect__x3L+(x3div>>1))/x3div)|0;
			int x3R_=((scalerVIP_color_noise_mpeg_v_detect__x3R+(x3div>>1))/x3div)|0;
			int x3_=((x3+(x3div>>1))/x3div)|0;
			scalerVIP_color_noise_mpeg_v_detect__yub=(y3L*(x3R_-x3_)+y3R*(x3_-x3L_)+((x3R_-x3L_)>>1))/(x3R_-x3L_);
		}
		if(y2L==y2R){
			scalerVIP_color_noise_mpeg_v_detect__yub2=y2L;
		}else if(x2L==x2R){
			scalerVIP_color_noise_mpeg_v_detect__yub2=(y2L+y2R)>>1;
		}else if(x2<=x2L){
			scalerVIP_color_noise_mpeg_v_detect__yub2=y2L;
		}else if(x2>=x2R){
			scalerVIP_color_noise_mpeg_v_detect__yub2=y2R;
		}else{
			x2div=((y2L<y2R?y2R-y2L:(y2L-y2R))+1)>>1;
			x2L_=((x2L+(x2div>>1))/x2div)|0;
			x2R_=((x2R+(x2div>>1))/x2div)|0;
			x2_=((x2+(x2div>>1))/x2div)|0;
			scalerVIP_color_noise_mpeg_v_detect__yub2=(y2L*(x2R_-x2_)+y2R*(x2_-x2L_)+((x2R_-x2L_)>>1))/(x2R_-x2L_);
		}
		scalerVIP_color_noise_mpeg_v_detect__yen=1;
	}while(false);
	scalerVIP_color_noise_mpeg_v_detect_y=(scalerVIP_color_noise_mpeg_v_detect__yub*scalerVIP_color_noise_mpeg_v_detect__yub2)>>8;
}


#if 1//mpegnr_h_170705h
void scalerVIP_color_noise_mpeg_apply(void)
{
	mpegnr_ich1_blend_nr_hor_step_RBUS	mpegnr_ich1_blend_nr_hor_step_r	;
	mpegnr_ich1_mpegnr1_RBUS	mpegnr_ich1_mpegnr1_r	;
	mpegnr_ich1_mpegnr2_RBUS	mpegnr_ich1_mpegnr2_r	;
	mpegnr_ich1_mpegnr_ub_delta1_RBUS	mpegnr_ich1_mpegnr_ub_delta1_r	;
	mpegnr_ich1_mpegnr_ub_delta2_RBUS	mpegnr_ich1_mpegnr_ub_delta2_r	;
	mpegnr_ich1_det_hist_hor_step_RBUS	mpegnr_ich1_det_hist_hor_step_r	;
	mpegnr_ich1_hist_blking_hor_range_RBUS	mpegnr_ich1_hist_blking_hor_range_r	;
	mpegnr_ich1_hist_blking_ver_range_RBUS	mpegnr_ich1_hist_blking_ver_range_r	;
	nr_dch1_mpegnr1_RBUS	nr_dch1_mpegnr1_r;
	nr_dch1_mpegnr1_RBUS nr_dch1_mpegnr1_q;
	static int cnt=0;



	mpegnr_ich1_blend_nr_hor_step_r	.regValue=IoReg_Read32(	MPEGNR_ICH1_blend_NR_Hor_step_reg);
	mpegnr_ich1_mpegnr1_r	.regValue=IoReg_Read32(	MPEGNR_ICH1_MPEGNR1_reg);
	mpegnr_ich1_mpegnr2_r	.regValue=IoReg_Read32(	MPEGNR_ICH1_MPEGNR2_reg);
	mpegnr_ich1_mpegnr_ub_delta1_r	.regValue=IoReg_Read32(	MPEGNR_ICH1_MPEGNR_UB_delta1_reg);
	mpegnr_ich1_mpegnr_ub_delta2_r	.regValue=IoReg_Read32(	MPEGNR_ICH1_MPEGNR_UB_delta2_reg);
	mpegnr_ich1_det_hist_hor_step_r	.regValue=IoReg_Read32(	MPEGNR_ICH1_det_Hist_Hor_step_reg);
	mpegnr_ich1_hist_blking_hor_range_r	.regValue=IoReg_Read32(	MPEGNR_ICH1_Hist_Blking_Hor_Range_reg);
	mpegnr_ich1_hist_blking_ver_range_r	.regValue=IoReg_Read32(	MPEGNR_ICH1_Hist_Blking_Ver_Range_reg);

	nr_dch1_mpegnr1_r.regValue=IoReg_Read32(NR_DCH1_MPEGNR1_reg);

	//debug for resolution detector!if enable -> disable the H_MPEG resolution detector
	nr_dch1_mpegnr1_q.regValue=IoReg_Read32(NR_DCH1_MPEGNR1_reg);
	cnt++;

	// apply	
	if(
		0<=scalerVIP_color_noise_mpeg_h_detect__y_turn&&scalerVIP_color_noise_mpeg_h_detect__y_turn<9
		&&scalerVIP_color_noise_mpeg_h_detect__a_scaling[scalerVIP_color_noise_mpeg_h_detect__z_turn]>=0x800
		&&(!scalerVIP_color_noise_mpeg_h_detect__x_pipeline||scalerVIP_color_noise_mpeg_h_detect__z_turn%3==2)
	){
		scalerVIP_color_noise_mpeg_h_detect__y_scaling=scalerVIP_color_noise_mpeg_h_detect__a_scaling[scalerVIP_color_noise_mpeg_h_detect__y_turn];

		if(scalerVIP_color_noise_mpeg_h_detect__yen){// ||scalerVIP_color_noise_mpeg_h_detect__z_turn==scalerVIP_color_noise_mpeg_h_detect__y_turn
			if(scalerVIP_color_noise_mpeg_h_detect__x_requires_ver&&scalerVIP_color_noise_mpeg_detect_y>scalerVIP_color_noise_mpeg_v_detect_y){
				scalerVIP_color_noise_mpeg_detect_y=scalerVIP_color_noise_mpeg_v_detect_y;
			}
			mpegnr_ich1_mpegnr2_r.cp_mpegenable_x=1;
			mpegnr_ich1_blend_nr_hor_step_r.cp_mpghor_blend_xstep=scalerVIP_color_noise_mpeg_h_detect__y_scaling;
			mpegnr_ich1_mpegnr2_r.cp_mpgidx_x=scalerVIP_color_noise_mpeg_h_detect__amax1p[0][scalerVIP_color_noise_mpeg_h_detect__y_turn];
			mpegnr_ich1_mpegnr1_r.cp_mpgupperbound_x=scalerVIP_color_noise_mpeg_detect_y;
			mpegnr_ich1_mpegnr_ub_delta2_r.cp_mpgub_delta3=mpegnr_ich1_mpegnr1_r.cp_mpgupperbound_x;
			mpegnr_ich1_mpegnr_ub_delta1_r.cp_mpgub_delta2=mpegnr_ich1_mpegnr1_r.cp_mpgupperbound_x;
			if(scalerVIP_color_noise_mpeg_h_detect__y_scaling<0x1800){
				mpegnr_ich1_mpegnr_ub_delta1_r.cp_mpgub_delta1=mpegnr_ich1_mpegnr1_r.cp_mpgupperbound_x;
				mpegnr_ich1_mpegnr1_r.cp_mpgnr_filter_sel=0;
			}else{
				if(scalerVIP_color_noise_mpeg_h_detect__y_scaling<0x2000){
					mpegnr_ich1_mpegnr1_r.cp_mpgnr_filter_sel=2;
					mpegnr_ich1_mpegnr_ub_delta1_r.cp_mpgub_delta1=((scalerVIP_color_noise_mpeg_detect_y*5)/3)>>1;
				}else{
					mpegnr_ich1_mpegnr1_r.cp_mpgnr_filter_sel=1;
					mpegnr_ich1_mpegnr_ub_delta1_r.cp_mpgub_delta1=(scalerVIP_color_noise_mpeg_detect_y*2/3);
				}
			}// todo : mpegai
		}else{
			mpegnr_ich1_mpegnr2_r.cp_mpegenable_x=0;
		}


		if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
			printk(
				KERN_INFO "\n[apply_mpeg_detect_y]0x%x %d 0x%x[/apply_mpeg_detect_y]"
				,mpegnr_ich1_mpegnr1_r.cp_mpgupperbound_x
				,cnt
				,mpegnr_ich1_mpegnr1_r.regValue
				);
		}

		// write to registers
		IoReg_Write32(	MPEGNR_ICH1_blend_NR_Hor_step_reg,	mpegnr_ich1_blend_nr_hor_step_r.regValue);
		IoReg_Write32(	MPEGNR_ICH1_MPEGNR1_reg	,		mpegnr_ich1_mpegnr1_r.regValue);
		IoReg_Write32(	MPEGNR_ICH1_MPEGNR2_reg	,		mpegnr_ich1_mpegnr2_r.regValue);
		IoReg_Write32(	MPEGNR_ICH1_MPEGNR_UB_delta1_reg,	mpegnr_ich1_mpegnr_ub_delta1_r.regValue);
		IoReg_Write32(	MPEGNR_ICH1_MPEGNR_UB_delta2_reg,	mpegnr_ich1_mpegnr_ub_delta2_r.regValue);
			/*
			printk(
				KERN_EMERG "\n[mpegnr_v]jin %08x %08x %08x %08x[/mpegnr_v]",
				nr_dch1_blend_nr_ver_step_r	.regValue,
				nr_dch1_mpegnr1_r	.regValue,
				nr_dch1_mpegnr_ub_delta1_r	.regValue,
				nr_dch1_mpegnr_ub_delta2_r	.regValue
			);
			//*/
	}


	if(mpegnr_ich1_mpegnr1_r.cp_mpgupperbound_x != scalerVIP_color_noise_mpeg_detect_y){

		if((Start_Print.Mpeg_Nr==TRUE) || (nr_dch1_mpegnr1_r.cp_mpglowerbound&0x40)) {//MPEG_dummy, b8025550[24:31], bit30
		printk(
			KERN_INFO "\n[apply_mpeg_detect_y]%x %x[/apply_mpeg_detect_y]"
			,mpegnr_ich1_mpegnr1_r.cp_mpgupperbound_x
			,scalerVIP_color_noise_mpeg_detect_y
			);
		}

	}
	// next frame setting
	{
		int y_next_scaling=scalerVIP_color_noise_mpeg_h_detect__a_scaling[(scalerVIP_color_noise_mpeg_h_detect__z_turn+(scalerVIP_color_noise_mpeg_h_detect__x_pipeline?2:0))%9];
		mpegnr_ich1_hist_blking_hor_range_r.cp_histhorstart=0;
		mpegnr_ich1_hist_blking_hor_range_r.cp_histhorend=scalerVIP_color_noise_mpeg_h_detect__xwidth-1;
		mpegnr_ich1_hist_blking_ver_range_r.cp_histverstart=0;
		mpegnr_ich1_hist_blking_ver_range_r.cp_histverend=scalerVIP_color_noise_mpeg_h_detect__xheight-1;
		if(y_next_scaling>=0x800){
			if((nr_dch1_mpegnr1_q.cp_mpglowerbound&0x10)){//MPEG_dummy, b8025550[24:31], bit29
				mpegnr_ich1_det_hist_hor_step_r.cp_histhor_det_xstep=0x1000;
			}else{
				mpegnr_ich1_det_hist_hor_step_r.cp_histhor_det_xstep=y_next_scaling;
			}
			IoReg_Write32(	MPEGNR_ICH1_det_Hist_Hor_step_reg	,	mpegnr_ich1_det_hist_hor_step_r	.regValue);
			IoReg_Write32(	MPEGNR_ICH1_Hist_Blking_Hor_Range_reg	,	mpegnr_ich1_hist_blking_hor_range_r	.regValue);
			IoReg_Write32(	MPEGNR_ICH1_Hist_Blking_Ver_Range_reg	,	mpegnr_ich1_hist_blking_ver_range_r	.regValue);
		}
	}
	// db_apply
	IoReg_SetBits(MPEGNR_ICH1_GENERAL_DB_CTRL_reg, MPEGNR_ICH1_GENERAL_DB_CTRL_general_db_apply_mask); /* DB apply */
	MpegEnable_flag=mpegnr_ich1_mpegnr2_r.cp_mpegenable_x;
			/*
			printk(
				KERN_EMERG "\n[mpegnr_v]jin %d %d %d %d %d[/mpegnr_v]",
				MpegEnable_flag,
				scalerVIP_color_noise_mpeg_h_detect__z_turn,
				scalerVIP_color_noise_mpeg_h_detect__y_turn,
				scalerVIP_color_noise_mpeg_h_detect__yub,
				scalerVIP_color_noise_mpeg_h_detect__yub2
			);
			//*/
}
#else

unsigned int RTNR_MAD_count_Y3_count=0;
unsigned int MCNR_GMV_Ratio = 0;
void scalerVIP_color_noise_mpeg_apply(void)
{
	unsigned int		counter_ratio_avg =0 ;
	unsigned int		counter_ratio_th =0;
	unsigned int		MpegRatio_th =0;
	unsigned int		mpgupperbound_x_rate = 0;
	unsigned char 		mpgupperbound_x_gain =0;
	mpegnr_ich1_mpegnr2_RBUS ich1_MPEGNR2_reg;
	static unsigned int MpegRatioSum_Max = 0;
	static unsigned char cp_mpegenable_x_temp = 0,cp_mpegenable_x_temp_keep = 0;
	static signed char flag_cp_mpegenable_x=0;
	unsigned char PQA_table_select = scaler_GetShare_Memory_system_setting_info_Struct()->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_table_select;
	unsigned int *pPQA_InputMAD_MPEG = &(scaler_GetShare_Memory_VIP_TABLE_Struct()->PQA_Input_Table[PQA_table_select][I_MPEG_MAD][0]);

	nr_dch1_local_var1_RBUS dch1_local_var1_reg;
	dch1_local_var1_reg.regValue = scaler_rtd_inl(NR_DCH1_Local_Var1_reg);
	ich1_MPEGNR2_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_MPEGNR2_reg);

	if( Field_Count==MpegPeriod )
	{
		//flora, add for Sirius non8x8 detector/////////////////////////////////////////////////////////
		switch((RPC_system_info_structure_table->VIP_source))
		{
			case VIP_QUALITY_HDMI_4k2kI_30:
			case VIP_QUALITY_HDMI_4k2kP_30:
			case VIP_QUALITY_HDMI_4k2kP_60:
			case VIP_QUALITY_DTV_4k2kI_30:
			case VIP_QUALITY_DTV_4k2kP_30:
			case VIP_QUALITY_DTV_4k2kP_60:
			case VIP_QUALITY_PVR_4k2kI_30:
			case VIP_QUALITY_PVR_4k2kP_30:
			case VIP_QUALITY_PVR_4k2kP_60:
				mpgupperbound_x_gain =1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1000;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=120;
				else
					MpegRatio_th=100;
			break;

			case VIP_QUALITY_HDMI_720P:
			case VIP_QUALITY_YPbPr_720P:
			case VIP_QUALITY_DTV_720P:
			case VIP_QUALITY_PVR_720P:
				mpgupperbound_x_gain =1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1c71;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=96;
				else
					MpegRatio_th=80;
			break;
			case VIP_QUALITY_HDMI_1080I:
			case VIP_QUALITY_HDMI_1080P:
			case VIP_QUALITY_YPbPr_1080I:
			case VIP_QUALITY_YPbPr_1080P:
			case VIP_QUALITY_PVR_1080I:
			case VIP_QUALITY_PVR_1080P:
				mpgupperbound_x_gain =1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1000;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=120;
				else
					MpegRatio_th=100;
			break;
			case VIP_QUALITY_DTV_1080I:
			case VIP_QUALITY_DTV_1080P:
				mpgupperbound_x_gain =1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1000;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=340;
				else
					MpegRatio_th=330;
			break;
			case VIP_QUALITY_YPbPr_480I:
			case VIP_QUALITY_YPbPr_576I:
			case VIP_QUALITY_HDMI_480I:
			case VIP_QUALITY_HDMI_576I:

				mpgupperbound_x_gain = 1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1000;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=96;
				else
					MpegRatio_th=70;
				break;
			case VIP_QUALITY_YPbPr_480P:
			case VIP_QUALITY_YPbPr_576P:
			case VIP_QUALITY_HDMI_480P:
			case VIP_QUALITY_HDMI_576P:
				mpgupperbound_x_gain =1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1000;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=160;
				else
					MpegRatio_th=140;
			break;

			case VIP_QUALITY_DTV_480P:
			case VIP_QUALITY_DTV_576P:
			case VIP_QUALITY_PVR_480P:
			case VIP_QUALITY_PVR_576P:
				mpgupperbound_x_gain =1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1000;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=160;
				else
					MpegRatio_th=140;
			break;

			case VIP_QUALITY_DTV_480I:
			case VIP_QUALITY_DTV_576I:
			case VIP_QUALITY_PVR_480I:
			case VIP_QUALITY_PVR_576I:

				mpgupperbound_x_gain =1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1000;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=96;
				else
					MpegRatio_th=80;
				break;

			case VIP_QUALITY_CVBS_NTSC:
			case VIP_QUALITY_CVBS_PAL:

				mpgupperbound_x_gain =1;
				XSTEP_NUM=1;
				array_xstep[0]=0x1000;
				if(flag_cp_mpegenable_x==0)
					MpegRatio_th=80;
				else
					MpegRatio_th=75;

				break;

			default:
				mpgupperbound_x_gain =1;
				ich1_MPEGNR2_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_MPEGNR2_reg);
				ich1_MPEGNR2_reg.cp_mpegenable_x = 0;
				scaler_rtd_outl(MPEGNR_ICH1_MPEGNR2_reg, ich1_MPEGNR2_reg.regValue);
				return;
				break;

		}

		//debug for resolution detector!if enable -> disable the H_MPEG resolution detector
		nr_dch1_mpegnr1_RBUS nr_dch1_mpegnr1_q;
		nr_dch1_mpegnr1_q.regValue=IoReg_Read32(NR_DCH1_MPEGNR1_reg);
		if((nr_dch1_mpegnr1_q.cp_mpglowerbound&0x10))//MPEG_dummy, b8025550[24:31], bit28
			XSTEP_NUM = 1;

		xstep_idx_apply=xstep_idx_detect;
		xstep_idx_detect++;
		 if(xstep_idx_detect>=XSTEP_NUM)
			xstep_idx_detect=0;

		mpegnr_ich1_det_hist_hor_step_RBUS ich1_det_hist_hor_step_reg;
		ich1_det_hist_hor_step_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_det_Hist_Hor_step_reg);
		ich1_det_hist_hor_step_reg.cp_histhor_det_xstep=array_xstep[xstep_idx_detect];
		scaler_rtd_outl(MPEGNR_ICH1_det_Hist_Hor_step_reg, ich1_det_hist_hor_step_reg.regValue);

		//threshold for center diff
		mpegnr_ich1_det_hist_hor_thd_RBUS ich1_det_hist_hor_thd_reg;
		ich1_det_hist_hor_thd_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_det_Hist_Hor_thd_reg);
		ich1_det_hist_hor_thd_reg.cp_histhor_diff_th_high=0xf0;
		if((system_info_structure_table->Input_src_Type == _SRC_HDMI)&&array_xstep[xstep_idx_detect]==4096)
			ich1_det_hist_hor_thd_reg.cp_histhor_diff_th_low=10;
		else
			ich1_det_hist_hor_thd_reg.cp_histhor_diff_th_low=1;
		scaler_rtd_outl(MPEGNR_ICH1_det_Hist_Hor_thd_reg, ich1_det_hist_hor_thd_reg.regValue);

		////////////////////////////////////////////////////////////////////////////////////////////

		if(MpegRatioSum_Count!=0)
		{
			MpegRatio_ave=(MpegRatioSum)/MpegRatioSum_Count;
			MpegCounter_H_ave = MpegCounter_H/MpegRatioSum_Count;
			counter_ratio_avg = counter_ratio_sum/MpegRatioSum_Count;
		}

		if((Start_Print.Mpeg_Nr==TRUE)||((nr_dch1_mpegnr1_q.cp_mpglowerbound&0x40))) { //MPEG_dummy, b8025550[24:31], bit30
				printk(KERN_INFO "\n=======Mpeg info by Flora================================\n");
				printk(KERN_INFO "MAD_motion_status = %d\n", SmartPic_clue->MAD_motion_status);
				printk(KERN_INFO "MpegRatio_ave=%d	MpegRatio_th=%d, gain=%d\n", MpegRatio_ave, MpegRatio_th,mpgupperbound_x_gain);
				printk(KERN_INFO "counter_ratio_avg=%d	counter_ratio_th=%d\n", counter_ratio_avg, counter_ratio_th);
				printk(KERN_INFO "MpgIdx_X_arr[0]=%d	MpgIdx_X_arr[1]=%d MpgIdx_X_arr[2]=%d\n", MpgIdx_X_arr[0], MpgIdx_X_arr[1],MpgIdx_X_arr[2]);
		}


		if( (MpegRatio_ave>=MpegRatio_th) && (counter_ratio_avg>=counter_ratio_th) &&
				(MpgIdx_X_arr[0]==MpgIdx_X_arr[1]) && (MpgIdx_X_arr[1]==MpgIdx_X_arr[2]) ) {

			NL_mpg=(MpegRatio_ave*3/2-64)>>6;
			if(NL_mpg>10)
				NL_mpg=10;

			if(DynamicOptimizeSystem[12] || scalerVIP_DI_MiddleWare_GetStatus(STATUS_HMC))//LG boat or no.107
				NL_mpg=2;

			if(Start_Print.Mpeg_Nr==TRUE)
			{
				printk(KERN_INFO "NL_mpg=%d\n", NL_mpg);
				printk(KERN_INFO "MpegRatio_ave=	%d MpegRatioSum_Max=%d\n", MpegRatio_ave, MpegRatioSum_Max);
				printk(KERN_INFO "TableNR_MPEGNR_H=	%d scalerVip_mpegNR=%d\n", TableNR_MPEGNR_H, scalerVip_mpegNR);
				printk(KERN_INFO "vip_src=%d Y[1]=%d,Y[2]=%d,sat[0]=%d\n", system_info_structure_table->VIP_source, Y_hist_ratio[1], Y_hist_ratio[2], sat_hist_ratio[0]);
			}

			/* exclude artificial pattern in HDMI 1080i*/
			if ((RPC_system_info_structure_table->VIP_source == VIP_QUALITY_HDMI_1080I) && ((Y_hist_ratio[1] + Y_hist_ratio[2]) > 800)
				&& (sat_hist_ratio[0] > 700))
				NL_mpg = 0;

			if(NL_mpg>=2 && MpegRatio_ave>=MpegRatioSum_Max)
			{
				MpegRatioSum_Max = MpegRatio_ave;
				cp_mpegenable_x_temp = 1;
			}else if(NL_mpg>=1){
				cp_mpegenable_x_temp_keep = 1;
			}
		}
		else
		{
			NL_mpg=0;
		}
		if(xstep_idx_detect == 0)		//Field_Count = MpegPeriod*XSTEP_NUM
		{
			mpegnr_ich1_mpegnr1_RBUS ich1_MPEGNR1_reg;
			ich1_MPEGNR1_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_MPEGNR1_reg);

			if(MpegCounter_H_ave<=2048)
				mpgupperbound_x_rate = 0;
			else if(MpegCounter_H_ave>=4096)
				mpgupperbound_x_rate = 256;
			else
				mpgupperbound_x_rate = 256 - ((4096-MpegCounter_H_ave)>>3);

			mpgupperbound_x_rate *= mpgupperbound_x_gain;

			if((cp_mpegenable_x_temp == 1) || ((DynamicOptimizeSystem[5]==1)||(DynamicOptimizeSystem[12]==1)||(DynamicOptimizeSystem[23]==1)||(DynamicOptimizeSystem[24]==1)))
			{
				ich1_MPEGNR2_reg.cp_mpegenable_x = 1;
				flag_cp_mpegenable_x++;
				if(flag_cp_mpegenable_x>5)
					flag_cp_mpegenable_x=5;
				ich1_MPEGNR1_reg.cp_mpgupperbound_x = (35 * mpgupperbound_x_rate)>>8;
			}
			else
			{

				//ich1_MPEGNR2_reg.cp_mpegenable_x = 0;
				if(cp_mpegenable_x_temp_keep == 0){
					flag_cp_mpegenable_x--;
				}
				if(flag_cp_mpegenable_x<=0)
					flag_cp_mpegenable_x=0;

				ich1_MPEGNR2_reg.cp_mpegenable_x = 1;

				MCNR_GMV_Ratio = 100 - scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio();//MCNR_GMV_Ratio : 100 -> 0 ( still -> motion )
				if(RTNR_MAD_count_Y3_count > (RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio)){
					RTNR_MAD_count_Y3_count = RTNR_MAD_count_Y3_count - (((RTNR_MAD_count_Y3_count - (RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio))>>3) + 1);
				}
				else if(((RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio) > (RTNR_MAD_count_Y3_count+10))) {
					RTNR_MAD_count_Y3_count = RTNR_MAD_count_Y3_count + ((((RTNR_MAD_count_Y3_avg+MCNR_GMV_Ratio) - RTNR_MAD_count_Y3_count)>>3) + 1) ;
				}

				if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L00])
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = 0;
				else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L01])
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = (5 * mpgupperbound_x_rate)>>8;
				else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L02])
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = (10 * mpgupperbound_x_rate)>>8;
				else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L03])
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = (15 * mpgupperbound_x_rate)>>8;
				else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L04])
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = (20 * mpgupperbound_x_rate)>>8;
				else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L05])
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = (25 * mpgupperbound_x_rate)>>8;
				else if(RTNR_MAD_count_Y3_count<pPQA_InputMAD_MPEG[PQA_I_L06])
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = (30 * mpgupperbound_x_rate)>>8;
				else
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = (35 * mpgupperbound_x_rate)>>8;

				if(flag_cp_mpegenable_x >0)
					ich1_MPEGNR1_reg.cp_mpgupperbound_x = (35 * mpgupperbound_x_rate)>>8;



			}
			scalerVIP_color_noise_mpeg_detect_y=ich1_MPEGNR1_reg.cp_mpgupperbound_x;
			scaler_rtd_outl(MPEGNR_ICH1_MPEGNR1_reg, ich1_MPEGNR1_reg.regValue);
			cp_mpegenable_x_temp = 0;
			cp_mpegenable_x_temp_keep = 0;
			MpegRatioSum_Max = 0;
		}

		ich1_MPEGNR2_reg.cp_mpgidx_x=MpgIdx_X;

#if 1
	if((Start_Print.Mpeg_Nr==TRUE)||((nr_dch1_mpegnr1_q.cp_mpglowerbound&0x40))) { //MPEG_dummy, b8025550[24:31], bit30
		if(ich1_MPEGNR2_reg.cp_mpegenable_x==1) {
			printk(KERN_INFO "o------MPEG NR Enable-------------------------------------------o\n");
			printk(KERN_INFO "o---counter_ratio_avg = %d, xstep_idx_detect=%d, MpegCounter_H_ave=%d  ---o\n", counter_ratio_avg, xstep_idx_detect, MpegCounter_H_ave);
			printk(KERN_INFO "o---MpegRatio_ave = %d, MpegRatioSum = %d, MpegRatioSum_Count = %d\n", MpegRatio_ave, MpegRatioSum, MpegRatioSum_Count);
			printk(KERN_INFO "o---Mpeg_level_sum = %d, mpgupperbound_x_rate = %d----o\n", (scalerVip_mpegNR+TableNR_MPEGNR_H+TableNR_MPEGNR_V), mpgupperbound_x_rate);
			printk(KERN_INFO "o---scalerVip_mpegNR=%d,TableNR_MPEGNR_H=%d,TableNR_MPEGNR_V=%d---o\n",scalerVip_mpegNR,TableNR_MPEGNR_H,TableNR_MPEGNR_V);
			printk(KERN_INFO "o---NL_mpg = %d, cp_mpgidx_x = %d, cp_mpegenable_x=%d ---o\n", NL_mpg, ich1_MPEGNR2_reg.cp_mpgidx_x, ich1_MPEGNR2_reg.cp_mpegenable_x);
			printk(KERN_INFO "o---cp_mpegresultweight_x=%d, cp_mpgdcgain=%d ---o\n", ich1_MPEGNR2_reg.cp_mpegresultweight_x, ich1_MPEGNR2_reg.cp_mpgdcgain);
			printk(KERN_INFO "o---GMV_Ratio=%d, %d, %d ---o\n",  scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio(),RTNR_MAD_count_Y3_avg , RTNR_MAD_count_Y3_count);
			printk(KERN_INFO "o----------------------------------------------------------------------------------o\n");
		} else {
			// oliver-
			printk(KERN_INFO "o---scalerVip_mpegNR_H offoffoffoffoffoffoffoffoffoff------o\n");
			printk(KERN_INFO "o---scalerVip_mpegNR=%d,TableNR_MPEGNR_H=%d,TableNR_MPEGNR_V=%d---o\n",scalerVip_mpegNR,TableNR_MPEGNR_H,TableNR_MPEGNR_V);
		}
	}
#endif

		////scalervip_printf(AutoMADebugMsg,"ooo---Scaler_InputSrcGetMainChType()=%d---ooo\n",Scaler_InputSrcGetMainChType());
		////scalervip_printf(AutoMADebugMsg,"ooo---drvif_module_vdc_NoiseStatus_isr=%d---ooo\n",drvif_module_vdc_NoiseStatus_isr());

		if((nr_dch1_mpegnr1_q.cp_mpglowerbound&1)!=1){
			scaler_rtd_outl(MPEGNR_ICH1_MPEGNR2_reg, ich1_MPEGNR2_reg.regValue);
		}

		IoReg_SetBits(NR_SNR_DB_CTRL_reg, NR_SNR_DB_CTRL_snr_db_apply_mask); /* DB apply */

		NL_mpg_sharp = NL_mpg;


		counter_ratio_sum =0;
		MpegRatioSum=0;
		MpegCounter_H = 0;
		MpegRatioSum_Count=0;
		Field_Count=0;
		NL_mpg=0;
    }

}
#endif

void scalerVIP_color_noise_mpeg_v_apply(void){
	nr_dch1_det_vist_hor_step_RBUS	nr_dch1_det_vist_hor_step_r	;
	nr_dch1_blend_nr_ver_step_RBUS	nr_dch1_blend_nr_ver_step_r	;
	nr_dch1_mpegnr1_RBUS	nr_dch1_mpegnr1_r	;
	nr_dch1_mpegnr_ub_delta1_RBUS	nr_dch1_mpegnr_ub_delta1_r	;
	nr_dch1_mpegnr_ub_delta2_RBUS	nr_dch1_mpegnr_ub_delta2_r	;
	nr_dch1_vist_blking_hor_range_RBUS	nr_dch1_vist_blking_hor_range_r	;
	nr_dch1_vist_blking_ver_range_RBUS	nr_dch1_vist_blking_ver_range_r	;
	nr_dch1_mpegnr1_RBUS nr_dch1_mpegnr1_q;


	nr_dch1_det_vist_hor_step_r	.regValue=IoReg_Read32(	NR_DCH1_det_Vist_Hor_step_reg	);
	nr_dch1_blend_nr_ver_step_r	.regValue=IoReg_Read32(	NR_DCH1_blend_NR_Ver_step_reg	);
	nr_dch1_mpegnr1_r	.regValue=IoReg_Read32(	NR_DCH1_MPEGNR1_reg	);
	nr_dch1_mpegnr_ub_delta1_r	.regValue=IoReg_Read32(	NR_DCH1_MPEGNR_UB_delta1_reg	);
	nr_dch1_mpegnr_ub_delta2_r	.regValue=IoReg_Read32(	NR_DCH1_MPEGNR_UB_delta2_reg	);
	nr_dch1_vist_blking_hor_range_r	.regValue=IoReg_Read32(	NR_DCH1_Vist_Blking_Hor_Range_reg	);
	nr_dch1_vist_blking_ver_range_r	.regValue=IoReg_Read32(	NR_DCH1_Vist_Blking_Ver_Range_reg	);
	// apply	

	//debug for resolution detector!if enable -> disable the V_MPEG resolution detector
	nr_dch1_mpegnr1_q.regValue=IoReg_Read32(NR_DCH1_MPEGNR1_reg);

	if(
		0<=scalerVIP_color_noise_mpeg_v_detect__y_turn&&scalerVIP_color_noise_mpeg_v_detect__y_turn<9
		&&scalerVIP_color_noise_mpeg_v_detect__a_scaling[scalerVIP_color_noise_mpeg_v_detect__z_turn]>=0x800
		&&(!scalerVIP_color_noise_mpeg_v_detect__x_pipeline||scalerVIP_color_noise_mpeg_v_detect__z_turn%3==2)
	){
		scalerVIP_color_noise_mpeg_v_detect__y_scaling=scalerVIP_color_noise_mpeg_v_detect__a_scaling[scalerVIP_color_noise_mpeg_v_detect__y_turn];
		if(scalerVIP_color_noise_mpeg_v_detect__yen){// ||scalerVIP_color_noise_mpeg_v_detect__z_turn==scalerVIP_color_noise_mpeg_v_detect__y_turn
			if(scalerVIP_color_noise_mpeg_v_detect__x_requires_hor&&scalerVIP_color_noise_mpeg_v_detect_y>scalerVIP_color_noise_mpeg_detect_y){
				scalerVIP_color_noise_mpeg_v_detect_y=scalerVIP_color_noise_mpeg_detect_y;
			}
			nr_dch1_mpegnr1_r.cp_mpegenable_y_y = 1;// OSD_MPEGNR_V_En;
			nr_dch1_blend_nr_ver_step_r.cp_mpgver_blend_ystep=scalerVIP_color_noise_mpeg_v_detect__y_scaling;
			nr_dch1_mpegnr1_r.cp_mpgidx_y=scalerVIP_color_noise_mpeg_v_detect__amax1p[0][scalerVIP_color_noise_mpeg_v_detect__y_turn];
			nr_dch1_mpegnr1_r.cp_mpgupperbound=scalerVIP_color_noise_mpeg_v_detect_y>>2;
			nr_dch1_mpegnr_ub_delta2_r.cp_mpgub_delta3=nr_dch1_mpegnr1_r.cp_mpgupperbound;
			nr_dch1_mpegnr_ub_delta1_r.cp_mpgub_delta2=nr_dch1_mpegnr1_r.cp_mpgupperbound;
			if(scalerVIP_color_noise_mpeg_v_detect__y_scaling<0x1800){
				nr_dch1_mpegnr_ub_delta1_r.cp_mpgub_delta1=nr_dch1_mpegnr1_r.cp_mpgupperbound;
				if(scalerVIP_color_noise_mpeg_v_detect__y_scaling<0x1000){
					nr_dch1_mpegnr1_r.cp_mpglpmode=1;
				}else{
					nr_dch1_mpegnr1_r.cp_mpglpmode=0;
				}
			}else{
				if(scalerVIP_color_noise_mpeg_v_detect__y_scaling<0x2000){
					nr_dch1_mpegnr1_r.cp_mpglpmode=3;
					nr_dch1_mpegnr_ub_delta1_r.cp_mpgub_delta1=((scalerVIP_color_noise_mpeg_v_detect_y*5)/3)>>3;
				}else{
					nr_dch1_mpegnr1_r.cp_mpglpmode=2;
					nr_dch1_mpegnr_ub_delta1_r.cp_mpgub_delta1=(scalerVIP_color_noise_mpeg_v_detect_y/3)>>1;
				}
			}// todo : mpegai
		}else{
			nr_dch1_mpegnr1_r.cp_mpegenable_y_y=0;
		}
		// write to registers
		IoReg_Write32(	NR_DCH1_blend_NR_Ver_step_reg	,	nr_dch1_blend_nr_ver_step_r	.regValue);
		IoReg_Write32(	NR_DCH1_MPEGNR1_reg	,	nr_dch1_mpegnr1_r	.regValue);
		IoReg_Write32(	NR_DCH1_MPEGNR_UB_delta1_reg	,	nr_dch1_mpegnr_ub_delta1_r	.regValue);
		IoReg_Write32(	NR_DCH1_MPEGNR_UB_delta2_reg	,	nr_dch1_mpegnr_ub_delta2_r	.regValue);
			/*
			printk(
				KERN_EMERG "\n[mpegnr_v]jin %08x %08x %08x %08x[/mpegnr_v]",
				nr_dch1_blend_nr_ver_step_r	.regValue,
				nr_dch1_mpegnr1_r	.regValue,
				nr_dch1_mpegnr_ub_delta1_r	.regValue,
				nr_dch1_mpegnr_ub_delta2_r	.regValue
			);
			//*/
	}
	// next frame setting
	{
		int y_next_scaling=scalerVIP_color_noise_mpeg_v_detect__a_scaling[(scalerVIP_color_noise_mpeg_v_detect__z_turn+(scalerVIP_color_noise_mpeg_v_detect__x_pipeline?2:0))%9];
		nr_dch1_vist_blking_hor_range_r.cp_visthorstart=0;
		nr_dch1_vist_blking_hor_range_r.cp_visthorend=scalerVIP_color_noise_mpeg_v_detect__xwidth-1;
		nr_dch1_vist_blking_ver_range_r.cp_vistverstart=0;
		nr_dch1_vist_blking_ver_range_r.cp_vistverend=scalerVIP_color_noise_mpeg_v_detect__xheight-1;
		if(y_next_scaling>=0x800){
			if((nr_dch1_mpegnr1_q.cp_mpglowerbound&0x20)){//MPEG_dummy, b8025550[24:31], bit29
				nr_dch1_det_vist_hor_step_r.cp_visthor_det_ystep=0x1000;
			} else {
				nr_dch1_det_vist_hor_step_r.cp_visthor_det_ystep=y_next_scaling;
			}

			IoReg_Write32(	NR_DCH1_det_Vist_Hor_step_reg	,	nr_dch1_det_vist_hor_step_r	.regValue);
			IoReg_Write32(	NR_DCH1_Vist_Blking_Hor_Range_reg	,	nr_dch1_vist_blking_hor_range_r	.regValue);
			IoReg_Write32(	NR_DCH1_Vist_Blking_Ver_Range_reg	,	nr_dch1_vist_blking_ver_range_r	.regValue);
		}
	}
	// db_apply
	IoReg_SetBits(NR_SNR_DB_CTRL_reg, NR_SNR_DB_CTRL_snr_db_apply_mask); /* DB apply */
	MpegEnable_flag=nr_dch1_mpegnr1_r.cp_mpegenable_y_y;
			/*
			printk(
				KERN_EMERG "\n[mpegnr_v]jin %d %d %d %d %d[/mpegnr_v]",
				MpegEnable_flag,
				scalerVIP_color_noise_mpeg_v_detect__z_turn,
				scalerVIP_color_noise_mpeg_v_detect__y_turn,
				scalerVIP_color_noise_mpeg_v_detect__yub,
				scalerVIP_color_noise_mpeg_v_detect__yub2
			);
			//*/
}
//============================Elsie 20130425: color mpeg end=====================

#if 0
void scalerVIP_color_mpeg_data_reset(unsigned long arg) {
	NoiseSum_spatial=0;
	MpegRatioSum=0;
	MpegRatioSum_Count=0;
	ContainStill_Count=0;
	Field_Count=0;

	//flora, add for Sirius non8x8 detector
	XSTEP_NUM= arg;
	/*
	ROSPrintf("1.[mpeg_data_reset]ucMode_Curr=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].ucMode_Curr);
	ROSPrintf("1.[mpeg_data_reset]XSTEP_NUM=%d\n",XSTEP_NUM);
	*/
	xstep_idx_detect=0;
	xstep_idx_apply=0;
	mpegnr_ich1_det_hist_hor_step_RBUS ich1_det_hist_hor_step_reg;
	ich1_det_hist_hor_step_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_det_Hist_Hor_step_reg);
	ich1_det_hist_hor_step_reg.cp_histhor_det_xstep=array_xstep[0];
	scaler_rtd_outl(MPEGNR_ICH1_det_Hist_Hor_step_reg, ich1_det_hist_hor_step_reg.regValue);
}
#endif



//=========================== Pure Color Detection ===========================
unsigned char pure_color_detect(unsigned char channel, unsigned int width, unsigned int height)
{
	if (ID_TV002_Flag[ID_Radio_TV002] == 1) {
		pure_color_weighting = 0;
		return 0;
	}
	unsigned char MainDCC_SC = (RPC_SmartPic_clue->SceneChange);
	unsigned int hist_sum;//, hue_hist_sum;
	unsigned int i;//, hue_hist[24];
	unsigned int hist_sum_max=0;
	int max_index=0;//, hue_max_index=0;
	unsigned int pure_color_weighting_of_max_bin_ratio = 0;
	unsigned int pure_color_weighting_of_first_and_second_bin_ratio = 0;
	pure_color_weighting = 0;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);
	static int purecolor_weighting_buffer[256] = {[0 ... 255]=0x20}; //buffer = 256 frames

	hist_sum = 0;

	for(i = 0; i< (COLOR_HISTOGRAM_LEVEL - 1); i++) {
		hist_sum = reg_HistCnt[i]+reg_HistCnt[i+1];

		if(hist_sum>hist_sum_max) {
			max_index = i;
			hist_sum_max = hist_sum;
		}
	}

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Dcc_2==TRUE)) {
		ROSPrintf("====== pure_color_detect ========\n");
		ROSPrintf("hist_sum_max=%d \n",hist_sum_max);
		ROSPrintf("Total_HistCnt=%d \n",(SmartPic_clue->Hist_Y_Total_sum));
		ROSPrintf("((Total_HistCnt*31)>>5)=%d \n",(((SmartPic_clue->Hist_Y_Total_sum)*31)>>5));
		ROSPrintf("DCC_Histogram_Peak_White=%d \n",(SmartPic_clue->Hist_Peak_White_IRE_Value));
		ROSPrintf("Histogram_Mean_value=%d \n",(SmartPic_clue->Hist_Y_Mean_Value));
	}

	//if the highest 2 bins take higher percentage, higher pure color weighting will be set.
	int weighting_gap = 0;
	if( (hist_sum_max > (((SmartPic_clue->Hist_Y_Total_sum)*31)>>5)) )
	{
		if(hist_sum_max >= ((SmartPic_clue->Hist_Y_Total_sum*127)>>7))//tolerence some noise
			pure_color_weighting_of_max_bin_ratio = 32;
		else if(hist_sum_max <= (((SmartPic_clue->Hist_Y_Total_sum)*31)>>5))
			pure_color_weighting_of_max_bin_ratio = 0;
		else if(hist_sum_max < ((SmartPic_clue->Hist_Y_Total_sum*127)>>7) && hist_sum_max > (((SmartPic_clue->Hist_Y_Total_sum)*31)>>5))
		{
			weighting_gap = (((SmartPic_clue->Hist_Y_Total_sum*127)>>7) - (((SmartPic_clue->Hist_Y_Total_sum)*31)>>5)) >> 5;

			for( i = 0; i < 32; i++)
			{
				if((((SmartPic_clue->Hist_Y_Total_sum)*31)>>5) + weighting_gap * i <= hist_sum_max
					&& (((SmartPic_clue->Hist_Y_Total_sum)*31)>>5) + weighting_gap * (i+1) > hist_sum_max)
				{
					pure_color_weighting_of_max_bin_ratio = i;
				}
				else if((((SmartPic_clue->Hist_Y_Total_sum)*31)>>5) + weighting_gap * (i+1) <= hist_sum_max)
					pure_color_weighting_of_max_bin_ratio = 32;
			}
		}
	}
	else
	{
		pure_color_weighting_of_max_bin_ratio = 0;
	}

	//if it enter the purecolor above and the highest two bins are closer, it means the 1 bins are not the noise(there are two Y histogram). Then, pure color weighting will be set lower.
	pure_color_weighting_of_first_and_second_bin_ratio = 0;
	if(hist_sum_max > (((SmartPic_clue->Hist_Y_Total_sum)*31)>>5))
	{
		if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Dcc_2==TRUE))
		{
			ROSPrintf("max_index = %d\n", max_index);
			ROSPrintf("reg_HistCnt[max_index] = %d\n", reg_HistCnt[max_index]);
			ROSPrintf("reg_HistCnt[max_index+1] = %d\n", reg_HistCnt[max_index+1]);
		}
		if(reg_HistCnt[max_index] > ((reg_HistCnt[max_index+1]) >> 1))
		{
			if(reg_HistCnt[max_index+1] == 0)
				pure_color_weighting_of_first_and_second_bin_ratio = 32;
			else
				pure_color_weighting_of_first_and_second_bin_ratio = (reg_HistCnt[max_index] / reg_HistCnt[max_index+1]);
		}
		else if(reg_HistCnt[max_index+1] >= ((reg_HistCnt[max_index]) >> 1))
		{
			if(reg_HistCnt[max_index] == 0)
				pure_color_weighting_of_first_and_second_bin_ratio = 32;
			else
				pure_color_weighting_of_first_and_second_bin_ratio = (reg_HistCnt[max_index+1] / reg_HistCnt[max_index]);
		}

		if(pure_color_weighting_of_first_and_second_bin_ratio >= 32)
			pure_color_weighting_of_first_and_second_bin_ratio = 32;
		else if(pure_color_weighting_of_first_and_second_bin_ratio <= 0)
			pure_color_weighting_of_first_and_second_bin_ratio = 0;
	}

	//combine two weighting above together
	pure_color_weighting = (pure_color_weighting_of_max_bin_ratio + pure_color_weighting_of_first_and_second_bin_ratio) >> 1;
	if(pure_color_weighting >= 32)
		pure_color_weighting = 32;
	else if (pure_color_weighting <= 0)
		pure_color_weighting = 0;

//20171005 hugh: for CVBS, there is some noise that will effect purecolor weighting and lead to flick
	if(MainDCC_SC == 0)
	{
		//update weighting buffer
		int tmp_value = 0;
		for(i = 0; i < 256; ++i)
		{
			tmp_value = purecolor_weighting_buffer[i];
			if(i < 255)
				purecolor_weighting_buffer[i] = purecolor_weighting_buffer[i+1];
			else// i=31
				purecolor_weighting_buffer[i] = pure_color_weighting;
		}

		for(i = 0; i < 256; ++i)
			pure_color_weighting +=  purecolor_weighting_buffer[i];
		pure_color_weighting = pure_color_weighting >> 8;
	}
	else
	{
		for(i = 0; i < 256; ++i)
			purecolor_weighting_buffer[i] = pure_color_weighting;
	}
	if(pure_color_weighting >= 32)
		pure_color_weighting = 32;
	else if (pure_color_weighting <= 0)
		pure_color_weighting = 0;
	

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Dcc_2==TRUE))
	{
		ROSPrintf("====== pure_color_detect ========\n");
		ROSPrintf("pure_color_weighting_of_max_bin_ratio=%d \n",pure_color_weighting_of_max_bin_ratio);
		ROSPrintf("pure_color_weighting_of_first_and_second_bin_ratio=%d \n",pure_color_weighting_of_first_and_second_bin_ratio);
		ROSPrintf("pure_color_weighting=%d \n",pure_color_weighting);
	}

	if(pure_color_weighting > 0)
		return 1;
	else
		return 0;

}

#ifdef ISR_SONY_DETECT_ENABLE
unsigned char pure_color_detect_Sony(unsigned char channel, unsigned int width, unsigned int height)
{
	unsigned int hist_sum;//, hue_hist_sum;
	unsigned int i;//, hue_hist[24];
	unsigned int hist_sum_max=0;
	//unsigned int hue_hist_sum_max=0;
	int max_index=0;//, hue_max_index=0;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	if(sat_hist_ratio[0]>850)
		return FALSE;

	hist_sum = 0;
	hist_sum_max=0;
	for(i = 0; i< 23; i++)
	{
		hist_sum = hue_hist_ratio[i]+hue_hist_ratio[i+1];
		if(hist_sum>hist_sum_max)
		{
			max_index = i;
			hist_sum_max = hist_sum;
		}
	}
	if((hist_sum_max < 900))
		return FALSE;

	hist_sum_max=0;
	hist_sum = 0;
	for(i = 0; i< 31; i++)
	{
		hist_sum = reg_HistCnt[i]+reg_HistCnt[i+1];
		if(hist_sum>hist_sum_max)
		{
			max_index = i;
			hist_sum_max = hist_sum;
		}
	}

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Dcc_2==TRUE))
	{
		ROSPrintf("==== pure_color_detect_Sony======\n");
		ROSPrintf("hist_sum_max=%d \n",hist_sum_max);
		ROSPrintf("Total_HistCnt=%d \n",(SmartPic_clue->Hist_Y_Total_sum));
		ROSPrintf("((Total_HistCnt*253)>>8)=%d \n",(((SmartPic_clue->Hist_Y_Total_sum)*253)>>8));
	}

	//o------ judge the pure color ------o
	if( (hist_sum_max > (((SmartPic_clue->Hist_Y_Total_sum)*253)>>8)) )
		return 1;
	else
		return 0;

}
#endif

void skin_tone_Level_detect(unsigned char channel, unsigned int width, unsigned int height)
{
	unsigned int i;
	unsigned int Total_hue_hist_sum=0, Total_hue_hist_ratio;
	unsigned char max_index=0, secondindex=0;
	unsigned int hue_max_bin_cnt=0,hue_second_bin_cnt=0;
	unsigned char hue_max_bin_ratio=0,hue_second_bin_ratio=0;
	unsigned char hue_zero_bin_counter =0;

	unsigned int hue_his_sum_2_7=0, hue_his_ratio_2_7=0;

	unsigned short Y_his_max_ratio = 0 ;
	unsigned int Y_his_sum_12_18=0, Y_his_ratio_12_18=0;

	static unsigned int skin_tone_count=0;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);


	for(i=12;i<=18;i++)
	{
		Y_his_sum_12_18+=reg_HistCnt[i];
	}

	Y_his_max_ratio = SmartPic_clue->Hist_Y_MAX_bin_ratio;// his max ration
	Y_his_ratio_12_18 = Y_his_sum_12_18*100/((SmartPic_clue->Hist_Y_Total_sum)+1);//his local ratio

	for(i=0;i<24;i++)
	{
		//Hue_His_Bin[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));

		Total_hue_hist_sum+= (SmartPic_clue->Hue_Main_His[i]); //total hue cnt

		if((SmartPic_clue->Hue_Main_His[i])==0)
			hue_zero_bin_counter++; //zero bin cnt

		if(hue_max_bin_cnt<=(SmartPic_clue->Hue_Main_His[i])) //decide max and second hue bin info
		{
			hue_second_bin_cnt = hue_max_bin_cnt;
			hue_max_bin_cnt = (SmartPic_clue->Hue_Main_His[i]);
			max_index=i;
		}
		else if(hue_second_bin_cnt<=(SmartPic_clue->Hue_Main_His[i]))
		{
			hue_second_bin_cnt = (SmartPic_clue->Hue_Main_His[i]);
			secondindex = i;
		}

		if( (i>=4) && (i<=7) )
		{
			hue_his_sum_2_7+=(SmartPic_clue->Hue_Main_His[i]);
		}
#if 0
		if(MA_print_count%120==0)
		{
			ROSPrintf("Hue_His_Bin[%d]=%d \n",i, (SmartPic_clue->Hue_Main_His[i]));
		}
#endif

	}

	Total_hue_hist_ratio = (Total_hue_hist_sum*100)/(width*height+1);//hue cnt ratio by total pixcel

	hue_max_bin_ratio=(hue_max_bin_cnt*100)/(Total_hue_hist_sum+1);
	hue_second_bin_ratio=(hue_second_bin_cnt*100)/(Total_hue_hist_sum+1);

	hue_his_sum_2_7+=1;
	hue_his_ratio_2_7 =(hue_his_sum_2_7*100)/(Total_hue_hist_sum+1);

	if( (Y_his_max_ratio>=40) && (Y_his_ratio_12_18>=70) && (Total_hue_hist_ratio>=15))
	{
		if((hue_his_ratio_2_7>=68)&&(hue_max_bin_ratio>=50))
		{
			skin_tone_huu_bin_ratio = hue_his_ratio_2_7;
		}
		new_skin_tone_flag = 1;

	}
	else
	{
		skin_tone_huu_bin_ratio = 0;
		new_skin_tone_flag = 0;
	}


#if 0
	if(skin_tone_count%120==0)
	{
		ROSPrintf("Total_pixel=%d,Total_hue_hist_sum=%d \n",width*height, Total_hue_hist_sum );
		ROSPrintf("hue_zero_bin_counter=%d,Total_hue_hist_ratio=%d \n",hue_zero_bin_counter,Total_hue_hist_ratio);
		ROSPrintf("max: index=%d, cnt=%d,hue_max_bin_ratio=%d \n",max_index,hue_max_bin_cnt,hue_max_bin_ratio );
		ROSPrintf("second: index=%d, cnt=%d, hue_second_bin_ratio=%d \n",secondindex,hue_second_bin_cnt, hue_second_bin_ratio);
		ROSPrintf("hue_his_sum_4_7=%d, hue_his_ratio_4_7=%d \n",hue_his_sum_2_7,hue_his_ratio_2_7);

		ROSPrintf("Y_his_max_ratio=%d, Y_his_ratio_12_18=%d \n",Y_his_max_ratio,Y_his_ratio_12_18);


		ROSPrintf("!!!new_skin_tone_flag = %d \n",new_skin_tone_flag);

	}
#endif

	skin_tone_count++;


}




//=========================== Skin Tone Detection ===========================
#ifdef ISR_SKIN_TONE_DETECT_FUNCTION_ENABLE
#define Print_skin_tone 0

void skin_tone_detect(unsigned char channel, unsigned int width, unsigned int height)
{
	unsigned int hist_sum, hist_sum_local, hist_ratio=0, hist_local_ratio=0, hist2_sum,hist_bin01_ratio;
	unsigned int i;//, hue_hist[24];
	unsigned char histogram_non_zero[24], non_zero_sum =0, corn_check =0; //, line_girl_check =0;
	static unsigned int skin_tone_count=0;

//===== default judge bound =====
	unsigned char Hue_histogram_weight[24], non_zero_count =0;
	unsigned char Hue_up_bound_count = 0,  Hue_center_bound_count = 0, Hue_low_bound_count = 0, Hue_high_bound_count =0 ;
	unsigned char Hue_count_up_bound=20 ,Hue_count_low_bound=10, Hue_count_high_bound =20 ;
	unsigned char sum_high_bound= 0;


	unsigned int hist_sum2, hist_ratio2=0, hist_local_ratio2=0;//sony demo
	di_im_di_hfd_statistic_RBUS	im_di_hfd_statistic_Reg;//sony demo
	im_di_hfd_statistic_Reg.regValue = rtd_inl(DI_IM_DI_HFD_STATISTIC_reg);//sony demo
	unsigned char result_check=0;
	unsigned char max_index=0;
	unsigned int tmp=0;
	unsigned int Hue_hist[COLOR_HUE_HISTOGRAM_LEVEL];

	hist2_sum = 0;

	for(i=0;i<24;i++)
	{
		Hue_hist[i] = (SmartPic_clue->Hue_Main_His)[i];

		histogram_non_zero[i] = 0;
		hist2_sum+= Hue_hist[i];
		if(Hue_hist[i]>tmp)
		{
			max_index=i;
			tmp=Hue_hist[i];
		}
	}

	hist2_sum+=1;


//	      scalerDrvPrint("\n>>>>>>>>>>>>>>>> skin_tone_begin = %d <<<<<<<<<<<<<<<\n",skin_tone_begin);


	//}


//	for(i = 0; i< 24; i++)
//		scalerDrvPrint("\n>>>>nick187print>>>>>> hue2_%d = %d <<<<<<\n",i,100*hue_hist_2[i]/hist2_sum);


	// following section to detect the corn move hue color
	non_zero_sum = 0;
	non_zero_count = 0;
	for(i = 0; i< 24; i++)
	{
		if(((unsigned char)(100*Hue_hist[i] /hist2_sum)) == 0)
		{
			histogram_non_zero[i] = 0;
			Hue_histogram_weight[i] = 0;
		}
		else
		{
			histogram_non_zero[i] = 1;
			Hue_histogram_weight[i]=(unsigned char)(100*Hue_hist[i] /hist2_sum);
		}

		Hue_histogram_weight[i] = (Hue_histogram_weight[i]>100)?0:Hue_histogram_weight[i];

		non_zero_count += histogram_non_zero[i];

		non_zero_sum += histogram_non_zero[i];
		if(non_zero_sum == 0)
		{
			switch(i)
				{
				case 4:// hue2[0]~[4] doesn't have value,
				case 9:// hue2[9] reset to 0, hue2[5]~[8] this for yelllow and green corn
				case 13: //hue[8]~[13]  always 0
				case 17://hue2[17] reset to 0, hue2[14]~[16] for cyan sky   //20100611 nick187
				case 23://hue2[16]~[23] always 0
						corn_check += 1;

						break;
				default:
						corn_check += 0;
						break;
				}
		}
		else
		{
			if( i == 5) // hue2[5]~[7] this for yelllow and green cone
				corn_check += 1; // hue2[5] has value, hue2[14] has value
			if(i ==14)//  hue2[14]~[15] for cyan sky
				corn_check += 1; // hue2[5] has value, hue2[14] has value


			non_zero_sum = 0;
		}


	}


	hist_bin01_ratio=Hue_hist[1]*100/(hist2_sum);


	hist_sum = Hue_hist[2]+Hue_hist[3]+Hue_hist[4];
		hist_sum2 = Hue_hist[3]+Hue_hist[4]+Hue_hist[5];//sony demo

	if(hist_bin01_ratio>58)
		hist_sum_local = hist_sum+Hue_hist[5];
	else
		hist_sum_local = Hue_hist[0]+Hue_hist[1]+hist_sum+Hue_hist[5];

	if (hist2_sum)
		hist_ratio = hist_sum*100/ (width*height+1);      //(hist2_sum); avoid divide by zero

	if (hist_sum_local)  // hist_sum_local could be zero when system booting
		hist_local_ratio = hist_sum*100/hist_sum_local;

	//sony demo
    	if (hist2_sum)
			hist_ratio2 = hist_sum2*100/ (width*height+1);
        //sony demo
		if (hist_sum_local)  // hist_sum_local could be zero when system booting
			hist_local_ratio2 = hist_sum2*100/hist_sum_local;

	//LG demo 45and 46 flag
	Hue_up_bound_count = 0;
	Hue_low_bound_count= 0;
	Hue_center_bound_count = 0;
	Hue_high_bound_count= 0;
	sum_high_bound=0;
	for(i = 0; i< 24; i++)
	{
		if(Hue_histogram_weight[i]<=Hue_count_up_bound && Hue_histogram_weight[i]>Hue_count_low_bound)
		{
		 	Hue_center_bound_count++;
		}
		else if(Hue_histogram_weight[i]<=Hue_count_low_bound && Hue_histogram_weight[i]!=0)
		{
		 	Hue_low_bound_count++;
		}
		else if( Hue_histogram_weight[i]>Hue_count_up_bound)
		{
		 	Hue_up_bound_count++;
		}

		if(Hue_histogram_weight[i]>Hue_count_high_bound)
		{
			Hue_high_bound_count++;
			sum_high_bound = sum_high_bound+Hue_histogram_weight[i];
		}

	}

	#define SKIN_TONE_MV_THL 25
	if( (hist_local_ratio>75) && (hist_ratio>8) && (Hue_hist[3]>Hue_hist[2]) && (Hue_hist[3]>Hue_hist[1]) && (Hue_hist[3]>Hue_hist[4]) && (Hue_hist[3]>Hue_hist[5]) &&((SmartPic_clue->Hist_Y_Mean_Value) > SKIN_TONE_MV_THL))
	{ //org (hist_ratio>10)  change by Jerry Wu 20101103, condition:max hue_hist_2[3]
		Line_girl_tone_result = 0;
		Corn_tone_result = 0;
		(SmartPic_clue->skintoneflag) = 1;
		start_to_detected =1;
		result_check=1;
		//avoid moving moon pattern
		if(((SmartPic_clue->Hist_Y_Mean_Value)==37||(SmartPic_clue->Hist_Y_Mean_Value)==36))
		{
			if((Hue_hist[3]<((Hue_hist[2]*225)>>7)))
				(SmartPic_clue->skintoneflag) = 0;
		}
		// oliver-
	//	if((skin_tone_count % 90) == 0)//sony demo
		{
			//ROSPrintf("[skin]section 0!! \n");
			VIP_DEBUG_PRINTF("[skin]section 0!! \n");
			VIP_DEBUG_PRINTF("[skin]section 0,Histogram_Mean_value =%d\n",(SmartPic_clue->Hist_Y_Mean_Value));
		}
	}
	else if( (hist_local_ratio>75) && (hist_ratio>8) && (Hue_hist[3]>Hue_hist[2]) && ((Hue_hist[3]*2)>Hue_hist[1]) && (Hue_hist[3]>Hue_hist[4]) && (Hue_hist[3]>Hue_hist[5])&&((SmartPic_clue->Hist_Y_Mean_Value) > SKIN_TONE_MV_THL) )
	{// (hist_ratio>10) change by Jerry Wu 20101103,
		Line_girl_tone_result = 0;
		Corn_tone_result = 0;
		(SmartPic_clue->skintoneflag) = 1;
		start_to_detected =1;
		result_check=2;
	//oliver-
	//	if((skin_tone_count % 90) == 0)//sony demo
		{
			//ROSPrintf("[skin]section 1!! \n");
			VIP_DEBUG_PRINTF("[skin]section 1!! \n");
			VIP_DEBUG_PRINTF("[skin]section 1,Histogram_Mean_value=%d\n",(SmartPic_clue->Hist_Y_Mean_Value));
		}
	}
	else if( (hist_local_ratio>75) && (hist_ratio>45) && (Hue_hist[2]>Hue_hist[3]) && ((Hue_hist[3]*2)>Hue_hist[1]) && (Hue_hist[3]>Hue_hist[4]) && (Hue_hist[3]>Hue_hist[5])&&((SmartPic_clue->Hist_Y_Mean_Value) > SKIN_TONE_MV_THL) )
	{ // for SONY little baby, 20100126 Jerry Wu
		Line_girl_tone_result = 0;
		Corn_tone_result = 0;
		(SmartPic_clue->skintoneflag) = 1;
		start_to_detected =1;
		result_check=3;
		// oliver-
		//if((skin_tone_count % 90) == 0)//sony demo
		{
			//ROSPrintf("[skin]section 2!! \n");
			VIP_DEBUG_PRINTF("[skin]section 2!! \n");
			VIP_DEBUG_PRINTF("[skin]section 2,Histogram_Mean_value=%d\n",(SmartPic_clue->Hist_Y_Mean_Value));
		}
	}
	else if( (hist_local_ratio>40) &&(hist_local_ratio<50)&& (hist_ratio>10) && (hist_ratio<20) && (Hue_hist[3]>Hue_hist[2]) && ( (Hue_hist[3]>Hue_hist[4]) && (Hue_hist[3]>Hue_hist[5]) )&&((SmartPic_clue->Hist_Y_Mean_Value) > SKIN_TONE_MV_THL))
	{ // for SONY Red swather girl, 20100127 Jerry Wu
		Line_girl_tone_result = 0;
		Corn_tone_result = 0;
		(SmartPic_clue->skintoneflag) = 1;
		start_to_detected =1;
		result_check=4;
		// oliver-
		//if((skin_tone_count % 90) == 0)//sony demo
		{
			//ROSPrintf("[skin]section 3!! \n");
			VIP_DEBUG_PRINTF("[skin]section 3!! \n");
			VIP_DEBUG_PRINTF("[skin]section 3,Histogram_Mean_value=%d\n",(SmartPic_clue->Hist_Y_Mean_Value));
		}
	}
	else if( (hist_local_ratio>75) && (hist_ratio>8) && (Hue_hist[4]>Hue_hist[3]) && (Hue_hist[4]>Hue_hist[2]) && (Hue_hist[4]>Hue_hist[5]) && (Hue_hist[4]>Hue_hist[6])&&((SmartPic_clue->Hist_Y_Mean_Value) > SKIN_TONE_MV_THL) )
	{ //org (hist_ratio>10)  change by Jerry Wu 20101103, condition:max hue_hist_2[3]
		Line_girl_tone_result = 0;
		Corn_tone_result = 0;
		(SmartPic_clue->skintoneflag) = 1;
		start_to_detected =1;
		result_check=5;
		if(((SmartPic_clue->Hist_Y_Mean_Value)==40||(SmartPic_clue->Hist_Y_Mean_Value)==41))
		{
			if(hist_ratio<=9)
				(SmartPic_clue->skintoneflag) = 0;
		}

		// oliver-
		//if((skin_tone_count % 90) == 0)//sony demo
		{
			//ROSPrintf("[skin]section 4!! \n");
	   	 	VIP_DEBUG_PRINTF("[skin]section 4!! \n");
			VIP_DEBUG_PRINTF("[skin]section 4,Histogram_Mean_value=%d\n",(SmartPic_clue->Hist_Y_Mean_Value));
		}
	}
	else if(hist_local_ratio2>78 &&((Hue_hist[3]>Hue_hist[0]) && (Hue_hist[3]>Hue_hist[1]) && (Hue_hist[3]>Hue_hist[2]) && (Hue_hist[3]>Hue_hist[4]))&&((SmartPic_clue->Hist_Y_Mean_Value) > 63) )
	{
		(SmartPic_clue->skintoneflag) = 1;
		skin_tone_for_panasonic =1;
		result_check=6;
		//if((skin_tone_count % 90) == 0)//panasonic style for skin tone
		{
			//ROSPrintf("[skin]section 5!! \n");
	   	 	VIP_DEBUG_PRINTF("[skin]section 4!! \n");
			VIP_DEBUG_PRINTF("[skin]section 4,Histogram_Mean_value=%d\n",(SmartPic_clue->Hist_Y_Mean_Value));
		}
	}
	else if(hist_local_ratio2>80 &&((Hue_hist[4]>Hue_hist[1]) && (Hue_hist[4]>Hue_hist[2]) && (Hue_hist[4]>Hue_hist[3]) && (Hue_hist[4]>Hue_hist[5]))&&((SmartPic_clue->Hist_Y_Mean_Value) > 63) )
	{
		(SmartPic_clue->skintoneflag) = 1;
		skin_tone_for_panasonic =1;
		result_check=7;
		//if((skin_tone_count % 90) == 0)//panasonic style for skin tone
		{
			//ROSPrintf("[skin]section 6!! \n");
	   	 	VIP_DEBUG_PRINTF("[skin]section 4!! \n");
			VIP_DEBUG_PRINTF("[skin]section 4,Histogram_Mean_value=%d\n",(SmartPic_clue->Hist_Y_Mean_Value));
		}
	}

	else if(corn_check >=7)
	{ //this function implement in drvif_color_ma_hfd_problem
		Line_girl_tone_result = 0;
		Corn_tone_result = 1;
		(SmartPic_clue->skintoneflag) = 0;
		start_to_detected =1;
		//if((skin_tone_count % 90) == 0)//sony demo
		{
			//ROSPrintf("[skin]section 8!! \n");
			VIP_DEBUG_PRINTF("[skin]section 6!!,Histogram_Mean_value=%d \n",(SmartPic_clue->Hist_Y_Mean_Value));
			VIP_DEBUG_PRINTF("--------------------------------------------Corn Detect--------------------------\n");
		}
	}
	else
	{
		if((skin_tone_count % 10) == 0)//sony demo
		{
			VIP_DEBUG_PRINTF("[skin]Yes.corn_check =%d, hfd=%d\n",corn_check,im_di_hfd_statistic_Reg.regValue);
		}


		Line_girl_tone_result = 0;
		Corn_tone_result = 0;
		(SmartPic_clue->skintoneflag) = 0;
		skin_tone_for_panasonic =0;
		result_check=0;
	}

	//max index must be 1,2,3,4,5,6
	if(max_index>6)
		(SmartPic_clue->skintoneflag) = 0;

#if 0
	if(MA_print_count%100==0)
		ROSPrintf("r=%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d\n",
		result_check,(SmartPic_clue->Hist_Y_Mean_Value),hist_local_ratio,hist_ratio,max_index,
		Hue_hist[0],Hue_hist[1],Hue_hist[2],Hue_hist[3],Hue_hist[4],Hue_hist[5],Hue_hist[6]);
#endif
	skin_tone_begin = 1;
	skin_tone_count++;

}
#endif

//if( ((SmartPic_clue->Hist_Y_Mean_Value)<47&&(SmartPic_clue->Hist_Y_Mean_Value)>40) && (im_di_hfd_statistic_Reg.regValue>=105000)  && (hist2_sum<=40000) && (Center_Difference>=15 && Center_Difference<=130))//sony demo
unsigned int mcc_detect_table[6][7] =
{
	{51,		43,		80000,		1700000,		0,		145,		10},		//NTSC // cychen LG deno 45 -> temp disable	// mcc_detect_table[NTSC][3]= 120000 from 40000
	{51,		42,		100000,		40000,		0,		140,		10},		//PAL // cychen LG deno 45 -> temp disable 43->42
	{47,		40,		90000,		40000,		0,		130,		10},		//SD
	{47,		40,		90000,		40000,		0,		130,		10},		//HD
	{47,		40,		100000,		40000,		15,		130,		10},		//VGA
	{47,		40,		100000,		40000,		0,		180,		10},		//HDMI PAL
};

unsigned char motion_concentric_circles_detect(unsigned int width, unsigned int height)
{

	unsigned int hist_local_sum, hist_sum_localrange, hist_ratio_allrange=0, hist_local_ratio=0, hist2_sum;
	unsigned int i;//, hue_hist[24];
	unsigned char radio_color_dete_config=0,curr_motion_status_flag=0;
    //unsigned char motion_condiction_flag=0;	//sony demo
	unsigned int local_HistCnt_ratio[8] = {0};
	unsigned int HistCnt_sum, HistCnt_flag=0, local_ratio_sum=0,local_ratio_average_high=0;
	unsigned char curr_motion_status = 0, ii = 0;

	unsigned int Center_Difference = 0;
	static unsigned int pre_Center_Difference = 0;

	static unsigned int counter_file=0;//sony demo
	static unsigned int sat_hist_sum_bin3to31=0;//2014/03/05 since Sirius
	static unsigned char pre_Saturation_detect_flag=1;
	unsigned char still_concentric_circles_detect_flag=0;

	unsigned int Hue_hist[COLOR_HUE_HISTOGRAM_LEVEL];
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	 _system_setting_info *system_info_structure_table=NULL;
	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

	if(system_info_structure_table == NULL){
		if(MA_print_count%360==0)
			ROSPrintf("motion_concentric_circles_detect Share Memory PQ data ERROR, system_info = %x, \n",system_info_structure_table);
		return 0;
	}

	unsigned int printf_Flag=0,print_delay=0;
	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;

	di_im_di_hfd_statistic_RBUS	im_di_hfd_statistic_Reg;//sony demo
	im_di_hfd_statistic_Reg.regValue = rtd_inl(DI_IM_DI_HFD_STATISTIC_reg);//sony demo

	curr_motion_status = scalerVideo_GetCurMotionStatus();


	hist2_sum = 0;
	for(i=0;i<24;i++)
	{
		Hue_hist[i] =(SmartPic_clue->Hue_Main_His)[i];
		hist2_sum+= Hue_hist[i];//already read info. from skin tone detector
	}
	hist2_sum+=1;

	HistCnt_sum = 0;
	for(i=0;i<32;i++)
	{
		HistCnt_sum+= reg_HistCnt[i];//already read info. from skin tone detector
	}
	HistCnt_sum+=1;

	if(HistCnt_sum>0)
	{
		local_HistCnt_ratio[0]=100*(reg_HistCnt[0]+reg_HistCnt[1]+reg_HistCnt[2]+reg_HistCnt[3])/HistCnt_sum;
		local_HistCnt_ratio[1]=100*(reg_HistCnt[4]+reg_HistCnt[5]+reg_HistCnt[6]+reg_HistCnt[7])/HistCnt_sum;
		local_HistCnt_ratio[2]=100*(reg_HistCnt[8]+reg_HistCnt[9]+reg_HistCnt[10]+reg_HistCnt[11])/HistCnt_sum;
		local_HistCnt_ratio[3]=100*(reg_HistCnt[12]+reg_HistCnt[13]+reg_HistCnt[14]+reg_HistCnt[15])/HistCnt_sum;
		local_HistCnt_ratio[4]=100*(reg_HistCnt[16]+reg_HistCnt[17]+reg_HistCnt[18]+reg_HistCnt[19])/HistCnt_sum;
		local_HistCnt_ratio[5]=100*(reg_HistCnt[20]+reg_HistCnt[21]+reg_HistCnt[22]+reg_HistCnt[23])/HistCnt_sum;
		local_HistCnt_ratio[6]=100*(reg_HistCnt[24]+reg_HistCnt[25]+reg_HistCnt[26]+reg_HistCnt[27])/HistCnt_sum;
		local_HistCnt_ratio[7]=100*(reg_HistCnt[28]+reg_HistCnt[29]+reg_HistCnt[30]+reg_HistCnt[31])/HistCnt_sum;
	}

/*
	for(i=0;i<8;i++)//sony demo
	{
		if(local_HistCnt_ratio[i]<0)
			local_HistCnt_ratio[i]=0;
	}
*/
	hist_local_sum = reg_HistCnt[9]+reg_HistCnt[10]+reg_HistCnt[14];//sony demo

	for(i=1;i<17;i++)
	{
		hist_sum_localrange = reg_HistCnt[i];//sony demo
	}

	if (hist2_sum) //(hist2_sum); avoid divide by zero
		hist_ratio_allrange = hist_local_sum*100/hist2_sum;

	if (hist_sum_localrange)  // hist_sum_local could be zero when system booting
		hist_local_ratio = hist_local_sum*100/hist_sum_localrange;

	local_ratio_sum=local_HistCnt_ratio[1]+local_HistCnt_ratio[2]+local_HistCnt_ratio[3]+local_HistCnt_ratio[4]+local_HistCnt_ratio[5];//sony demo
	local_ratio_average_high=(local_HistCnt_ratio[6]+local_HistCnt_ratio[7]);//sony demo

//==========HistCnt_flag condiction===================================
	if( (SmartPic_clue->Hist_Y_Mean_Value)<mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][0]&&(SmartPic_clue->Hist_Y_Mean_Value)>mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][1] )
	{
		if(local_ratio_sum>80&&local_ratio_average_high<10&&(local_HistCnt_ratio[1]+local_HistCnt_ratio[2])<=40&&(local_HistCnt_ratio[0]>0 && local_HistCnt_ratio[0]<10))//sony demo
		{

			HistCnt_flag=1;
		}
		else
		{
			HistCnt_flag=0;
		}
	}
	else
	{
		HistCnt_flag=0;
	}
//===========================================================


//==========Saturation_detect_flag condiction============================
	if( (SmartPic_clue->saturationflag)==0)//add for hue_hist_2=0; no data
	{
		radio_color_dete_config=0;
		pre_Saturation_detect_flag = radio_color_dete_config;
	}
	else if( (SmartPic_clue->saturationflag)==3 && pre_Saturation_detect_flag==0)
	{
		radio_color_dete_config=0;
	}
	else
	{
		radio_color_dete_config=1;
		pre_Saturation_detect_flag=radio_color_dete_config;
	}
//================================================================

//===========curr_motion_status condiction==================================
	if( (curr_motion_status<3&&curr_motion_status>0)||curr_motion_status==7)//add for hue_hist_2=0; no data
	{
		curr_motion_status_flag=1;
	}
	else
	{
		curr_motion_status_flag=0;
	}
//================================================================

//===========motion
	Center_Difference = 0;
	for(ii = 4; ii < 12 ; ii++)
	{
		Center_Difference = Center_Difference + Difference_H[ii] + Difference_V[ii];
	}
//===============


//================================================================
	/*START: new "low-sat." condition for still_concentric_circles_detect_flag @ 2014/03/05 since Sirius*/
	sat_hist_sum_bin3to31=0;
	for(i=3;i<32;i++)
		sat_hist_sum_bin3to31 += sat_hist_ratio[i];
	/*END*/
	//scalerVIP_StillMotion(SmartPic_clue); //rord.tsao mark 2015/06/18
	scalerVIP_Difference_H_V_Calculate();

//#if motion_concentric_circles_log
	if((printf_Flag==4) && (MA_print_count%print_delay==0))
		{

			ROSPrintf("ooo--- Histogram_Mean_value=%d ---ooo\n",(SmartPic_clue->Hist_Y_Mean_Value));
			ROSPrintf("ooo--- im_di_hfd_statistic_Reg=%d ---ooo\n",im_di_hfd_statistic_Reg.regValue);
			ROSPrintf("ooo--- Center_Difference=%d 	---ooo\n",Center_Difference/*,	scalerVIP_StillMotion()*/);
			ROSPrintf("ooo--- hist2_sum=%d 	%d---ooo\n",hist2_sum,SmartPic_clue->RTNR_MAD_count_Y_avg_ratio);
			ROSPrintf("ooo--- %d 	%d 		%d	 	%d---ooo\n",((SmartPic_clue->Hist_Y_Mean_Value)<mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][0]&&(SmartPic_clue->Hist_Y_Mean_Value)>mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][1]),(im_di_hfd_statistic_Reg.regValue>=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][2]), (hist2_sum<=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][3]),(Center_Difference>=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][4] && Center_Difference<=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][5]));
			ROSPrintf("ooo--- sat_hist_sum_bin3to31=%d---ooo\n",sat_hist_sum_bin3to31);
			ROSPrintf("ooo-----------------------------------------------ooo\n");
			if(((SmartPic_clue->Hist_Y_Mean_Value)<mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][0]&&(SmartPic_clue->Hist_Y_Mean_Value)>mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][1])==0)
				ROSPrintf("ooo---1. %d < %d < %d---ooo\n",mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][1],(SmartPic_clue->Hist_Y_Mean_Value),mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][0]);
			if((im_di_hfd_statistic_Reg.regValue>=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][2])==0)
				ROSPrintf("ooo---2. %d >= %d---ooo\n",im_di_hfd_statistic_Reg.regValue,mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][2]);
			if((hist2_sum<=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][3])==0)
				ROSPrintf("ooo---3. %d <= %d---ooo\n",hist2_sum,mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][3]);
			if((Center_Difference>=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][4] && Center_Difference<=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][5])==0)
				ROSPrintf("ooo---4. %d <= %d <= %d---ooo\n",mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][4] ,Center_Difference, mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][5]);
			if((sat_hist_sum_bin3to31<=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][6])==0)
				ROSPrintf("ooo---5. %d <= %d ---ooo\n",sat_hist_sum_bin3to31,mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][6]);

		}
//#endif

//	if( ((SmartPic_clue->Hist_Y_Mean_Value)<47&&(SmartPic_clue->Hist_Y_Mean_Value)>40) && curr_motion_status_flag==1 && HistCnt_flag==1 && (im_di_hfd_statistic_Reg.regValue>=120000)   )//sony demo
	if( ((SmartPic_clue->Hist_Y_Mean_Value)<mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][0] &&
		(SmartPic_clue->Hist_Y_Mean_Value)>mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][1]) &&
		(im_di_hfd_statistic_Reg.regValue>=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][2]) &&
		(hist2_sum<=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][3]) &&
		(Center_Difference>=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][4] &&
		Center_Difference<=mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][5]) &&
		sat_hist_sum_bin3to31 <= mcc_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][6])
	{
		still_concentric_circles_detect_flag=1;
	}
	else
	{
		still_concentric_circles_detect_flag=0;
	}
	pre_Center_Difference = Center_Difference;
	counter_file++;

	return still_concentric_circles_detect_flag;

}


unsigned char motion_purecolor_concentric_circles_detect(unsigned int width, unsigned int height)//sony demo
{


	unsigned int hist2_sum;
	unsigned int i;//, hue_hist[24];
	static unsigned int local_hue_his1=0,local_hue_his2=0,local_hue_his3=0;
	unsigned char radio_color_dete_config=0,curr_motion_status_flag=0;
	unsigned int local_HistCnt_ratio[8] = {0};
	unsigned int HistCnt_sum, HistCnt_flag=0, local_ratio_sum=0;
	unsigned char curr_motion_status = 0;

	static unsigned int counter_file=0;
	unsigned char motion_purecolor_concentric_circles_detect_flag=0;//sony demo
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	di_im_di_hfd_statistic_RBUS	im_di_hfd_statistic_Reg;
	im_di_hfd_statistic_Reg.regValue = rtd_inl(DI_IM_DI_HFD_STATISTIC_reg);



    curr_motion_status = scalerVideo_GetCurMotionStatus();
	// oliver-
	//static unsigned short H_Block_Pre1[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
	//static unsigned short V_Block_Pre1[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
	//static unsigned short H_Block_Pre2[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
	//static unsigned short V_Block_Pre2[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

	hist2_sum = 0;
	for(i=0;i<24;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		hist2_sum+= hue_hist_2[i];//already read info. from skin tone detector
	}
	hist2_sum+=1;

	HistCnt_sum = 0;
	for(i=0;i<32;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		HistCnt_sum+= reg_HistCnt[i];//already read info. from skin tone detector
	}
	HistCnt_sum+=1;

	local_HistCnt_ratio[0]=100*(reg_HistCnt[0]+reg_HistCnt[1]+reg_HistCnt[2]+reg_HistCnt[3])/HistCnt_sum;
	local_HistCnt_ratio[1]=100*(reg_HistCnt[4]+reg_HistCnt[5]+reg_HistCnt[6]+reg_HistCnt[7])/HistCnt_sum;
	local_HistCnt_ratio[2]=100*(reg_HistCnt[8]+reg_HistCnt[9]+reg_HistCnt[10]+reg_HistCnt[11])/HistCnt_sum;
	local_HistCnt_ratio[3]=100*(reg_HistCnt[12]+reg_HistCnt[13]+reg_HistCnt[14]+reg_HistCnt[15])/HistCnt_sum;
	local_HistCnt_ratio[4]=100*(reg_HistCnt[16]+reg_HistCnt[17]+reg_HistCnt[18]+reg_HistCnt[19])/HistCnt_sum;
	local_HistCnt_ratio[5]=100*(reg_HistCnt[20]+reg_HistCnt[21]+reg_HistCnt[22]+reg_HistCnt[23])/HistCnt_sum;
	local_HistCnt_ratio[6]=100*(reg_HistCnt[24]+reg_HistCnt[25]+reg_HistCnt[26]+reg_HistCnt[27])/HistCnt_sum;
	local_HistCnt_ratio[7]=100*(reg_HistCnt[28]+reg_HistCnt[29]+reg_HistCnt[30]+reg_HistCnt[31])/HistCnt_sum;

/*
	for(i=0;i<8;i++)
	{
		if(local_HistCnt_ratio[i]<0)
			local_HistCnt_ratio[i]=0;
	}
*/
    if(hist2_sum!=0)
    {
		local_hue_his1 =100*hue_hist_2[9]/hist2_sum;
		local_hue_his2 =100*hue_hist_2[17]/hist2_sum;
		local_hue_his3 =100*hue_hist_2[2]/hist2_sum;
    }


	local_ratio_sum=local_HistCnt_ratio[4]+local_HistCnt_ratio[5]+local_HistCnt_ratio[6]+local_HistCnt_ratio[7];

//==========HistCnt_flag condiction===================================
	if( (SmartPic_clue->Hist_Y_Mean_Value)<30 )
	{
		if(local_ratio_sum<3)
		{

			HistCnt_flag=1;
	}
		else
	{
			HistCnt_flag=0;
		}
	}
	else
	{
		HistCnt_flag=0;
	}
//===========================================================


//==========Saturation_detect_flag condiction============================
if(hist2_sum!=0)
{
	if( (local_hue_his1>=82 && local_hue_his1<=88 ) || (local_hue_his2>=78 && local_hue_his2<=87) || (local_hue_his3>=80 && local_hue_his3<=93) )//add for hue_hist_2=0; no data
	{
		radio_color_dete_config=1;
	}
	else
	{
		radio_color_dete_config=0;
	}
}
//================================================================

//===========curr_motion_status condiction==================================
	if( curr_motion_status<=1)//add for hue_hist_2=0; no data
	{
		curr_motion_status_flag=1;
	}
	else
	{
		curr_motion_status_flag=0;
	}
//================================================================

//================================================================


	if( radio_color_dete_config==1 && curr_motion_status_flag==1 && HistCnt_flag==1 )
	{

		if(counter_file%60==0)
		{
			//ROSPrintf("ooo---motion_purecolor_concentric_circles_detect=1---ooo\n");
		}
		motion_purecolor_concentric_circles_detect_flag=1;
		counter_file++;
		//return 1;
	}
	else
	{
/*
		if(counter_file%60==0)
		{
			ROSPrintf("ooo---motion_purecolor_concentric_circles_detect=0---ooo\n");
			ROSPrintf("ooo--- local_hue_his1=%d,local_hue_his2=%d, local_hue_his3=%d ---ooo\n",local_hue_his1,local_hue_his2,local_hue_his3);
			ROSPrintf("ooo--- hist2_sum=%d, color_dete_config=%d ---ooo\n",hist2_sum,radio_color_dete_config);
			ROSPrintf("ooo--- curr_motion_status = %d,curr_motion_status_flag=%d ---ooo\n",curr_motion_status,curr_motion_status_flag);
			ROSPrintf("ooo--- local_ratio_sum=%d, local_ratio_average_high=%d ---ooo\n",local_ratio_sum);
			ROSPrintf("ooo--- Histogram_Mean_value=%d ,HistCnt_flag=%d---ooo\n",(SmartPic_clue->Hist_Y_Mean_Value),HistCnt_flag);
			ROSPrintf("ooo--- im_di_hfd_statistic_Reg=%d ---ooo\n",im_di_hfd_statistic_Reg.regValue);

		}
*/
		motion_purecolor_concentric_circles_detect_flag=0;
		counter_file++;
		//return 0;
	}

	return motion_purecolor_concentric_circles_detect_flag;


}


unsigned char motion_move_concentric_circles_detect(unsigned int width, unsigned int height)
{
	unsigned int hist_local_sum, hist_sum_localrange, hist_ratio_allrange=0, hist_local_ratio=0, hist2_sum;
	unsigned int i;//, hue_hist[24];
	unsigned char radio_color_dete_config=0,curr_motion_status_flag=0;
	unsigned int local_HistCnt_ratio[8] = {0};
	unsigned int HistCnt_sum, HistCnt_flag=0, local_ratio_sum=0,local_ratio_average_high=0;
	unsigned char curr_motion_status = 0;
	static unsigned char pre_Saturation_detect_flag=1;

	static unsigned int counter_file=0;
	unsigned char motion_move_concentric_circles_detect_flag=0;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	di_im_di_hfd_statistic_RBUS	im_di_hfd_statistic_Reg;
	im_di_hfd_statistic_Reg.regValue = rtd_inl(DI_IM_DI_HFD_STATISTIC_reg);



       curr_motion_status = scalerVideo_GetCurMotionStatus();
	// oliver-
	//static unsigned short H_Block_Pre1[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
	//static unsigned short V_Block_Pre1[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
	//static unsigned short H_Block_Pre2[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
	//static unsigned short V_Block_Pre2[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

	hist2_sum = 0;
	for(i=0;i<24;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		hist2_sum+= hue_hist_2[i];//already read info. from skin tone detector
	}
	hist2_sum+=1;

	HistCnt_sum = 0;
	for(i=0;i<32;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		HistCnt_sum+= reg_HistCnt[i];//already read info. from skin tone detector
	}
	HistCnt_sum+=1;


	local_HistCnt_ratio[0]=100*(reg_HistCnt[0]+reg_HistCnt[1]+reg_HistCnt[2]+reg_HistCnt[3])/HistCnt_sum;
	local_HistCnt_ratio[1]=100*(reg_HistCnt[4]+reg_HistCnt[5]+reg_HistCnt[6]+reg_HistCnt[7])/HistCnt_sum;
	local_HistCnt_ratio[2]=100*(reg_HistCnt[8]+reg_HistCnt[9]+reg_HistCnt[10]+reg_HistCnt[11])/HistCnt_sum;
	local_HistCnt_ratio[3]=100*(reg_HistCnt[12]+reg_HistCnt[13]+reg_HistCnt[14]+reg_HistCnt[15])/HistCnt_sum;
	local_HistCnt_ratio[4]=100*(reg_HistCnt[16]+reg_HistCnt[17]+reg_HistCnt[18]+reg_HistCnt[19])/HistCnt_sum;
	local_HistCnt_ratio[5]=100*(reg_HistCnt[20]+reg_HistCnt[21]+reg_HistCnt[22]+reg_HistCnt[23])/HistCnt_sum;
	local_HistCnt_ratio[6]=100*(reg_HistCnt[24]+reg_HistCnt[25]+reg_HistCnt[26]+reg_HistCnt[27])/HistCnt_sum;
	local_HistCnt_ratio[7]=100*(reg_HistCnt[28]+reg_HistCnt[29]+reg_HistCnt[30]+reg_HistCnt[31])/HistCnt_sum;
/*
		for(i=0;i<8;i++)
		{
		if(local_HistCnt_ratio[i]<0)
			local_HistCnt_ratio[i]=0;
	}
*/
	hist_local_sum = reg_HistCnt[9]+reg_HistCnt[10]+reg_HistCnt[14];

	for(i=1;i<17;i++)
	{
		hist_sum_localrange = reg_HistCnt[i];
	}

	if (hist2_sum) //(hist2_sum); avoid divide by zero
		hist_ratio_allrange = hist_local_sum*100/hist2_sum;

	if (hist_sum_localrange)  // hist_sum_local could be zero when system booting
		hist_local_ratio = hist_local_sum*100/hist_sum_localrange;

	local_ratio_sum=local_HistCnt_ratio[1]+local_HistCnt_ratio[2]+local_HistCnt_ratio[3]+local_HistCnt_ratio[4]+local_HistCnt_ratio[5];
	local_ratio_average_high=(local_HistCnt_ratio[6]+local_HistCnt_ratio[7]);

//==========HistCnt_flag condiction===================================
	if( (SmartPic_clue->Hist_Y_Mean_Value)<47&&(SmartPic_clue->Hist_Y_Mean_Value)>40 )
	{
		if(local_ratio_sum>80 && local_ratio_average_high<=6 && local_HistCnt_ratio[0]<3 )
		{

			HistCnt_flag=1;
	}
	else
	{
			HistCnt_flag=0;
		}
	}
	else
	{
		HistCnt_flag=0;
	}
//===========================================================


//==========Saturation_detect_flag condiction============================
	if( (SmartPic_clue->saturationflag)==0)//add for hue_hist_2=0; no data
	{
		radio_color_dete_config=0;
		pre_Saturation_detect_flag = radio_color_dete_config;
	}
	else if( (SmartPic_clue->saturationflag)==3 && pre_Saturation_detect_flag==0)
	{
		radio_color_dete_config=0;
	}
	else
	{
		radio_color_dete_config=1;
		pre_Saturation_detect_flag=radio_color_dete_config;
	}
//================================================================

//===========curr_motion_status condiction==================================
	if(system_info_structure_table->Input_src_Form == _SRC_FROM_VDC)
	{
		if(scalerVideo_readMode()==VDC_MODE_PALI)
		{
			if( curr_motion_status==7)//add for hue_hist_2=0; no data
			{
				curr_motion_status_flag=1;
			}
			else
			{
				curr_motion_status_flag=0;
			}
		}

		if(scalerVideo_readMode()==VDC_MODE_NTSC)
			{
			if( curr_motion_status>=5)//add for hue_hist_2=0; no data
			{
				curr_motion_status_flag=1;
			}
			else
			{
				curr_motion_status_flag=0;
			}
		}
	}


//================================================================

//================================================================


#if 0
static unsigned int print_cnt = 0;
if(print_cnt % 60 == 0)
	ROSPrintf("[nick187] curr_ms=%d, DCC_MC=%d, lrah=%d, lHr[0]=%d, hfd_statistic=%d\n",
	curr_motion_status_flag, (SmartPic_clue->Hist_Y_Mean_Value), local_ratio_average_high, local_HistCnt_ratio[0], im_di_hfd_statistic_Reg.regValue);
print_cnt ++;
#endif

	if( curr_motion_status_flag==1 && HistCnt_flag==1 && (im_di_hfd_statistic_Reg.regValue>=50000)   )
	{

		if(counter_file%60==0)
		{
			//ROSPrintf("ooo---motion_move_concentric_circles_detect=1---ooo\n");
		}
		motion_move_concentric_circles_detect_flag=1;
		counter_file++;
		//return 1;
	}
	else
	{
/*
		if(counter_file%60==0)
		{
			ROSPrintf("ooo---motion_move_concentric_circles_detect=0---ooo\n");
			ROSPrintf("ooo--- Saturation_detect_flag=%d ---ooo\n",(SmartPic_clue->saturationflag));
			ROSPrintf("ooo--- curr_motion_status = %d,curr_motion_status_flag=%d ---ooo\n",curr_motion_status,curr_motion_status_flag);
			ROSPrintf("ooo--- hist_ratio_allrange=%d, hist_local_ratio=%d ---ooo\n",hist_ratio_allrange,hist_local_ratio);
			ROSPrintf("ooo--- local_ratio_sum=%d, local_ratio_average_high=%d ---ooo\n",local_ratio_sum,local_ratio_average_high);
			ROSPrintf("ooo--- Histogram_Mean_value=%d ,HistCnt_flag=%d---ooo\n",(SmartPic_clue->Hist_Y_Mean_Value),HistCnt_flag);
			ROSPrintf("ooo--- im_di_hfd_statistic_Reg=%d ---ooo\n",im_di_hfd_statistic_Reg.regValue);

		for(i=0;i<8;i++)
		{
				ROSPrintf("ooo--- local_HistCnt_ratio[%d]=%d ---ooo\n",i,local_HistCnt_ratio[i]);
		}

		}
*/
		motion_move_concentric_circles_detect_flag=0;
		counter_file++;
		//return 0;
	}

	return motion_move_concentric_circles_detect_flag;


}





void DI_Champagne_problem(void)
{

		di_im_di_ma_frame_motion_th_a_RBUS frame_motion_a_reg;// frame motion a
		di_im_di_ma_frame_motion_th_b_RBUS frame_motion_b_reg;// frame motion b
		di_im_di_ma_frame_motion_th_c_RBUS frame_motion_c_reg;// frame motion c
		di_im_di_ma_field_teeth_th_a_RBUS  field_teeth_th_a_reg;

		//if((SmartPic_clue->Champagne_flag)==1)// && film_motion_top > 4 && film_motion_bot > 4 && film_motion_left > 4 && film_motion_right > 4)
		//{
			frame_motion_a_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg);
			frame_motion_b_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg);
			frame_motion_c_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg);
			field_teeth_th_a_reg.regValue = rtd_inl(DI_IM_DI_MA_FIELD_TEETH_TH_A_reg);

			frame_motion_a_reg.ma_framemtha = 0x04;
			frame_motion_a_reg.ma_framehtha = 0x05;
			frame_motion_a_reg.ma_framerlvtha = 0x01;
			frame_motion_a_reg.ma_framestha = 0x01;

			frame_motion_b_reg.ma_framemthb = 0x14;
			frame_motion_b_reg.ma_framehthb = 0x0a;
			frame_motion_b_reg.ma_framerlvthb = 0x02;
			frame_motion_b_reg.ma_framesthb = 0x02;

			frame_motion_c_reg.ma_framemthc = 0x32;
			frame_motion_c_reg.ma_framehthc = 0x14;
			frame_motion_c_reg.ma_framerlvthc = 0x01;
			frame_motion_c_reg.ma_framesthc = 0x01;

			field_teeth_th_a_reg.ma_fieldteethstha = 0x32;
			field_teeth_th_a_reg.ma_fieldteethmtha = 0x14;
			field_teeth_th_a_reg.ma_fieldteethhtha = 0x03;
			field_teeth_th_a_reg.ma_fieldteethrlvtha = 0x03;

			/*
			frame_motion_a_reg.regValue =   0x04050101; //0x04050202;
			frame_motion_b_reg.regValue =   0x140a0202; //0x140a060c;
			frame_motion_c_reg.regValue =   0x32140101; //0x140a060c;
			field_teeth_th_a_reg.regValue = 0x32140303; //0x3a141018;
			*/

			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, frame_motion_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, frame_motion_b_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, frame_motion_c_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FIELD_TEETH_TH_A_reg, field_teeth_th_a_reg.regValue);
		//}
		//else
		//{
		//	scalerVIP_colorMAQuickSetTh(2);
		//}


}


unsigned char DI_detect_Champagne(unsigned int width, unsigned int height)
{

	unsigned int cur_total_motion;
	static unsigned int counter_file=0;
	unsigned int film_motion_c, film_motion_top, film_motion_bot, film_motion_left, film_motion_right;
	unsigned int motion_h_09, motion_h_10, motion_h_11;

	unsigned int hist_local_sum, hist_sum_localrange, hist_ratio_allrange=0, hist_local_ratio=0, hist2_sum;
	int i;
	unsigned int local_HistCnt_ratio[8],HistCnt_sum;
	unsigned char curr_motion_status = 0;

	unsigned char his_flag=0, Mean_value_flag=0, motion_flag=0;
	unsigned char DI_detect_Champagne_flag=0;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	di_im_di_hfd_statistic_RBUS	im_di_hfd_statistic_Reg;
	im_di_hfd_statistic_Reg.regValue = rtd_inl(DI_IM_DI_HFD_STATISTIC_reg);

	//di_im_di_si_film_motion_h_09_RBUS im_di_si_film_motion_h_09_reg;
	//di_im_di_si_film_motion_h_10_RBUS im_di_si_film_motion_h_10_reg;
	//di_im_di_si_film_motion_h_11_RBUS im_di_si_film_motion_h_11_reg;

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use rtd_t_inl in kernel
	cur_total_motion = rtd_t_inl(di_im_di_si_ma_total_fm_sum_RBUS,DI_IM_DI_SI_MA_TOTAL_FM_SUM_reg).total_frame_motion_sum;
	film_motion_c = rtd_t_inl(di_im_di_si_film_motion_c_RBUS,DI_IM_DI_SI_FILM_MOTION_C_reg).film_motionstatus_259_240;
	film_motion_top = rtd_t_inl(di_im_di_si_film_motion_h_t_RBUS,DI_IM_DI_SI_FILM_MOTION_H_T_reg).film_motionstatus_379_360;
	film_motion_bot = rtd_t_inl(di_im_di_si_film_motion_h_b_RBUS,DI_IM_DI_SI_FILM_MOTION_H_B_reg).film_motionstatus_339_320;
	film_motion_left = rtd_t_inl(di_im_di_si_film_motion_v_l_RBUS,DI_IM_DI_SI_FILM_MOTION_V_L_reg).film_motionstatus_319_300;
	film_motion_right = rtd_t_inl(di_im_di_si_film_motion_v_r_RBUS,DI_IM_DI_SI_FILM_MOTION_V_R_reg).film_motionstatus_279_260;

	motion_h_09 = rtd_t_inl(di_im_di_si_film_motion_h_09_RBUS,DI_IM_DI_SI_FILM_MOTION_H_09_reg).film_motionstatus_199_180;
	motion_h_10 = rtd_t_inl(di_im_di_si_film_motion_h_10_RBUS,DI_IM_DI_SI_FILM_MOTION_H_10_reg).film_motionstatus_219_200;
	motion_h_11 = rtd_t_inl(di_im_di_si_film_motion_h_11_RBUS,DI_IM_DI_SI_FILM_MOTION_H_11_reg).film_motionstatus_239_220;
#else
	di_im_di_si_ma_total_fm_sum_RBUS ma_total_fm_sum;
	di_im_di_si_film_motion_c_RBUS di_si_film_motion_c;
	di_im_di_si_film_motion_h_t_RBUS di_si_film_motion_h_t;
	di_im_di_si_film_motion_h_b_RBUS di_si_film_motion_h_b;
	di_im_di_si_film_motion_v_l_RBUS di_si_film_motion_v_l;
	di_im_di_si_film_motion_v_r_RBUS di_si_film_motion_v_r;

	di_im_di_si_film_motion_h_09_RBUS di_si_film_motion_h_09;
	di_im_di_si_film_motion_h_10_RBUS di_si_film_motion_h_10;
	di_im_di_si_film_motion_h_11_RBUS di_si_film_motion_h_11;

	ma_total_fm_sum.regValue = rtd_inl(DI_IM_DI_SI_MA_TOTAL_FM_SUM_reg);
	di_si_film_motion_c.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_C_reg);
	di_si_film_motion_h_t.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_T_reg);
	di_si_film_motion_h_b.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_B_reg);
	di_si_film_motion_v_l.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_V_L_reg);
	di_si_film_motion_v_r.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_V_R_reg);

	di_si_film_motion_h_09.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_09_reg);
	di_si_film_motion_h_10.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_10_reg);
	di_si_film_motion_h_11.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_11_reg);


	cur_total_motion = ma_total_fm_sum.total_frame_motion_sum;
	film_motion_c = di_si_film_motion_c.film_motionstatus_259_240;
	film_motion_top = di_si_film_motion_h_t.film_motionstatus_379_360;
	film_motion_bot = di_si_film_motion_h_b.film_motionstatus_339_320;
	film_motion_left = di_si_film_motion_v_l.film_motionstatus_319_300;
	film_motion_right = di_si_film_motion_v_r.film_motionstatus_279_260;

	motion_h_09 = di_si_film_motion_h_09.film_motionstatus_199_180;
	motion_h_10 = di_si_film_motion_h_10.film_motionstatus_219_200;
	motion_h_11 = di_si_film_motion_h_11.film_motionstatus_239_220;
#endif

	curr_motion_status = scalerVideo_GetCurMotionStatus();

	hist2_sum = 0;
	for(i=0;i<24;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		hist2_sum+= hue_hist_2[i];//already read info. from skin tone detector
	}
	hist2_sum+=1;

	hist_local_sum = hue_hist_2[3]+hue_hist_2[4];
	hist_sum_localrange = hue_hist_2[2]+hist_local_sum+hue_hist_2[5]+hue_hist_2[6];

	if (hist2_sum) //(hist2_sum); avoid divide by zero
		hist_ratio_allrange = hist_local_sum*100/hist2_sum;

	if (hist_sum_localrange)  // hist_sum_local could be zero when system booting
		hist_local_ratio = hist_local_sum*100/hist_sum_localrange;

	HistCnt_sum = 0;
	for(i=0;i<32;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		HistCnt_sum+= reg_HistCnt[i];//already read info. from skin tone detector
	}
	HistCnt_sum+=1;

//===================FOR add condiction avoid restaurant  (not OK)==========================================

		local_HistCnt_ratio[0]=100*(reg_HistCnt[0]+reg_HistCnt[1]+reg_HistCnt[2]+reg_HistCnt[3])/HistCnt_sum;
		local_HistCnt_ratio[1]=100*(reg_HistCnt[4]+reg_HistCnt[5]+reg_HistCnt[6]+reg_HistCnt[7])/HistCnt_sum;
		local_HistCnt_ratio[2]=100*(reg_HistCnt[8]+reg_HistCnt[9]+reg_HistCnt[10]+reg_HistCnt[11])/HistCnt_sum;
		local_HistCnt_ratio[3]=100*(reg_HistCnt[12]+reg_HistCnt[13]+reg_HistCnt[14]+reg_HistCnt[15])/HistCnt_sum;
		local_HistCnt_ratio[4]=100*(reg_HistCnt[16]+reg_HistCnt[17]+reg_HistCnt[18]+reg_HistCnt[19])/HistCnt_sum;
		local_HistCnt_ratio[5]=100*(reg_HistCnt[20]+reg_HistCnt[21]+reg_HistCnt[22]+reg_HistCnt[23])/HistCnt_sum;
		local_HistCnt_ratio[6]=100*(reg_HistCnt[24]+reg_HistCnt[25]+reg_HistCnt[26]+reg_HistCnt[27])/HistCnt_sum;
		local_HistCnt_ratio[7]=100*(reg_HistCnt[28]+reg_HistCnt[29]+reg_HistCnt[30]+reg_HistCnt[31])/HistCnt_sum;


	if(local_HistCnt_ratio[3]>=70 && local_HistCnt_ratio[3]<=90)
	{
		his_flag=1;
	}
	else
	{
		his_flag=0;
	}

	if((SmartPic_clue->Hist_Y_Mean_Value)>=38 && (SmartPic_clue->Hist_Y_Mean_Value)<=47)
	{
		Mean_value_flag=1;
	}
	else
	{
		Mean_value_flag=0;
	}

	if(motion_h_09<=300 && motion_h_10<=80 && motion_h_11<=60 && film_motion_left<=20 && film_motion_bot<=100 )
	{
		motion_flag=1;
	}
	else
	{
		motion_flag=0;
	}


	counter_file++;


	if( his_flag==1 && Mean_value_flag==1 && motion_flag==1 && (SmartPic_clue->di_motion_status)<=3 && im_di_hfd_statistic_Reg.regValue<=1000)
	{

		DI_detect_Champagne_flag =1;
	}
	else
	{
		DI_detect_Champagne_flag =0;
	}


	if(counter_file%10==0)
	{
		if(DI_detect_Champagne_flag==1)
		{
			VIP_DEBUG_PRINTF("oo---DI_detect_Champagne_flag=%d---oo\n",DI_detect_Champagne_flag);
		}
		else
		{

			VIP_DEBUG_PRINTF("oo---DI_detect_Champagne_flag=%d---oo\n",DI_detect_Champagne_flag);
/*
		ROSPrintf("o---film_motion_left = %d, MA_data[1] = %d, MA_data[2] = %d  ---o\n", film_motion_left, film_motion_bot, film_motion_c);
		ROSPrintf("oo---motion_h_09=%d, motion_h_10=%d, motion_h_11=%d---oo\n",motion_h_09,motion_h_10,motion_h_11);
		ROSPrintf("oo---Histogram_Mean_value=%d---oo\n",(SmartPic_clue->Hist_Y_Mean_Value));
		ROSPrintf("oo---motion_flag=%d, Mean_value_flag=%d,his_flag=%d---oo\n",motion_flag,Mean_value_flag,his_flag);
		for(i=0;i<8;i++)
		{
			ROSPrintf("ooo--- local_HistCnt_ratio[%d]=%d ---ooo\n",i,local_HistCnt_ratio[i]);
		}

		for(i=0;i<COLOR_HISTOGRAM_LEVEL;i++)
		{
			ROSPrintf(">>>>>>>>>>>>>>>> reg_HistCnt[%d] = %d <<<<<<<<<<<<<<<\n",i,reg_HistCnt[i]);
		}

		for(i=0; i<24; i++)
		{
			ROSPrintf(">>>>>>>>>>>>>>>> hue_hist_2[%d] = %d <<<<<<<<<<<<<<<\n",i,hue_hist_2[i]);
		}
*/
		}

}



	return DI_detect_Champagne_flag;


}

unsigned char Sony_radio_detect(unsigned char channel, unsigned int width, unsigned int height)
{
	unsigned int hist_local_sum, hist_sum_localrange, hist_ratio_allrange=0, hist_local_ratio=0, hist2_sum;
	unsigned int i;//, hue_hist[24];
	unsigned char radio_color_dete_config=0;
	unsigned int local_HistCnt_ratio[8],HistCnt_sum;
	unsigned char curr_motion_status = 0;
	static unsigned char pre_Saturation_detect_flag=1;

	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

    curr_motion_status = scalerVideo_GetCurMotionStatus();

	hist2_sum = 0;
	for(i=0;i<24;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		hist2_sum+= hue_hist_2[i];//already read info. from skin tone detector
	}
	hist2_sum+=1;

	hist_local_sum = hue_hist_2[3]+hue_hist_2[4];
	hist_sum_localrange = hue_hist_2[2]+hist_local_sum+hue_hist_2[5]+hue_hist_2[6];

	if (hist2_sum) //(hist2_sum); avoid divide by zero
		hist_ratio_allrange = hist_local_sum*100/hist2_sum;

	if (hist_sum_localrange)  // hist_sum_local could be zero when system booting
		hist_local_ratio = hist_local_sum*100/hist_sum_localrange;

	HistCnt_sum = 0;
	for(i=0;i<32;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		HistCnt_sum+= reg_HistCnt[i];//already read info. from skin tone detector
	}
	HistCnt_sum+=1;

//===================FOR add condiction avoid restaurant  (not OK)==========================================
	if(HistCnt_sum>0)
	{
		local_HistCnt_ratio[0]=100*(reg_HistCnt[0]+reg_HistCnt[1]+reg_HistCnt[2]+reg_HistCnt[3])/HistCnt_sum;
		local_HistCnt_ratio[1]=100*(reg_HistCnt[4]+reg_HistCnt[5]+reg_HistCnt[6]+reg_HistCnt[7])/HistCnt_sum;
		local_HistCnt_ratio[2]=100*(reg_HistCnt[8]+reg_HistCnt[9]+reg_HistCnt[10]+reg_HistCnt[11])/HistCnt_sum;
		local_HistCnt_ratio[3]=100*(reg_HistCnt[12]+reg_HistCnt[13]+reg_HistCnt[14]+reg_HistCnt[15])/HistCnt_sum;
		local_HistCnt_ratio[4]=100*(reg_HistCnt[16]+reg_HistCnt[17]+reg_HistCnt[18]+reg_HistCnt[19])/HistCnt_sum;
		local_HistCnt_ratio[5]=100*(reg_HistCnt[20]+reg_HistCnt[21]+reg_HistCnt[22]+reg_HistCnt[23])/HistCnt_sum;
		local_HistCnt_ratio[6]=100*(reg_HistCnt[24]+reg_HistCnt[25]+reg_HistCnt[26]+reg_HistCnt[27])/HistCnt_sum;
		local_HistCnt_ratio[7]=100*(reg_HistCnt[28]+reg_HistCnt[29]+reg_HistCnt[30]+reg_HistCnt[31])/HistCnt_sum;
	}
//=====================================================================================


	if( (SmartPic_clue->saturationflag)==0)//add for hue_hist_2=0; no data
	{
		radio_color_dete_config=0;
		pre_Saturation_detect_flag = radio_color_dete_config;
	}
	else if( (SmartPic_clue->saturationflag)==3 && pre_Saturation_detect_flag==0)
	{
		radio_color_dete_config=0;
	}
	else
	{
		radio_color_dete_config=1;
		pre_Saturation_detect_flag=radio_color_dete_config;
	}

#if 0

	for(i=0;i<COLOR_HISTOGRAM_LEVEL;i++)
	{
		//scalervip_printf(AutoMADebugMsg,">>>>>>>>>>>>>>>> reg_HistCnt[%d] = %d <<<<<<<<<<<<<<<\n",i,reg_HistCnt[i]);
	}

	 //scalervip_printf(AutoMADebugMsg,"\nooo--- hue_hist_2---ooo\n");
	for(i=0; i<24; i++)
	{
		//scalervip_printf(AutoMADebugMsg,">>>>>>>>>>>>>>>> hue_hist_2[%d] = %d <<<<<<<<<<<<<<<\n",i,hue_hist_2[i]);
	}


	//if(MA_print_count%20 == 0)
		//ROSPrintf("%d,%d,%d\n",(SmartPic_clue->Hist_Y_Mean_Value),curr_motion_status,radio_color_dete_config);
#endif

	unsigned char his_up_th=0, his_low_th=0;
	unsigned char which_source=255;
	which_source=(RPC_system_info_structure_table->VIP_source);

	if((which_source>=VIP_QUALITY_HDMI_480I && which_source<=VIP_QUALITY_HDMI_576P)||(which_source>=VIP_QUALITY_YPbPr_480I && which_source<=VIP_QUALITY_YPbPr_576P))
	{
		his_up_th = 13;
		his_low_th = 7;
	}
	else if((which_source>=VIP_QUALITY_HDMI_720P && which_source<=VIP_QUALITY_HDMI_1080P))
	{
		his_up_th = 19;
		his_low_th = 16;
	}

	//if((SmartPic_clue->Hist_Y_Mean_Value)<12 && curr_motion_status<3 && radio_color_dete_config==0 )//sony demo
	if((SmartPic_clue->Hist_Y_Mean_Value)<=his_up_th && (SmartPic_clue->Hist_Y_Mean_Value)>=his_low_th && curr_motion_status<3 && radio_color_dete_config==0 )// for sony demo 480i,blu-ray 4:3,16:9
	{
		if(MA_print_count%30 ==0)
		{
			//ROSPrintf("ooo---Sony_radio_detect=1---ooo\n");
		}
//===================FOR add condiction avoid restaurant  (not OK)==========================================
		//for(i=0;i<8;i++)
		//{
			//scalervip_printf(AutoMADebugMsg,"ooo--- local_HistCnt_ratio[%d]=%d ---ooo\n",i,local_HistCnt_ratio[i]);
		//}
//===================FOR add condiction avoid restaurant  (not OK)==========================================
		return 1;
	}
	else
	{
		//ROSPrintf("ooo---Sony_radio_detect=0---ooo\n");
		//ROSPrintf("ooo--- Saturation_detect_flag=%d, radio_color_dete_config=%d, pre_Saturation_detect_flag=%d ---ooo\n",(SmartPic_clue->saturationflag),radio_color_dete_config,pre_Saturation_detect_flag);
		//ROSPrintf("ooo--- curr_motion_status = %d ---ooo\n",curr_motion_status);
		//ROSPrintf("ooo--- hist_ratio_allrange=%d, hist_local_ratio=%d ---ooo\n",hist_ratio_allrange,hist_local_ratio);
		//ROSPrintf("ooo--- Histogram_Mean_value=%d ---ooo\n",(SmartPic_clue->Hist_Y_Mean_Value));

		return 0;
	}

}

unsigned int black_white_detect_table[5][6] =
{
	{300,	1,		60000,		2		},	//NTSC
	{300,	1,		60000,		2		},	//PAL
	{1,		1,		40000,		40000	},	//SD
	{1,		1,		40000,		40000	},	//HD
	{1,		1,		40000,		40000	},	//VGA
};
unsigned char black_white_pattern_detect(void)
{
	unsigned int MA_hist2_sum;
	unsigned int hist2_sum;
	unsigned char i;
	hist2_sum = 0;
	for(i=0;i<24;i++)
	{
		//hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		hist2_sum+= hue_hist_2[i];//already read info. from skin tone detector
	}
	hist2_sum+=1;

	MA_hist2_sum = Lerp(SmartPic_clue->RTNR_MAD_count_Y_avg_ratio, black_white_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][0], black_white_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][1], black_white_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][2], black_white_detect_table[(SmartPic_clue->Remmping_Src_Timing_index)][3], 0, 0);

	unsigned char u_coring,v_coring;
	color_icm_dm_uv_coring_RBUS dm_uv_coring_REG;
	dm_uv_coring_REG.regValue = rtd_inl(COLOR_ICM_DM_UV_Coring_reg);
	u_coring = dm_uv_coring_REG.u_coring;
	v_coring = dm_uv_coring_REG.v_coring;

#if black_white_pattern_log
	if(MA_print_count%30 ==0)
	{
		ROSPrintf(" RTNR_MAD_count_Y_sum_avg  = %d\n",RTNR_MAD_count_Y);
		ROSPrintf(" u_coring  = %d\n",u_coring);
		ROSPrintf(" MA_hist2_sum  = %d\n",MA_hist2_sum);
		ROSPrintf(" hist2_sum  = %d\n",hist2_sum);
		ROSPrintf(" (MA_hist2_sum - ((MA_hist2_sum*u_coring)>>7))  = %d\n",(MA_hist2_sum - ((MA_hist2_sum*u_coring)>>7)));
		if((hist2_sum<(MA_hist2_sum - ((MA_hist2_sum*u_coring)>>7))) == 0)
			ROSPrintf("1. %d < %d\n",hist2_sum ,(MA_hist2_sum - ((MA_hist2_sum*u_coring)>>7)));
	}
#endif

	if((hist2_sum<(MA_hist2_sum - ((MA_hist2_sum*u_coring)>>7))))
	{
		return 1;
	}
	else
	{
		return 0;
	}

}

//------------------------------------------------------
// Erin move 100305

//------------------------------------------------------
/**
 * Color histogram ISR
 *
 * @param	void
 * @return	void
 */
short SHP_Coef [VIP_QUALITY_SOURCE_NUM][VIP_QUALITY_D_PEAKING_NUM];

//--------------------------------------------------
// Move from Pacific Start , Erin 100305
//--------------------------------------------------

#if 0//frank@1127 reduce code
void drvif_color_AutoColorBarNR_ON(unsigned char channel)//Leo Chen add,20101227
{
	color_d_vc_global_ctrl_RBUS d_vc_global_ctrl_reg;
	d_vc_global_ctrl_reg.regValue = scaler_rtd_inl(COLOR_D_VC_Global_CTRL_reg);

	d_vc_global_ctrl_reg.m_sharp_en=0;
	//d_vc_global_ctrl_reg.m_icm_en=0; //affect colorbar detection, mark it
	drvif_color_setcdcti(channel,10);

	scaler_rtd_outl(COLOR_D_VC_Global_CTRL_reg, d_vc_global_ctrl_reg.regValue);

}

void drvif_color_AutoColorBarNR_OFF(unsigned char channel)//Leo Chen add,20101227
{
	color_d_vc_global_ctrl_RBUS d_vc_global_ctrl_reg;
	d_vc_global_ctrl_reg.regValue = scaler_rtd_inl(COLOR_D_VC_Global_CTRL_reg);

	d_vc_global_ctrl_reg.m_sharp_en=1;
	//d_vc_global_ctrl_reg.m_icm_en=1;//affect colorbar detection, mark it
	drvif_color_setcdcti(channel,TableDCTI);

	scaler_rtd_outl(COLOR_D_VC_Global_CTRL_reg, d_vc_global_ctrl_reg.regValue);
}
#endif

unsigned short H_Block_Pre1[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned short V_Block_Pre1[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned short H_Block_Pre2[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
unsigned short V_Block_Pre2[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

int drvif_color_colorbar_dectector(_clues* SmartPic_clue)//planck_HDMI
{
	unsigned char i;
	unsigned short Left_Total=0;
	unsigned short Right_Total=0;
	unsigned char Left_high=0;
	unsigned char imcolorbar_H_Ratio = 0;
	unsigned char imcolorbar_V_Ratio = 0;
	unsigned char imcolorbar_H_diff = 0;
	unsigned char imcolorbar_V_diff = 0;
	unsigned char imcolorbar_Hue = 0;
	unsigned short Max=0;
	unsigned short Min=65535;
	unsigned short H_Block_Diff[16] ;
	unsigned short V_Block_Diff[16] ;
	unsigned char H_Block_Diff_Count=0;
	unsigned char V_Block_Diff_Count=0;
	static unsigned char print_cnt=0;
	//static int imcolorbar_H_diff_temp = 0, imcolorbar_V_diff_temp=0;

	unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	for ( i=0 ; i<24 ; i++ )
	{
		if(hue_hist_2[i] != 0){
			imcolorbar_Hue = 1;
			break;
		}
		else{
			imcolorbar_Hue = 0;
		}
	}
	for(i=1;i<10;i++)
	{
		if(H_Block[i]<=Min)
			Min=H_Block[i];
		if(H_Block[i]>=Max)
			Max=H_Block[i];
	}
	if( (Max-Min)*100/(Min+1)<10 )
		imcolorbar_H_Ratio=1;

	if((print_cnt % 120) == 0)
	{
		//ROSPrintf("Max_H=%d\n",Max);
		//ROSPrintf("Min_H=%d\n",Min);
	}

	Max=0;
	Min=65535;
	for(i=0;i<15;i++)
	{
		if(V_Block[i]<=Min)
			Min=V_Block[i];
		if(V_Block[i]>=Max)
			Max=V_Block[i];
	}
	if( (Max-Min)*100/(Min+1)>4 )
		imcolorbar_V_Ratio=1;

	for(i=0;i<8;i++)
	{
		Left_Total+=V_Block[7-i];
		Right_Total+=V_Block[i+8];
	}

if((print_cnt % 300) == 0){

	//ROSPrintf("Max_V=%d\n",Max);
	//ROSPrintf("Min_V=%d\n",Min);

	//ROSPrintf("Left_Total=%d\n",Left_Total);
	//ROSPrintf("Right_Total=%d\n",Right_Total);
}

	if(((Left_Total*103)/(Right_Total+1))>200)
		Left_high=1;

	for(i=0;i<16;i++)
	{
		H_Block_Diff[i] = ABS(H_Block[i], H_Block_Pre2[i] );
		V_Block_Diff[i] = ABS(V_Block[i], V_Block_Pre2[i] );

		if(H_Block_Diff[i] <= 15){
			H_Block_Diff_Count++;
		}
		if(V_Block_Diff[i] <= 15){
			V_Block_Diff_Count++;
		}
	}
	if(H_Block_Diff_Count >= 15){
		imcolorbar_H_diff = 1;
	}
	if(V_Block_Diff_Count >= 15){
		imcolorbar_V_diff = 1;
	}

	for ( i=0 ; i<16 ; i++ )
	{
		H_Block_Pre2[i] = H_Block_Pre1[i];
		V_Block_Pre2[i] = V_Block_Pre1[i];
		H_Block_Pre1[i] = H_Block[i];
		V_Block_Pre1[i] = V_Block[i];
	}

#if 0
	if((print_cnt % 300) == 0){
		for(i=0;i<16;i++)
		{
			ROSPrintf("H_Block_Diff[%d]=%d, V_Block_Diff[%d]=%d\n",i,H_Block_Diff[i],i,V_Block_Diff[i]);
		}
		ROSPrintf("H_Block_Diff_Count=%d, V_Block_Diff_Count=%d\n",H_Block_Diff_Count,V_Block_Diff_Count);
		ROSPrintf("imcolorbar_H_diff_temp=%d, imcolorbar_V_diff_temp=%d\n",imcolorbar_H_diff_temp,imcolorbar_V_diff_temp);
		ROSPrintf("imcolorbar_H_diff=%d, imcolorbar_V_diff=%d, imcolorbar_Hue= %d\n",imcolorbar_H_diff,imcolorbar_V_diff,imcolorbar_Hue);
		ROSPrintf("imcolorbar_H_Ratio=%d, imcolorbar_V_Ratio=%d, Left_high= %d\n",imcolorbar_H_Ratio,imcolorbar_V_Ratio,Left_high);

		if(( imcolorbar_H_diff_temp>=2 || imcolorbar_V_diff_temp>=2))
		{
			ROSPrintf("diff_temp = 1\n");
		}

		if((imcolorbar_H_diff ==1 || imcolorbar_V_diff ==1))
		{
			ROSPrintf("diff = 1\n");
		}

		if(( (imcolorbar_H_diff ==1) || (imcolorbar_V_diff ==1) || ((imcolorbar_H_diff_temp>=2) || (imcolorbar_V_diff_temp>=2))))
		{
			ROSPrintf("mix_diff = 1\n");
		}

	}
#endif

	print_cnt++;
	if((imcolorbar_H_Ratio ==1)  && (imcolorbar_V_Ratio ==1) && (Left_high==1) && ( (imcolorbar_H_diff ==1) || (imcolorbar_V_diff ==1) ) && imcolorbar_Hue==1 )
	{
		if((print_cnt % 120) == 0){
		/*
			ROSPrintf(" i'm a vertical colobar!!\n");
		*/
				print_cnt = 0;
		};
		return 1;
	}
	else
	{
			if(((print_cnt % 120) == 0)){
			/*
				ROSPrintf(" Not a vertical colobar!!\n");
				ROSPrintf("H_Block_Diff_Count=%d, V_Block_Diff_Count=%d\n",H_Block_Diff_Count,V_Block_Diff_Count);
				ROSPrintf("imcolorbar_H_diff_temp=%d, imcolorbar_V_diff_temp=%d\n",imcolorbar_H_diff_temp,imcolorbar_V_diff_temp);
				ROSPrintf("imcolorbar_H_diff=%d, imcolorbar_V_diff=%d, imcolorbar_Hue= %d\n",imcolorbar_H_diff,imcolorbar_V_diff,imcolorbar_Hue);
				ROSPrintf("imcolorbar_H_Ratio=%d, imcolorbar_V_Ratio=%d, Left_high= %d\n",imcolorbar_H_Ratio,imcolorbar_V_Ratio,Left_high);
				ROSPrintf("Max_H=%d\n",Max);
				ROSPrintf("Min_H=%d\n",Min);
			*/
				print_cnt = 0;
			}

		return 0;
	}

}


int drvif_color_colorbar_dectector_by_SatHueProfile(_clues* SmartPic_clue)//planck_HDMI
{
	unsigned char i;
	unsigned char imcolorbar_H_diff = 0;
	unsigned char imcolorbar_V_diff = 0;
	unsigned char imcolorbar_Hue = 0;

	unsigned short Max_range[6]={0,0,0,0,0,0};
	unsigned short Min_range[6]={65535,65535,65535,65535,65535,65535};
	unsigned short diff[6]={0,0,0,0,0,0},max_ratio=0,min_ratio=0;
	unsigned short diff_min_index=6,min_diff=65535,diff_max_index=6,max_diff=0;

	unsigned short H_Block_Diff[16] ;
	unsigned short V_Block_Diff[16] ;
	unsigned char H_Block_Diff_Count=0;
	unsigned char V_Block_Diff_Count=0;

	int symmetry_score = 0, hue_score=0, color_bar_score =0, HV_diff_score=0;
	static short debounce = 5, pre_color_bar_score=255;

	unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	//== symmetry judge for H====
	for(i=0;i<16;i++)
	{
		//up
	 	if((i>=1) && (i<=7))
	  	{
	  		if(H_Block[i]<=Min_range[0])
				Min_range[0]=H_Block[i];
			if(H_Block[i]>=Max_range[0])
				Max_range[0]=H_Block[i];
	 	}
		//middle
		if((i>=6) && (i<=10))
	  	{
	  		if(H_Block[i]<=Min_range[1])
				Min_range[1]=H_Block[i];
			if(H_Block[i]>=Max_range[1])
				Max_range[1]=H_Block[i];
	 	}
		//down
		if((i>=8) && (i<=14))
	  	{
	  		if(H_Block[i]<=Min_range[2])
				Min_range[2]=H_Block[i];
			if(H_Block[i]>=Max_range[2])
				Max_range[2]=H_Block[i];
	 	}
		//extend_up
		if((i>=1) && (i<=10))
	  	{
	  		if(H_Block[i]<=Min_range[3])
				Min_range[3]=H_Block[i];
			if(H_Block[i]>=Max_range[3])
				Max_range[3]=H_Block[i];
	 	}
		//extend_down
		if((i>=6) && (i<=14))
	  	{
	  		if(H_Block[i]<=Min_range[4])
				Min_range[4]=H_Block[i];
			if(H_Block[i]>=Max_range[4])
				Max_range[4]=H_Block[i];
	 	}
		//up_two_bin
	 	if(/*(i>=0) && */(i<=1))
	  	{
	  		if(H_Block[i]<=Min_range[5])
				Min_range[5]=H_Block[i];
			if(H_Block[i]>=Max_range[5])
				Max_range[5]=H_Block[i];
	 	}
	}

	for(i=0;i<6;i++)
	{
		diff[i]=Max_range[i]-Min_range[i];
		if(diff[i]<=min_diff)
		{
			min_diff = diff[i];
			diff_min_index = i;
		}
		if(diff[i]>=max_diff)
		{
			max_diff = diff[i];
			diff_max_index = i;
		}
	}

	min_ratio = (min_diff*1000)/(Min_range[diff_min_index]+1);
	max_ratio = (max_diff*1000)/(Min_range[diff_max_index]+1);

	if(min_ratio<=10)
	{
		symmetry_score = min_ratio;
	}
	else
	{
		symmetry_score = max_ratio - min_ratio;
		if(symmetry_score<=0)
		{
			symmetry_score =0;
		}
		else if(symmetry_score >= 64)
		{
			symmetry_score =64;
		}
	}

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
	{
		for(i=0;i<6;i++)
		{
			ROSPrintf("diff[%d]=%d\n",i,diff[i]);
		}
		ROSPrintf("max_rario=%d, %d\n",max_ratio,Min_range[diff_min_index]);
		ROSPrintf("min_rario=%d, %d\n",min_ratio,Max_range[diff_min_index]);
	}
	//========================

	//======== motion judge =============
	for(i=0;i<16;i++)
	{
		H_Block_Diff[i] = ABS(H_Block[i], H_Block_Pre2[i] );
		V_Block_Diff[i] = ABS(V_Block[i], V_Block_Pre2[i] );

		if(H_Block_Diff[i] <= 15){
			H_Block_Diff_Count++;
		}
		if(V_Block_Diff[i] <= 15){
			V_Block_Diff_Count++;
		}
	}

	if(H_Block_Diff_Count >= 10)
	{
		imcolorbar_H_diff = 1;
	}

	if(V_Block_Diff_Count >= 10)
	{
		imcolorbar_V_diff = 1;
	}

	HV_diff_score = (H_Block_Diff_Count + V_Block_Diff_Count) - 20;

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
	{
		ROSPrintf("H_Block_Diff_Count=%d, V_Block_Diff_Count=%d\n",H_Block_Diff_Count,V_Block_Diff_Count);
	}
	//===============================

	//====== hue judge= =======

	//R-> hue[2], G->hue[10], B->hue[17]~[18], C->hue[13]~[14], M->hue[21]~[22] ,Y->hue[6]
	unsigned short colorbar_hue_ratio_total = 0, avg_hue_ratio=0, diff_sum_hue_ratio=0;
	unsigned short hue_ratio[6];

	hue_ratio[0]=(SmartPic_clue->Hue_Main_His_Ratio)[1]+(SmartPic_clue->Hue_Main_His_Ratio)[2];//R
	hue_ratio[1]=(SmartPic_clue->Hue_Main_His_Ratio)[9]+(SmartPic_clue->Hue_Main_His_Ratio)[10];//G
	hue_ratio[2]=(SmartPic_clue->Hue_Main_His_Ratio)[17]+(SmartPic_clue->Hue_Main_His_Ratio)[18];//B
	hue_ratio[3]=(SmartPic_clue->Hue_Main_His_Ratio)[13]+(SmartPic_clue->Hue_Main_His_Ratio)[14];//C
	hue_ratio[4]=(SmartPic_clue->Hue_Main_His_Ratio)[21]+(SmartPic_clue->Hue_Main_His_Ratio)[22];//M
	hue_ratio[5]=(SmartPic_clue->Hue_Main_His_Ratio)[5]+(SmartPic_clue->Hue_Main_His_Ratio)[6];//Y

	for ( i=0 ; i<6 ; i++ )
	{
		if(hue_ratio[i] != 0)
		{
			imcolorbar_Hue = 1;
			break;
		}
		else
		{
			imcolorbar_Hue = 0;
		}
	}

	for(i = 0; i < 6; i++)
	{
		colorbar_hue_ratio_total += hue_ratio[i];
	}

	avg_hue_ratio = colorbar_hue_ratio_total/6;

	for(i = 0; i < 6; i++)
	{
		diff_sum_hue_ratio += ABS(hue_ratio[i],avg_hue_ratio);
	}

	//more score, less colorbar
	if(colorbar_hue_ratio_total<=800)
	{
		hue_score = 64;
	}
	else
	{
		hue_score = diff_sum_hue_ratio-70;
		if(hue_score<=0)
		{
			hue_score =0;
		}
		else if(hue_score>=64)
		{
			hue_score =64;
		}
	}
	//=====================

	//====== sat judge= =======
	unsigned char sat_flag = 0;
	if(SmartPic_clue->sat_ratio_mean_value>=43)
	{
		sat_flag = 1;
	}
	else
	{
		sat_flag = 0;
	}
	//=====================

	//color_bar_score => 0 ~ 160, more score, more colorbar
	color_bar_score = ((64- hue_score)+(64-symmetry_score))*sat_flag*imcolorbar_Hue + HV_diff_score;

	if(color_bar_score<=0)
	{
		color_bar_score =0;
	}

	if( abs(pre_color_bar_score-color_bar_score)>1 )
	{
		debounce++;
	}
	else
	{
		debounce--;
	}

	if(debounce<0)
		debounce =0;

	if(debounce>5)
		debounce =5;

	if(debounce>=5)
	{
		pre_color_bar_score = color_bar_score;
	}

	for ( i=0 ; i<16 ; i++ )
	{
		H_Block_Pre2[i] = H_Block_Pre1[i];
		V_Block_Pre2[i] = V_Block_Pre1[i];
		H_Block_Pre1[i] = H_Block[i];
		V_Block_Pre1[i] = V_Block[i];
	}

#if 1
if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ColorBar==TRUE))
{
	ROSPrintf("=== Profile ===\n");
	ROSPrintf(" DispLen=%d, DispWid=%d\n",SmartPic_clue->SCALER_DISP_INFO.DispLen,SmartPic_clue->SCALER_DISP_INFO.DispWid);
	for(i=0;i<16;i++)
	{
		//ROSPrintf("[%d ] H = %d, H_Pre2=%d, H_diff=%d, H_Pre1=%d \n",i,H_Block[i],H_Block_Pre2[i],H_Block_Diff[i],H_Block_Pre1[i]);
		ROSPrintf("[%d ] H = %d\n",i,H_Block[i]);

	}
/*
	for(i=0;i<16;i++)
	{
		//ROSPrintf("[%d ] V = %d, V_Pre2=%d, V_diff=%d, V_Pre1=%d \n",i,V_Block[i],V_Block_Pre2[i],V_Block_Diff[i],V_Block_Pre1[i]);
		ROSPrintf("[%d ] V = %d\n",i,V_Block[i]);
	}
*/
	for(i=0;i<24;i++)
	{
		ROSPrintf("[%d ] HUE = %d, ratio=%d\n",i,hue_hist_2[i], (SmartPic_clue->Hue_Main_His_Ratio)[i]);
	}

	for(i = 0; i < 6; i++)
	{
		ROSPrintf("hue_ratio[%d] = %d\n",i,hue_ratio[i]);
	}

	for(i = 0; i < 32; i++)
	{
		ROSPrintf("[%d ] sat = %d\n",i,(SmartPic_clue->Sat_Main_His_Ratio)[i]);
	}
	ROSPrintf("sat_ratio_mean_value=%d\n",SmartPic_clue->sat_ratio_mean_value);
	ROSPrintf("sat_sumcnt_ratio sat_=%d, hue = %d\n",SmartPic_clue->sat_sumcnt_ratio,SmartPic_clue->hue_sumcnt_ratio);
	ROSPrintf("colorbar_hue_ratio_total=%d\n",colorbar_hue_ratio_total);
	ROSPrintf("avg_hue_ratio=%d,diff_sum_hue_ratio=%d\n",avg_hue_ratio,diff_sum_hue_ratio);
	ROSPrintf("sat_flag=%d,time_H_diff=%d\n",sat_flag, imcolorbar_H_diff);
	ROSPrintf("H_Block_Diff_Count=%d, V_Block_Diff_Count=%d\n",H_Block_Diff_Count,V_Block_Diff_Count);
	ROSPrintf("HV_diff_score=%d\n",HV_diff_score);
	ROSPrintf("symmetry_score=%d\n",symmetry_score);
	ROSPrintf("hue_score=%d\n",hue_score);
	ROSPrintf("color_bar_score=%d,pre_color_bar_score=%d\n",color_bar_score,pre_color_bar_score);

	ROSPrintf("=== detector flag ===\n");
	ROSPrintf("imcolorbar_Hue= %d\n",imcolorbar_Hue);


}
#endif

	return pre_color_bar_score;

}


/*==================================================*/
/*                                                                                                                 */
/* Progressive film detection                                                              */
/*                                                                                                                 */
/*================================================== */
void p_film_detection(void)
{
#if 0	//20150706 roger mark for compiler error
	unsigned int film_cnt_avg=0;
	unsigned char i;
	di_di_p_film_ctrl1_RBUS di_p_film_ctrl1_reg;
	di_di_p_film_read_RBUS di_p_film_read_reg;

	di_p_film_read_reg.regValue= rtd_inl(DI_DI_P_FILM_READ_reg);
	film_cnt[9]=film_cnt[8];
	film_cnt[8]=film_cnt[7];
	film_cnt[7]=film_cnt[6];
	film_cnt[6]=film_cnt[5];
	film_cnt[5]=film_cnt[4];
	film_cnt[4]=film_cnt[3];
	film_cnt[3]=film_cnt[2];
	film_cnt[2]=film_cnt[1];
	film_cnt[1]=film_cnt[0];
	film_cnt[0]=di_p_film_read_reg.prgfilm_motion_cnt;

	for(i=0;i<10;i++)
		film_cnt_avg=film_cnt_avg+film_cnt[i];
	film_cnt_avg=film_cnt_avg/10;
	di_p_film_ctrl1_reg.regValue= rtd_inl(DI_DI_P_FILM_CTRL1_reg);
	di_p_film_ctrl1_reg.prgfilm_fw_motion_cnt_avg = film_cnt_avg;
	rtd_outl(DI_DI_P_FILM_CTRL1_reg, di_p_film_ctrl1_reg.regValue);
	//scalerDrvPrint("",);
#endif
}

int scalerVIP_pwm_set(int index, int duty) {
	misc_pwm_pwm0_duty_set_RBUS 	pwm_duty_set_reg;
	int duty_max;

	static unsigned int printcount=0;
	printcount++;

	#if DCR_DEBUG_TPV
  		ROSPrintf("\033[1;31m %s: index = %d, duty = %d   m_isIncreaseMode=%d \033[m\n", __FUNCTION__, index, duty,m_isIncreaseMode);
	#endif

	if (index >= 8) return -1;

	pwm_duty_set_reg.regValue = rtd_inl(MISC_PWM_PWM0_DUTY_SET_reg + index * 12);
	duty_max = pwm_duty_set_reg.pwm0_totalcnt;

	if (duty >= duty_max) duty = duty_max;
	if (duty <= 0) duty = 0;
	pwm_duty_set_reg.pwm0_dut = duty;

	#if DCR_DEBUG_TPV
		ROSPrintf("\033[1;31m pwm_duty_set_reg.pwm0_dut = %d  duty_max=%d,m_BL_LV_Act_Max = %d \033[m\n", pwm_duty_set_reg.pwm0_dut,duty_max,m_BL_LV_Act_Max);
	#endif
	rtd_outl(MISC_PWM_PWM0_DUTY_SET_reg + index * 12, pwm_duty_set_reg.regValue);
	return 0;

}
unsigned char scalerVIP_pwm_get(int index) {
	misc_pwm_pwm0_duty_set_RBUS 	pwm_duty_set_reg;

	if (index >= 8) return -1;

	pwm_duty_set_reg.regValue = rtd_inl(MISC_PWM_PWM0_DUTY_SET_reg + index * 12);

	return pwm_duty_set_reg.pwm0_dut;
}

int scalerVIP_iso_pwm_set(int index, int duty) {

	iso_misc_pwm_mis_pwm0_duty_set_RBUS 	pwm_duty_set_reg;
	int duty_max;

	#if DCR_DEBUG_TPV
		ROSPrintf("\033[1;31m %s: index = %d, duty = %d   m_isIncreaseMode=%d  \033[m\n", __FUNCTION__, index, duty, m_isIncreaseMode);
	#endif

	if (index >= 8) return -1;

	pwm_duty_set_reg.regValue = rtd_inl(ISO_MISC_PWM_MIS_PWM0_DUTY_SET_reg + index * 12);
	duty_max = pwm_duty_set_reg.mis_pwm0_totalcnt;

	if (duty >= duty_max) duty = duty_max;
	if (duty <= 0) duty = 0;
	pwm_duty_set_reg.mis_pwm0_dut = duty;

	#if DCR_DEBUG_TPV
		ROSPrintf("\033[1;31m pwm_duty_set_reg.pwm0_dut = %d  duty_max=%d,m_BL_LV_Act_Max = %d \033[m\n", pwm_duty_set_reg.pwm0_dut,duty_max,m_BL_LV_Act_Max);
	#endif
	rtd_outl(ISO_MISC_PWM_MIS_PWM0_DUTY_SET_reg + index * 12, pwm_duty_set_reg.regValue);

	return 0;
}
unsigned char scalerVIP_iso_pwm_get(int index) {

	iso_misc_pwm_mis_pwm0_duty_set_RBUS 	pwm_duty_set_reg;

	if (index >= 8) return -1;
	pwm_duty_set_reg.regValue = rtd_inl(ISO_MISC_PWM_MIS_PWM0_DUTY_SET_reg + index * 12);

	return pwm_duty_set_reg.mis_pwm0_dut;
}

void scalerVIP_IoGpio_SetPwmDuty(unsigned int pwmInfo, unsigned int duty)
{
	unsigned int pin_type, pwmNum;

	pin_type = pwmInfo >> 16;
	pwmNum = pwmInfo & 0x0000FFFF;

	pthread_mutex_lock(&gpio_mutex);
	if (pin_type) { // iso
		scalerVIP_iso_pwm_set(pwmNum, duty);
	}
	else { //mis
		scalerVIP_pwm_set(pwmNum, duty);
	}
	pthread_mutex_unlock(&gpio_mutex);
}
unsigned char scalerVIP_IoGpio_GetPwmDuty(unsigned int pwmInfo)
{
	UINT32 pin_type, pwmNum;

	pin_type = pwmInfo >> 16;
	pwmNum = pwmInfo & 0x0000FFFF;

	if (pin_type) { // iso
		return scalerVIP_iso_pwm_get(pwmNum);
	}
	else { //mis
		return scalerVIP_pwm_get(pwmNum);
	}
}

void scalerVIP_DCR_TPV_TV()
{
	scalerVIP_TVSource_Separation();
	if(m_bIsTVSource)
	{
		scalerVIP_DCR_TPV();
	}
	else   //not tv source
	{
		if(DCR_set_mapping==FALSE)  //20130502
		{
			int i,offset;
			#ifdef fix_DCR_Table_memory
			offset=0;//2*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM;
			for(i=0; i<5;i++)
			{
				MV_ref[i] = DCR_Table_TPV_non_TV[offset+0*DCT_TABLE_NUM+i];
				BL_ref[i] = DCR_Table_TPV_non_TV[offset+1*DCT_TABLE_NUM+i];
				BL_Duty_ref[i]=DCR_Table_TPV_non_TV[offset+2*DCT_TABLE_NUM+i];
				Duty_ref[i]=DCR_Table_TPV_non_TV[offset+3*DCT_TABLE_NUM+i];

				ROSPrintf("\n [DCR] MV_ref[%d]=%d, BL_ref[%d]=%d,",i,MV_ref[i],i,BL_ref[i]);
				ROSPrintf("\n [DCR] BL_Duty_ref[%d]=%d, Duty_ref[%d]=%d\n",i,BL_Duty_ref[i],i,Duty_ref[i]);



			}
			m_DCR_mode = DCR_Table_TPV_non_TV[offset+4*DCT_TABLE_NUM+0];
			m_frame_need_SC=DCR_Table_TPV_non_TV[offset+4*DCT_TABLE_NUM+1];
			m_frame_need_NML=DCR_Table_TPV_non_TV[offset+4*DCT_TABLE_NUM+2];
			m_stable_buf_thl=DCR_Table_TPV_non_TV[offset+4*DCT_TABLE_NUM+3];
			m_DZ_break_thl=DCR_Table_TPV_non_TV[offset+4*DCT_TABLE_NUM+4];
			ROSPrintf("\n [DCR] DCR_TABLE[4]=%d,  %d,  %d,	%d\n",m_frame_need_SC,m_frame_need_NML,m_stable_buf_thl,m_DZ_break_thl);
			#else
			offset=2*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM;
			for(i=0; i<5;i++)
			{
				MV_ref[i] = DCR_TABLE[offset+0*DCT_TABLE_NUM+i];
				BL_ref[i] = DCR_TABLE[offset+1*DCT_TABLE_NUM+i];
				BL_Duty_ref[i]=DCR_TABLE[offset+2*DCT_TABLE_NUM+i];
				Duty_ref[i]=DCR_TABLE[offset+3*DCT_TABLE_NUM+i];

				ROSPrintf("\n [DCR] MV_ref[%d]=%d, BL_ref[%d]=%d,",i,MV_ref[i],i,BL_ref[i]);
				ROSPrintf("\n [DCR] BL_Duty_ref[%d]=%d, Duty_ref[%d]=%d\n",i,BL_Duty_ref[i],i,Duty_ref[i]);



			}
			m_DCR_mode = DCR_TABLE[offset+4*DCT_TABLE_NUM+0];
			m_frame_need_SC=DCR_TABLE[offset+4*DCT_TABLE_NUM+1];
			m_frame_need_NML=DCR_TABLE[offset+4*DCT_TABLE_NUM+2];
			m_stable_buf_thl=DCR_TABLE[offset+4*DCT_TABLE_NUM+3];
			m_DZ_break_thl=DCR_TABLE[offset+4*DCT_TABLE_NUM+4];
			ROSPrintf("\n [DCR] DCR_TABLE[4]=%d,  %d,  %d,	%d\n",m_frame_need_SC,m_frame_need_NML,m_stable_buf_thl,m_DZ_break_thl);
			#endif
			DCR_set_mapping=TRUE;
		}

		/* ======================= */
		/* ======= On/Off DCR ======= */
		/* ======================= */
	#if DCR_DEBUG_TPV
		if((MA_print_count % 300) == 0)
		{
			ROSPrintf("DCR_Table_DEBUG\n");
			ROSPrintf(" %d	%d	%d	%d	%d\n", MV_ref[0],MV_ref[1],MV_ref[2],MV_ref[3],MV_ref[4] );
			ROSPrintf(" %d	%d	%d	%d	%d\n", BL_ref[0],BL_ref[1],BL_ref[2],BL_ref[3],BL_ref[4] );
			ROSPrintf(" %d	%d	%d	%d	%d\n", BL_Duty_ref[0],BL_Duty_ref[1],BL_Duty_ref[2],BL_Duty_ref[3],BL_Duty_ref[4] );
			ROSPrintf(" %d	%d	%d	%d	%d\n", Duty_ref[0],Duty_ref[1],Duty_ref[2],Duty_ref[3],Duty_ref[4] );
			ROSPrintf("APL = %d  Motion_Value = %d\n",SmartPic_clue->Hist_Y_Mean_Value,scalerVIP_Get_Profile_Motion());
		}
	#endif
		if((m_DCR_On_Off == TRUE) && (TV_05_style_ON == 0))
		{
				if(frame_idx < 20){  // frame_idx fix
					frame_idx++;
				}
				else{
					drvif_color_ma_DCR_new(m_frame_need_SC, m_frame_need_NML, m_stable_buf_thl, m_DZ_break_thl);
				}
		}

		m_last_DCR_On_Off=m_DCR_On_Off;

		log_count++;

	}

}
void scalerVIP_DCR_TPV()
{
	#if 0
		if((MA_print_count % 300) == 0){
		ROSPrintf("m_nTPV_New_DCR_isr\n");
		ROSPrintf("======DCR_On_Off=%d,  DetectMotion=%d, Motion_Par_In=%d=========== \n", m_DCR_On_Off,m_bDetectMotion,m_bMotion_Par_Ini);
		}
	#endif
	//only APL buffer
	unsigned char nAPL_frame=50;
	if((MA_print_count % nAPL_frame) == 0){
		RecordAPL((unsigned char)(SmartPic_clue->Hist_Y_Mean_Value));
	}
	if(frame_idx < DCR_Table_TPV[2*DCR_TABLE_COL_NUM+4]){
		frame_idx++;
	}
	else
	{
		//DCR setting update
		unsigned char idx_c,offset;
		#ifdef fix_DCR_Table_2694A_global
		offset=DCR_TABLE_COL_NUM*2;
		for(idx_c=0; idx_c<DCR_TABLE_COL_NUM*2;idx_c++)
		{
			DCR_Table_TPV[offset+idx_c]=DCR_Table_TPV_global_setting[idx_c];
		}
		#else
		unsigned char idx_r;
		for(idx_r=DCR_TABLE_ROW_NUM-1;idx_r>=DCR_TABLE_ROW_NUM-2;idx_r--)
			for(idx_c=0;idx_c<DCR_TABLE_COL_NUM;idx_c++)
			{
				offset=m_DCR_On_Off*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM+idx_r*DCR_TABLE_COL_NUM+idx_c;
				DCR_Table_TPV[(idx_r-2)*DCR_TABLE_COL_NUM+idx_c] = DCR_TABLE[offset];
			}
		#endif
		drvif_color_Plan_DCR_Curve();


		//detect motion
		#if 1
		if( (GetMaxValue(&APL_Buf[0],APL_Buf_NUM) - GetMinValue(&APL_Buf[0],APL_Buf_NUM)) <= DCR_Table_TPV[m_nAPL_Tolerate] )
			m_bDetectMotion = FALSE;
		else
			m_bDetectMotion = TRUE;
		#if DCR_DEBUG_TPV
		unsigned char i;
		ROSPrintf("DetectMotion_DEBUG\n");
		for(i=0;i<APL_Buf_NUM;i++)
			ROSPrintf(" =%d=",APL_Buf[i]);
		ROSPrintf("\nDetectMotion_DEBUG\n");
		#endif
		#else
		if(DCR_Table_TPV[m_nMotion_Th] >= scalerVIP_Get_Profile_Motion())
		{	//((SmartPic_clue->Hist_Y_Mean_Value)>=18 && (SmartPic_clue->Hist_Y_Mean_Value)<=19)  Ec
			if(( ( (GetMaxValue(&APL_Buf[0],APL_Buf_NUM) - GetMinValue(&APL_Buf[0],APL_Buf_NUM)) == 0 )&& (scalerVIP_Get_Profile_Motion()>=19 && scalerVIP_Get_Profile_Motion()<=24))||(scalerVIP_Get_Profile_Motion()<=2))
				m_bDetectMotion = FALSE;
			else
				m_bDetectMotion = TRUE;
		}
		else
			m_bDetectMotion = TRUE;
		#endif
		if(m_bDetectMotion == m_bMotion_Par_Ini) //Motion Detect update
		{
			drvif_color_Plan_DCR_Curve();
			m_bMotion_Par_Ini = !m_bMotion_Par_Ini;
		}
		#if DCR_DEBUG_TPV
		//if((MA_print_count % 300) == 0)
		{
			ROSPrintf("DCR_Table_DEBUG\n");
			ROSPrintf(" %d	%d	%d	%d	%d\n", DCR_Table_TPV[0],DCR_Table_TPV[1],DCR_Table_TPV[2],DCR_Table_TPV[3],DCR_Table_TPV[4] );
			ROSPrintf(" %d	%d	%d	%d	%d\n", DCR_Table_TPV[5],DCR_Table_TPV[6],DCR_Table_TPV[7],DCR_Table_TPV[8],DCR_Table_TPV[9] );
			ROSPrintf(" %d	%d	%d	%d	%d\n", DCR_Table_TPV[10],DCR_Table_TPV[11],DCR_Table_TPV[12],DCR_Table_TPV[13],DCR_Table_TPV[14] );
			ROSPrintf(" %d	%d	%d	%d	%d\n", DCR_Table_TPV[15],DCR_Table_TPV[16],DCR_Table_TPV[17],DCR_Table_TPV[18],DCR_Table_TPV[19] );
			//ROSPrintf("DCC_Histogram_Mean_value = %d	m_DCR_Max_Value = %d   Motion_Value = %d\n",DCC_Histogram_Mean_value,m_BL_LV_From_User,scalerVIP_Get_Profile_Motion());
			ROSPrintf("APL = %d  Motion_Value = %d\n",SmartPic_clue->Hist_Y_Mean_Value,scalerVIP_Get_Profile_Motion());
		}
		#endif
		frame_idx = 0;
		/* ======================= */
		/* ======= On/Off DCR ==&& ==DCR Default=== */
		/* ======================= */
		if( m_bDefault_OFF || m_DCR_On_Off )
			drvif_color_ma_DCR_TPV(DCR_Table_TPV, (SmartPic_clue->Hist_Y_Mean_Value),m_BL_LV_From_User);
		m_last_DCR_On_Off=m_DCR_On_Off;
	}

}

void scalerVIP_DCR_OLD()
{
	if(DCR_TABLE == NULL)
		return;

	if(DCR_set_mapping==FALSE){
		int i;
		for(i=0; i<5;i++) {
			MV_ref[i] = DCR_TABLE[0*DCT_TABLE_NUM+i];
			BL_ref[i] = DCR_TABLE[1*DCT_TABLE_NUM+i];
			BL_Duty_ref[i]= DCR_TABLE[2*DCT_TABLE_NUM+i];
			Duty_ref[i]= DCR_TABLE[3*DCT_TABLE_NUM+i];

			if((MA_print_count % 300) == 0){
				printk(KERN_NOTICE "\n [DCR] MV_ref[%d]=%d, BL_ref[%d]=%d,",i,MV_ref[i],i,BL_ref[i]);
				printk(KERN_NOTICE "\n [DCR] BL_Duty_ref[%d]=%d, Duty_ref[%d]=%d\n",i,BL_Duty_ref[i],i,Duty_ref[i]);
			}
		}

		m_DCR_mode = DCR_TABLE[4*DCT_TABLE_NUM+0];
		m_frame_need_SC = DCR_TABLE[4*DCT_TABLE_NUM+1];
		m_frame_need_NML = DCR_TABLE[4*DCT_TABLE_NUM+2];
		m_stable_buf_thl = DCR_TABLE[4*DCT_TABLE_NUM+3];
		m_DZ_break_thl = DCR_TABLE[4*DCT_TABLE_NUM+4];
		if((MA_print_count % 300) == 0)
			printk(KERN_NOTICE "\n [DCR] DCR_TABLE[4]=%d,  %d,  %d,  %d\n",m_frame_need_SC,m_frame_need_NML,m_stable_buf_thl,m_DZ_break_thl);

		DCR_set_mapping=TRUE;
	}

	/* ======================= */
	/* ======= On/Off DCR ======= */
	/* ======================= */
	if((m_DCR_On_Off == TRUE) && (TV_05_style_ON == 0)) {
		drvif_color_ma_DCR_new(m_frame_need_SC, m_frame_need_NML, m_stable_buf_thl, m_DZ_break_thl);
	}

	m_last_DCR_On_Off=m_DCR_On_Off;

	if(m_DCR_On_Off == TRUE){
		//drvif_color_TSB_Active_Backlight_Control();
	}
	log_count++;

}
void scalerVIP_DCR_TPV_2694A()
{
	#if DCR_DEBUG_TPV
	if(MA_print_count%100==0)
		ROSPrintf("\n=== m_nDCR_Mode = %d\n",m_nDCR_Mode);
	#endif
	if(m_nDCR_Mode == 1 || m_nDCR_Mode == 2)
		scalerVIP_DCR_TPV_Multi_Mode();
	else
		scalerVIP_DCR_TPV();
}

void scalerVIP_DCR_TPV_TV_2694A()
{
	scalerVIP_TVSource_Separation();
	if(m_bIsTVSource)
	{
		scalerVIP_DCR_TPV_2694A();
	}
	else   //not tv source
	{
		scalerVIP_DCR_TPV_Multi_Mode();
	}
}
//1=standard, 2=best power, 3=best picture
void scalerVIP_DCR_TPV_Multi_Mode()
{
	unsigned char i, MV, current_osd, dcr_mode, osd_bl_max, osd_bl_min, osd_bl_lower_boundary;
	unsigned char his_ref_start, his_ref_end, osd_bl_ref_start, osd_bl_ref_end;
	unsigned char BL_current_pwm, BL_set=0, his_ref[DCR_TABLE_COL_NUM], bl_ref[DCR_TABLE_COL_NUM], ctrl[DCR_TABLE_COL_NUM];
	unsigned char  SC_flag;
	short BL_target;
	SC_flag = (RPC_SmartPic_clue->SceneChange);
	//get current duty pwm	setting
	BL_current_pwm = scalerVIP_IoGpio_GetPwmDuty(m_PIN_BL_ADJ);
	//duty_max = pwm_duty_set_reg.pwm0_totalcnt;
	if(BL_current_pwm==0) //reg is 0, when ui osd set 100 ==> fix this bug.
		BL_current_pwm = 255;

	// osd max =100, increase mode for TPV 2958i
	osd_bl_max = 100;
	osd_bl_min = 0;
	osd_bl_lower_boundary = 15;
	dcr_mode = m_nDCR_Mode;
	MV = (SmartPic_clue->Hist_Y_Mean_Value);
	current_osd = m_BL_LV_From_User;

	if(dcr_mode > 3 || dcr_mode == 0) // 0=off, 1=standard, 2=best power, 3=best picture
		return;

	// update curve
	unsigned char offset;
	#ifdef fix_DCR_Table_memory
	offset=0;//2*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM;
	for(i=0;i<DCR_TABLE_COL_NUM;i++)
	{
		his_ref[i] = *(DCR_Table_TPV_non_TV + offset + ((dcr_mode-1)*2+0)*DCR_TABLE_COL_NUM+i);
		bl_ref[i] = *(DCR_Table_TPV_non_TV + offset + ((dcr_mode-1)*2+1)*DCR_TABLE_COL_NUM+i);
	}
	#else
	offset=2*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM;
	for(i=0;i<DCR_TABLE_COL_NUM;i++)
	{
		his_ref[i] = *(DCR_TABLE + offset + ((dcr_mode-1)*2+0)*DCR_TABLE_COL_NUM+i);
		bl_ref[i] = *(DCR_TABLE + offset + ((dcr_mode-1)*2+1)*DCR_TABLE_COL_NUM+i);
	}
	#endif
	//use DCR ON/OFF TABLE
	offset=m_DCR_On_Off*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM+4*DCR_TABLE_COL_NUM;
	for(i=0;i<DCR_TABLE_COL_NUM;i++)
	{
		//offset=m_DCR_On_Off*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM+4*DCR_TABLE_COL_NUM+i;
		ctrl[i] = *(DCR_TABLE + offset + i);
	}
	#if DCR_DEBUG_TPV
	if(MA_print_count%100==0)
	{
		ROSPrintf("\n=== DCR_TPV_Multi_Mode , ctrl = %d,%d,%d ,%d ,%d===\n",ctrl[0],ctrl[1],ctrl[2],ctrl[3],ctrl[4]);
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,his_ref = %d,%d,%d,%d,%d===\n",his_ref[0],his_ref[1],his_ref[2],his_ref[3],his_ref[4]);
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,bl_ref = %d,%d,%d,%d,%d===\n",bl_ref[0],bl_ref[1],bl_ref[2],bl_ref[3],bl_ref[4]);
	}
	#endif
	//================


	//mapping range
	for(i=0;i<DCR_TABLE_COL_NUM;i++)
		if(MV<his_ref[i])
			break;
	if(i==5)
	{
		his_ref_end = his_ref[i-1];
	        osd_bl_ref_end = bl_ref[i-1];
	}
	else
	{
	his_ref_end = his_ref[i];
	osd_bl_ref_end = bl_ref[i];
	}
	if(i==0)
	{
		his_ref_start = his_ref[i];
		osd_bl_ref_start = bl_ref[i];
	}
	else
	{
		his_ref_start = his_ref[i-1];
		osd_bl_ref_start = bl_ref[i-1];
	}

	//osd backlight control
	current_osd = current_osd * (osd_bl_max-osd_bl_lower_boundary) / osd_bl_max + osd_bl_lower_boundary;//low is 15, re mapping
	osd_bl_ref_start = osd_bl_ref_start * (current_osd - osd_bl_min) / (osd_bl_max - osd_bl_min);
	osd_bl_ref_end = osd_bl_ref_end * (current_osd - osd_bl_min) / (osd_bl_max - osd_bl_min);

	// compute target BL value and mapping to PWM value
	#if DCR_DEBUG_TPV
	if(MA_print_count%300==0)
	{
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,his_ref_start = %d,his_ref_end =%d===\n",his_ref_start,his_ref_end);
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,osd_bl_ref_start=%d,osd_bl_ref_end=%d===\n",osd_bl_ref_start,osd_bl_ref_end);
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,m_BL_LV_Act_Max = %d,m_BL_LV_Act_Min = %d===\n",m_BL_LV_Act_Max,m_BL_LV_Act_Min);
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,osd_bl_max=%d,osd_bl_min=%d===\n",osd_bl_max,osd_bl_min);
	}
	#endif
	if(i==0) //minimun is  his_ref[0]
		BL_target = osd_bl_ref_end;
	else if(i==5)
		BL_target = osd_bl_ref_end;
	else
		BL_target = (MV - his_ref_start) * (osd_bl_ref_end - osd_bl_ref_start) / (his_ref_end - his_ref_start) + osd_bl_ref_start;
	#if DCR_DEBUG_TPV
	if(MA_print_count%100==0)
		ROSPrintf("\n=== DCR_TPV_Multi_Mode , BL_target = %d ===\n",BL_target);
	#endif
	BL_target = BL_target * (m_BL_LV_Act_Max - m_BL_LV_Act_Min) / (osd_bl_max - osd_bl_min) + m_BL_LV_Act_Min;

	#if DCR_DEBUG_TPV
	if(MA_print_count%100==0)
	{
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,dcr_mode=%d,MV=%d,BL_target=%d,BL_current_pwm=%d===\n",dcr_mode,MV,BL_target,BL_current_pwm);
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,i=%d,current_osd=%d,m_BL_LV_From_User=%d,m_isIncreaseMode%d===\n",i,current_osd,m_BL_LV_From_User,m_isIncreaseMode);
	}
	#endif

	if(BL_target>BL_current_pwm && BL_target-BL_current_pwm>=ctrl[2*SC_flag])
		BL_set = BL_current_pwm + ctrl[2*SC_flag];		// backlight setting with a step
	else if (BL_target<BL_current_pwm && BL_current_pwm-BL_target>=ctrl[1+2*SC_flag])
		BL_set = BL_current_pwm - ctrl[1+2*SC_flag];
	else if(BL_target != BL_current_pwm)
		BL_set=BL_target;
	else
		return;
	//record
	#if DCR_DEBUG_TPV
	if(MA_print_count%100==0)
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,BL_prev=%d,BL_current=%d,BL_target=%d,BL_set=%d===\n",BL_prev,BL_current,BL_target,BL_set);
	#endif


	BL_target=BL_set;
	BL_target = (BL_target-m_BL_LV_Act_Min) * (osd_bl_max - osd_bl_min) / (m_BL_LV_Act_Max - m_BL_LV_Act_Min)+osd_bl_min;
	BL_current = BL_target;//BL_set;
	BL_prev = BL_current;
	#if DCR_DEBUG_TPV
	if(MA_print_count%100==0)
		ROSPrintf("\n=== DCR_TPV_Multi_Mode ,BL_prev=%d,BL_current=%d,BL_target=%d,BL_set=%d===\n",BL_prev,BL_current,BL_target,BL_set);
	#endif
	if(!m_isIncreaseMode)
		BL_set = m_BL_LV_Act_Max - BL_set;
 	#if DCR_DEBUG_TPV
	if(MA_print_count%100==0)
		ROSPrintf("\n= DCR_TPV_Multi_Mode BL_set =%d=\n",BL_set);
	#endif
	scalerVIP_IoGpio_SetPwmDuty(m_PIN_BL_ADJ, BL_set);

}

//20121106 roger add
unsigned char scalerVIP_Get_Profile_Motion()
{
	return Profile_Motion_Detect_Value;
}

//roger add 20110830, for motion detect for all source
void scalerVIP_Profile_Motion_Detect(unsigned char display, _clues* SmartPic_clue)
{
	static unsigned short H_Block_Pre_PMD[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};	//roger add 20110826, PMD = profile motion detect
	static unsigned short V_Block_Pre_PMD[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};	//roger add 20110826, PMD = profile motion detect
	unsigned int H_PMDV_temp = 0;
	unsigned int V_PMDV_temp = 0;
	unsigned int H_diff_Sum = 0;
	unsigned int V_diff_Sum = 0;
	int i;
	unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	for (i = 0; i < 16; i++)
	{
		H_diff_Sum = H_diff_Sum + ABS(H_Block[i], H_Block_Pre_PMD[i]);
 		V_diff_Sum = V_diff_Sum + ABS(V_Block[i], V_Block_Pre_PMD[i]);
	}

	//H: xxxK, V: xxxK is the sum of the white patten of block 0 to 15, but it's only for reference
	//the range of H_PMDV is 50, the range of V_PMDV is also 50
	switch(SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:		//H: 114K, V: 38K
		case _MODE_576I:		//H: 139K, V: 46K
			H_PMDV_temp = H_diff_Sum >> 4;
			V_PMDV_temp = V_diff_Sum >> 3;
			break;
		case _MODE_480P:	//H: 237K, V: 79K
		case _MODE_576P:	//H: 286K, V: 95K
			H_PMDV_temp = H_diff_Sum >> 5;
			V_PMDV_temp = V_diff_Sum >> 4;
			break;
		case _MODE_720P50:	//H: 351K, V: 131K
		case _MODE_720P60:	//H: 351K, V: 131K
			H_PMDV_temp = H_diff_Sum >> 5;
			V_PMDV_temp = V_diff_Sum >> 4;
			break;
		case _MODE_1080I25:	//H: 261K, V: 131K
		case _MODE_1080I30:	//H: 261K, V: 131K
			H_PMDV_temp = H_diff_Sum >> 6;
			V_PMDV_temp = V_diff_Sum >> 4;
			break;
		case _MODE_1080P50:	//H: 531K, V: 131K
		case _MODE_1080P60:	//H: 531K, V: 131K
			H_PMDV_temp = H_diff_Sum >> 6;
			V_PMDV_temp = V_diff_Sum >> 4;
			break;
		default:
			H_PMDV_temp = H_diff_Sum >> 5;
			V_PMDV_temp = V_diff_Sum >> 4;
			break;
	}

	#ifdef CONFIG_USE_RT_STORAGE_NO_DDR
	//20121106 roger add, ONLY for Pacific' no DDR set. In DDR set, don't use this
	switch(SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_1080I25:
		case _MODE_1080I30:
			//rtd_log(_LOGGER_INFO, "scalerVIP_Profile_Motion_Detect, i-signal re-adjust H_PMDV!! H_PMDV_temp = %d\n", H_PMDV_temp);
			if (H_PMDV_temp > 15)
				H_PMDV_temp = H_PMDV_temp - 15;
			else
				H_PMDV_temp = 0;
			break;
		default:
			break;
	}
	#endif

	H_PMDV_temp = (H_PMDV_temp > 50) ? 50 : H_PMDV_temp;
	V_PMDV_temp = (V_PMDV_temp > 50) ? 50 : V_PMDV_temp;
	Profile_Motion_Detect_Value = H_PMDV_temp + V_PMDV_temp;
	if (Profile_Motion_Detect_Value == 0) Profile_Motion_Detect_Value = 1;		//avoid the value=0

	for (i = 0; i < 16; i++)
	{
		H_Block_Pre_PMD[i] = H_Block[i];
		V_Block_Pre_PMD[i] = V_Block[i];
	}

#if 0	//debug message
	static unsigned int print_cnt = 0;
	print_cnt++;
	if ((print_cnt % 10) == 0)
	{
		//for (i = 0; i < 16; i++)
			//printk("H_Block[%d] = %d, V_Block[%d] = %d\n", i, H_Block[i], i, V_Block[i]);

		rtd_log(_LOGGER_INFO, "source = %d\n", info->ucMode_Curr);
		rtd_log(_LOGGER_INFO, "H_diff_Sum = %d, \nV_diff_Sum = %d\n", H_diff_Sum, V_diff_Sum);
		rtd_log(_LOGGER_INFO, "H_PMDV_temp = %d, \nV_PMDV_temp = %d, \nProfile_Motion_Detect_Value = %d\n", H_PMDV_temp, V_PMDV_temp, Profile_Motion_Detect_Value);
	}
#endif

	return;
}



void drvif_color_ma_DCR_TV057(unsigned char Set_PWMValue)
{


	unsigned int pwmNum=0;
	unsigned char Target_Dutyvalue=0;
	//unsigned int OSDBL_ratio=0;
	//unsigned char MinPWMbyspec=0,MaxPWMbyspec=0;
	unsigned char diff=0,duty_step=0;
	unsigned char danger_zoom_th =0;
	unsigned char powersave_weight=5;
	//when OSD powersave=on
	if(VIP_DCR_powersave_enable==1)
		powersave_weight=4;
	else
		powersave_weight=5;

	//cut the  pwmNum to(0,FFFF)
	pwmNum = m_PIN_BL_ADJ & 0x0000FFFF;

	//scale the backlight OSD (0,100) to range(5,100)
	//MinPWMbyspec=((14-2)*Set_PWMValue)/255+2;
	//MaxPWMbyspec=Set_PWMValue;
	//OSDBL_ratio=m_BL_LV_From_User*255/100;//ratio

	//Target_Dutyvalue=OSDBL_ratio*(MaxPWMbyspec-MinPWMbyspec)/255+MinPWMbyspec;//100;>>a*b+c;
	//Target_Dutyvalue=Target_Dutyvalue & 0xFF;
	Target_Dutyvalue=Set_PWMValue;
	Target_Dutyvalue=Target_Dutyvalue*powersave_weight/5;

#if 0
		if((MA_print_count % 150) == 0)
		{
			ROSPrintf("[Young]@@  OSD DCR m_BL_LV_From_User=%d@@ \n",m_BL_LV_From_User);
			//ROSPrintf("[Young]@@  MinPWMbyspec=%d,MaxPWMbyspec=%d @@ \n",MinPWMbyspec,MaxPWMbyspec);
			ROSPrintf("[Young]***  DCR_refresh_TV057=%d,SceneChange=%d  *** \n",DCR_refresh_TV057,SceneChange);
			ROSPrintf("[Young]@@  OSD DCR Current_Dutyvalue=%d,Target_Dutyvalue=%d@@ \n",Current_Dutyvalue,Target_Dutyvalue);

		}
#endif
	if(panaFlag)//for DC on init setting
	{
		//ROSPrintf("[Young]***  target_OSD_duty=%d,BL_current_pana=%d,panaFlag=%d  *** \n",target_OSD_duty,BL_current_pana,panaFlag);
		Current_Dutyvalue = Target_Dutyvalue;
		panaFlag = FALSE;
	}

	diff=ABS(Target_Dutyvalue,Current_Dutyvalue);

	if( ((RPC_SmartPic_clue->SceneChange)==1) || (DCR_refresh_TV057==TRUE) )
	{
		danger_zoom_th =0;
		if( DCR_refresh_TV057==TRUE && diff==0)
		{
			Current_Dutyvalue= (Current_Dutyvalue>0)?(Current_Dutyvalue-1):(Current_Dutyvalue+1);
		}
		else
		{
			duty_step = diff;
		}
		DCR_refresh_TV057 = FALSE;
	}
	else
	{
		danger_zoom_th =5;
		duty_step = ((diff>>1)+1)>=5?5:((diff>>1)+1);
	}

	misc_pwm_pwm0_duty_set_RBUS 	pwm_duty_set_reg;
	pwm_duty_set_reg.regValue = rtd_inl(MISC_PWM_PWM0_DUTY_SET_reg + pwmNum * 12);



	if((Target_Dutyvalue >Current_Dutyvalue)&&(diff>danger_zoom_th))
		Current_Dutyvalue = Current_Dutyvalue +duty_step;		// backlight setting with a step  //step_up=4
	else if(( Current_Dutyvalue>Target_Dutyvalue)&&(diff>danger_zoom_th))
		Current_Dutyvalue = Current_Dutyvalue -duty_step;       //step_down=1
	else if(Target_Dutyvalue != Current_Dutyvalue)
		Current_Dutyvalue=Target_Dutyvalue;
	else
		return;


	if(Current_Dutyvalue>255)
		Current_Dutyvalue=255;
	if(Current_Dutyvalue<0)
		Current_Dutyvalue=0;


//set duty,duty is (0,255)
	//scalerVIP_pwm_set(pwmNum, linearrange_duty);
	scalerVIP_pwm_set(pwmNum, Current_Dutyvalue);


#if 0
		if((MA_print_count % 300) == 0)
		{
			//ROSPrintf("[Young]@@  OSD DCR m_BL_LV_From_User=%d ,,target_OSD_duty=%d@@ \n",m_BL_LV_From_User,target_OSD_duty);
			ROSPrintf("[Young]@@  linearrange_duty=%d @@ \n",linearrange_duty);
			ROSPrintf("[Young]@@  BL_current_pana=%d @@ \n",BL_current_pana);
			//ROSPrintf("[Young]@@ pwmNum=%d ,BL_set=%d  BL_set_duty=%d @@ \n",pwmNum,BL_set,BL_set_duty);
		}
#endif


}



void scalerVIP_TVSource_Separation()
{
	unsigned char input_src_from;
	input_src_from = Scaler_DispGetInputInfoByDisp(SLR_MAIN_DISPLAY, SLR_INPUT_INPUT_SRC);
	#if DCR_DEBUG_TPV
	if((MA_print_count % 300) == 0)
		ROSPrintf(" TVSource_Separation : %d	(1:Atv 2:Dtv) \n",input_src_from );
	#endif
	switch(input_src_from)
	{
		case _SRC_TV:
			m_bIsTVSource=TRUE;
		break;
		case _SRC_VO:
			m_bIsTVSource=TRUE;
		break;
		default :
		 	m_bIsTVSource=FALSE;
		break;
	}
	//ROSPrintf(" m_bIsTVSource : %d	\n",m_bIsTVSource );
}
short drvif_color_BL_PWM__Interpolation(short nDiff,short nOffset,short nBLDiff,short nHisDiff)
{
	INT16 nSetting=nDiff*nBLDiff/nHisDiff+nOffset;
	//if((MA_print_count % 100) == 0)
		//ROSPrintf("==nDiff	=%d,nOffset=%d  ,nBLDiff=%d ,nHisDiff=%d,nSetting=%d====== \n",nDiff,nOffset,nBLDiff,nHisDiff,nSetting);
	return nSetting;
}
void RecordAPL(unsigned char nAPL)
{
	APL_Buf[nAPL_Buf_index]=nAPL;
	nAPL_Buf_index++;
	if(nAPL_Buf_index == APL_Buf_NUM)
		nAPL_Buf_index=0;
}
char GetMaxValue(unsigned char * Array ,char nLen)
{
	unsigned char nMax,nIdx;
	nMax=Array[0];
	for( nIdx = 0 ;nIdx<=nLen-1;nIdx++)
		if(Array[nIdx] > nMax)
			nMax=Array[nIdx];
	return nMax;
}
char GetMinValue(unsigned char * Array ,char nLen)
{
	unsigned char nMin,nIdx;
		nMin=Array[0];
		for( nIdx = 0 ;nIdx<=nLen-1;nIdx++)
			if(Array[nIdx] < nMin)
				nMin=Array[nIdx];
		return nMin;
}


void drvif_color_ma_DCR_TPV(unsigned char *TPV_DCR_TABLE, unsigned int DCC_HIS_MV, unsigned char BL_OSD)
{
	unsigned char i;
	unsigned char SC_flag ;
	static unsigned char blFlag = TRUE;
	static unsigned char blFirstOpenFlag = FALSE;
	short BL_target, BL_set,nMappingValue;
	//static short BL_current = 100;
	static unsigned char   BL_max=100,BL_min=0;
	BL_max = m_DCR_UI_Max_Value;
	BL_min = m_DCR_UI_Min_Value;
	SC_flag = (RPC_SmartPic_clue->SceneChange);
	//get BL_current at 1st
	if(blFlag){
		BL_current = BL_OSD;
		blFlag = FALSE;
		blFirstOpenFlag = TRUE;
	}
	if( !m_last_DCR_On_Off && !m_bDefault_OFF)
    {
        BL_current=BL_OSD;
    }
	//RecordAPL((unsigned char)DCC_HIS_MV);

	// i=0  BL_target = min, i=5 BL_target = max, i=1~4  interpolation
	for(i=0;i<DCR_TABLE_COL_NUM;i++)
		if(DCC_HIS_MV<(*(TPV_DCR_TABLE+i)))
			break;
	if(i==0)
		BL_target = *(TPV_DCR_TABLE+DCR_TABLE_COL_NUM+0);
	else if(i == 5)
		BL_target = *(TPV_DCR_TABLE+DCR_TABLE_COL_NUM+4);
	else
	{
		/*if(i == 1 && !m_bDetectMotion) //static
		{
			if(DCC_HIS_MV >0 && DCC_HIS_MV<7)
				BL_target=9*DCC_HIS_MV+37;  //PWM =8.94*APL+36.86%
			else
				BL_target=drvif_color_BL_PWM__Interpolation((DCC_HIS_MV-(*(TPV_DCR_TABLE+i-1))),(*(TPV_DCR_TABLE+1*DCR_TABLE_COL_NUM+i-1)),((*(TPV_DCR_TABLE+1*DCR_TABLE_COL_NUM+i))-(*(TPV_DCR_TABLE+1*DCR_TABLE_COL_NUM+i-1))),(*(TPV_DCR_TABLE+i)-(*(TPV_DCR_TABLE+i-1))));
		}
		else*/
			BL_target=drvif_color_BL_PWM__Interpolation((DCC_HIS_MV-(*(TPV_DCR_TABLE+i-1))),(*(TPV_DCR_TABLE+1*DCR_TABLE_COL_NUM+i-1)),((*(TPV_DCR_TABLE+1*DCR_TABLE_COL_NUM+i))-(*(TPV_DCR_TABLE+1*DCR_TABLE_COL_NUM+i-1))),(*(TPV_DCR_TABLE+i)-(*(TPV_DCR_TABLE+i-1))));

	}
	// DCR_SLAVE mode BL_target max = osd
	if(*(TPV_DCR_TABLE+3*DCR_TABLE_COL_NUM+0) == DCR_SLAVE_ISR){
		if(!(blFirstOpenFlag && (BL_OSD==0)))
		{
			BL_target = (BL_OSD*BL_target)/100;
			blFirstOpenFlag=FALSE;
		}
		else
			blFirstOpenFlag=FALSE;
	}
	if( !m_bDefault_OFF && !m_DCR_On_Off)// Default On & OSD SET OFF
	{
		BL_target=BL_OSD;
		BL_set=BL_target;
	}
	else
	{
		if(BL_target>BL_current && BL_target-BL_current>=(*(TPV_DCR_TABLE+2*DCR_TABLE_COL_NUM+2*SC_flag+0)))
			BL_set = BL_current + (*(TPV_DCR_TABLE+2*DCR_TABLE_COL_NUM+2*SC_flag+0));		// backlight setting with a step
		else if (BL_target<BL_current && BL_current-BL_target>=(*(TPV_DCR_TABLE+2*DCR_TABLE_COL_NUM+2*SC_flag+1)))
			BL_set = BL_current - (*(TPV_DCR_TABLE+2*DCR_TABLE_COL_NUM+2*SC_flag+1));
		else if(BL_target != BL_current)
			BL_set=BL_target;
		else
			return;
	}

	//MAPPING TO 255
	if(m_isIncreaseMode)
		nMappingValue = (BL_set-BL_min)*(m_BL_LV_Act_Max - m_BL_LV_Act_Min)/(BL_max-BL_min)+ m_BL_LV_Act_Min;
	else
		nMappingValue = m_BL_LV_Act_Max - ((BL_set-BL_min)*(m_BL_LV_Act_Max - m_BL_LV_Act_Min)/(BL_max-BL_min)+ m_BL_LV_Act_Min);
	//Set Pwm Duty
	nMappingValue&= 0xFF;
	//scalerVIP_pwm_set(7, nMappingValue);
	scalerVIP_IoGpio_SetPwmDuty(m_PIN_BL_ADJ, nMappingValue);
	BL_current = BL_set;
	BL_prev = BL_current;
	#if DCR_DEBUG_TPV
	//if((MA_print_count % 300) == 0)
	ROSPrintf("======DCC_HIS_MV=%d, BL_target=%d, BL_set=%d, i=%d, BL_OSD=%d ,nMappingValue=%d  =========== \n", DCC_HIS_MV,BL_target,BL_set,i,BL_OSD,nMappingValue);
	#endif

}


void drvif_color_Plan_DCR_Curve()
{
	unsigned char idx_r, idx_c,offset;
	if( !m_bDefault_OFF && !m_DCR_On_Off)// Default On & OSD SET OFF
	{
		for(idx_r=DCR_TABLE_ROW_NUM-6;idx_r <= DCR_TABLE_ROW_NUM-5;idx_r++)
		{
			if(idx_r == DCR_TABLE_ROW_NUM-5)
			{
				for(idx_c=0;idx_c<DCR_TABLE_COL_NUM;idx_c++)
					DCR_Table_TPV[DCR_TABLE_COL_NUM+idx_c] = 100;
			}
			else
			{
				for(idx_c=0;idx_c<DCR_TABLE_COL_NUM;idx_c++)
				{
					offset=m_DCR_On_Off*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM+idx_r*DCR_TABLE_COL_NUM+idx_c;
					DCR_Table_TPV[idx_c] = DCR_TABLE[offset];
				}
			}
		}
	}
	else
	{
		if(!m_bDetectMotion) //static
		{

			for(idx_r=DCR_TABLE_ROW_NUM-6;idx_r <= DCR_TABLE_ROW_NUM-5;idx_r++)
					for(idx_c=0;idx_c<DCR_TABLE_COL_NUM;idx_c++)
					{
						offset=m_DCR_On_Off*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM+idx_r*DCR_TABLE_COL_NUM+idx_c;
						DCR_Table_TPV[idx_r*DCR_TABLE_COL_NUM+idx_c] =  DCR_TABLE[offset];
					}
		}
		else //dynamic
		{
			for(idx_r=DCR_TABLE_ROW_NUM-4;idx_r<=DCR_TABLE_ROW_NUM-3;idx_r++)
					for(idx_c=0;idx_c<DCR_TABLE_COL_NUM;idx_c++)
					{
						offset=m_DCR_On_Off*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM+idx_r*DCR_TABLE_COL_NUM+idx_c;
						DCR_Table_TPV[(idx_r-2)*DCR_TABLE_COL_NUM+idx_c] = DCR_TABLE[offset];
					}
		}
	}
}
//===============end_DCR=============


/*=============================================
/ Function name:drvif_color_ma_DCR_new
/ Input:
/       [Frame_need_SC] : how many frame need to achieve target when scene change.
/       [Frame_need_NML] : how many frame need to achieve target nomally.
/       [stable_buf_thl] : Define Dead Zone thl.
/       [DZ_break_thl] : how many frame to break Dead Zone.
=============================================*/
void drvif_color_ma_DCR_new(unsigned short Frame_need_SC, unsigned short Frame_need_NML, unsigned short stable_buf_thl, unsigned short DZ_break_thl)
{
        /* BL_prev : previous Backlight */
        /* BL_current : current Backlight */
        /* BL_desired : desired calculating Backlight */
        /* BL_desired_prev : previous desired calculating Backlight */
        /* BL_target : tracking target Backlight */
        static unsigned char   BL_max=100,BL_min=0;
        static unsigned int mappingValue=255;
        static int BL_current=100,BL_prev=100,BL_desired=100,BL_desired_prev=100,BL_target=100,MV=0,BL_Duty=0;
        static unsigned short Frame_need=30;
        static unsigned char SegWide=10,dead_zone_break_count=0;
        static unsigned char frame_count=0,frame_leave=60,t=0,vel=0;
        static int   diff=0,stable_buffer=0;
        static unsigned char   Segment=Segment_F;
        static unsigned char is_DeadZone=false;
		#if 0
		static unsigned short DCR_count = 0;
		DCR_count++;
		if (DCR_count % 60 == 0)
			ROSPrintf("\n drvif_color_ma_DCR_new, MV = %d, m_BL_LV_From_User = %d, BL_desired = %d, m_DCR_mode = %d\n", (SmartPic_clue->Hist_Y_Mean_Value), m_BL_LV_From_User, BL_desired, m_DCR_mode);
		#endif
	BL_max = m_DCR_UI_Max_Value;
	BL_min = m_DCR_UI_Min_Value;
        MV=(SmartPic_clue->Hist_Y_Mean_Value);
        frame_count++;

        if(m_last_DCR_On_Off==0){
            BL_current=m_BL_LV_From_User;
        }

        /*======================*/
        /*     DCR Calculating Backlight       */
        /*======================*/
        /* DCR fomulation */
        if(MV<MV_ref[0])
            Segment = Segment_A;
        else if(MV<MV_ref[1] && MV>=MV_ref[0])
            Segment = Segment_B;
        else if(MV<MV_ref[2] && MV>=MV_ref[1])
            Segment = Segment_C;
        else if(MV<MV_ref[3] && MV>=MV_ref[2])
            Segment = Segment_D;
        else if(MV<MV_ref[4] && MV>=MV_ref[3])
            Segment = Segment_E;
        else if(MV>=MV_ref[4])
            Segment = Segment_F;


        /* DCR fomulation */
        switch(Segment) {
                case Segment_A:
                                BL_desired = BL_ref[0];
                    break;
                case Segment_B:
                case Segment_C:
                case Segment_D:
                case Segment_E:
                                BL_desired=(BL_ref[Segment]-BL_ref[Segment-1])*((MV)-MV_ref[Segment-1])/(MV_ref[Segment]-MV_ref[Segment-1])+BL_ref[Segment-1];
                    break;
                case Segment_F:
                                BL_desired = BL_ref[4];
                    break;
                default:
                                BL_desired = BL_ref[4];
                    break;
        }

		//20120523 roger add for slave mode
		if (m_DCR_mode == DCR_SLAVE_ISR)
			BL_desired = (BL_desired * m_BL_LV_From_User) / 100;

        if((RPC_SmartPic_clue->SceneChange)==1) {/* 20100901 LeoChen add */

            Frame_need=Frame_need_SC;
        } else {
            Frame_need=Frame_need_NML;
        }
        /*=============*/
        /*     DCR Tracking     */
        /*=============*/
        /* ========== accumulate difference of backlight  ========== */
        stable_buffer+=(BL_desired-BL_desired_prev);
        /* ========== RDBL : Reliable Desired Backlight  ========== */
        if(1){//RDBL enable

                /* ==========  Define Dead zone for stable desired backlight  ========== */
                if(stable_buffer>stable_buf_thl||stable_buffer<-stable_buf_thl){//break dead zone

                        is_DeadZone=false;
                        BL_target=BL_desired; /* update desired backlight */
                        stable_buffer=0; /* reset accumulating */
                        dead_zone_break_count=0;
                }
                else if(stable_buffer!=0) {//dead zone with umstable desired backlight

                        is_DeadZone=true;
                        if(dead_zone_break_count==DZ_break_thl) {

                                BL_target=BL_desired;/* update desired backlight */
                                stable_buffer=0; /* reset accumulating */
                                frame_leave=Frame_need-DZ_break_thl;
                                frame_leave=frame_leave>0?frame_leave:-frame_leave;
                                dead_zone_break_count=0;
                        } else {
                                dead_zone_break_count++;
                        }
                } else {//dead zone with stable desired backlight

                        is_DeadZone=true;
                        dead_zone_break_count=0;
                }
        } else {
                BL_target=BL_desired;
                stable_buf_thl=0;
        }

        /*  ========== calculating difference between desired and present  ========== */
        diff=ABS(BL_target,BL_current);
#ifdef DCR_debug_en
	if((MA_print_count % 300) == 0) {
               printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR1  BL_target %d\n",BL_target);
               printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR1  BL_current %d\n",BL_current);
        }
#endif
        if(diff!=0) {
                if(is_DeadZone){//dead zone

                        frame_leave--;
                        frame_leave=frame_leave<1?1:frame_leave; /* avoid divide 0 */
                } else {
                        frame_leave=Frame_need;
                        stable_buffer=0;

                }
                /* ========== Adaptive SegWide ========== */
                if(frame_leave<diff) {//stage1

                        vel=diff/(frame_leave+1);
                } else {//stage2

                        SegWide=/*(diff==0)?frame_leave:*/(frame_leave/diff);
                        t=(t<(SegWide))?(t+1):0;
                        vel=(t==0)?1:0;
                }

                if((BL_target)>(BL_current))
                        BL_current=BL_current+vel;
                else
                        BL_current=BL_current-vel;
        }


        /*  ========== update BL_desired_prev  ========== */
        BL_desired_prev=BL_desired;
        BL_current=(BL_current>=BL_max)?BL_max:((BL_current<=BL_min)?BL_min:BL_current);

#ifdef DCR_debug_en
        if((MA_print_count % 300) == 0) {
               printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&Histogram_Mean_value %d\n",(SmartPic_clue->Hist_Y_Mean_Value));
               printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR1  BL_desired %d\n",BL_desired);
               printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR1  BL_current %d\n",BL_current);
        }
#endif

        /*===================*/
        /*== DCR Writing to BL Reg==*/
        /*===================*/
#ifdef DCR_debug_en
	if((MA_print_count % 300) == 0)
		printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR	BL_current=%d,BL_prev=%d\n",BL_current, BL_prev);

	if((MA_print_count % 300) == 0){
		printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR  BL_Duty=%d, mode= %d\n",BL_Duty,m_isIncreaseMode);
		printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR  m_BL_LV_Act_Max=%d, m_BL_LV_Act_Min= %d\n",m_BL_LV_Act_Max, m_BL_LV_Act_Min);
		printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR  BL_max=%d, BL_min= %d\n",BL_max, BL_min);
	}
#endif
    	if((BL_current != BL_prev) || (m_DCR_refresh == TRUE)) {// || (m_last_DCR_On_Off==0))

		//ROSPrintf("Histogram_Mean_value %d\n",(SmartPic_clue->Hist_Y_Mean_Value));
		//ROSPrintf("DCR  BL_current %d\n",BL_current);
		m_DCR_refresh = FALSE;

                /* ====   RE-MAPPING  :  mapping from backlight to PWM Duty  ==== */
                if(BL_current<BL_Duty_ref[0])
                    Segment = Segment_A;
                else if(BL_current<BL_Duty_ref[1] && BL_current>=BL_Duty_ref[0])
                    Segment = Segment_B;
                else if(BL_current<BL_Duty_ref[2] && BL_current>=BL_Duty_ref[1])
                    Segment = Segment_C;
                else if(BL_current<BL_Duty_ref[3] && BL_current>=BL_Duty_ref[2])
                    Segment = Segment_D;
                else if(BL_current<BL_Duty_ref[4] && BL_current>=BL_Duty_ref[3])
                    Segment = Segment_E;
                else if(BL_current>=BL_Duty_ref[4])
                    Segment = Segment_F;

                switch(Segment) {
                        case Segment_A:
                                        BL_Duty = Duty_ref[0];
                            break;
                        case Segment_B:
                        case Segment_C:
                        case Segment_D:
                        case Segment_E:
                                        BL_Duty=(Duty_ref[Segment]-Duty_ref[Segment-1])*((BL_current)-BL_Duty_ref[Segment-1])/(BL_Duty_ref[Segment]-BL_Duty_ref[Segment-1])+Duty_ref[Segment-1];
                            break;
                        case Segment_F:
                                        BL_Duty = Duty_ref[4];
                            break;
                        default:
                                        BL_Duty = Duty_ref[4];
                            break;
                }

                if(m_isIncreaseMode) {
		   	mappingValue = (BL_Duty-BL_min)*(m_BL_LV_Act_Max - m_BL_LV_Act_Min)/(BL_max-BL_min+1) + m_BL_LV_Act_Min;
                } else {
		  	mappingValue = m_BL_LV_Act_Max-((BL_Duty-BL_min)*(m_BL_LV_Act_Max - m_BL_LV_Act_Min)/(BL_max-BL_min+1) + m_BL_LV_Act_Min);
                }

	      	mappingValue &= 0xFF;
		 //ROSPrintf("DCR  mappingValue %d\n",mappingValue);

              	//scalerVIP_IoGpio_SetPwmDuty(m_PIN_BL_ADJ, mappingValue);

            	// backlight on
           	// scalerVIP_IoGpio_SetPinLevel(m_PIN_BL_ON_OFF, m_BACKLIGHT_ON);
           	SmartPic_clue->DCR_GDBC_mappingValue = mappingValue;
#ifdef DCR_debug_en
		printk(KERN_NOTICE "\n >>>>>>>>>>>> &&&&&&&&DCR  mappingValue=%d, BL_Duty= %d\n",mappingValue, BL_Duty);
#endif
                BL_prev=BL_current;
    	}



}
//===============end_DCR=============


int abs_dcc( int input )
{
    return ( input < 0 ) ? -input : input;
}

unsigned int Lerp(unsigned int X_current, unsigned int X_1, unsigned int X_0, unsigned int Y_1, unsigned int Y_0, unsigned int x_offset_1, unsigned int x_offset_0)
{
	unsigned int Lerp_value;

	if ((Y_1 - Y_0) == 0)
		Lerp_value = Y_0;
	else
	{
		if (X_current <= (X_0 + x_offset_0))
			Lerp_value = Y_0;
		else if (X_current >= (X_1 - x_offset_1))
			Lerp_value = Y_1;
		else
		{
			//Lerp_value = (Y_0 + (((X_current - (X_0 + x_offset_0)) * (Y_1 - Y_0) * 8) / ((X_1 - x_offset_1) - (X_0 + x_offset_0))) / 8);
			if(Y_1 > Y_0)	//	if positive lerp
				Lerp_value = (Y_0 + (((X_current - X_0 - x_offset_0) * (Y_1 - Y_0) * 8) / (X_1 - X_0 - x_offset_1 - x_offset_0)) / 8);
			else	//	if negative lerp
				Lerp_value = (Y_0 - (((X_current - X_0 - x_offset_0) * (Y_0 - Y_1) * 8) / (X_1 - X_0 - x_offset_1 - x_offset_0)) / 8);
		}
	}
	return Lerp_value;
}

unsigned int Lerp_NR_rate(unsigned short NRX, unsigned char NR_LEVEL, unsigned char rate)
{
	unsigned int X_1, X_0;
	if(NR_LEVEL >= 14)
		NR_LEVEL = 14;

	X_1 = (unsigned int)(*(NR_TABLE8+ NRX * NR_LEVEL_MAX + NR_LEVEL));
	X_0 = (unsigned int)(*(NR_TABLE8 + NRX * NR_LEVEL_MAX + NR_LEVEL - 1));

	if( X_1 >= X_0 )
		return ((X_1 - X_0)*rate/100) + X_0;
	else
		return ((X_0 - X_1)*rate/100) + X_1;
}

unsigned int Lerp_NR_rate_32(unsigned short NRX, unsigned char NR_LEVEL, unsigned char rate)
{
	unsigned int X_1, X_0;
	if(NR_LEVEL >= 14)
		NR_LEVEL = 14;

	X_1 = (unsigned int)(*(NR_TABLE32+ NRX * NR_LEVEL_MAX + NR_LEVEL));
	X_0 = (unsigned int)(*(NR_TABLE32 + NRX * NR_LEVEL_MAX + NR_LEVEL - 1));

	if( X_1 >= X_0 )
		return ((X_1 - X_0)*rate/100) + X_0;
	else
		return ((X_0 - X_1)*rate/100) + X_1;
}


//=========================== Pure Color Detection ===========================
unsigned int di_pow(unsigned int x, unsigned int p)
{
	int i=0;
	unsigned int r = 1;

	  if(p == 0) return 1;
	  if(x == 0) return 0;


	for(i=0;i<p;i++)
	{
		r*=x;
	}
	return r;
/*
	  unsigned int r = 1;
	  for(;;)
	  {
	  	if(p & 1)
			r *= x;
	    	if((p >>= 1) == 0)
			return r;
	   	 x *= x;
	  }
	  */
}


unsigned int DCCsqrt_table[4096]={ // this table means SQRT(X)*1024
0x0000,0x0400,0x05a8,0x06ed,0x0800,0x08f1,0x09cc,0x0a95,
0x0b50,0x0c00,0x0ca6,0x0d44,0x0ddb,0x0e6c,0x0ef7,0x0f7d,
0x1000,0x107e,0x10f8,0x116f,0x11e3,0x1254,0x12c2,0x132e,
0x1398,0x1400,0x1465,0x14c8,0x152a,0x158a,0x15e8,0x1645,
0x16a0,0x16fa,0x1752,0x17aa,0x1800,0x1854,0x18a8,0x18fa,
0x194c,0x199c,0x19ec,0x1a3a,0x1a88,0x1ad5,0x1b21,0x1b6c,
0x1bb6,0x1c00,0x1c48,0x1c90,0x1cd8,0x1d1e,0x1d64,0x1daa,
0x1dee,0x1e33,0x1e76,0x1eb9,0x1efb,0x1f3d,0x1f7e,0x1fbf,
0x2000,0x203f,0x207f,0x20bd,0x20fc,0x2139,0x2177,0x21b4,
0x21f0,0x222d,0x2268,0x22a4,0x22df,0x2319,0x2353,0x238d,
0x23c6,0x2400,0x2438,0x2471,0x24a9,0x24e0,0x2518,0x254f,
0x2585,0x25bc,0x25f2,0x2628,0x265d,0x2693,0x26c8,0x26fc,
0x2731,0x2765,0x2799,0x27cc,0x2800,0x2833,0x2865,0x2898,
0x28ca,0x28fc,0x292e,0x2960,0x2991,0x29c2,0x29f3,0x2a24,
0x2a54,0x2a85,0x2ab5,0x2ae5,0x2b14,0x2b44,0x2b73,0x2ba2,
0x2bd1,0x2c00,0x2c2e,0x2c5c,0x2c8a,0x2cb8,0x2ce6,0x2d13,
0x2d41,0x2d6e,0x2d9b,0x2dc8,0x2df4,0x2e21,0x2e4d,0x2e79,
0x2ea5,0x2ed1,0x2efd,0x2f28,0x2f54,0x2f7f,0x2faa,0x2fd5,
0x3000,0x302a,0x3055,0x307f,0x30a9,0x30d3,0x30fd,0x3127,
0x3150,0x317a,0x31a3,0x31cc,0x31f5,0x321e,0x3247,0x3270,
0x3298,0x32c1,0x32e9,0x3311,0x3339,0x3361,0x3389,0x33b0,
0x33d8,0x3400,0x3427,0x344e,0x3475,0x349c,0x34c3,0x34ea,
0x3510,0x3537,0x355d,0x3584,0x35aa,0x35d0,0x35f6,0x361c,
0x3642,0x3667,0x368d,0x36b2,0x36d8,0x36fd,0x3722,0x3747,
0x376c,0x3791,0x37b6,0x37db,0x3800,0x3824,0x3848,0x386d,
0x3891,0x38b5,0x38d9,0x38fd,0x3921,0x3945,0x3969,0x398c,
0x39b0,0x39d3,0x39f7,0x3a1a,0x3a3d,0x3a60,0x3a83,0x3aa6,
0x3ac9,0x3aec,0x3b0f,0x3b31,0x3b54,0x3b76,0x3b99,0x3bbb,
0x3bdd,0x3c00,0x3c22,0x3c44,0x3c66,0x3c87,0x3ca9,0x3ccb,
0x3ced,0x3d0e,0x3d30,0x3d51,0x3d72,0x3d94,0x3db5,0x3dd6,
0x3df7,0x3e18,0x3e39,0x3e5a,0x3e7b,0x3e9c,0x3ebc,0x3edd,
0x3efd,0x3f1e,0x3f3e,0x3f5f,0x3f7f,0x3f9f,0x3fbf,0x3fdf,
0x4000,0x401f,0x403f,0x405f,0x407f,0x409f,0x40be,0x40de,
0x40fe,0x411d,0x413c,0x415c,0x417b,0x419a,0x41ba,0x41d9,
0x41f8,0x4217,0x4236,0x4255,0x4273,0x4292,0x42b1,0x42d0,
0x42ee,0x430d,0x432b,0x434a,0x4368,0x4387,0x43a5,0x43c3,
0x43e1,0x4400,0x441e,0x443c,0x445a,0x4478,0x4495,0x44b3,
0x44d1,0x44ef,0x450c,0x452a,0x4548,0x4565,0x4583,0x45a0,
0x45be,0x45db,0x45f8,0x4615,0x4633,0x4650,0x466d,0x468a,
0x46a7,0x46c4,0x46e1,0x46fe,0x471b,0x4737,0x4754,0x4771,
0x478d,0x47aa,0x47c7,0x47e3,0x4800,0x481c,0x4838,0x4855,
0x4871,0x488d,0x48a9,0x48c6,0x48e2,0x48fe,0x491a,0x4936,
0x4952,0x496e,0x498a,0x49a5,0x49c1,0x49dd,0x49f9,0x4a14,
0x4a30,0x4a4b,0x4a67,0x4a83,0x4a9e,0x4ab9,0x4ad5,0x4af0,
0x4b0b,0x4b27,0x4b42,0x4b5d,0x4b78,0x4b93,0x4bae,0x4bca,
0x4be5,0x4c00,0x4c1a,0x4c35,0x4c50,0x4c6b,0x4c86,0x4ca1,
0x4cbb,0x4cd6,0x4cf1,0x4d0b,0x4d26,0x4d40,0x4d5b,0x4d75,
0x4d90,0x4daa,0x4dc4,0x4ddf,0x4df9,0x4e13,0x4e2d,0x4e48,
0x4e62,0x4e7c,0x4e96,0x4eb0,0x4eca,0x4ee4,0x4efe,0x4f18,
0x4f32,0x4f4c,0x4f65,0x4f7f,0x4f99,0x4fb3,0x4fcc,0x4fe6,
0x5000,0x5019,0x5033,0x504c,0x5066,0x507f,0x5099,0x50b2,
0x50cb,0x50e5,0x50fe,0x5117,0x5130,0x514a,0x5163,0x517c,
0x5195,0x51ae,0x51c7,0x51e0,0x51f9,0x5212,0x522b,0x5244,
0x525d,0x5276,0x528f,0x52a7,0x52c0,0x52d9,0x52f2,0x530a,
0x5323,0x533c,0x5354,0x536d,0x5385,0x539e,0x53b6,0x53cf,
0x53e7,0x5400,0x5418,0x5430,0x5449,0x5461,0x5479,0x5491,
0x54a9,0x54c2,0x54da,0x54f2,0x550a,0x5522,0x553a,0x5552,
0x556a,0x5582,0x559a,0x55b2,0x55ca,0x55e2,0x55fa,0x5611,
0x5629,0x5641,0x5659,0x5670,0x5688,0x56a0,0x56b7,0x56cf,
0x56e6,0x56fe,0x5716,0x572d,0x5745,0x575c,0x5773,0x578b,
0x57a2,0x57ba,0x57d1,0x57e8,0x5800,0x5817,0x582e,0x5845,
0x585c,0x5874,0x588b,0x58a2,0x58b9,0x58d0,0x58e7,0x58fe,
0x5915,0x592c,0x5943,0x595a,0x5971,0x5988,0x599f,0x59b5,
0x59cc,0x59e3,0x59fa,0x5a11,0x5a27,0x5a3e,0x5a55,0x5a6b,
0x5a82,0x5a99,0x5aaf,0x5ac6,0x5adc,0x5af3,0x5b09,0x5b20,
0x5b36,0x5b4d,0x5b63,0x5b7a,0x5b90,0x5ba6,0x5bbd,0x5bd3,
0x5be9,0x5c00,0x5c16,0x5c2c,0x5c42,0x5c58,0x5c6f,0x5c85,
0x5c9b,0x5cb1,0x5cc7,0x5cdd,0x5cf3,0x5d09,0x5d1f,0x5d35,
0x5d4b,0x5d61,0x5d77,0x5d8d,0x5da3,0x5db9,0x5dce,0x5de4,
0x5dfa,0x5e10,0x5e26,0x5e3b,0x5e51,0x5e67,0x5e7c,0x5e92,
0x5ea8,0x5ebd,0x5ed3,0x5ee9,0x5efe,0x5f14,0x5f29,0x5f3f,
0x5f54,0x5f6a,0x5f7f,0x5f95,0x5faa,0x5fbf,0x5fd5,0x5fea,
0x6000,0x6015,0x602a,0x603f,0x6055,0x606a,0x607f,0x6094,
0x60aa,0x60bf,0x60d4,0x60e9,0x60fe,0x6113,0x6128,0x613d,
0x6152,0x6168,0x617d,0x6192,0x61a7,0x61bb,0x61d0,0x61e5,
0x61fa,0x620f,0x6224,0x6239,0x624e,0x6263,0x6277,0x628c,
0x62a1,0x62b6,0x62ca,0x62df,0x62f4,0x6309,0x631d,0x6332,
0x6347,0x635b,0x6370,0x6384,0x6399,0x63ad,0x63c2,0x63d7,
0x63eb,0x6400,0x6414,0x6428,0x643d,0x6451,0x6466,0x647a,
0x648e,0x64a3,0x64b7,0x64cb,0x64e0,0x64f4,0x6508,0x651d,
0x6531,0x6545,0x6559,0x656e,0x6582,0x6596,0x65aa,0x65be,
0x65d2,0x65e6,0x65fa,0x660f,0x6623,0x6637,0x664b,0x665f,
0x6673,0x6687,0x669b,0x66af,0x66c3,0x66d6,0x66ea,0x66fe,
0x6712,0x6726,0x673a,0x674e,0x6761,0x6775,0x6789,0x679d,
0x67b1,0x67c4,0x67d8,0x67ec,0x6800,0x6813,0x6827,0x683b,
0x684e,0x6862,0x6875,0x6889,0x689d,0x68b0,0x68c4,0x68d7,
0x68eb,0x68fe,0x6912,0x6925,0x6939,0x694c,0x6960,0x6973,
0x6986,0x699a,0x69ad,0x69c1,0x69d4,0x69e7,0x69fb,0x6a0e,
0x6a21,0x6a35,0x6a48,0x6a5b,0x6a6e,0x6a82,0x6a95,0x6aa8,
0x6abb,0x6ace,0x6ae2,0x6af5,0x6b08,0x6b1b,0x6b2e,0x6b41,
0x6b54,0x6b67,0x6b7a,0x6b8d,0x6ba1,0x6bb4,0x6bc7,0x6bda,
0x6bed,0x6c00,0x6c12,0x6c25,0x6c38,0x6c4b,0x6c5e,0x6c71,
0x6c84,0x6c97,0x6caa,0x6cbc,0x6ccf,0x6ce2,0x6cf5,0x6d08,
0x6d1a,0x6d2d,0x6d40,0x6d53,0x6d65,0x6d78,0x6d8b,0x6d9e,
0x6db0,0x6dc3,0x6dd6,0x6de8,0x6dfb,0x6e0d,0x6e20,0x6e33,
0x6e45,0x6e58,0x6e6a,0x6e7d,0x6e8f,0x6ea2,0x6eb4,0x6ec7,
0x6ed9,0x6eec,0x6efe,0x6f11,0x6f23,0x6f36,0x6f48,0x6f5a,
0x6f6d,0x6f7f,0x6f92,0x6fa4,0x6fb6,0x6fc9,0x6fdb,0x6fed,
0x7000,0x7012,0x7024,0x7036,0x7049,0x705b,0x706d,0x707f,
0x7091,0x70a4,0x70b6,0x70c8,0x70da,0x70ec,0x70fe,0x7110,
0x7123,0x7135,0x7147,0x7159,0x716b,0x717d,0x718f,0x71a1,
0x71b3,0x71c5,0x71d7,0x71e9,0x71fb,0x720d,0x721f,0x7231,
0x7243,0x7255,0x7267,0x7279,0x728a,0x729c,0x72ae,0x72c0,
0x72d2,0x72e4,0x72f5,0x7307,0x7319,0x732b,0x733d,0x734e,
0x7360,0x7372,0x7384,0x7395,0x73a7,0x73b9,0x73ca,0x73dc,
0x73ee,0x7400,0x7411,0x7423,0x7434,0x7446,0x7458,0x7469,
0x747b,0x748c,0x749e,0x74b0,0x74c1,0x74d3,0x74e4,0x74f6,
0x7507,0x7519,0x752a,0x753c,0x754d,0x755f,0x7570,0x7581,
0x7593,0x75a4,0x75b6,0x75c7,0x75d8,0x75ea,0x75fb,0x760d,
0x761e,0x762f,0x7641,0x7652,0x7663,0x7674,0x7686,0x7697,
0x76a8,0x76ba,0x76cb,0x76dc,0x76ed,0x76fe,0x7710,0x7721,
0x7732,0x7743,0x7754,0x7766,0x7777,0x7788,0x7799,0x77aa,
0x77bb,0x77cc,0x77dd,0x77ee,0x7800,0x7811,0x7822,0x7833,
0x7844,0x7855,0x7866,0x7877,0x7888,0x7899,0x78aa,0x78bb,
0x78cc,0x78dd,0x78ee,0x78fe,0x790f,0x7920,0x7931,0x7942,
0x7953,0x7964,0x7975,0x7986,0x7996,0x79a7,0x79b8,0x79c9,
0x79da,0x79eb,0x79fb,0x7a0c,0x7a1d,0x7a2e,0x7a3e,0x7a4f,
0x7a60,0x7a71,0x7a81,0x7a92,0x7aa3,0x7ab3,0x7ac4,0x7ad5,
0x7ae5,0x7af6,0x7b07,0x7b17,0x7b28,0x7b39,0x7b49,0x7b5a,
0x7b6b,0x7b7b,0x7b8c,0x7b9c,0x7bad,0x7bbd,0x7bce,0x7bde,
0x7bef,0x7c00,0x7c10,0x7c21,0x7c31,0x7c41,0x7c52,0x7c62,
0x7c73,0x7c83,0x7c94,0x7ca4,0x7cb5,0x7cc5,0x7cd5,0x7ce6,
0x7cf6,0x7d07,0x7d17,0x7d27,0x7d38,0x7d48,0x7d58,0x7d69,
0x7d79,0x7d89,0x7d9a,0x7daa,0x7dba,0x7dcb,0x7ddb,0x7deb,
0x7dfb,0x7e0c,0x7e1c,0x7e2c,0x7e3c,0x7e4d,0x7e5d,0x7e6d,
0x7e7d,0x7e8d,0x7e9e,0x7eae,0x7ebe,0x7ece,0x7ede,0x7eee,
0x7efe,0x7f0f,0x7f1f,0x7f2f,0x7f3f,0x7f4f,0x7f5f,0x7f6f,
0x7f7f,0x7f8f,0x7f9f,0x7faf,0x7fbf,0x7fcf,0x7fdf,0x7fef,
0x8000,0x800f,0x801f,0x802f,0x803f,0x804f,0x805f,0x806f,
0x807f,0x808f,0x809f,0x80af,0x80bf,0x80cf,0x80df,0x80ef,
0x80ff,0x810e,0x811e,0x812e,0x813e,0x814e,0x815e,0x816d,
0x817d,0x818d,0x819d,0x81ad,0x81bc,0x81cc,0x81dc,0x81ec,
0x81fc,0x820b,0x821b,0x822b,0x823b,0x824a,0x825a,0x826a,
0x8279,0x8289,0x8299,0x82a8,0x82b8,0x82c8,0x82d7,0x82e7,
0x82f7,0x8306,0x8316,0x8326,0x8335,0x8345,0x8354,0x8364,
0x8374,0x8383,0x8393,0x83a2,0x83b2,0x83c1,0x83d1,0x83e0,
0x83f0,0x8400,0x840f,0x841f,0x842e,0x843e,0x844d,0x845c,
0x846c,0x847b,0x848b,0x849a,0x84aa,0x84b9,0x84c9,0x84d8,
0x84e7,0x84f7,0x8506,0x8516,0x8525,0x8534,0x8544,0x8553,
0x8562,0x8572,0x8581,0x8591,0x85a0,0x85af,0x85be,0x85ce,
0x85dd,0x85ec,0x85fc,0x860b,0x861a,0x862a,0x8639,0x8648,
0x8657,0x8667,0x8676,0x8685,0x8694,0x86a3,0x86b3,0x86c2,
0x86d1,0x86e0,0x86ef,0x86ff,0x870e,0x871d,0x872c,0x873b,
0x874a,0x8759,0x8769,0x8778,0x8787,0x8796,0x87a5,0x87b4,
0x87c3,0x87d2,0x87e1,0x87f0,0x8800,0x880f,0x881e,0x882d,
0x883c,0x884b,0x885a,0x8869,0x8878,0x8887,0x8896,0x88a5,
0x88b4,0x88c3,0x88d2,0x88e1,0x88f0,0x88ff,0x890e,0x891c,
0x892b,0x893a,0x8949,0x8958,0x8967,0x8976,0x8985,0x8994,
0x89a3,0x89b2,0x89c0,0x89cf,0x89de,0x89ed,0x89fc,0x8a0b,
0x8a19,0x8a28,0x8a37,0x8a46,0x8a55,0x8a64,0x8a72,0x8a81,
0x8a90,0x8a9f,0x8aad,0x8abc,0x8acb,0x8ada,0x8ae8,0x8af7,
0x8b06,0x8b15,0x8b23,0x8b32,0x8b41,0x8b50,0x8b5e,0x8b6d,
0x8b7c,0x8b8a,0x8b99,0x8ba8,0x8bb6,0x8bc5,0x8bd4,0x8be2,
0x8bf1,0x8c00,0x8c0e,0x8c1d,0x8c2b,0x8c3a,0x8c49,0x8c57,
0x8c66,0x8c74,0x8c83,0x8c91,0x8ca0,0x8caf,0x8cbd,0x8ccc,
0x8cda,0x8ce9,0x8cf7,0x8d06,0x8d14,0x8d23,0x8d31,0x8d40,
0x8d4e,0x8d5d,0x8d6b,0x8d7a,0x8d88,0x8d97,0x8da5,0x8db4,
0x8dc2,0x8dd1,0x8ddf,0x8ded,0x8dfc,0x8e0a,0x8e19,0x8e27,
0x8e36,0x8e44,0x8e52,0x8e61,0x8e6f,0x8e7d,0x8e8c,0x8e9a,
0x8ea9,0x8eb7,0x8ec5,0x8ed4,0x8ee2,0x8ef0,0x8eff,0x8f0d,
0x8f1b,0x8f2a,0x8f38,0x8f46,0x8f54,0x8f63,0x8f71,0x8f7f,
0x8f8e,0x8f9c,0x8faa,0x8fb8,0x8fc7,0x8fd5,0x8fe3,0x8ff1,
0x9000,0x900e,0x901c,0x902a,0x9038,0x9047,0x9055,0x9063,
0x9071,0x907f,0x908d,0x909c,0x90aa,0x90b8,0x90c6,0x90d4,
0x90e2,0x90f0,0x90ff,0x910d,0x911b,0x9129,0x9137,0x9145,
0x9153,0x9161,0x916f,0x917e,0x918c,0x919a,0x91a8,0x91b6,
0x91c4,0x91d2,0x91e0,0x91ee,0x91fc,0x920a,0x9218,0x9226,
0x9234,0x9242,0x9250,0x925e,0x926c,0x927a,0x9288,0x9296,
0x92a4,0x92b2,0x92c0,0x92ce,0x92dc,0x92ea,0x92f8,0x9306,
0x9314,0x9321,0x932f,0x933d,0x934b,0x9359,0x9367,0x9375,
0x9383,0x9391,0x939f,0x93ac,0x93ba,0x93c8,0x93d6,0x93e4,
0x93f2,0x9400,0x940d,0x941b,0x9429,0x9437,0x9445,0x9452,
0x9460,0x946e,0x947c,0x948a,0x9497,0x94a5,0x94b3,0x94c1,
0x94cf,0x94dc,0x94ea,0x94f8,0x9506,0x9513,0x9521,0x952f,
0x953c,0x954a,0x9558,0x9566,0x9573,0x9581,0x958f,0x959c,
0x95aa,0x95b8,0x95c5,0x95d3,0x95e1,0x95ee,0x95fc,0x960a,
0x9617,0x9625,0x9633,0x9640,0x964e,0x965c,0x9669,0x9677,
0x9684,0x9692,0x96a0,0x96ad,0x96bb,0x96c8,0x96d6,0x96e4,
0x96f1,0x96ff,0x970c,0x971a,0x9727,0x9735,0x9742,0x9750,
0x975d,0x976b,0x9779,0x9786,0x9794,0x97a1,0x97af,0x97bc,
0x97ca,0x97d7,0x97e5,0x97f2,0x9800,0x980d,0x981a,0x9828,
0x9835,0x9843,0x9850,0x985e,0x986b,0x9879,0x9886,0x9893,
0x98a1,0x98ae,0x98bc,0x98c9,0x98d6,0x98e4,0x98f1,0x98ff,
0x990c,0x9919,0x9927,0x9934,0x9942,0x994f,0x995c,0x996a,
0x9977,0x9984,0x9992,0x999f,0x99ac,0x99ba,0x99c7,0x99d4,
0x99e2,0x99ef,0x99fc,0x9a09,0x9a17,0x9a24,0x9a31,0x9a3f,
0x9a4c,0x9a59,0x9a66,0x9a74,0x9a81,0x9a8e,0x9a9b,0x9aa9,
0x9ab6,0x9ac3,0x9ad0,0x9ade,0x9aeb,0x9af8,0x9b05,0x9b12,
0x9b20,0x9b2d,0x9b3a,0x9b47,0x9b54,0x9b62,0x9b6f,0x9b7c,
0x9b89,0x9b96,0x9ba3,0x9bb1,0x9bbe,0x9bcb,0x9bd8,0x9be5,
0x9bf2,0x9c00,0x9c0d,0x9c1a,0x9c27,0x9c34,0x9c41,0x9c4e,
0x9c5b,0x9c68,0x9c75,0x9c83,0x9c90,0x9c9d,0x9caa,0x9cb7,
0x9cc4,0x9cd1,0x9cde,0x9ceb,0x9cf8,0x9d05,0x9d12,0x9d1f,
0x9d2c,0x9d39,0x9d46,0x9d53,0x9d60,0x9d6d,0x9d7a,0x9d87,
0x9d94,0x9da1,0x9dae,0x9dbb,0x9dc8,0x9dd5,0x9de2,0x9def,
0x9dfc,0x9e09,0x9e16,0x9e23,0x9e30,0x9e3d,0x9e4a,0x9e57,
0x9e64,0x9e71,0x9e7e,0x9e8b,0x9e98,0x9ea4,0x9eb1,0x9ebe,
0x9ecb,0x9ed8,0x9ee5,0x9ef2,0x9eff,0x9f0c,0x9f18,0x9f25,
0x9f32,0x9f3f,0x9f4c,0x9f59,0x9f66,0x9f72,0x9f7f,0x9f8c,
0x9f99,0x9fa6,0x9fb3,0x9fbf,0x9fcc,0x9fd9,0x9fe6,0x9ff3,
0xa000,0xa00c,0xa019,0xa026,0xa033,0xa03f,0xa04c,0xa059,
0xa066,0xa073,0xa07f,0xa08c,0xa099,0xa0a6,0xa0b2,0xa0bf,
0xa0cc,0xa0d9,0xa0e5,0xa0f2,0xa0ff,0xa10b,0xa118,0xa125,
0xa132,0xa13e,0xa14b,0xa158,0xa164,0xa171,0xa17e,0xa18a,
0xa197,0xa1a4,0xa1b0,0xa1bd,0xa1ca,0xa1d6,0xa1e3,0xa1f0,
0xa1fc,0xa209,0xa216,0xa222,0xa22f,0xa23c,0xa248,0xa255,
0xa261,0xa26e,0xa27b,0xa287,0xa294,0xa2a0,0xa2ad,0xa2ba,
0xa2c6,0xa2d3,0xa2df,0xa2ec,0xa2f8,0xa305,0xa312,0xa31e,
0xa32b,0xa337,0xa344,0xa350,0xa35d,0xa369,0xa376,0xa382,
0xa38f,0xa39b,0xa3a8,0xa3b5,0xa3c1,0xa3ce,0xa3da,0xa3e7,
0xa3f3,0xa400,0xa40c,0xa418,0xa425,0xa431,0xa43e,0xa44a,
0xa457,0xa463,0xa470,0xa47c,0xa489,0xa495,0xa4a2,0xa4ae,
0xa4ba,0xa4c7,0xa4d3,0xa4e0,0xa4ec,0xa4f9,0xa505,0xa511,
0xa51e,0xa52a,0xa537,0xa543,0xa54f,0xa55c,0xa568,0xa574,
0xa581,0xa58d,0xa59a,0xa5a6,0xa5b2,0xa5bf,0xa5cb,0xa5d7,
0xa5e4,0xa5f0,0xa5fc,0xa609,0xa615,0xa621,0xa62e,0xa63a,
0xa646,0xa653,0xa65f,0xa66b,0xa678,0xa684,0xa690,0xa69d,
0xa6a9,0xa6b5,0xa6c1,0xa6ce,0xa6da,0xa6e6,0xa6f2,0xa6ff,
0xa70b,0xa717,0xa724,0xa730,0xa73c,0xa748,0xa754,0xa761,
0xa76d,0xa779,0xa785,0xa792,0xa79e,0xa7aa,0xa7b6,0xa7c3,
0xa7cf,0xa7db,0xa7e7,0xa7f3,0xa800,0xa80c,0xa818,0xa824,
0xa830,0xa83c,0xa849,0xa855,0xa861,0xa86d,0xa879,0xa885,
0xa892,0xa89e,0xa8aa,0xa8b6,0xa8c2,0xa8ce,0xa8da,0xa8e6,
0xa8f3,0xa8ff,0xa90b,0xa917,0xa923,0xa92f,0xa93b,0xa947,
0xa953,0xa960,0xa96c,0xa978,0xa984,0xa990,0xa99c,0xa9a8,
0xa9b4,0xa9c0,0xa9cc,0xa9d8,0xa9e4,0xa9f0,0xa9fc,0xaa09,
0xaa15,0xaa21,0xaa2d,0xaa39,0xaa45,0xaa51,0xaa5d,0xaa69,
0xaa75,0xaa81,0xaa8d,0xaa99,0xaaa5,0xaab1,0xaabd,0xaac9,
0xaad5,0xaae1,0xaaed,0xaaf9,0xab05,0xab11,0xab1d,0xab29,
0xab35,0xab41,0xab4d,0xab58,0xab64,0xab70,0xab7c,0xab88,
0xab94,0xaba0,0xabac,0xabb8,0xabc4,0xabd0,0xabdc,0xabe8,
0xabf4,0xac00,0xac0b,0xac17,0xac23,0xac2f,0xac3b,0xac47,
0xac53,0xac5f,0xac6b,0xac76,0xac82,0xac8e,0xac9a,0xaca6,
0xacb2,0xacbe,0xacc9,0xacd5,0xace1,0xaced,0xacf9,0xad05,
0xad11,0xad1c,0xad28,0xad34,0xad40,0xad4c,0xad57,0xad63,
0xad6f,0xad7b,0xad87,0xad92,0xad9e,0xadaa,0xadb6,0xadc2,
0xadcd,0xadd9,0xade5,0xadf1,0xadfd,0xae08,0xae14,0xae20,
0xae2c,0xae37,0xae43,0xae4f,0xae5b,0xae66,0xae72,0xae7e,
0xae8a,0xae95,0xaea1,0xaead,0xaeb8,0xaec4,0xaed0,0xaedc,
0xaee7,0xaef3,0xaeff,0xaf0a,0xaf16,0xaf22,0xaf2e,0xaf39,
0xaf45,0xaf51,0xaf5c,0xaf68,0xaf74,0xaf7f,0xaf8b,0xaf97,
0xafa2,0xafae,0xafba,0xafc5,0xafd1,0xafdd,0xafe8,0xaff4,
0xb000,0xb00b,0xb017,0xb022,0xb02e,0xb03a,0xb045,0xb051,
0xb05c,0xb068,0xb074,0xb07f,0xb08b,0xb097,0xb0a2,0xb0ae,
0xb0b9,0xb0c5,0xb0d0,0xb0dc,0xb0e8,0xb0f3,0xb0ff,0xb10a,
0xb116,0xb121,0xb12d,0xb139,0xb144,0xb150,0xb15b,0xb167,
0xb172,0xb17e,0xb189,0xb195,0xb1a0,0xb1ac,0xb1b8,0xb1c3,
0xb1cf,0xb1da,0xb1e6,0xb1f1,0xb1fd,0xb208,0xb214,0xb21f,
0xb22b,0xb236,0xb242,0xb24d,0xb259,0xb264,0xb270,0xb27b,
0xb286,0xb292,0xb29d,0xb2a9,0xb2b4,0xb2c0,0xb2cb,0xb2d7,
0xb2e2,0xb2ee,0xb2f9,0xb305,0xb310,0xb31b,0xb327,0xb332,
0xb33e,0xb349,0xb355,0xb360,0xb36b,0xb377,0xb382,0xb38e,
0xb399,0xb3a4,0xb3b0,0xb3bb,0xb3c7,0xb3d2,0xb3dd,0xb3e9,
0xb3f4,0xb400,0xb40b,0xb416,0xb422,0xb42d,0xb438,0xb444,
0xb44f,0xb45a,0xb466,0xb471,0xb47c,0xb488,0xb493,0xb49f,
0xb4aa,0xb4b5,0xb4c1,0xb4cc,0xb4d7,0xb4e2,0xb4ee,0xb4f9,
0xb504,0xb510,0xb51b,0xb526,0xb532,0xb53d,0xb548,0xb554,
0xb55f,0xb56a,0xb575,0xb581,0xb58c,0xb597,0xb5a3,0xb5ae,
0xb5b9,0xb5c4,0xb5d0,0xb5db,0xb5e6,0xb5f1,0xb5fd,0xb608,
0xb613,0xb61e,0xb62a,0xb635,0xb640,0xb64b,0xb657,0xb662,
0xb66d,0xb678,0xb684,0xb68f,0xb69a,0xb6a5,0xb6b0,0xb6bc,
0xb6c7,0xb6d2,0xb6dd,0xb6e8,0xb6f4,0xb6ff,0xb70a,0xb715,
0xb720,0xb72c,0xb737,0xb742,0xb74d,0xb758,0xb763,0xb76f,
0xb77a,0xb785,0xb790,0xb79b,0xb7a6,0xb7b2,0xb7bd,0xb7c8,
0xb7d3,0xb7de,0xb7e9,0xb7f4,0xb800,0xb80b,0xb816,0xb821,
0xb82c,0xb837,0xb842,0xb84d,0xb858,0xb864,0xb86f,0xb87a,
0xb885,0xb890,0xb89b,0xb8a6,0xb8b1,0xb8bc,0xb8c7,0xb8d3,
0xb8de,0xb8e9,0xb8f4,0xb8ff,0xb90a,0xb915,0xb920,0xb92b,
0xb936,0xb941,0xb94c,0xb957,0xb962,0xb96d,0xb978,0xb983,
0xb98f,0xb99a,0xb9a5,0xb9b0,0xb9bb,0xb9c6,0xb9d1,0xb9dc,
0xb9e7,0xb9f2,0xb9fd,0xba08,0xba13,0xba1e,0xba29,0xba34,
0xba3f,0xba4a,0xba55,0xba60,0xba6b,0xba76,0xba81,0xba8c,
0xba97,0xbaa2,0xbaad,0xbab8,0xbac3,0xbace,0xbad8,0xbae3,
0xbaee,0xbaf9,0xbb04,0xbb0f,0xbb1a,0xbb25,0xbb30,0xbb3b,
0xbb46,0xbb51,0xbb5c,0xbb67,0xbb72,0xbb7d,0xbb88,0xbb92,
0xbb9d,0xbba8,0xbbb3,0xbbbe,0xbbc9,0xbbd4,0xbbdf,0xbbea,
0xbbf5,0xbc00,0xbc0a,0xbc15,0xbc20,0xbc2b,0xbc36,0xbc41,
0xbc4c,0xbc57,0xbc61,0xbc6c,0xbc77,0xbc82,0xbc8d,0xbc98,
0xbca3,0xbcad,0xbcb8,0xbcc3,0xbcce,0xbcd9,0xbce4,0xbcef,
0xbcf9,0xbd04,0xbd0f,0xbd1a,0xbd25,0xbd30,0xbd3a,0xbd45,
0xbd50,0xbd5b,0xbd66,0xbd70,0xbd7b,0xbd86,0xbd91,0xbd9c,
0xbda6,0xbdb1,0xbdbc,0xbdc7,0xbdd2,0xbddc,0xbde7,0xbdf2,
0xbdfd,0xbe08,0xbe12,0xbe1d,0xbe28,0xbe33,0xbe3d,0xbe48,
0xbe53,0xbe5e,0xbe68,0xbe73,0xbe7e,0xbe89,0xbe93,0xbe9e,
0xbea9,0xbeb4,0xbebe,0xbec9,0xbed4,0xbedf,0xbee9,0xbef4,
0xbeff,0xbf0a,0xbf14,0xbf1f,0xbf2a,0xbf34,0xbf3f,0xbf4a,
0xbf55,0xbf5f,0xbf6a,0xbf75,0xbf7f,0xbf8a,0xbf95,0xbf9f,
0xbfaa,0xbfb5,0xbfbf,0xbfca,0xbfd5,0xbfdf,0xbfea,0xbff5,
0xc000,0xc00a,0xc015,0xc01f,0xc02a,0xc035,0xc03f,0xc04a,
0xc055,0xc05f,0xc06a,0xc075,0xc07f,0xc08a,0xc095,0xc09f,
0xc0aa,0xc0b5,0xc0bf,0xc0ca,0xc0d4,0xc0df,0xc0ea,0xc0f4,
0xc0ff,0xc109,0xc114,0xc11f,0xc129,0xc134,0xc13e,0xc149,
0xc154,0xc15e,0xc169,0xc173,0xc17e,0xc189,0xc193,0xc19e,
0xc1a8,0xc1b3,0xc1bd,0xc1c8,0xc1d3,0xc1dd,0xc1e8,0xc1f2,
0xc1fd,0xc207,0xc212,0xc21d,0xc227,0xc232,0xc23c,0xc247,
0xc251,0xc25c,0xc266,0xc271,0xc27b,0xc286,0xc290,0xc29b,
0xc2a5,0xc2b0,0xc2bb,0xc2c5,0xc2d0,0xc2da,0xc2e5,0xc2ef,
0xc2fa,0xc304,0xc30f,0xc319,0xc324,0xc32e,0xc339,0xc343,
0xc34e,0xc358,0xc363,0xc36d,0xc377,0xc382,0xc38c,0xc397,
0xc3a1,0xc3ac,0xc3b6,0xc3c1,0xc3cb,0xc3d6,0xc3e0,0xc3eb,
0xc3f5,0xc400,0xc40a,0xc414,0xc41f,0xc429,0xc434,0xc43e,
0xc449,0xc453,0xc45d,0xc468,0xc472,0xc47d,0xc487,0xc492,
0xc49c,0xc4a6,0xc4b1,0xc4bb,0xc4c6,0xc4d0,0xc4da,0xc4e5,
0xc4ef,0xc4fa,0xc504,0xc50e,0xc519,0xc523,0xc52e,0xc538,
0xc542,0xc54d,0xc557,0xc562,0xc56c,0xc576,0xc581,0xc58b,
0xc595,0xc5a0,0xc5aa,0xc5b4,0xc5bf,0xc5c9,0xc5d4,0xc5de,
0xc5e8,0xc5f3,0xc5fd,0xc607,0xc612,0xc61c,0xc626,0xc631,
0xc63b,0xc645,0xc650,0xc65a,0xc664,0xc66f,0xc679,0xc683,
0xc68e,0xc698,0xc6a2,0xc6ac,0xc6b7,0xc6c1,0xc6cb,0xc6d6,
0xc6e0,0xc6ea,0xc6f5,0xc6ff,0xc709,0xc713,0xc71e,0xc728,
0xc732,0xc73d,0xc747,0xc751,0xc75b,0xc766,0xc770,0xc77a,
0xc784,0xc78f,0xc799,0xc7a3,0xc7ae,0xc7b8,0xc7c2,0xc7cc,
0xc7d7,0xc7e1,0xc7eb,0xc7f5,0xc800,0xc80a,0xc814,0xc81e,
0xc828,0xc833,0xc83d,0xc847,0xc851,0xc85c,0xc866,0xc870,
0xc87a,0xc884,0xc88f,0xc899,0xc8a3,0xc8ad,0xc8b7,0xc8c2,
0xc8cc,0xc8d6,0xc8e0,0xc8ea,0xc8f5,0xc8ff,0xc909,0xc913,
0xc91d,0xc928,0xc932,0xc93c,0xc946,0xc950,0xc95a,0xc965,
0xc96f,0xc979,0xc983,0xc98d,0xc997,0xc9a2,0xc9ac,0xc9b6,
0xc9c0,0xc9ca,0xc9d4,0xc9df,0xc9e9,0xc9f3,0xc9fd,0xca07,
0xca11,0xca1b,0xca26,0xca30,0xca3a,0xca44,0xca4e,0xca58,
0xca62,0xca6c,0xca76,0xca81,0xca8b,0xca95,0xca9f,0xcaa9,
0xcab3,0xcabd,0xcac7,0xcad1,0xcadc,0xcae6,0xcaf0,0xcafa,
0xcb04,0xcb0e,0xcb18,0xcb22,0xcb2c,0xcb36,0xcb40,0xcb4a,
0xcb55,0xcb5f,0xcb69,0xcb73,0xcb7d,0xcb87,0xcb91,0xcb9b,
0xcba5,0xcbaf,0xcbb9,0xcbc3,0xcbcd,0xcbd7,0xcbe1,0xcbeb,
0xcbf5,0xcc00,0xcc0a,0xcc14,0xcc1e,0xcc28,0xcc32,0xcc3c,
0xcc46,0xcc50,0xcc5a,0xcc64,0xcc6e,0xcc78,0xcc82,0xcc8c,
0xcc96,0xcca0,0xccaa,0xccb4,0xccbe,0xccc8,0xccd2,0xccdc,
0xcce6,0xccf0,0xccfa,0xcd04,0xcd0e,0xcd18,0xcd22,0xcd2c,
0xcd36,0xcd40,0xcd4a,0xcd54,0xcd5e,0xcd68,0xcd72,0xcd7c,
0xcd86,0xcd90,0xcd99,0xcda3,0xcdad,0xcdb7,0xcdc1,0xcdcb,
0xcdd5,0xcddf,0xcde9,0xcdf3,0xcdfd,0xce07,0xce11,0xce1b,
0xce25,0xce2f,0xce39,0xce43,0xce4c,0xce56,0xce60,0xce6a,
0xce74,0xce7e,0xce88,0xce92,0xce9c,0xcea6,0xceb0,0xceba,
0xcec3,0xcecd,0xced7,0xcee1,0xceeb,0xcef5,0xceff,0xcf09,
0xcf13,0xcf1d,0xcf26,0xcf30,0xcf3a,0xcf44,0xcf4e,0xcf58,
0xcf62,0xcf6c,0xcf75,0xcf7f,0xcf89,0xcf93,0xcf9d,0xcfa7,
0xcfb1,0xcfbb,0xcfc4,0xcfce,0xcfd8,0xcfe2,0xcfec,0xcff6,
0xd000,0xd009,0xd013,0xd01d,0xd027,0xd031,0xd03b,0xd044,
0xd04e,0xd058,0xd062,0xd06c,0xd076,0xd07f,0xd089,0xd093,
0xd09d,0xd0a7,0xd0b0,0xd0ba,0xd0c4,0xd0ce,0xd0d8,0xd0e1,
0xd0eb,0xd0f5,0xd0ff,0xd109,0xd112,0xd11c,0xd126,0xd130,
0xd13a,0xd143,0xd14d,0xd157,0xd161,0xd16b,0xd174,0xd17e,
0xd188,0xd192,0xd19b,0xd1a5,0xd1af,0xd1b9,0xd1c3,0xd1cc,
0xd1d6,0xd1e0,0xd1ea,0xd1f3,0xd1fd,0xd207,0xd211,0xd21a,
0xd224,0xd22e,0xd238,0xd241,0xd24b,0xd255,0xd25f,0xd268,
0xd272,0xd27c,0xd285,0xd28f,0xd299,0xd2a3,0xd2ac,0xd2b6,
0xd2c0,0xd2c9,0xd2d3,0xd2dd,0xd2e7,0xd2f0,0xd2fa,0xd304,
0xd30d,0xd317,0xd321,0xd32b,0xd334,0xd33e,0xd348,0xd351,
0xd35b,0xd365,0xd36e,0xd378,0xd382,0xd38b,0xd395,0xd39f,
0xd3a8,0xd3b2,0xd3bc,0xd3c6,0xd3cf,0xd3d9,0xd3e3,0xd3ec,
0xd3f6,0xd400,0xd409,0xd413,0xd41c,0xd426,0xd430,0xd439,
0xd443,0xd44d,0xd456,0xd460,0xd46a,0xd473,0xd47d,0xd487,
0xd490,0xd49a,0xd4a3,0xd4ad,0xd4b7,0xd4c0,0xd4ca,0xd4d4,
0xd4dd,0xd4e7,0xd4f0,0xd4fa,0xd504,0xd50d,0xd517,0xd521,
0xd52a,0xd534,0xd53d,0xd547,0xd551,0xd55a,0xd564,0xd56d,
0xd577,0xd581,0xd58a,0xd594,0xd59d,0xd5a7,0xd5b0,0xd5ba,
0xd5c4,0xd5cd,0xd5d7,0xd5e0,0xd5ea,0xd5f4,0xd5fd,0xd607,
0xd610,0xd61a,0xd623,0xd62d,0xd637,0xd640,0xd64a,0xd653,
0xd65d,0xd666,0xd670,0xd679,0xd683,0xd68c,0xd696,0xd6a0,
0xd6a9,0xd6b3,0xd6bc,0xd6c6,0xd6cf,0xd6d9,0xd6e2,0xd6ec,
0xd6f5,0xd6ff,0xd708,0xd712,0xd71b,0xd725,0xd72f,0xd738,
0xd742,0xd74b,0xd755,0xd75e,0xd768,0xd771,0xd77b,0xd784,
0xd78e,0xd797,0xd7a1,0xd7aa,0xd7b4,0xd7bd,0xd7c7,0xd7d0,
0xd7da,0xd7e3,0xd7ed,0xd7f6,0xd800,0xd809,0xd812,0xd81c,
0xd825,0xd82f,0xd838,0xd842,0xd84b,0xd855,0xd85e,0xd868,
0xd871,0xd87b,0xd884,0xd88e,0xd897,0xd8a0,0xd8aa,0xd8b3,
0xd8bd,0xd8c6,0xd8d0,0xd8d9,0xd8e3,0xd8ec,0xd8f5,0xd8ff,
0xd908,0xd912,0xd91b,0xd925,0xd92e,0xd938,0xd941,0xd94a,
0xd954,0xd95d,0xd967,0xd970,0xd979,0xd983,0xd98c,0xd996,
0xd99f,0xd9a9,0xd9b2,0xd9bb,0xd9c5,0xd9ce,0xd9d8,0xd9e1,
0xd9ea,0xd9f4,0xd9fd,0xda07,0xda10,0xda19,0xda23,0xda2c,
0xda35,0xda3f,0xda48,0xda52,0xda5b,0xda64,0xda6e,0xda77,
0xda81,0xda8a,0xda93,0xda9d,0xdaa6,0xdaaf,0xdab9,0xdac2,
0xdacb,0xdad5,0xdade,0xdae8,0xdaf1,0xdafa,0xdb04,0xdb0d,
0xdb16,0xdb20,0xdb29,0xdb32,0xdb3c,0xdb45,0xdb4e,0xdb58,
0xdb61,0xdb6a,0xdb74,0xdb7d,0xdb86,0xdb90,0xdb99,0xdba2,
0xdbac,0xdbb5,0xdbbe,0xdbc8,0xdbd1,0xdbda,0xdbe4,0xdbed,
0xdbf6,0xdc00,0xdc09,0xdc12,0xdc1b,0xdc25,0xdc2e,0xdc37,
0xdc41,0xdc4a,0xdc53,0xdc5d,0xdc66,0xdc6f,0xdc78,0xdc82,
0xdc8b,0xdc94,0xdc9e,0xdca7,0xdcb0,0xdcb9,0xdcc3,0xdccc,
0xdcd5,0xdcde,0xdce8,0xdcf1,0xdcfa,0xdd04,0xdd0d,0xdd16,
0xdd1f,0xdd29,0xdd32,0xdd3b,0xdd44,0xdd4e,0xdd57,0xdd60,
0xdd69,0xdd73,0xdd7c,0xdd85,0xdd8e,0xdd98,0xdda1,0xddaa,
0xddb3,0xddbd,0xddc6,0xddcf,0xddd8,0xdde2,0xddeb,0xddf4,
0xddfd,0xde06,0xde10,0xde19,0xde22,0xde2b,0xde35,0xde3e,
0xde47,0xde50,0xde59,0xde63,0xde6c,0xde75,0xde7e,0xde87,
0xde91,0xde9a,0xdea3,0xdeac,0xdeb5,0xdebf,0xdec8,0xded1,
0xdeda,0xdee3,0xdeed,0xdef6,0xdeff,0xdf08,0xdf11,0xdf1a,
0xdf24,0xdf2d,0xdf36,0xdf3f,0xdf48,0xdf52,0xdf5b,0xdf64,
0xdf6d,0xdf76,0xdf7f,0xdf89,0xdf92,0xdf9b,0xdfa4,0xdfad,
0xdfb6,0xdfbf,0xdfc9,0xdfd2,0xdfdb,0xdfe4,0xdfed,0xdff6,
0xe000,0xe009,0xe012,0xe01b,0xe024,0xe02d,0xe036,0xe03f,
0xe049,0xe052,0xe05b,0xe064,0xe06d,0xe076,0xe07f,0xe088,
0xe092,0xe09b,0xe0a4,0xe0ad,0xe0b6,0xe0bf,0xe0c8,0xe0d1,
0xe0db,0xe0e4,0xe0ed,0xe0f6,0xe0ff,0xe108,0xe111,0xe11a,
0xe123,0xe12c,0xe136,0xe13f,0xe148,0xe151,0xe15a,0xe163,
0xe16c,0xe175,0xe17e,0xe187,0xe190,0xe199,0xe1a3,0xe1ac,
0xe1b5,0xe1be,0xe1c7,0xe1d0,0xe1d9,0xe1e2,0xe1eb,0xe1f4,
0xe1fd,0xe206,0xe20f,0xe218,0xe221,0xe22b,0xe234,0xe23d,
0xe246,0xe24f,0xe258,0xe261,0xe26a,0xe273,0xe27c,0xe285,
0xe28e,0xe297,0xe2a0,0xe2a9,0xe2b2,0xe2bb,0xe2c4,0xe2cd,
0xe2d6,0xe2df,0xe2e8,0xe2f1,0xe2fa,0xe303,0xe30c,0xe315,
0xe31f,0xe328,0xe331,0xe33a,0xe343,0xe34c,0xe355,0xe35e,
0xe367,0xe370,0xe379,0xe382,0xe38b,0xe394,0xe39d,0xe3a6,
0xe3af,0xe3b8,0xe3c1,0xe3ca,0xe3d3,0xe3dc,0xe3e5,0xe3ee,
0xe3f7,0xe400,0xe408,0xe411,0xe41a,0xe423,0xe42c,0xe435,
0xe43e,0xe447,0xe450,0xe459,0xe462,0xe46b,0xe474,0xe47d,
0xe486,0xe48f,0xe498,0xe4a1,0xe4aa,0xe4b3,0xe4bc,0xe4c5,
0xe4ce,0xe4d7,0xe4e0,0xe4e9,0xe4f2,0xe4fa,0xe503,0xe50c,
0xe515,0xe51e,0xe527,0xe530,0xe539,0xe542,0xe54b,0xe554,
0xe55d,0xe566,0xe56f,0xe578,0xe580,0xe589,0xe592,0xe59b,
0xe5a4,0xe5ad,0xe5b6,0xe5bf,0xe5c8,0xe5d1,0xe5da,0xe5e3,
0xe5eb,0xe5f4,0xe5fd,0xe606,0xe60f,0xe618,0xe621,0xe62a,
0xe633,0xe63c,0xe644,0xe64d,0xe656,0xe65f,0xe668,0xe671,
0xe67a,0xe683,0xe68c,0xe694,0xe69d,0xe6a6,0xe6af,0xe6b8,
0xe6c1,0xe6ca,0xe6d3,0xe6db,0xe6e4,0xe6ed,0xe6f6,0xe6ff,
0xe708,0xe711,0xe71a,0xe722,0xe72b,0xe734,0xe73d,0xe746,
0xe74f,0xe758,0xe760,0xe769,0xe772,0xe77b,0xe784,0xe78d,
0xe795,0xe79e,0xe7a7,0xe7b0,0xe7b9,0xe7c2,0xe7cb,0xe7d3,
0xe7dc,0xe7e5,0xe7ee,0xe7f7,0xe800,0xe808,0xe811,0xe81a,
0xe823,0xe82c,0xe834,0xe83d,0xe846,0xe84f,0xe858,0xe861,
0xe869,0xe872,0xe87b,0xe884,0xe88d,0xe895,0xe89e,0xe8a7,
0xe8b0,0xe8b9,0xe8c1,0xe8ca,0xe8d3,0xe8dc,0xe8e5,0xe8ed,
0xe8f6,0xe8ff,0xe908,0xe911,0xe919,0xe922,0xe92b,0xe934,
0xe93c,0xe945,0xe94e,0xe957,0xe960,0xe968,0xe971,0xe97a,
0xe983,0xe98b,0xe994,0xe99d,0xe9a6,0xe9ae,0xe9b7,0xe9c0,
0xe9c9,0xe9d2,0xe9da,0xe9e3,0xe9ec,0xe9f5,0xe9fd,0xea06,
0xea0f,0xea18,0xea20,0xea29,0xea32,0xea3b,0xea43,0xea4c,
0xea55,0xea5e,0xea66,0xea6f,0xea78,0xea80,0xea89,0xea92,
0xea9b,0xeaa3,0xeaac,0xeab5,0xeabe,0xeac6,0xeacf,0xead8,
0xeae0,0xeae9,0xeaf2,0xeafb,0xeb03,0xeb0c,0xeb15,0xeb1d,
0xeb26,0xeb2f,0xeb38,0xeb40,0xeb49,0xeb52,0xeb5a,0xeb63,
0xeb6c,0xeb74,0xeb7d,0xeb86,0xeb8f,0xeb97,0xeba0,0xeba9,
0xebb1,0xebba,0xebc3,0xebcb,0xebd4,0xebdd,0xebe5,0xebee,
0xebf7,0xec00,0xec08,0xec11,0xec1a,0xec22,0xec2b,0xec34,
0xec3c,0xec45,0xec4e,0xec56,0xec5f,0xec68,0xec70,0xec79,
0xec82,0xec8a,0xec93,0xec9c,0xeca4,0xecad,0xecb5,0xecbe,
0xecc7,0xeccf,0xecd8,0xece1,0xece9,0xecf2,0xecfb,0xed03,
0xed0c,0xed15,0xed1d,0xed26,0xed2e,0xed37,0xed40,0xed48,
0xed51,0xed5a,0xed62,0xed6b,0xed74,0xed7c,0xed85,0xed8d,
0xed96,0xed9f,0xeda7,0xedb0,0xedb8,0xedc1,0xedca,0xedd2,
0xeddb,0xede4,0xedec,0xedf5,0xedfd,0xee06,0xee0f,0xee17,
0xee20,0xee28,0xee31,0xee3a,0xee42,0xee4b,0xee53,0xee5c,
0xee65,0xee6d,0xee76,0xee7e,0xee87,0xee8f,0xee98,0xeea1,
0xeea9,0xeeb2,0xeeba,0xeec3,0xeecc,0xeed4,0xeedd,0xeee5,
0xeeee,0xeef6,0xeeff,0xef08,0xef10,0xef19,0xef21,0xef2a,
0xef32,0xef3b,0xef43,0xef4c,0xef55,0xef5d,0xef66,0xef6e,
0xef77,0xef7f,0xef88,0xef90,0xef99,0xefa2,0xefaa,0xefb3,
0xefbb,0xefc4,0xefcc,0xefd5,0xefdd,0xefe6,0xefee,0xeff7,
0xf000,0xf008,0xf011,0xf019,0xf022,0xf02a,0xf033,0xf03b,
0xf044,0xf04c,0xf055,0xf05d,0xf066,0xf06e,0xf077,0xf07f,
0xf088,0xf090,0xf099,0xf0a1,0xf0aa,0xf0b2,0xf0bb,0xf0c3,
0xf0cc,0xf0d4,0xf0dd,0xf0e5,0xf0ee,0xf0f6,0xf0ff,0xf107,
0xf110,0xf118,0xf121,0xf129,0xf132,0xf13a,0xf143,0xf14b,
0xf154,0xf15c,0xf165,0xf16d,0xf176,0xf17e,0xf187,0xf18f,
0xf198,0xf1a0,0xf1a9,0xf1b1,0xf1ba,0xf1c2,0xf1cb,0xf1d3,
0xf1dc,0xf1e4,0xf1ec,0xf1f5,0xf1fd,0xf206,0xf20e,0xf217,
0xf21f,0xf228,0xf230,0xf239,0xf241,0xf24a,0xf252,0xf25a,
0xf263,0xf26b,0xf274,0xf27c,0xf285,0xf28d,0xf296,0xf29e,
0xf2a6,0xf2af,0xf2b7,0xf2c0,0xf2c8,0xf2d1,0xf2d9,0xf2e1,
0xf2ea,0xf2f2,0xf2fb,0xf303,0xf30c,0xf314,0xf31c,0xf325,
0xf32d,0xf336,0xf33e,0xf347,0xf34f,0xf357,0xf360,0xf368,
0xf371,0xf379,0xf381,0xf38a,0xf392,0xf39b,0xf3a3,0xf3ac,
0xf3b4,0xf3bc,0xf3c5,0xf3cd,0xf3d6,0xf3de,0xf3e6,0xf3ef,
0xf3f7,0xf400,0xf408,0xf410,0xf419,0xf421,0xf429,0xf432,
0xf43a,0xf443,0xf44b,0xf453,0xf45c,0xf464,0xf46d,0xf475,
0xf47d,0xf486,0xf48e,0xf496,0xf49f,0xf4a7,0xf4b0,0xf4b8,
0xf4c0,0xf4c9,0xf4d1,0xf4d9,0xf4e2,0xf4ea,0xf4f2,0xf4fb,
0xf503,0xf50c,0xf514,0xf51c,0xf525,0xf52d,0xf535,0xf53e,
0xf546,0xf54e,0xf557,0xf55f,0xf567,0xf570,0xf578,0xf580,
0xf589,0xf591,0xf599,0xf5a2,0xf5aa,0xf5b2,0xf5bb,0xf5c3,
0xf5cb,0xf5d4,0xf5dc,0xf5e4,0xf5ed,0xf5f5,0xf5fd,0xf606,
0xf60e,0xf616,0xf61f,0xf627,0xf62f,0xf638,0xf640,0xf648,
0xf651,0xf659,0xf661,0xf66a,0xf672,0xf67a,0xf682,0xf68b,
0xf693,0xf69b,0xf6a4,0xf6ac,0xf6b4,0xf6bd,0xf6c5,0xf6cd,
0xf6d6,0xf6de,0xf6e6,0xf6ee,0xf6f7,0xf6ff,0xf707,0xf710,
0xf718,0xf720,0xf728,0xf731,0xf739,0xf741,0xf74a,0xf752,
0xf75a,0xf762,0xf76b,0xf773,0xf77b,0xf784,0xf78c,0xf794,
0xf79c,0xf7a5,0xf7ad,0xf7b5,0xf7bd,0xf7c6,0xf7ce,0xf7d6,
0xf7de,0xf7e7,0xf7ef,0xf7f7,0xf800,0xf808,0xf810,0xf818,
0xf821,0xf829,0xf831,0xf839,0xf842,0xf84a,0xf852,0xf85a,
0xf863,0xf86b,0xf873,0xf87b,0xf883,0xf88c,0xf894,0xf89c,
0xf8a4,0xf8ad,0xf8b5,0xf8bd,0xf8c5,0xf8ce,0xf8d6,0xf8de,
0xf8e6,0xf8ef,0xf8f7,0xf8ff,0xf907,0xf90f,0xf918,0xf920,
0xf928,0xf930,0xf939,0xf941,0xf949,0xf951,0xf959,0xf962,
0xf96a,0xf972,0xf97a,0xf982,0xf98b,0xf993,0xf99b,0xf9a3,
0xf9ab,0xf9b4,0xf9bc,0xf9c4,0xf9cc,0xf9d4,0xf9dd,0xf9e5,
0xf9ed,0xf9f5,0xf9fd,0xfa06,0xfa0e,0xfa16,0xfa1e,0xfa26,
0xfa2f,0xfa37,0xfa3f,0xfa47,0xfa4f,0xfa58,0xfa60,0xfa68,
0xfa70,0xfa78,0xfa80,0xfa89,0xfa91,0xfa99,0xfaa1,0xfaa9,
0xfab1,0xfaba,0xfac2,0xfaca,0xfad2,0xfada,0xfae2,0xfaeb,
0xfaf3,0xfafb,0xfb03,0xfb0b,0xfb13,0xfb1c,0xfb24,0xfb2c,
0xfb34,0xfb3c,0xfb44,0xfb4c,0xfb55,0xfb5d,0xfb65,0xfb6d,
0xfb75,0xfb7d,0xfb85,0xfb8e,0xfb96,0xfb9e,0xfba6,0xfbae,
0xfbb6,0xfbbe,0xfbc7,0xfbcf,0xfbd7,0xfbdf,0xfbe7,0xfbef,
0xfbf7,0xfc00,0xfc08,0xfc10,0xfc18,0xfc20,0xfc28,0xfc30,
0xfc38,0xfc40,0xfc49,0xfc51,0xfc59,0xfc61,0xfc69,0xfc71,
0xfc79,0xfc81,0xfc8a,0xfc92,0xfc9a,0xfca2,0xfcaa,0xfcb2,
0xfcba,0xfcc2,0xfcca,0xfcd2,0xfcdb,0xfce3,0xfceb,0xfcf3,
0xfcfb,0xfd03,0xfd0b,0xfd13,0xfd1b,0xfd23,0xfd2c,0xfd34,
0xfd3c,0xfd44,0xfd4c,0xfd54,0xfd5c,0xfd64,0xfd6c,0xfd74,
0xfd7c,0xfd84,0xfd8d,0xfd95,0xfd9d,0xfda5,0xfdad,0xfdb5,
0xfdbd,0xfdc5,0xfdcd,0xfdd5,0xfddd,0xfde5,0xfded,0xfdf5,
0xfdfd,0xfe06,0xfe0e,0xfe16,0xfe1e,0xfe26,0xfe2e,0xfe36,
0xfe3e,0xfe46,0xfe4e,0xfe56,0xfe5e,0xfe66,0xfe6e,0xfe76,
0xfe7e,0xfe86,0xfe8e,0xfe97,0xfe9f,0xfea7,0xfeaf,0xfeb7,
0xfebf,0xfec7,0xfecf,0xfed7,0xfedf,0xfee7,0xfeef,0xfef7,
0xfeff,0xff07,0xff0f,0xff17,0xff1f,0xff27,0xff2f,0xff37,
0xff3f,0xff47,0xff4f,0xff57,0xff5f,0xff67,0xff6f,0xff77,
0xff7f,0xff87,0xff8f,0xff97,0xff9f,0xffa7,0xffaf,0xffb7,
0xffbf,0xffc7,0xffcf,0xffd7,0xffdf,0xffe7,0xffef,0xfff7};





//--------------------------------------------------------------------------------------
// Copy functions from VIP libs for scalerVIP.c , because it can't call lib function in kernel space
// Start
//--------------------------------------------------------------------------------------

//>>>>>>>>>>>>>>>  old RTNR start <<<<<<<<<<<<<<<<<<<<<<<<<<<
void drvif_color_rtnr_y_th_isr(unsigned char channel, unsigned char *Th_Y)
{
//write register
	//RTD_Log(LOGGER_DEBUG,"\n jason==> Start RTNR_Y setting ... \n");


	di_im_di_rtnr_control_RBUS im_di_rtnr_control_reg;
	di_im_di_rtnr_y_16_k0_k7_RBUS im_di_rtnr_y_k_reg;
	di_im_di_rtnr_y_16_th0_th3_RBUS im_di_rtnr_y_16_th0_th3_reg;
	di_im_di_rtnr_y_16_th4_th7_RBUS im_di_rtnr_y_16_th4_th7_reg;
	di_im_di_rtnr_y_16_th8_th11_RBUS im_di_rtnr_y_16_th8_th11_reg;
	di_im_di_rtnr_y_16_th12_th14_RBUS im_di_rtnr_y_16_th12_th14_reg;

	im_di_rtnr_control_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);
	im_di_rtnr_y_k_reg.regValue = rtd_inl(DI_IM_DI_RTNR_Y_16_K0_K7_reg);
	im_di_rtnr_y_16_th0_th3_reg.regValue = rtd_inl(DI_IM_DI_RTNR_Y_16_TH0_TH3_reg);
	im_di_rtnr_y_16_th4_th7_reg.regValue = rtd_inl(DI_IM_DI_RTNR_Y_16_TH4_TH7_reg);
	im_di_rtnr_y_16_th8_th11_reg.regValue = rtd_inl(DI_IM_DI_RTNR_Y_16_TH8_TH11_reg);
	im_di_rtnr_y_16_th12_th14_reg.regValue = rtd_inl(DI_IM_DI_RTNR_Y_16_TH12_TH14_reg);

	if(channel == _CHANNEL1)
	{
		im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly0 = Th_Y[0];
		im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly1 = Th_Y[1];
		im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly2 = Th_Y[2];
		im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly3 = Th_Y[3];
		im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly4 = Th_Y[4];
		im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly5 = Th_Y[5];
		im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly6 = Th_Y[6];
		im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly7 = Th_Y[7];
		im_di_rtnr_y_16_th8_th11_reg.cp_temporalthly8 = Th_Y[8];
		im_di_rtnr_y_16_th8_th11_reg.cp_temporalthly9 = Th_Y[9];
		im_di_rtnr_y_16_th8_th11_reg.cp_temporalthly10 = Th_Y[10];
		im_di_rtnr_y_16_th8_th11_reg.cp_temporalthly11 = Th_Y[11];
		im_di_rtnr_y_16_th12_th14_reg.cp_temporalthly12 = Th_Y[12];
		im_di_rtnr_y_16_th12_th14_reg.cp_temporalthly13 = Th_Y[13];
		im_di_rtnr_y_16_th12_th14_reg.cp_temporalthly14 = Th_Y[14];
	/*
		if(Th_Y[0]!=0)//GET_RTNR_MODE(channel) flag must be turned on by menucofig
		{
			im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly0 = Th_Y[0];
			im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly1 = Th_Y[1];
			im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly2 = Th_Y[2];
			im_di_rtnr_y_16_th0_th3_reg.cp_temporalthly3 = Th_Y[3];
			im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly4 = Th_Y[4];
			im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly5 = Th_Y[5];
			im_di_rtnr_y_16_th4_th7_reg.cp_temporalthly6 = Th_Y[6];
		}
		else
		{
			im_di_rtnr_y_k_reg.cp_temporal_y_k0 = 7;//no rtnr effect
			im_di_rtnr_y_k_reg.cp_temporal_y_k1=  7;
			im_di_rtnr_y_k_reg.cp_temporal_y_k2 = 7;
			im_di_rtnr_y_k_reg.cp_temporal_y_k3 = 7;
			im_di_rtnr_y_k_reg.cp_temporal_y_k4 = 7;
			im_di_rtnr_y_k_reg.cp_temporal_y_k5 = 7;
			im_di_rtnr_y_k_reg.cp_temporal_y_k6 = 7;
			im_di_rtnr_y_k_reg.cp_temporal_y_k7 = 7;
		}
	*/

		scaler_rtd_outl(DI_IM_DI_RTNR_CONTROL_reg,im_di_rtnr_control_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_Y_16_K0_K7_reg,im_di_rtnr_y_k_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_Y_16_TH0_TH3_reg,im_di_rtnr_y_16_th0_th3_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_Y_16_TH4_TH7_reg,im_di_rtnr_y_16_th4_th7_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_Y_16_TH8_TH11_reg,im_di_rtnr_y_16_th8_th11_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_Y_16_TH12_TH14_reg,im_di_rtnr_y_16_th12_th14_reg.regValue);
		//WaitFor_IEN_STOP1();//20080516 jason for double buffer

	}


}

void drvif_color_rtnr_c_th_isr(unsigned char channel, unsigned char *Th_C)
{


	di_im_di_rtnr_control_RBUS im_di_rtnr_control_reg;
	di_im_di_rtnr_c_k_RBUS im_di_rtnr_c_k_reg;
	di_im_di_rtnr_c_th0_th3_RBUS im_di_rtnr_c_th0_th3_reg;
	di_im_di_rtnr_c_th4_th6_RBUS im_di_rtnr_c_th4_th6_reg;


	im_di_rtnr_control_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);
	im_di_rtnr_c_k_reg.regValue = rtd_inl(DI_IM_DI_RTNR_C_K_reg);
	im_di_rtnr_c_th0_th3_reg.regValue = rtd_inl(DI_IM_DI_RTNR_C_TH0_TH3_reg);
	im_di_rtnr_c_th4_th6_reg.regValue = rtd_inl(DI_IM_DI_RTNR_C_TH4_TH6_reg);

	if(channel == _CHANNEL1)
	{
		im_di_rtnr_c_th0_th3_reg.cp_temporalthlc0 = Th_C[0];
		im_di_rtnr_c_th0_th3_reg.cp_temporalthlc1 = Th_C[1];
		im_di_rtnr_c_th0_th3_reg.cp_temporalthlc2 = Th_C[2];
		im_di_rtnr_c_th0_th3_reg.cp_temporalthlc3 = Th_C[3];
		im_di_rtnr_c_th4_th6_reg.cp_temporalthlc4 = Th_C[4];
		im_di_rtnr_c_th4_th6_reg.cp_temporalthlc5 = Th_C[5];
		im_di_rtnr_c_th4_th6_reg.cp_temporalthlc6 = Th_C[6];
	/*
		if(Th_C[0]!=0)//GET_RTNR_MODE(channel) flag must be turned on by menucofig
		{
			im_di_rtnr_c_th0_th3_reg.cp_temporalthlc0 = Th_C[0];
			im_di_rtnr_c_th0_th3_reg.cp_temporalthlc1 = Th_C[1];
			im_di_rtnr_c_th0_th3_reg.cp_temporalthlc2 = Th_C[2];
			im_di_rtnr_c_th0_th3_reg.cp_temporalthlc3 = Th_C[3];
			im_di_rtnr_c_th4_th6_reg.cp_temporalthlc4 = Th_C[4];
			im_di_rtnr_c_th4_th6_reg.cp_temporalthlc5 = Th_C[5];
			im_di_rtnr_c_th4_th6_reg.cp_temporalthlc6 = Th_C[6];

		}
		else//th1 = 0 or project no support RTNR
		{
			im_di_rtnr_c_k_reg.cp_temporal_c_k0 = 7;//no rtnr effect
			im_di_rtnr_c_k_reg.cp_temporal_c_k1=  7;
			im_di_rtnr_c_k_reg.cp_temporal_c_k2 = 7;
			im_di_rtnr_c_k_reg.cp_temporal_c_k3 = 7;
			im_di_rtnr_c_k_reg.cp_temporal_c_k4 = 7;
			im_di_rtnr_c_k_reg.cp_temporal_c_k5 = 7;
			im_di_rtnr_c_k_reg.cp_temporal_c_k6 = 7;
			im_di_rtnr_c_k_reg.cp_temporal_c_k7 = 7;
		}
	*/
		//IoReg_Write32(DI_IM_DI_RTNR_CONTROL_reg,RecursiveTemporalNRCtrl_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_CONTROL_reg,im_di_rtnr_control_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_C_K_reg,im_di_rtnr_c_k_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_C_TH0_TH3_reg,im_di_rtnr_c_th0_th3_reg.regValue);
		scaler_rtd_outl(DI_IM_DI_RTNR_C_TH4_TH6_reg,im_di_rtnr_c_th4_th6_reg.regValue);
	}


}

#ifdef ISR_OLD_RTNR_ENABLE

void drvif_color_rtnr_y_k(unsigned char channel, unsigned int Y_K0_K7, unsigned int Y_K8_K15)
{
//write register

	if(channel == _CHANNEL1)
	{
		scaler_rtd_maskl( DI_IM_DI_RTNR_Y_16_K0_K7_reg, ~(0xffffffff), (unsigned int)(Y_K0_K7));
		scaler_rtd_maskl( DI_IM_DI_RTNR_Y_16_K8_K15_reg, ~(0xffffffff), (unsigned int)(Y_K8_K15));

	}

}


void drvif_color_rtnr_c_k(unsigned char channel, unsigned int K_C)
{
//write register
	if(channel == _CHANNEL1)
	{

		scaler_rtd_maskl( DI_IM_DI_RTNR_C_K_reg, ~(0xffffffff), (unsigned int)(K_C));	// nick187 marked @ 20110223

	}

}
#endif
//>>>>>>>>>>>>>>>  old RTNR  end <<<<<<<<<<<<<<<<<<<<<<<<<<<



/*
//>>>>>>>>>>>>>>>  new RTNR start <<<<<<<<<<<<<<<<<<<<<<<<<<<
#ifdef ISR_NEW_RTNR_ENABLE
void fwif_color_new_rtnr_adjust(unsigned char channel, unsigned char RTNR_level)
{
		int i;
		unsigned char *rtnr_2D_kmap=NULL;

		if (channel == _CHANNEL1)
		{
			if(Scaler_InputSrcGetMainChType()==_SRC_HDMI || Scaler_InputSrcGetMainChType()==_SRC_COMPONENT || Scaler_InputSrcGetMainChType()==_SRC_YPBPR)
			{
				switch (RTNR_level)
				{
					case 0:
						rtnr_2D_kmap = &New_RTNR_Coef_1[0][0];
						break;
					case 1:
						rtnr_2D_kmap = &TV_AutoNr_RTNR_Coef_A[0][0];
						break;
					case 2:
					case 3:
					case 4:
					case 5:
					case 6:
					case 7:
					case 8:
						rtnr_2D_kmap = &TV_AutoNr_RTNR_Coef_B[0][0];
				    	break;
					case 9:
							//rtnr_2D_kmap = &TV_AutoNr_RTNR_Coef_C[0][0];
							//break;
					case 10:
							//rtnr_2D_kmap = &TV_AutoNr_RTNR_Coef_D[0][0];
							//break;
					default://default off
						rtnr_2D_kmap = &TV_AutoNr_RTNR_Coef_A[0][0];
					break;
				}
			}
			else if(Scaler_InputSrcGetMainChType()==_SRC_CVBS)
			{

				switch (RTNR_level)
				{
					case 0:
						rtnr_2D_kmap = &CVBS_AutoNr_RTNR_Coef_A[0][0];
						break;
					case 1:
					case 2:
					case 3:
					case 4:
					case 5:
					case 6:
						rtnr_2D_kmap = &CVBS_AutoNr_RTNR_Coef_B[0][0];
						break;
					break;
					case 7:
						rtnr_2D_kmap = &CVBS_AutoNr_RTNR_Coef_C[0][0];
						break;
					case 8:
						//	rtnr_2D_kmap = &CVBS_AutoNr_RTNR_Coef_C[0][0];
			    		//	break;
					case 9:
						//	rtnr_2D_kmap = &CVBS_AutoNr_RTNR_Coef_C[0][0];
						//	break;
					case 10:
						//	rtnr_2D_kmap = &CVBS_AutoNr_RTNR_Coef_D[0][0];
						//	break;
					default://default off
						rtnr_2D_kmap = &CVBS_AutoNr_RTNR_Coef_B[0][0];
					break;
				}

			}
		}

	if(rtnr_2D_kmap!=NULL)
	{
		for(i=0;i<8;i++)
		{
			drvif_color_newrtnr_rtnr_k(i,&rtnr_2D_kmap[i*8]);
		}
	}


}

void drvif_color_newrtnr_rtnr_k(unsigned char row_select, unsigned char *th)
{

	di_im_di_rtnr_new_k_00_RBUS rtnr_new_k_00;
	di_im_di_rtnr_new_k_10_RBUS rtnr_new_k_10;
	di_im_di_rtnr_new_k_20_RBUS rtnr_new_k_20;
	di_im_di_rtnr_new_k_30_RBUS rtnr_new_k_30;
	di_im_di_rtnr_new_k_40_RBUS rtnr_new_k_40;
	di_im_di_rtnr_new_k_50_RBUS rtnr_new_k_50;
	di_im_di_rtnr_new_k_60_RBUS rtnr_new_k_60;
	di_im_di_rtnr_new_k_70_RBUS rtnr_new_k_70;

	switch (row_select)
	{
	case 0:


		rtnr_new_k_00.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_K_00_reg);

		rtnr_new_k_00.rtnr_k_00 = th[0];
		rtnr_new_k_00.rtnr_k_01 = th[1];
		rtnr_new_k_00.rtnr_k_02 = th[2];
		rtnr_new_k_00.rtnr_k_03 = th[3];
		rtnr_new_k_00.rtnr_k_04 = th[4];
		rtnr_new_k_00.rtnr_k_05 = th[5];
		rtnr_new_k_00.rtnr_k_06 = th[6];
		rtnr_new_k_00.rtnr_k_07 = th[7];

		//for(int i=1;i<8;i++)
		//printf("k_th0[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_K_00_reg, rtnr_new_k_00.regValue);
		break;

	case 1:


		rtnr_new_k_10.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_K_10_reg);

		rtnr_new_k_10.rtnr_k_10 = th[0];
		rtnr_new_k_10.rtnr_k_11 = th[1];
		rtnr_new_k_10.rtnr_k_12 = th[2];
		rtnr_new_k_10.rtnr_k_13 = th[3];
		rtnr_new_k_10.rtnr_k_14 = th[4];
		rtnr_new_k_10.rtnr_k_15 = th[5];
		rtnr_new_k_10.rtnr_k_16 = th[6];
		rtnr_new_k_10.rtnr_k_17 = th[7];

		//for(int i=1;i<8;i++)
		//printf("k_th1[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_K_10_reg, rtnr_new_k_10.regValue);
		break;

	case 2:


		rtnr_new_k_20.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_K_20_reg);

		rtnr_new_k_20.rtnr_k_20 = th[0];
		rtnr_new_k_20.rtnr_k_21 = th[1];
		rtnr_new_k_20.rtnr_k_22 = th[2];
		rtnr_new_k_20.rtnr_k_23 = th[3];
		rtnr_new_k_20.rtnr_k_24 = th[4];
		rtnr_new_k_20.rtnr_k_25 = th[5];
		rtnr_new_k_20.rtnr_k_26 = th[6];
		rtnr_new_k_20.rtnr_k_27 = th[7];

		//for(int i=1;i<8;i++)
		//printf("k_th2[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_K_20_reg, rtnr_new_k_20.regValue);
		break;

	case 3:


		rtnr_new_k_30.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_K_30_reg);

		rtnr_new_k_30.rtnr_k_30 = th[0];
		rtnr_new_k_30.rtnr_k_31 = th[1];
		rtnr_new_k_30.rtnr_k_32 = th[2];
		rtnr_new_k_30.rtnr_k_33 = th[3];
		rtnr_new_k_30.rtnr_k_34 = th[4];
		rtnr_new_k_30.rtnr_k_35 = th[5];
		rtnr_new_k_30.rtnr_k_36 = th[6];
		rtnr_new_k_30.rtnr_k_37 = th[7];

		//for(int i=1;i<8;i++)
		//printf("k_th3[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_K_30_reg, rtnr_new_k_30.regValue);
		break;

	case 4:

		rtnr_new_k_40.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_K_40_reg);

		rtnr_new_k_40.rtnr_k_40 = th[0];
		rtnr_new_k_40.rtnr_k_41 = th[1];
		rtnr_new_k_40.rtnr_k_42 = th[2];
		rtnr_new_k_40.rtnr_k_43 = th[3];
		rtnr_new_k_40.rtnr_k_44 = th[4];
		rtnr_new_k_40.rtnr_k_45 = th[5];
		rtnr_new_k_40.rtnr_k_46 = th[6];
		rtnr_new_k_40.rtnr_k_47 = th[7];

		//for(int i=1;i<8;i++)
		//printf("k_th4[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_K_40_reg, rtnr_new_k_40.regValue);
		break;

	case 5:


		rtnr_new_k_50.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_K_50_reg);

		rtnr_new_k_50.rtnr_k_50 =th[0];
		rtnr_new_k_50.rtnr_k_51 =th[1];
		rtnr_new_k_50.rtnr_k_52 =th[2];
		rtnr_new_k_50.rtnr_k_53 =th[3];
		rtnr_new_k_50.rtnr_k_54 =th[4];
		rtnr_new_k_50.rtnr_k_55 =th[5];
		rtnr_new_k_50.rtnr_k_56 =th[6];
		rtnr_new_k_50.rtnr_k_57 =th[7];

		//for(int i=1;i<8;i++)
		//printf("k_th5[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_K_50_reg, rtnr_new_k_50.regValue);
		break;

	case 6:


		rtnr_new_k_60.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_K_60_reg);

		rtnr_new_k_60.rtnr_k_60 =th[0];
		rtnr_new_k_60.rtnr_k_61 =th[1];
		rtnr_new_k_60.rtnr_k_62 =th[2];
		rtnr_new_k_60.rtnr_k_63 =th[3];
		rtnr_new_k_60.rtnr_k_64 =th[4];
		rtnr_new_k_60.rtnr_k_65 =th[5];
		rtnr_new_k_60.rtnr_k_66 =th[6];
		rtnr_new_k_60.rtnr_k_67 =th[7];

		//for(int i=1;i<8;i++)
		//printf("k_th6[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_K_60_reg, rtnr_new_k_60.regValue);
		break;

	case 7:


		rtnr_new_k_70.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_K_70_reg);

		rtnr_new_k_70.rtnr_k_70 = th[0];
		rtnr_new_k_70.rtnr_k_71 = th[1];
		rtnr_new_k_70.rtnr_k_72 = th[2];
		rtnr_new_k_70.rtnr_k_73 = th[3];
		rtnr_new_k_70.rtnr_k_74 = th[4];
		rtnr_new_k_70.rtnr_k_75 = th[5];
		rtnr_new_k_70.rtnr_k_76 = th[6];
		rtnr_new_k_70.rtnr_k_77 = th[7];

		//for(int i=1;i<8;i++)
		//printf("k_th7[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_K_70_reg, rtnr_new_k_70.regValue);
		break;

	default:
		break;
	}

}

void drvif_color_newrtnr_sad_th(unsigned char edge, unsigned char *th)
{
	if (edge)
	{
		di_im_di_rtnr_new_sad_edge_th_1_RBUS rtnr_new_sad_edge_th_1;
		di_im_di_rtnr_new_sad_edge_th_2_RBUS rtnr_new_sad_edge_th_2;

		rtnr_new_sad_edge_th_1.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SAD_EDGE_TH_1_reg);
		rtnr_new_sad_edge_th_2.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SAD_EDGE_TH_2_reg);

		rtnr_new_sad_edge_th_1.rtnr_calculate_motion_sad_edge_th1 = th[0];
		rtnr_new_sad_edge_th_1.rtnr_calculate_motion_sad_edge_th2 = th[1];
		rtnr_new_sad_edge_th_1.rtnr_calculate_motion_sad_edge_th3 = th[2];
		rtnr_new_sad_edge_th_1.rtnr_calculate_motion_sad_edge_th4 = th[3];
		rtnr_new_sad_edge_th_2.rtnr_calculate_motion_sad_edge_th5 = th[4];
		rtnr_new_sad_edge_th_2.rtnr_calculate_motion_sad_edge_th6 = th[5];
		rtnr_new_sad_edge_th_2.rtnr_calculate_motion_sad_edge_th7 = th[6];

		//for(int i=1;i<7;i++)
		//printf("sad_edge_th[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_SAD_EDGE_TH_1_reg, rtnr_new_sad_edge_th_1.regValue);
		rtd_outl(DI_IM_DI_RTNR_NEW_SAD_EDGE_TH_2_reg, rtnr_new_sad_edge_th_2.regValue);
	}
	else
	{
		di_im_di_rtnr_new_sad_nonedge_th_1_RBUS rtnr_new_sad_nonedge_th_1;
		di_im_di_rtnr_new_sad_nonedge_th_2_RBUS rtnr_new_sad_nonedge_th_2;

		rtnr_new_sad_nonedge_th_1.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SAD_NONEDGE_TH_1_reg);
		rtnr_new_sad_nonedge_th_2.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SAD_NONEDGE_TH_2_reg);

		rtnr_new_sad_nonedge_th_1.rtnr_calculate_motion_sad_nonedge_th1 = th[0];
		rtnr_new_sad_nonedge_th_1.rtnr_calculate_motion_sad_nonedge_th2 = th[1];
		rtnr_new_sad_nonedge_th_1.rtnr_calculate_motion_sad_nonedge_th3 = th[2];
		rtnr_new_sad_nonedge_th_1.rtnr_calculate_motion_sad_nonedge_th4 = th[3];
		rtnr_new_sad_nonedge_th_2.rtnr_calculate_motion_sad_nonedge_th5 = th[4];
		rtnr_new_sad_nonedge_th_2.rtnr_calculate_motion_sad_nonedge_th6 = th[5];
		rtnr_new_sad_nonedge_th_2.rtnr_calculate_motion_sad_nonedge_th7 = th[6];

		//for(int i=1;i<7;i++)
		//printf("sad_noedge_th[%d]=%x\n",i,th[i]);

		rtd_outl(DI_IM_DI_RTNR_NEW_SAD_NONEDGE_TH_1_reg, rtnr_new_sad_nonedge_th_1.regValue);
		rtd_outl(DI_IM_DI_RTNR_NEW_SAD_NONEDGE_TH_2_reg, rtnr_new_sad_nonedge_th_2.regValue);
	}
}


void drvif_color_newrtnr_sta_th(unsigned char *th)
{
	di_im_di_rtnr_new_sad_count_th_RBUS rtnr_new_sad_count_th;
	di_im_di_rtnr_new_sad_nonedge_th_2_RBUS rtnr_new_sad_nonedge_th_2;
	rtnr_new_sad_count_th.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SAD_COUNT_TH_reg);
	rtnr_new_sad_nonedge_th_2.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SAD_NONEDGE_TH_2_reg);

	rtnr_new_sad_count_th.rtnr_statistic_motion_count_th1 = th[0];
	rtnr_new_sad_count_th.rtnr_statistic_motion_count_th2 = th[1];
	rtnr_new_sad_count_th.rtnr_statistic_motion_count_th3 = th[2];
	rtnr_new_sad_count_th.rtnr_statistic_motion_count_th4 = th[3];
	rtnr_new_sad_count_th.rtnr_statistic_motion_count_th5 = th[4];
	rtnr_new_sad_count_th.rtnr_statistic_motion_count_th6 = th[5];
//	rtnr_new_sad_count_th.rtnr_statistic_motion_count_th7 = th[6];
#if 0	//20150706 roger mark for compiler error
	rtnr_new_sad_nonedge_th_2.rtnr_statistic_motion_count_th7 = th[6];
#endif
	//for(int i=1;i<7;i++)
		//printf("sad_sta_th[%d]=%x\n",i,th[i]);

	rtd_outl(DI_IM_DI_RTNR_NEW_SAD_COUNT_TH_reg, rtnr_new_sad_count_th.regValue);
	rtd_outl(DI_IM_DI_RTNR_NEW_SAD_NONEDGE_TH_2_reg, rtnr_new_sad_nonedge_th_2.regValue);
}

void drvif_color_newrtnr_edgetypediff_th(unsigned char *th)
{
	di_im_di_rtnr_new_edgetypediff_th_1_RBUS rtnr_new_edgetypediff_th_1;
	di_im_di_rtnr_new_edgetypediff_th_2_RBUS rtnr_new_edgetypediff_th_2;

	rtnr_new_edgetypediff_th_1.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_EDGETYPEDIFF_TH_1_reg);
	rtnr_new_edgetypediff_th_2.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_EDGETYPEDIFF_TH_2_reg);

	rtnr_new_edgetypediff_th_1.rtnr_edgetypediff_count_th1 = th[0];
	rtnr_new_edgetypediff_th_1.rtnr_edgetypediff_count_th2 = th[1];
	rtnr_new_edgetypediff_th_1.rtnr_edgetypediff_count_th3 = th[2];
	rtnr_new_edgetypediff_th_1.rtnr_edgetypediff_count_th4 = th[3];
	rtnr_new_edgetypediff_th_2.rtnr_edgetypediff_count_th5 = th[4];
	rtnr_new_edgetypediff_th_2.rtnr_edgetypediff_count_th6 = th[5];
	rtnr_new_edgetypediff_th_2.rtnr_edgetypediff_count_th7 = th[6];

	//for(int i=1;i<7;i++)
		//printf("sad_dgetype_th[%d]=%x\n",i,th[i]);

	rtd_outl(DI_IM_DI_RTNR_NEW_EDGETYPEDIFF_TH_1_reg, rtnr_new_edgetypediff_th_1.regValue);
	rtd_outl(DI_IM_DI_RTNR_NEW_EDGETYPEDIFF_TH_2_reg, rtnr_new_edgetypediff_th_2.regValue);

}

void drvif_color_newrtnr_snr_edge_th(unsigned int *th)
{
//Elsie 20140724: Old RTNR SNR has been removed
#if 0
	di_im_di_rtnr_new_snr_th_1_RBUS rtnr_new_snr_th_1;
	di_im_di_rtnr_new_snr_th2_RBUS rtnr_new_snr_th_2;
	rtnr_new_snr_th_1.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SNR_TH_1_reg);
	rtnr_new_snr_th_2.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SNR_TH2_reg);
	rtnr_new_snr_th_1.rtnr_snr_edgestatus_th1 = th[0];
	rtnr_new_snr_th_1.rtnr_snr_edgestatus_th2 = th[1];
	rtnr_new_snr_th_1.rtnr_snr_edgestatus_th3 = th[2];
	rtnr_new_snr_th_1.rtnr_snr_edgestatus_th4 = th[3];
	rtnr_new_snr_th_2.rtnr_snr_edgestatus_th5 = th[4];
	rtnr_new_snr_th_2.rtnr_snr_edgestatus_th6 = th[5];
	rtnr_new_snr_th_2.rtnr_snr_edgestatus_th7 = th[6];

	rtd_outl(DI_IM_DI_RTNR_NEW_SNR_TH_1_reg, rtnr_new_snr_th_1.regValue);
 	rtd_outl(DI_IM_DI_RTNR_NEW_SNR_TH2_reg, rtnr_new_snr_th_2.regValue);
#endif
}
#endif

//>>>>>>>>>>>>>>>  new RTNR end <<<<<<<<<<<<<<<<<<<<<<<<<<<
*/

#ifdef ISR_AMBILIGHT_ENABLE
unsigned char drvif_color_dragon_profile_dectector_ambilight(unsigned char display, unsigned short *H_ambBlock, unsigned short *V_ambBlock, unsigned short *Profile_transition_sum, unsigned char hx_offset, unsigned char vy_offset, unsigned char Color_sel)
{
//This function will return profile data
//in Profile block, input is always 8 bit(truncated from 10 bit)
//	scalerDrvPrint("=================================  Start of Colobar_dectector =================================\n");
	unsigned int h_tmp, v_tmp;
	//unsigned short Active_Region[4];
	unsigned short IphActWid_H=0,IpvActLen_V=0;
	static unsigned char ini_flag = 1;
	static unsigned char color_set = 0;
	unsigned char ret, color, i;
	unsigned char h_shift_num=0, v_shift_num=0;
	unsigned char block_num = 4; //16 block in profile
	unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);
	vgip_vgip_chn1_act_hsta_width_RBUS vgip_chn1_act_hsta_width_reg;
	vgip_vgip_chn1_act_vsta_length_RBUS vgip_chn1_act_vsta_length_reg;
	#if AMBI_PROFILE_DETECT_DEBUG_TPV
	static unsigned char profile_dectector_count = 0;
	profile_dectector_count++;
	if((profile_dectector_count % 300) == 0)
	ROSPrintf("\n===1\n");
	#endif

	vgip_chn1_act_hsta_width_reg.regValue  = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg);
	vgip_chn1_act_vsta_length_reg.regValue = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_VSTA_Length_reg);
	// color select, 0=y, 1=u, 2=v, 3=y, then u, then v.
	if(Color_sel<3)
		color = Color_sel;
	else
		color = color_set;

	profile_ich1_hist_profile_ctrl_RBUS	hist_profile_ctrl_reg;
	profile_ich1_hist_profile_size_RBUS hist_profile_size_reg;
	profile_ich1_hist_profile_starth_RBUS hist_profile_starth_reg;
	profile_ich1_hist_profile_startv_RBUS hist_profile_startv_reg;

	profile_ich1_hist_profile_data_00_RBUS hist_profile_data_00_reg;
	profile_ich1_hist_profile_data_01_RBUS hist_profile_data_01_reg;
	profile_ich1_hist_profile_data_02_RBUS hist_profile_data_02_reg;
	profile_ich1_hist_profile_data_03_RBUS hist_profile_data_03_reg;
	profile_ich1_hist_profile_data_04_RBUS hist_profile_data_04_reg;
	profile_ich1_hist_profile_data_05_RBUS hist_profile_data_05_reg;
	profile_ich1_hist_profile_data_06_RBUS hist_profile_data_06_reg;
	profile_ich1_hist_profile_data_07_RBUS hist_profile_data_07_reg;
	profile_ich1_hist_profile_data_08_RBUS hist_profile_data_08_reg;
	profile_ich1_hist_profile_data_09_RBUS hist_profile_data_09_reg;
	profile_ich1_hist_profile_data_10_RBUS hist_profile_data_10_reg;
	profile_ich1_hist_profile_data_11_RBUS hist_profile_data_11_reg;
	profile_ich1_hist_profile_data_12_RBUS hist_profile_data_12_reg;
	profile_ich1_hist_profile_data_13_RBUS hist_profile_data_13_reg;
	profile_ich1_hist_profile_data_14_RBUS hist_profile_data_14_reg;
	profile_ich1_hist_profile_data_15_RBUS hist_profile_data_15_reg;

	profile_ich1_hist_profile_data_16_RBUS hist_profile_data_16_reg;
	profile_ich1_hist_profile_data_17_RBUS hist_profile_data_17_reg;
	profile_ich1_hist_profile_data_18_RBUS hist_profile_data_18_reg;
	profile_ich1_hist_profile_data_19_RBUS hist_profile_data_19_reg;
	profile_ich1_hist_profile_data_20_RBUS hist_profile_data_20_reg;
	profile_ich1_hist_profile_data_21_RBUS hist_profile_data_21_reg;
	profile_ich1_hist_profile_data_22_RBUS hist_profile_data_22_reg;
	profile_ich1_hist_profile_data_23_RBUS hist_profile_data_23_reg;



	hist_profile_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_CTRL_reg);
	hist_profile_size_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_size_reg);
	hist_profile_starth_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_StartH_reg);
	hist_profile_startv_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_StartV_reg);

	//drvif_color_activeregion_dragon(display, &Active_Region[0]);
	IphActWid_H=(SmartPic_clue->SCALER_DISP_INFO.IphActWid_H);
	IpvActLen_V=(SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V);
//	scalerDrvPrint("Active_Region[0]=%d\n",Active_Region[0]);
//	scalerDrvPrint("Active_Region[1]=%d\n",Active_Region[1]);
//	scalerDrvPrint("Active_Region[2]=%d\n",Active_Region[2]);
//	scalerDrvPrint("Active_Region[3]=%d\n",Active_Region[3]);

	//Set block size
    switch(SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x2;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x1;
			h_shift_num = 9;
			v_shift_num = 10;
			#if AMBI_PROFILE_DETECT_DEBUG_TPV
			if((profile_dectector_count % 300) == 0)
			ROSPrintf("\n===1.1\n");
			#endif
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x2;
			h_shift_num = 10;
			v_shift_num = 11;
			#if AMBI_PROFILE_DETECT_DEBUG_TPV
			if((profile_dectector_count % 300) == 0)
			ROSPrintf("\n===1.2\n");
			#endif
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x3;
			h_shift_num = 10;
			v_shift_num = 12;
			#if AMBI_PROFILE_DETECT_DEBUG_TPV
			if((profile_dectector_count % 300) == 0)
			ROSPrintf("\n===1.3\n");
			#endif
			break;
		default:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x2;
			h_shift_num = 10;
			v_shift_num = 11;
			#if AMBI_PROFILE_DETECT_DEBUG_TPV
			if((profile_dectector_count % 300) == 0)
			ROSPrintf("\n===1.4\n");
			#endif
			break;
	}
	#if AMBI_PROFILE_DETECT_DEBUG_TPV
	if((profile_dectector_count % 300) == 0)
	ROSPrintf("\n====2=  h_shift=%d,v_shift= %d\n"  ,h_shift_num,v_shift_num);
	#endif
	hist_profile_size_reg.ch1_pf_hsize = (IphActWid_H>>block_num) - ((2*hx_offset)>>block_num) - 1;//according to spec., size should be minus 1
	hist_profile_size_reg.ch1_pf_vsize = (IpvActLen_V>>block_num) - ((2*vy_offset)>>block_num) - 1;//according to spec., size should be minus 1
	//Set Start Position
	hist_profile_starth_reg.ch1_pf_starth = hx_offset;
	hist_profile_startv_reg.ch1_pf_startv = vy_offset;
	#if AMBI_PROFILE_DETECT_DEBUG_TPV
	if((profile_dectector_count % 300) == 0)
	ROSPrintf("\n====2.1=  hsize=%d ,vsize=%d\n"  ,hist_profile_size_reg.ch1_pf_hsize,hist_profile_size_reg.ch1_pf_vsize);
	#endif
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_size_reg, hist_profile_size_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_StartH_reg, hist_profile_starth_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_StartV_reg, hist_profile_startv_reg.regValue);


	if(ini_flag)
	{
		//enable profile
		hist_profile_ctrl_reg.ch1_pf_field_sel = 0x2;//next field
		hist_profile_ctrl_reg.ch1_pf_enable_profile = 0x1;
		ini_flag = 0;
	}


	// add for truncate HNSR & VNSR value before read his_profile, csfanchiang 20100908
	hist_profile_ctrl_reg.ch1_pf_yuv_sel = color;
	scaler_rtd_outl(PROFILE_ICH1_HIST_PROFILE_CTRL_reg, hist_profile_ctrl_reg.regValue);


	hist_profile_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_CTRL_reg);
	#if AMBI_PROFILE_DETECT_DEBUG_TPV
	if((profile_dectector_count % 60) == 0)
	ROSPrintf("\n===3====  IphActWid_H=%d ,IpvActLen_V=%d \n",IphActWid_H,IpvActLen_V);
	#endif
	if(hist_profile_ctrl_reg.ch1_pf_enable_profile==0)//wait for finish flag
	{
		hist_profile_data_00_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_00_reg);
		hist_profile_data_01_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_01_reg);
		hist_profile_data_02_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_02_reg);
		hist_profile_data_03_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_03_reg);
		hist_profile_data_04_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_04_reg);
		hist_profile_data_05_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_05_reg);
		hist_profile_data_06_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_06_reg);
		hist_profile_data_07_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_07_reg);
		hist_profile_data_08_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_08_reg);
		hist_profile_data_09_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_09_reg);
		hist_profile_data_10_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_10_reg);
		hist_profile_data_11_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_11_reg);
		hist_profile_data_12_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_12_reg);
		hist_profile_data_13_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_13_reg);
		hist_profile_data_14_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_14_reg);
		hist_profile_data_15_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_15_reg);

		hist_profile_data_16_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_16_reg);
		hist_profile_data_17_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_17_reg);
		hist_profile_data_18_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_18_reg);
		hist_profile_data_19_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_19_reg);
		hist_profile_data_20_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_20_reg);
		hist_profile_data_21_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_21_reg);
		hist_profile_data_22_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_22_reg);
		hist_profile_data_23_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_Data_23_reg);

		H_ambBlock[0]   = hist_profile_data_00_reg.ch1_pf_h00;
		H_ambBlock[1]   = hist_profile_data_00_reg.ch1_pf_h01;
		H_ambBlock[2]   = hist_profile_data_01_reg.ch1_pf_h02;
		H_ambBlock[3]   = hist_profile_data_01_reg.ch1_pf_h03;
		H_ambBlock[4]   = hist_profile_data_02_reg.ch1_pf_h04;
		H_ambBlock[5]   = hist_profile_data_02_reg.ch1_pf_h05;
		H_ambBlock[6]   = hist_profile_data_03_reg.ch1_pf_h06;
		H_ambBlock[7]   = hist_profile_data_03_reg.ch1_pf_h07;
		H_ambBlock[8]   = hist_profile_data_04_reg.ch1_pf_h08;
		H_ambBlock[9]   = hist_profile_data_04_reg.ch1_pf_h09;
		H_ambBlock[10] = hist_profile_data_05_reg.ch1_pf_h10;
		H_ambBlock[11] = hist_profile_data_05_reg.ch1_pf_h11;
		H_ambBlock[12] = hist_profile_data_06_reg.ch1_pf_h12;
		H_ambBlock[13] = hist_profile_data_06_reg.ch1_pf_h13;
		H_ambBlock[14] = hist_profile_data_07_reg.ch1_pf_h14;
		H_ambBlock[15] = hist_profile_data_07_reg.ch1_pf_h15;

		V_ambBlock[0]   = hist_profile_data_08_reg.ch1_pf_v00;
		V_ambBlock[1]   = hist_profile_data_08_reg.ch1_pf_v01;
		V_ambBlock[2]   = hist_profile_data_09_reg.ch1_pf_v02;
		V_ambBlock[3]   = hist_profile_data_09_reg.ch1_pf_v03;
		V_ambBlock[4]   = hist_profile_data_10_reg.ch1_pf_v04;
		V_ambBlock[5]   = hist_profile_data_10_reg.ch1_pf_v05;
		V_ambBlock[6]   = hist_profile_data_11_reg.ch1_pf_v06;
		V_ambBlock[7]   = hist_profile_data_11_reg.ch1_pf_v07;
		V_ambBlock[8]   = hist_profile_data_12_reg.ch1_pf_v08;
		V_ambBlock[9]   = hist_profile_data_12_reg.ch1_pf_v09;
		V_ambBlock[10] = hist_profile_data_13_reg.ch1_pf_v10;
		V_ambBlock[11] = hist_profile_data_13_reg.ch1_pf_v11;
		V_ambBlock[12] = hist_profile_data_14_reg.ch1_pf_v12;
		V_ambBlock[13] = hist_profile_data_14_reg.ch1_pf_v13;
		V_ambBlock[14] = hist_profile_data_15_reg.ch1_pf_v14;
		V_ambBlock[15] = hist_profile_data_15_reg.ch1_pf_v15;

		if(hist_profile_ctrl_reg.ch1_pf_yuv_sel == 0)
		{
		H_Block[0]   = hist_profile_data_00_reg.ch1_pf_h00;
		H_Block[1]   = hist_profile_data_00_reg.ch1_pf_h01;
		H_Block[2]   = hist_profile_data_01_reg.ch1_pf_h02;
		H_Block[3]   = hist_profile_data_01_reg.ch1_pf_h03;
		H_Block[4]   = hist_profile_data_02_reg.ch1_pf_h04;
		H_Block[5]   = hist_profile_data_02_reg.ch1_pf_h05;
		H_Block[6]   = hist_profile_data_03_reg.ch1_pf_h06;
		H_Block[7]   = hist_profile_data_03_reg.ch1_pf_h07;
		H_Block[8]   = hist_profile_data_04_reg.ch1_pf_h08;
		H_Block[9]   = hist_profile_data_04_reg.ch1_pf_h09;
		H_Block[10] = hist_profile_data_05_reg.ch1_pf_h10;
		H_Block[11] = hist_profile_data_05_reg.ch1_pf_h11;
		H_Block[12] = hist_profile_data_06_reg.ch1_pf_h12;
		H_Block[13] = hist_profile_data_06_reg.ch1_pf_h13;
		H_Block[14] = hist_profile_data_07_reg.ch1_pf_h14;
		H_Block[15] = hist_profile_data_07_reg.ch1_pf_h15;

		V_Block[0]   = hist_profile_data_08_reg.ch1_pf_v00;
		V_Block[1]   = hist_profile_data_08_reg.ch1_pf_v01;
		V_Block[2]   = hist_profile_data_09_reg.ch1_pf_v02;
		V_Block[3]   = hist_profile_data_09_reg.ch1_pf_v03;
		V_Block[4]   = hist_profile_data_10_reg.ch1_pf_v04;
		V_Block[5]   = hist_profile_data_10_reg.ch1_pf_v05;
		V_Block[6]   = hist_profile_data_11_reg.ch1_pf_v06;
		V_Block[7]   = hist_profile_data_11_reg.ch1_pf_v07;
		V_Block[8]   = hist_profile_data_12_reg.ch1_pf_v08;
		V_Block[9]   = hist_profile_data_12_reg.ch1_pf_v09;
		V_Block[10] = hist_profile_data_13_reg.ch1_pf_v10;
		V_Block[11] = hist_profile_data_13_reg.ch1_pf_v11;
		V_Block[12] = hist_profile_data_14_reg.ch1_pf_v12;
		V_Block[13] = hist_profile_data_14_reg.ch1_pf_v13;
		V_Block[14] = hist_profile_data_15_reg.ch1_pf_v14;
		V_Block[15] = hist_profile_data_15_reg.ch1_pf_v15;
		}


		#if AMBI_PROFILE_DETECT_DEBUG_TPV
		if((profile_dectector_count % 60) == 0)
		ROSPrintf("\n===4\n");
		#endif
		// caculate average,
		for(i=0;i<16;i++)
		{
			h_tmp = H_ambBlock[i];
			v_tmp = V_ambBlock[i];
			#if AMBI_PROFILE_DETECT_DEBUG_TPV
			if((profile_dectector_count % 60) == 0)
		        ROSPrintf("\n== yuv_sel = %d , H_Block[%d] = %d , V_Block[%d] = %d \n",color,i,H_ambBlock[i],i,V_ambBlock[i]);
			#endif
			if(((hist_profile_size_reg.ch1_pf_vsize+1)*(IphActWid_H-(2*hx_offset))) == 0)
				H_ambBlock[i] = 0;
			else
				H_ambBlock[i] = (unsigned short)((h_tmp<<h_shift_num) / ((hist_profile_size_reg.ch1_pf_vsize+1)*(IphActWid_H-(2*hx_offset))))<<2;//left shift 2 for 8 bit to 10bit
			if(((hist_profile_size_reg.ch1_pf_hsize+1)*(IpvActLen_V-(2*vy_offset))) == 0)
				V_ambBlock[i] = 0;
			else
				V_ambBlock[i] = (unsigned short)((v_tmp<<v_shift_num) / ((hist_profile_size_reg.ch1_pf_hsize+1)*(IpvActLen_V-(2*vy_offset))))<<2;

			#if AMBI_PROFILE_DETECT_DEBUG_TPV
			if((profile_dectector_count % 60) == 0)
		        ROSPrintf("\n== H_Block[%d] = %d , V_Block[%d] = %d \n",i,H_ambBlock[i],i,V_ambBlock[i]);
			#endif
		}
	#if AMBI_PROFILE_DETECT_DEBUG_TPV
	if((profile_dectector_count % 60) == 0)
	ROSPrintf("\n===5\n");
	#endif
		/*
		*Profile_transition_sum    = hist_profile_data_16_reg.ch1_pf_h00_right;
		*Profile_transition_sum  += hist_profile_data_16_reg.ch1_pf_h01_right;
		*Profile_transition_sum  += hist_profile_data_17_reg.ch1_pf_h02_right;
		*Profile_transition_sum  += hist_profile_data_17_reg.ch1_pf_h03_right;
		*Profile_transition_sum  += hist_profile_data_18_reg.ch1_pf_h04_right;
		*Profile_transition_sum  += hist_profile_data_18_reg.ch1_pf_h05_right;
		*Profile_transition_sum  += hist_profile_data_19_reg.ch1_pf_h06_right;
		*Profile_transition_sum  += hist_profile_data_19_reg.ch1_pf_h07_right;
		*Profile_transition_sum  += hist_profile_data_20_reg.ch1_pf_h08_right;
		*Profile_transition_sum  += hist_profile_data_20_reg.ch1_pf_h09_right;
		*Profile_transition_sum  += hist_profile_data_21_reg.ch1_pf_h10_right;
		*Profile_transition_sum  += hist_profile_data_21_reg.ch1_pf_h11_right;
		*Profile_transition_sum  += hist_profile_data_22_reg.ch1_pf_h12_right;
		*Profile_transition_sum  += hist_profile_data_22_reg.ch1_pf_h13_right;
		*Profile_transition_sum  += hist_profile_data_23_reg.ch1_pf_h14_right;
		*Profile_transition_sum  += hist_profile_data_23_reg.ch1_pf_h15_right;
		*/
		//enable profile
		hist_profile_ctrl_reg.ch1_pf_field_sel = 0x2;//next field
//		hist_profile_ctrl_reg.profile_ch_sel = 0x0;//ch1
		hist_profile_ctrl_reg.ch1_pf_enable_profile = 0x1;

		ret = color;
		// if Color_sel == 3, get yuv data, elieli 20130131
		if(Color_sel>=3)
			color = (color>=2)? 0:color+1;

		color_set = color;
		hist_profile_ctrl_reg.ch1_pf_yuv_sel = color;

		scaler_rtd_outl(PROFILE_ICH1_HIST_PROFILE_CTRL_reg, hist_profile_ctrl_reg.regValue);
	}
	else
	{
		ret = 3;//there's no new h and v data -> do no detection
	}
	#if AMBI_PROFILE_DETECT_DEBUG_TPV
	if((profile_dectector_count % 60) == 0)
		ROSPrintf("\n === profile_sel =%d,=%d\n",color,hist_profile_ctrl_reg.ch1_pf_enable_profile);
	#endif
	return (ret);

}
#endif

void scaler_Set_VIP_info_structure(unsigned char display,_clues* SmartPic_clue)
{
	//== Get disp info from scaler_disp_info. ==
	SmartPic_clue->SCALER_DISP_INFO.input_src	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_INPUT_SRC);
	SmartPic_clue->SCALER_DISP_INFO.disp_status	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_DISP_STATUS);
	SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_MODE_CURR);
	SmartPic_clue->SCALER_DISP_INFO.display		= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_DISPLAY);
	SmartPic_clue->SCALER_DISP_INFO.DispWid		= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_DISP_WID);
	SmartPic_clue->SCALER_DISP_INFO.DispLen		= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_DISP_LEN);
	SmartPic_clue->SCALER_DISP_INFO.CapWid		= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_CAP_WID);
	SmartPic_clue->SCALER_DISP_INFO.CapLen		= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_CAP_LEN);
	SmartPic_clue->SCALER_DISP_INFO.IpvActSTA_H	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_IPH_ACT_STA);
	SmartPic_clue->SCALER_DISP_INFO.IpvActSTA_V	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_IPV_ACT_STA);
	SmartPic_clue->SCALER_DISP_INFO.IphActWid_H	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_IPH_ACT_WID);
	SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_IPV_ACT_LEN);

	SmartPic_clue->SCALER_DISP_INFO.IphActSTA_Pre	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_IPH_ACT_STA_PRE);//scaler_disp_info[display].IphActSTA_Pre;
	SmartPic_clue->SCALER_DISP_INFO.IpvActSTA_Pre	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_IPV_ACT_STA_PRE);//scaler_disp_info[display].IpvActSTA_Pre;
	SmartPic_clue->SCALER_DISP_INFO.IphActWid_Pre	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_IPH_ACT_WID_PRE);//scaler_disp_info[display].IphActWid_Pre;
	SmartPic_clue->SCALER_DISP_INFO.IpvActLen_Pre	= Scaler_DispGetInputInfoByDisp(display, SLR_INPUT_IPV_ACT_LEN_PRE);//scaler_disp_info[display].IpvActLen_Pre;

	//== set system VGIP H and V DELAY Setting ==
	unsigned int ulTemp=0;
	ulTemp = scaler_rtd_inl(VGIP_VGIP_CHN1_DELAY_reg);
	SmartPic_clue->SCALER_DISP_INFO.HDelay = (unsigned short)ulTemp  & 0x0fff;
	SmartPic_clue->SCALER_DISP_INFO.VDelay = (unsigned short)(ulTemp >> 16) & 0x0fff;

}


unsigned char drvif_color_activeregion_dragon(unsigned char display, unsigned short *Region)
{
	vgip_vgip_chn1_act_hsta_width_RBUS vgip_chn1_act_hsta_width_reg;
	vgip_vgip_chn1_act_vsta_length_RBUS vgip_chn1_act_vsta_length_reg;
	//forster modified 071128
	unsigned int ulTemp;
	unsigned short HDelay;
	unsigned short VDelay;

	vgip_chn1_act_hsta_width_reg.regValue  = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg);
	vgip_chn1_act_vsta_length_reg.regValue = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_VSTA_Length_reg);
	ulTemp = scaler_rtd_inl(VGIP_VGIP_CHN1_DELAY_reg);
	VDelay = (unsigned short)ulTemp  & 0x0fff;
	HDelay = (unsigned short)(ulTemp >> 16) & 0x0fff;

	Region[0] = (vgip_chn1_act_hsta_width_reg.ch1_ih_act_sta);//Active_HStart
	Region[0] += HDelay;
	Region[1] = (vgip_chn1_act_hsta_width_reg.ch1_ih_act_wid);//Active_HWidtht
	Region[2] = (vgip_chn1_act_vsta_length_reg.ch1_iv_act_sta);//Active_VStart
	Region[2] += VDelay;
	Region[3] = (vgip_chn1_act_vsta_length_reg.ch1_iv_act_len);//Active_VLines
/*
	if(MA_print_count%150==0)
	{
		ROSPrintf("Region= %d, %d, %d, %d\n",Region[0],Region[1],Region[2],Region[3]);
		ROSPrintf("ulTemp=%d, VDelay=%d,HDelay=%d\n",ulTemp,VDelay,HDelay);

		ROSPrintf("DispLen=%d,DispWid=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].DispLen,scaler_disp_info[SLR_MAIN_DISPLAY].DispWid);
		ROSPrintf("MEM_ACT_WID=%d, MEM_ACT_LEN=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].MEM_ACT_WID,scaler_disp_info[SLR_MAIN_DISPLAY].MEM_ACT_LEN);
		ROSPrintf("MEM_ACT_HSTA=%d, MEM_ACT_VSTA=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].MEM_ACT_HSTA,scaler_disp_info[SLR_MAIN_DISPLAY].MEM_ACT_VSTA);
		ROSPrintf("CapWid=%d, CapLen=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].CapWid,scaler_disp_info[SLR_MAIN_DISPLAY].CapLen);
		ROSPrintf("disp_status=%x\n",scaler_disp_info[SLR_MAIN_DISPLAY].disp_status);
		ROSPrintf("IphActWid_Pre=%d, IpvActLen_Pre=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].IphActWid_Pre,scaler_disp_info[SLR_MAIN_DISPLAY].IpvActLen_Pre);
		ROSPrintf("IpvActSTA_H=%d, IpvActSTA_V=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].IpvActSTA_H,scaler_disp_info[SLR_MAIN_DISPLAY].IpvActSTA_V);
		ROSPrintf("IphActWid_H=%d, IpvActLen_V=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].IphActWid_H,scaler_disp_info[SLR_MAIN_DISPLAY].IpvActLen_V);
	}
*/
	//20071126 for CSW ypbpr display adjustment
	/*
	#ifndef CONFIG_YPBPR_OPEN_H_V_POSITION // CSW+ for project instead of Xoceco
		Region[0]+=0x32;
	#endif
       */
	return(1);
}

#ifdef ISR_SHARPNESS_BY_MEAN_ENABLE
void scalerVIP_Adjusted_Shp_by_HistMeanValue_HDMI()//for T2 @ HDMI, elieli 20130925
{
	unsigned char y_th[5]={15,20,25,30,40};
	unsigned char reduce_ratio[5]={108,115,128,128,128};//max ratio = 128
	unsigned char y_th0, y_th1, r0, r1;
	unsigned char moving_step = 1;
	unsigned char factor_index, factor;
	unsigned char text_pos_goal, text_neg_goal, edge_pos_goal, edge_neg_goal, ver_pos_goal, ver_neg_goal;
	unsigned char text_pos_cur, text_neg_cur, edge_pos_cur, edge_neg_cur, ver_pos_cur, ver_neg_cur;
	unsigned int DCC_Histogram_Mean_value = 0;

	DCC_Histogram_Mean_value = SmartPic_clue->Hist_Y_Mean_Value;

	color_sharp_dm_peaking_gain_RBUS dm_peaking_gain_reg;
	dm_peaking_gain_reg.regValue = rtd_inl(COLOR_SHARP_DM_PEAKING_GAIN_reg);
	color_sharp_dm_segpk_edgpk3_RBUS dm_segpk_edgpk3;
	dm_segpk_edgpk3.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg);
	color_sharp_dm_segpk_vpk2_RBUS dm_segpk_vpk2;
	dm_segpk_vpk2.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_VPK2_reg);

	if(DCC_Histogram_Mean_value<=y_th[0])
		factor_index = 0;
	else if(DCC_Histogram_Mean_value<=y_th[1])
		factor_index = 1;
	else if(DCC_Histogram_Mean_value<=y_th[2])
		factor_index = 2;
	else if(DCC_Histogram_Mean_value<=y_th[3])
		factor_index = 3;
	else if(DCC_Histogram_Mean_value<=y_th[4])
		factor_index = 4;
	else
		factor_index = 5;

	if(factor_index==0)
		factor = reduce_ratio[0];
	else if(factor_index == 5)
		factor = reduce_ratio[4];
	else
	{
		y_th0 = y_th[factor_index-1];
		y_th1 = y_th[factor_index];
		r0 = reduce_ratio[factor_index-1];
		r1 = reduce_ratio[factor_index];
		if(r1 >= r0)
			factor = (DCC_Histogram_Mean_value - y_th0) * (r1 - r0) / (y_th1 - y_th0) + r0;
		else
			factor =  r0 - (DCC_Histogram_Mean_value - y_th0) * (r0 - r1) / (y_th1 - y_th0);
	}

	text_pos_cur = dm_peaking_gain_reg.gain_pos;
	text_neg_cur = dm_peaking_gain_reg.gain_neg;
	edge_pos_cur = dm_segpk_edgpk3.gain_pos;
	edge_neg_cur = dm_segpk_edgpk3.gain_neg;
	ver_pos_cur = dm_segpk_vpk2.vpk_gain_pos;
	ver_neg_cur = dm_segpk_vpk2.vpk_gain_neg;

	text_pos_goal = (intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_TEXTURE_POS_GAIN] * factor)>>7;//max ratio is 128
	text_neg_goal = (intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_TEXTURE_NEG_GAIN] * factor)>>7;
	edge_pos_goal = (intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_EDGE_POS_GAIN] * factor)>>7;
	edge_neg_goal = (intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_EDGE_NEG_GAIN] * factor)>>7;
	ver_pos_goal = (intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_VERTICAL_POS_GAIN] * factor)>>7;
	ver_neg_goal = (intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_VERTICAL_NEG_GAIN] * factor)>>7;

	if(text_pos_cur>text_pos_goal)
		text_pos_cur = text_pos_cur - moving_step;
	else if(text_pos_cur<text_pos_goal)
		text_pos_cur = text_pos_cur + moving_step;
	else
		text_pos_cur = text_pos_cur;

	if(text_neg_cur>text_neg_goal)
		text_neg_cur = text_neg_cur - moving_step;
	else if(text_neg_cur<text_neg_goal)
		text_neg_cur = text_neg_cur + moving_step;
	else
		text_neg_cur = text_neg_cur;

	if(edge_pos_cur>edge_pos_goal)
		edge_pos_cur = edge_pos_cur - moving_step;
	else if(edge_pos_cur<edge_pos_goal)
		edge_pos_cur = edge_pos_cur + moving_step;
	else
		edge_pos_cur = edge_pos_cur;

	if(edge_neg_cur>edge_neg_goal)
		edge_neg_cur = edge_neg_cur - moving_step;
	else if(edge_neg_cur<edge_neg_goal)
		edge_neg_cur = edge_neg_cur + moving_step;
	else
		edge_neg_cur = edge_neg_cur;

	if(ver_pos_cur>ver_pos_goal)
		ver_pos_cur = ver_pos_cur - moving_step;
	else if(ver_pos_cur<ver_pos_goal)
		ver_pos_cur = ver_pos_cur + moving_step;
	else
		ver_pos_cur = ver_pos_cur;

	if(ver_neg_cur>ver_neg_goal)
		ver_neg_cur = ver_neg_cur - moving_step;
	else if(ver_neg_cur<ver_neg_goal)
		ver_neg_cur = ver_neg_cur + moving_step;
	else
		ver_neg_cur = ver_neg_cur;

	dm_peaking_gain_reg.gain_pos = text_pos_cur;
	dm_peaking_gain_reg.gain_neg = text_neg_cur;
	dm_segpk_edgpk3.gain_pos = edge_pos_cur;
	dm_segpk_edgpk3.gain_neg = edge_neg_cur;
	dm_segpk_vpk2.vpk_gain_pos = ver_pos_cur;
	dm_segpk_vpk2.vpk_gain_neg = ver_neg_cur;

	rtd_outl(COLOR_SHARP_DM_PEAKING_GAIN_reg, dm_peaking_gain_reg.regValue);
	rtd_outl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg, dm_segpk_edgpk3.regValue);
	rtd_outl(COLOR_SHARP_DM_SEGPK_VPK2_reg, dm_segpk_vpk2.regValue);

#if 0
	if(MA_print_count%100==0)
	{
		ROSPrintf("==========%d,%d,%d,%d,%d,%d,============\n",text_pos_goal, text_neg_goal, edge_pos_goal, edge_neg_goal, ver_pos_goal, ver_neg_goal);
		ROSPrintf("==========%d,%d,%d,%d,%d,%d,============\n",text_pos_cur, text_neg_cur, edge_pos_cur, edge_neg_cur, ver_pos_cur, ver_neg_cur);
		ROSPrintf("==========%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,============\n",intelligent_picture_table[0],intelligent_picture_table[1],
			intelligent_picture_table[2],intelligent_picture_table[3],intelligent_picture_table[4],intelligent_picture_table[5],intelligent_picture_table[6],
			intelligent_picture_table[7],intelligent_picture_table[8],intelligent_picture_table[9]);
		ROSPrintf("==========%d,%d,coRatio=%d,%d============\n",DCC_Histogram_Mean_value,factor,factor_index);
	}
#endif
}
#endif


#if 0
void drvif_color_MpegNR_AutoMode_Off(void)
{
	mpegnr_ich1_mpegnr2_RBUS ich1_MPEGNR2_reg;
	nr_dch1_mpegnr1_RBUS dch1_MPEGNR1_Reg;

	ich1_MPEGNR2_reg.regValue = rtd_inl(MPEGNR_ICH1_MPEGNR2_reg);
	dch1_MPEGNR1_Reg.regValue = rtd_inl(NR_DCH1_MPEGNR1_reg);

	ich1_MPEGNR2_reg.cp_mpegenable_x = 0;
	dch1_MPEGNR1_Reg.cp_mpegenable_y_c = 0;
	dch1_MPEGNR1_Reg.cp_mpegenable_y_y = 0;

	rtd_outl(MPEGNR_ICH1_MPEGNR2_reg, ich1_MPEGNR2_reg.regValue);
	rtd_outl(NR_DCH1_MPEGNR1_reg, dch1_MPEGNR1_Reg.regValue);
}
#endif

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
void VIP_SetShareMemAddr(SCALER_RPC_SHARE_MEM *a_ptShareMem)
{
	//reg_HistCnt =(UINT32 *)(a_ptShareMem->ulAddr[HIST_CNT_MEM_IDX]);

	//SmartPic_clue = (_clues *)(a_ptShareMem->ulAddr[SMARTPIC_CLUS_IDX]);

	RPC_SmartPic_clue = (_clues *)(a_ptShareMem->ulAddr[RPC_SMARTPIC_CLUS_IDX]);

	reg_HistCnt_Sub = (UINT32 *)(a_ptShareMem->ulAddr[HIST_CNT_SUB_MEM_IDX]);

	DCR_TABLE = (UINT8 *)(a_ptShareMem->ulAddr[DCR_TABLE_MEM_IDX]);

}
#endif

#ifdef ISR_RTNR_SWITCH_CORRECTION_BIT_FUNCTION_ENABLE
void drvif_color_switch_rtnr_rounding_correction_bit(unsigned char switch_on)
{
	//switch correction_bit for remnant shade.
	di_im_di_rtnr_control_RBUS di_im_di_rtnr_control_RBUS_reg;
	di_im_di_rtnr_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

	if((switch_on ==1)&&(pre_correction_flag==99))
	{
		if((di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction == 0)&&(di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en == 0)){
			pre_correction_flag = 0;
		}
		else if((di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction == 0)&&(di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en == 1)){
			pre_correction_flag = 1;
		}
		else if((di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction == 1)&&(di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en == 0)){
			pre_correction_flag = 2;
		}
		else if((di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction == 1)&&(di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en == 1)){
			pre_correction_flag = 3;
		}
	}

	if(switch_on ==1)
	{
		if(di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction == 1)//correction1 is enable
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 0;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en = 1;
			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
		}
		else if(di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en == 1)//correction2 is enable
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 1;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en = 0;
			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
		}
		else
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 0;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en = 1;
			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
		}
	}
	else{
		if(pre_correction_flag == 0){
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 0;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en = 0;
			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
			pre_correction_flag = 99;
		}
		else if(pre_correction_flag == 1){
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 0;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en = 1;
			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
			pre_correction_flag = 99;
		}
		else if(pre_correction_flag == 2){
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 1;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en = 0;
			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
			pre_correction_flag = 99;
		}
		else if(pre_correction_flag == 3){
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 1;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en = 1;
			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
			pre_correction_flag = 99;
		}
	}
}
#endif


//--------------------------------------------------------------------------------------
// Copy functions from VIP libs for scalerVIP.c , because it can't call lib function in kernel space
// End
//--------------------------------------------------------------------------------------

char scalerVIP_ReadProfile(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile_ctrl_RBUS hist_profile_ctrl_reg;
	profile_ich1_hist_profile_size_RBUS hist_profile_size_reg;
	profile_ich1_hist_profile_starth_RBUS hist_profile_starth_reg;
	profile_ich1_hist_profile_startv_RBUS hist_profile_startv_reg;
	unsigned short IWid, ILen;	//I-domain width & length
	unsigned char Profile_Block_Num = 16;//set profile h&V block number
	unsigned char ii;
	unsigned char profsum_shift=0;

	unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	hist_profile_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_CTRL_reg);
	hist_profile_size_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_size_reg);
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT// can't use scaler_rtd_t_inl in kernel
	IWid = scaler_rtd_t_inl(vgip_vgip_chn1_act_hsta_width_RBUS,VGIP_VGIP_CHN1_ACT_HSTA_Width_reg).ch1_ih_act_wid;	//Active_HWidtht
	ILen = scaler_rtd_t_inl(vgip_vgip_chn1_act_vsta_length_RBUS,VGIP_VGIP_CHN1_ACT_VSTA_Length_reg).ch1_iv_act_len;	//Active_VLines
#else
	vgip_vgip_chn1_act_hsta_width_RBUS vgip_chn1_act_hsta_width_reg;
	vgip_vgip_chn1_act_vsta_length_RBUS vgip_chn1_act_vsta_length_reg;

	vgip_chn1_act_hsta_width_reg.regValue  = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg);
	vgip_chn1_act_vsta_length_reg.regValue = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_VSTA_Length_reg);

	IWid = vgip_chn1_act_hsta_width_reg.ch1_ih_act_wid; //Active_HWidtht
	ILen = vgip_chn1_act_vsta_length_reg.ch1_iv_act_len; //Active_VLines
#endif
	//IWid = scaler_disp_info[_CHANNEL1].DispWid;
	//ILen = scaler_disp_info[_CHANNEL1].DispLen;

	//Set block size
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x2;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x1;
			profsum_shift = 9;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x2;
			profsum_shift = 10;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x3;
			profsum_shift = 10;
			break;
	}

	hist_profile_size_reg.ch1_pf_hsize = (IWid/Profile_Block_Num) -1;//according to spec., size should be minus 1
	//if( isInterlaced )
	if( (SmartPic_clue->SCALER_DISP_INFO.disp_status & _BIT8) != 0) // interlaced
		hist_profile_size_reg.ch1_pf_vsize = (ILen/Profile_Block_Num)*2 -1;//according to spec., size should be minus 1
	else
		hist_profile_size_reg.ch1_pf_vsize = (ILen/Profile_Block_Num) -1;//according to spec., size should be minus 1

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_size_reg, hist_profile_size_reg.regValue);

	//Set Start Position
	hist_profile_starth_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_StartH_reg);
	hist_profile_startv_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_StartV_reg);
	hist_profile_starth_reg.ch1_pf_starth = 0;
	hist_profile_startv_reg.ch1_pf_startv = 0;
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_StartH_reg, hist_profile_starth_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_StartV_reg, hist_profile_startv_reg.regValue);

	if ( hist_profile_ctrl_reg.ch1_pf_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
		H_Block[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_00_RBUS,PROFILE_ICH1_Hist_Profile_Data_00_reg).ch1_pf_h00;//hist_profile_data_00_reg.pf_h00;
		H_Block[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_00_RBUS,PROFILE_ICH1_Hist_Profile_Data_00_reg).ch1_pf_h01;//hist_profile_data_00_reg.pf_h01;
		H_Block[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_01_RBUS,PROFILE_ICH1_Hist_Profile_Data_01_reg).ch1_pf_h02;//hist_profile_data_01_reg.pf_h02;
		H_Block[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_01_RBUS,PROFILE_ICH1_Hist_Profile_Data_01_reg).ch1_pf_h03;//hist_profile_data_01_reg.pf_h03;
		H_Block[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_02_RBUS,PROFILE_ICH1_Hist_Profile_Data_02_reg).ch1_pf_h04;//hist_profile_data_02_reg.pf_h04;
		H_Block[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_02_RBUS,PROFILE_ICH1_Hist_Profile_Data_02_reg).ch1_pf_h05;//hist_profile_data_02_reg.pf_h05;
		H_Block[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_03_RBUS,PROFILE_ICH1_Hist_Profile_Data_03_reg).ch1_pf_h06;//hist_profile_data_03_reg.pf_h06;
		H_Block[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_03_RBUS,PROFILE_ICH1_Hist_Profile_Data_03_reg).ch1_pf_h07;//hist_profile_data_03_reg.pf_h07;
		H_Block[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_04_RBUS,PROFILE_ICH1_Hist_Profile_Data_04_reg).ch1_pf_h08;//hist_profile_data_04_reg.pf_h08;
		H_Block[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_04_RBUS,PROFILE_ICH1_Hist_Profile_Data_04_reg).ch1_pf_h09;//hist_profile_data_04_reg.pf_h09;
		H_Block[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_05_RBUS,PROFILE_ICH1_Hist_Profile_Data_05_reg).ch1_pf_h10;//hist_profile_data_05_reg.pf_h10;
		H_Block[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_05_RBUS,PROFILE_ICH1_Hist_Profile_Data_05_reg).ch1_pf_h11;//hist_profile_data_05_reg.pf_h11;
		H_Block[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_06_RBUS,PROFILE_ICH1_Hist_Profile_Data_06_reg).ch1_pf_h12;//hist_profile_data_06_reg.pf_h12;
		H_Block[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_06_RBUS,PROFILE_ICH1_Hist_Profile_Data_06_reg).ch1_pf_h13;//hist_profile_data_06_reg.pf_h13;
		H_Block[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_07_RBUS,PROFILE_ICH1_Hist_Profile_Data_07_reg).ch1_pf_h14;//hist_profile_data_07_reg.pf_h14;
		H_Block[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_07_RBUS,PROFILE_ICH1_Hist_Profile_Data_07_reg).ch1_pf_h15;//hist_profile_data_07_reg.pf_h15;

		V_Block[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_08_RBUS,PROFILE_ICH1_Hist_Profile_Data_08_reg).ch1_pf_v00;//hist_profile_data_08_reg.pf_v00;
		V_Block[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_08_RBUS,PROFILE_ICH1_Hist_Profile_Data_08_reg).ch1_pf_v01;//hist_profile_data_08_reg.pf_v01;
		V_Block[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_09_RBUS,PROFILE_ICH1_Hist_Profile_Data_09_reg).ch1_pf_v02;//hist_profile_data_09_reg.pf_v02;
		V_Block[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_09_RBUS,PROFILE_ICH1_Hist_Profile_Data_09_reg).ch1_pf_v03;//hist_profile_data_09_reg.pf_v03;
		V_Block[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_10_RBUS,PROFILE_ICH1_Hist_Profile_Data_10_reg).ch1_pf_v04;//hist_profile_data_10_reg.pf_v04;
		V_Block[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_10_RBUS,PROFILE_ICH1_Hist_Profile_Data_10_reg).ch1_pf_v05;//hist_profile_data_10_reg.pf_v05;
		V_Block[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_11_RBUS,PROFILE_ICH1_Hist_Profile_Data_11_reg).ch1_pf_v06;//hist_profile_data_11_reg.pf_v06;
		V_Block[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_11_RBUS,PROFILE_ICH1_Hist_Profile_Data_11_reg).ch1_pf_v07;//hist_profile_data_11_reg.pf_v07;
		V_Block[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_12_RBUS,PROFILE_ICH1_Hist_Profile_Data_12_reg).ch1_pf_v08;//hist_profile_data_12_reg.pf_v08;
		V_Block[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_12_RBUS,PROFILE_ICH1_Hist_Profile_Data_12_reg).ch1_pf_v09;//hist_profile_data_12_reg.pf_v09;
		V_Block[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_13_RBUS,PROFILE_ICH1_Hist_Profile_Data_13_reg).ch1_pf_v10;//hist_profile_data_13_reg.pf_v10;
		V_Block[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_13_RBUS,PROFILE_ICH1_Hist_Profile_Data_13_reg).ch1_pf_v11;//hist_profile_data_13_reg.pf_v11;
		V_Block[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_14_RBUS,PROFILE_ICH1_Hist_Profile_Data_14_reg).ch1_pf_v12;//hist_profile_data_14_reg.pf_v12;
		V_Block[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_14_RBUS,PROFILE_ICH1_Hist_Profile_Data_14_reg).ch1_pf_v13;//hist_profile_data_14_reg.pf_v13;
		V_Block[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_15_RBUS,PROFILE_ICH1_Hist_Profile_Data_15_reg).ch1_pf_v14;//hist_profile_data_15_reg.pf_v14;
		V_Block[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_15_RBUS,PROFILE_ICH1_Hist_Profile_Data_15_reg).ch1_pf_v15;//hist_profile_data_15_reg.pf_v15;
#else
		profile_ich1_hist_profile_data_00_RBUS data_00;
		profile_ich1_hist_profile_data_01_RBUS data_01;
		profile_ich1_hist_profile_data_02_RBUS data_02;
		profile_ich1_hist_profile_data_03_RBUS data_03;
		profile_ich1_hist_profile_data_04_RBUS data_04;
		profile_ich1_hist_profile_data_05_RBUS data_05;
		profile_ich1_hist_profile_data_06_RBUS data_06;
		profile_ich1_hist_profile_data_07_RBUS data_07;
		profile_ich1_hist_profile_data_08_RBUS data_08;
		profile_ich1_hist_profile_data_09_RBUS data_09;
		profile_ich1_hist_profile_data_10_RBUS data_10;
		profile_ich1_hist_profile_data_11_RBUS data_11;
		profile_ich1_hist_profile_data_12_RBUS data_12;
		profile_ich1_hist_profile_data_13_RBUS data_13;
		profile_ich1_hist_profile_data_14_RBUS data_14;
		profile_ich1_hist_profile_data_15_RBUS data_15;

		data_00.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_00_reg);
		data_01.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_01_reg);
		data_02.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_02_reg);
		data_03.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_03_reg);
		data_04.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_04_reg);
		data_05.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_05_reg);
		data_06.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_06_reg);
		data_07.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_07_reg);
		data_08.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_08_reg);
		data_09.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_09_reg);
		data_10.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_10_reg);
		data_11.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_11_reg);
		data_12.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_12_reg);
		data_13.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_13_reg);
		data_14.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_14_reg);
		data_15.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_15_reg);

		H_Block[0]   = data_00.ch1_pf_h00;
		H_Block[1]   = data_00.ch1_pf_h01;
		H_Block[2]   = data_01.ch1_pf_h02;
		H_Block[3]   = data_01.ch1_pf_h03;
		H_Block[4]   = data_02.ch1_pf_h04;
		H_Block[5]   = data_02.ch1_pf_h05;
		H_Block[6]   = data_03.ch1_pf_h06;
		H_Block[7]   = data_03.ch1_pf_h07;
		H_Block[8]   = data_04.ch1_pf_h08;
		H_Block[9]   = data_04.ch1_pf_h09;
		H_Block[10] = data_05.ch1_pf_h10;
		H_Block[11] = data_05.ch1_pf_h11;
		H_Block[12] = data_06.ch1_pf_h12;
		H_Block[13] = data_06.ch1_pf_h13;
		H_Block[14] = data_07.ch1_pf_h14;
		H_Block[15] = data_07.ch1_pf_h15;

		V_Block[0]   = data_08.ch1_pf_v00;
		V_Block[1]   = data_08.ch1_pf_v01;
		V_Block[2]   = data_09.ch1_pf_v02;
		V_Block[3]   = data_09.ch1_pf_v03;
		V_Block[4]   = data_10.ch1_pf_v04;
		V_Block[5]   = data_10.ch1_pf_v05;
		V_Block[6]   = data_11.ch1_pf_v06;
		V_Block[7]   = data_11.ch1_pf_v07;
		V_Block[8]   = data_12.ch1_pf_v08;
		V_Block[9]   = data_12.ch1_pf_v09;
		V_Block[10] = data_13.ch1_pf_v10;
		V_Block[11] = data_13.ch1_pf_v11;
		V_Block[12] = data_14.ch1_pf_v12;
		V_Block[13] = data_14.ch1_pf_v13;
		V_Block[14] = data_15.ch1_pf_v14;
		V_Block[15] = data_15.ch1_pf_v15;
#endif
		//enable profile
		hist_profile_ctrl_reg.ch1_pf_field_sel = 0x2;	//next field
		hist_profile_ctrl_reg.ch1_pf_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile_ctrl_reg.regValue);

		ProfSum = 0;
		for( ii=0; ii<16; ii++ ) {
			ProfSum += H_Block[ii];
		}
		//ProfSum = ProfSum << profsum_shift;
		//ROSPrintf( "[ScalerVIP] ========Profile OK, ProfSum=%d========\n", ProfSum );

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}
}

void scalerVIP_scalerColor_profile(void)
{
	_system_setting_info* system_info_structure_table = NULL;
	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

	_clues* SmartPic_clue=NULL;
	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();

	if((system_info_structure_table == NULL) || (SmartPic_clue == NULL) ) {
		if(MA_print_count%360==0)
			ROSPrintf("scalerVIP_scalerColor_profile Share Memory PQ data ERROR,system_info_structure_table = %x, SmartPic_clue = %x\n",system_info_structure_table, SmartPic_clue);
		return;
	}

	unsigned char Profile1_YUV_Sel, Profile2_YUV_Sel, Profile3_YUV_Sel ;

	scalerVIP_fwif_color_set_profile();

	Profile1_YUV_Sel = system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_CTRL_t.ch1_pf_yuv_sel_t;
	Profile2_YUV_Sel = system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_CTRL_t.ch1_pf_yuv_sel_t;
	Profile3_YUV_Sel = system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_CTRL_t.ch1_pf_yuv_sel_t;

	#if Print_Profile_Data
  	if (Profile_Print_Count_2%500==0)
	{

		ROSPrintf( "Profile1_YUV_Sel =%d \n", Profile1_YUV_Sel);
		ROSPrintf( "Profile2_YUV_Sel =%d \n", Profile2_YUV_Sel);
		ROSPrintf( "Profile3_YUV_Sel =%d \n", Profile3_YUV_Sel);

		Profile_Print_Count_2 = 0;
	}

	Profile_Print_Count_2++;
	#endif

	//Profile 1
	#if 1   		// Profile1's ch1_pf_yuv_sel needs to set 0 to run Y for detected_black_region function, etc.
	SmartPic_clue->Profile_Cal_INFO.ProfileFlag_Y = scalerVIP_ReadProfile1_Y(SmartPic_clue);
	ProfSum = Profile1_Y_Sum;
	#else
	if(Profile1_YUV_Sel ==0)
	{
		SmartPic_clue->Profile_Cal_INFO.ProfileFlag_Y = scalerVIP_ReadProfile1_Y(SmartPic_clue);
		ProfSum = Profile1_Y_Sum;
	}
	else if(Profile1_YUV_Sel ==1)
	{
		SmartPic_clue->Profile_Cal_INFO.ProfileFlag_U = scalerVIP_ReadProfile1_U(SmartPic_clue);
		ProfSum = Profile1_U_Sum;
	}
	else if(Profile1_YUV_Sel ==2)
	{
		SmartPic_clue->Profile_Cal_INFO.ProfileFlag_V = scalerVIP_ReadProfile1_V(SmartPic_clue);
		ProfSum = Profile1_V_Sum;
	}
	else
	{
		SmartPic_clue->Profile_Cal_INFO.ProfileFlag_Y = scalerVIP_ReadProfile1_Y(SmartPic_clue);
		ProfSum = Profile1_Y_Sum;
	}
	#endif

	//Profile 2
	if(Profile2_YUV_Sel ==0)
		SmartPic_clue->Profile_Cal_INFO.Profile2_Flag_Y = scalerVIP_ReadProfile2_Y(SmartPic_clue);
	else if(Profile2_YUV_Sel ==1)
		SmartPic_clue->Profile_Cal_INFO.Profile2_Flag_U = scalerVIP_ReadProfile2_U(SmartPic_clue);
	else if(Profile2_YUV_Sel ==2)
		SmartPic_clue->Profile_Cal_INFO.Profile2_Flag_V = scalerVIP_ReadProfile2_V(SmartPic_clue);
	else
		SmartPic_clue->Profile_Cal_INFO.Profile2_Flag_Y = scalerVIP_ReadProfile2_Y(SmartPic_clue);

	//Profile 3
	if(Profile3_YUV_Sel ==0)
		SmartPic_clue->Profile_Cal_INFO.Profile3_Flag_Y = scalerVIP_ReadProfile3_Y(SmartPic_clue);
	else if(Profile3_YUV_Sel ==1)
		SmartPic_clue->Profile_Cal_INFO.Profile3_Flag_U = scalerVIP_ReadProfile3_U(SmartPic_clue);
	else if(Profile3_YUV_Sel ==2)
		SmartPic_clue->Profile_Cal_INFO.Profile3_Flag_V = scalerVIP_ReadProfile3_V(SmartPic_clue);
	else
		SmartPic_clue->Profile_Cal_INFO.Profile3_Flag_Y = scalerVIP_ReadProfile3_Y(SmartPic_clue);

}


void scalerVIP_fwif_color_set_profile(void)
{
	_system_setting_info* system_info_structure_table = NULL;
	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

	DRV_Vip_Profile  Vip_Profile_Coef;

	_clues* SmartPic_clue=NULL;
	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();

	if((system_info_structure_table == NULL) || (SmartPic_clue == NULL) ) {
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR,system_info_structure_table = %x, SmartPic_clue = %x\n",system_info_structure_table,SmartPic_clue);
		return;
	}

	unsigned  short Profile1_Start_Offset_H, Profile1_Start_Offset_V;
	unsigned  short Profile2_Start_Offset_H, Profile2_Start_Offset_V;
	unsigned  short Profile3_Start_Offset_H, Profile3_Start_Offset_V;
	unsigned short Profile1_IWid, Profile1_ILen;				//I-domain width & length
	unsigned short Profile2_IWid, Profile2_ILen;
	unsigned short Profile3_IWid, Profile3_ILen;
	unsigned char Profile_Block_Num = 16;			//set profile h&V block number

	//  Initial parameters from Misc Table.
	if(Profile_Initial_Flag==0)
	{
		//Profile 1
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.en_4k2k_mode = system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_CTRL_t.en_4k2k_mode_t;
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.en_3d_mode =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_CTRL_t.en_3d_mode_t;
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_CTRL_t.ch1_pf_yuv_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_CTRL_t.ch1_pf_field_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_CTRL_t.ch1_pf_overflow_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_CTRL_t.ch1_pf_enable_profile_t;

		//Profile 2
		Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.en_4k2k_mode = system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_CTRL_t.en_4k2k_mode_t;  //  Profile2 has no en_4k2k_mode.
		Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.en_3d_mode =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_CTRL_t.en_3d_mode_t;	    	//  Profile2 has no en_3d_mode.
		Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_CTRL_t.ch1_pf_yuv_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_CTRL_t.ch1_pf_field_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_CTRL_t.ch1_pf_overflow_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_CTRL_t.ch1_pf_enable_profile_t;

		//Profile 3
		Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.en_4k2k_mode = system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_CTRL_t.en_4k2k_mode_t;	//  Profile3 has no en_4k2k_mode.
		Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.en_3d_mode =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_CTRL_t.en_3d_mode_t;		//  Profile3 has no en_3d_mode.
		Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_CTRL_t.ch1_pf_yuv_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_CTRL_t.ch1_pf_field_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_CTRL_t.ch1_pf_overflow_sel_t;
		Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_CTRL_t.ch1_pf_enable_profile_t;

	}

	#if Print_Profile_Data
  	if (Profile_Print_Count_1%3000 ==0)
	{
			ROSPrintf( "Profile0 - en_4k2k_mode =%d \n", Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.en_4k2k_mode);
			ROSPrintf( "en_3d_mode  =%d \n", Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.en_3d_mode);
			ROSPrintf( "ch1_pf_yuv_sel =%d \n", Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel);
			ROSPrintf( "ch1_pf_field_sel =%d \n", Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel);
			ROSPrintf( "ch1_pf_overflow_sel =%d \n", Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel);
			ROSPrintf( "ch1_pf_enable_profile =%d \n\n", Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile);

			ROSPrintf( "Profile1 -en_4k2k_mode =%d \n", Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.en_4k2k_mode);
			ROSPrintf( "en_3d_mode =%d \n", Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.en_3d_mode);
			ROSPrintf( "ch1_pf_yuv_sel =%d \n",Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel);
			ROSPrintf( "ch1_pf_field_sel  =%d \n",Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel);
			ROSPrintf( "ch1_pf_overflow_sel =%d \n", Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel);
			ROSPrintf( "ch1_pf_enable_profile =%d \n\n", Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile);

			ROSPrintf( "Profile2 -en_4k2k_mode =%d \n", Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.en_4k2k_mode);
			ROSPrintf( "en_3d_mode  =%d \n", Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.en_3d_mode);
			ROSPrintf( "ch1_pf_yuv_sel =%d \n",  Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel);
			ROSPrintf( "ch1_pf_field_sel =%d \n", Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel);
			ROSPrintf( "ch1_pf_overflow_sel =%d \n",Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel);
			ROSPrintf( "ch1_pf_enable_profile =%d \n\n", Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile);

			Profile_Print_Count_1 = 0;
	}

	Profile_Print_Count_1++;
	#endif

	// Get H & V Start Offset from Misc Table.
	Profile1_Start_Offset_H =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_StartH_t.ch1_pf_starth_t;
	Profile1_Start_Offset_V =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[0].VipICH1_Hist_Profile_StartV_t.ch1_pf_startv_t;

	Profile2_Start_Offset_H =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_StartH_t.ch1_pf_starth_t;
	Profile2_Start_Offset_V =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[1].VipICH1_Hist_Profile_StartV_t.ch1_pf_startv_t;

	Profile3_Start_Offset_H =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_StartH_t.ch1_pf_starth_t;
	Profile3_Start_Offset_V =  system_info_structure_table->PQ_Setting_Info.Profile_Table_Coef.Vip_Profile_Table[2].VipICH1_Hist_Profile_StartV_t.ch1_pf_startv_t;

	if((Profile1_Start_Offset_H > 1000)||(Profile1_Start_Offset_V > 500))
	{
		Profile1_Start_Offset_H = 0;
		Profile1_Start_Offset_V = 0;
	}

	if((Profile2_Start_Offset_H > 1000)||(Profile2_Start_Offset_V > 500))
	{
		Profile2_Start_Offset_H = 0;
		Profile2_Start_Offset_V = 0;
	}

	if((Profile3_Start_Offset_H > 1000)||(Profile3_Start_Offset_V > 500))
	{
		Profile3_Start_Offset_H = 0;
		Profile3_Start_Offset_V = 0;
	}

	//Set Profile Start Position
	Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_StartH.ch1_pf_starth  = Profile1_Start_Offset_H;
	Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_StartV.ch1_pf_startv = Profile1_Start_Offset_V;

	Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_StartH.ch1_pf_starth  = Profile2_Start_Offset_H;
	Vip_Profile_Coef.Vip_Profile_Info[1].VipICH1_Hist_Profile_StartV.ch1_pf_startv = Profile2_Start_Offset_V;

	Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_StartH.ch1_pf_starth  = Profile3_Start_Offset_H;
	Vip_Profile_Coef.Vip_Profile_Info[2].VipICH1_Hist_Profile_StartV.ch1_pf_startv = Profile3_Start_Offset_V;

	//Set Profile Block Size
	// Profile 1
	Profile1_IWid = SmartPic_clue->SCALER_DISP_INFO.IphActWid_H;
	Profile1_ILen = SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V;

	Profile1_IWid -= Profile1_Start_Offset_H*2;
	Profile1_ILen	-= Profile1_Start_Offset_V*2;

	Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_hsize  = (Profile1_IWid/Profile_Block_Num) -1;		//according to spec., size should be minus 1

	if( (SmartPic_clue->SCALER_DISP_INFO.disp_status & _BIT8) != 0 ) 	// Interlaced
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_vsize = (Profile1_ILen/Profile_Block_Num)*2 -1;	//according to spec., size should be minus 1
	else
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_vsize = (Profile1_ILen/Profile_Block_Num) -1;	//according to spec., size should be minus 1

	// Profile 2
	Profile2_IWid = SmartPic_clue->SCALER_DISP_INFO.IphActWid_H;
	Profile2_ILen = SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V;

	Profile2_IWid -= Profile1_Start_Offset_H*2;
	Profile2_ILen	-= Profile1_Start_Offset_V*2;

	Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_hsize  = (Profile2_IWid/Profile_Block_Num) -1;		//according to spec., size should be minus 1

	if( (SmartPic_clue->SCALER_DISP_INFO.disp_status & _BIT8) != 0 ) 	// Interlaced
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_vsize = (Profile2_ILen/Profile_Block_Num)*2 -1;	//according to spec., size should be minus 1
	else
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_vsize = (Profile2_ILen/Profile_Block_Num) -1;	//according to spec., size should be minus 1

	// Profile 3
	Profile3_IWid = SmartPic_clue->SCALER_DISP_INFO.IphActWid_H;
	Profile3_ILen = SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V;

	Profile3_IWid -= Profile1_Start_Offset_H*2;
	Profile3_ILen	-= Profile1_Start_Offset_V*2;

	Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_hsize  = (Profile3_IWid/Profile_Block_Num) -1;		//according to spec., size should be minus 1

	if( (SmartPic_clue->SCALER_DISP_INFO.disp_status & _BIT8) != 0 ) 	// Interlaced
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_vsize = (Profile3_ILen/Profile_Block_Num)*2 -1;	//according to spec., size should be minus 1
	else
		Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_vsize = (Profile3_ILen/Profile_Block_Num) -1;	//according to spec., size should be minus 1

	scalerVIP_drvif_color_profile(&Vip_Profile_Coef);

	Profile1_H_Block_size = Profile1_IWid*(Vip_Profile_Coef.Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_vsize+1);
}


void scalerVIP_drvif_color_profile(DRV_Vip_Profile *ptr)
{

	profile_ich1_hist_profile_ctrl_RBUS hist_profile_ctrl_reg;
	profile_ich1_hist_profile_size_RBUS hist_profile_size_reg;
	profile_ich1_hist_profile_starth_RBUS hist_profile_starth_reg;
	profile_ich1_hist_profile_startv_RBUS hist_profile_startv_reg;

	profile_ich1_hist_profile2_ctrl_RBUS hist_profile2_ctrl_reg;
	profile_ich1_hist_profile2_size_RBUS hist_profile2_size_reg;
	profile_ich1_hist_profile2_starth_RBUS hist_profile2_starth_reg;
	profile_ich1_hist_profile2_startv_RBUS hist_profile2_startv_reg;

	profile_ich1_hist_profile3_ctrl_RBUS hist_profile3_ctrl_reg;
	profile_ich1_hist_profile3_size_RBUS hist_profile3_size_reg;
	profile_ich1_hist_profile3_starth_RBUS hist_profile3_starth_reg;
	profile_ich1_hist_profile3_startv_RBUS hist_profile3_startv_reg;

	// Profile1
	hist_profile_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_CTRL_reg);
	hist_profile_size_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_size_reg);
	hist_profile_starth_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_StartH_reg);
	hist_profile_startv_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_StartV_reg);

	// Profile2
	hist_profile2_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile2_CTRL_reg);
	hist_profile2_size_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile2_size_reg);
	hist_profile2_starth_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile2_StartH_reg);
	hist_profile2_startv_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile2_StartV_reg);

	// Profile3
	hist_profile3_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile3_CTRL_reg);
	hist_profile3_size_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile3_size_reg);
	hist_profile3_starth_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile3_StartH_reg);
	hist_profile3_startv_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile3_StartV_reg);

	if(Profile_Initial_Flag==0)
	{
		// Profile1
		hist_profile_ctrl_reg.en_4k2k_mode = ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.en_4k2k_mode;
		hist_profile_ctrl_reg.en_3d_mode =ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.en_3d_mode;
		hist_profile_ctrl_reg.ch1_pf_yuv_sel = ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel;
		hist_profile_ctrl_reg.ch1_pf_field_sel = ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel;
		hist_profile_ctrl_reg.ch1_pf_overflow_sel = ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel;
		hist_profile_ctrl_reg.ch1_pf_enable_profile = ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile;

		// Profile2
		hist_profile2_ctrl_reg.ch1_pf2_yuv_sel = ptr->Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel;
		hist_profile2_ctrl_reg.ch1_pf2_field_sel = ptr->Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel;
		hist_profile2_ctrl_reg.ch1_pf2_overflow_sel = ptr->Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel;
		hist_profile2_ctrl_reg.ch1_pf2_enable_profile = ptr->Vip_Profile_Info[1].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile;

		// Profile3
		hist_profile3_ctrl_reg.ch1_pf3_yuv_sel = ptr->Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_yuv_sel;
		hist_profile3_ctrl_reg.ch1_pf3_field_sel = ptr->Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_field_sel;
		hist_profile3_ctrl_reg.ch1_pf3_overflow_sel = ptr->Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_overflow_sel;
		hist_profile3_ctrl_reg.ch1_pf3_enable_profile = ptr->Vip_Profile_Info[2].VipICH1_Hist_Profile_CTRL.ch1_pf_enable_profile;
	}

	// Profile1
	hist_profile_size_reg.ch1_pf_vsize = ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_vsize;
	hist_profile_size_reg.ch1_pf_hsize = ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_Size.ch1_pf_hsize;
	hist_profile_starth_reg.ch1_pf_starth= ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_StartH.ch1_pf_starth;
	hist_profile_startv_reg.ch1_pf_startv = ptr->Vip_Profile_Info[0].VipICH1_Hist_Profile_StartV.ch1_pf_startv;

	// Profile2
	hist_profile2_size_reg.ch1_pf2_vsize = ptr->Vip_Profile_Info[1].VipICH1_Hist_Profile_Size.ch1_pf_vsize;
	hist_profile2_size_reg.ch1_pf2_hsize = ptr->Vip_Profile_Info[1].VipICH1_Hist_Profile_Size.ch1_pf_hsize;
	hist_profile2_starth_reg.ch1_pf2_starth= ptr->Vip_Profile_Info[1].VipICH1_Hist_Profile_StartH.ch1_pf_starth;
	hist_profile2_startv_reg.ch1_pf2_startv = ptr->Vip_Profile_Info[1].VipICH1_Hist_Profile_StartV.ch1_pf_startv;

	// Profile3
	hist_profile3_size_reg.ch1_pf3_vsize = ptr->Vip_Profile_Info[2].VipICH1_Hist_Profile_Size.ch1_pf_vsize;
	hist_profile3_size_reg.ch1_pf3_hsize = ptr->Vip_Profile_Info[2].VipICH1_Hist_Profile_Size.ch1_pf_hsize;
	hist_profile3_starth_reg.ch1_pf3_starth= ptr->Vip_Profile_Info[2].VipICH1_Hist_Profile_StartH.ch1_pf_starth;
	hist_profile3_startv_reg.ch1_pf3_startv = ptr->Vip_Profile_Info[2].VipICH1_Hist_Profile_StartV.ch1_pf_startv;


	if(Profile_Initial_Flag==0)
	{
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile_ctrl_reg.regValue);
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile2_CTRL_reg, hist_profile2_ctrl_reg.regValue);
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_CTRL_reg, hist_profile3_ctrl_reg.regValue);
		Profile_Initial_Flag=1;
	}

	// Profile1
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_size_reg, hist_profile_size_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_StartH_reg, hist_profile_starth_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_StartV_reg, hist_profile_startv_reg.regValue);

	// Profile2
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile2_size_reg, hist_profile2_size_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile2_StartH_reg, hist_profile2_starth_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile2_StartV_reg, hist_profile2_startv_reg.regValue);

	// Profile3
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_size_reg, hist_profile3_size_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_StartH_reg, hist_profile3_starth_reg.regValue);
	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_StartV_reg, hist_profile3_startv_reg.regValue);

}


char scalerVIP_ReadProfile1_Y(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile_ctrl_RBUS hist_profile_ctrl_reg;
	unsigned char profsum_shift=10;
	unsigned long long Y_Sum = 0;
	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *H_Block_Y = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block_Y = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	hist_profile_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x2;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x1;
			profsum_shift = 9;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x2;
			profsum_shift = 10;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x3;
			profsum_shift = 10;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile_ctrl_reg.regValue);

	if ( hist_profile_ctrl_reg.ch1_pf_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		// Get Horizontal profile data for Y.
		H_Block_Y[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_00_RBUS,PROFILE_ICH1_Hist_Profile_Data_00_reg).ch1_pf_h00;//hist_profile_data_00_reg.pf_h00;
		H_Block_Y[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_00_RBUS,PROFILE_ICH1_Hist_Profile_Data_00_reg).ch1_pf_h01;//hist_profile_data_00_reg.pf_h01;
		H_Block_Y[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_01_RBUS,PROFILE_ICH1_Hist_Profile_Data_01_reg).ch1_pf_h02;//hist_profile_data_01_reg.pf_h02;
		H_Block_Y[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_01_RBUS,PROFILE_ICH1_Hist_Profile_Data_01_reg).ch1_pf_h03;//hist_profile_data_01_reg.pf_h03;
		H_Block_Y[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_02_RBUS,PROFILE_ICH1_Hist_Profile_Data_02_reg).ch1_pf_h04;//hist_profile_data_02_reg.pf_h04;
		H_Block_Y[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_02_RBUS,PROFILE_ICH1_Hist_Profile_Data_02_reg).ch1_pf_h05;//hist_profile_data_02_reg.pf_h05;
		H_Block_Y[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_03_RBUS,PROFILE_ICH1_Hist_Profile_Data_03_reg).ch1_pf_h06;//hist_profile_data_03_reg.pf_h06;
		H_Block_Y[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_03_RBUS,PROFILE_ICH1_Hist_Profile_Data_03_reg).ch1_pf_h07;//hist_profile_data_03_reg.pf_h07;
		H_Block_Y[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_04_RBUS,PROFILE_ICH1_Hist_Profile_Data_04_reg).ch1_pf_h08;//hist_profile_data_04_reg.pf_h08;
		H_Block_Y[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_04_RBUS,PROFILE_ICH1_Hist_Profile_Data_04_reg).ch1_pf_h09;//hist_profile_data_04_reg.pf_h09;
		H_Block_Y[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_05_RBUS,PROFILE_ICH1_Hist_Profile_Data_05_reg).ch1_pf_h10;//hist_profile_data_05_reg.pf_h10;
		H_Block_Y[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_05_RBUS,PROFILE_ICH1_Hist_Profile_Data_05_reg).ch1_pf_h11;//hist_profile_data_05_reg.pf_h11;
		H_Block_Y[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_06_RBUS,PROFILE_ICH1_Hist_Profile_Data_06_reg).ch1_pf_h12;//hist_profile_data_06_reg.pf_h12;
		H_Block_Y[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_06_RBUS,PROFILE_ICH1_Hist_Profile_Data_06_reg).ch1_pf_h13;//hist_profile_data_06_reg.pf_h13;
		H_Block_Y[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_07_RBUS,PROFILE_ICH1_Hist_Profile_Data_07_reg).ch1_pf_h14;//hist_profile_data_07_reg.pf_h14;
		H_Block_Y[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_07_RBUS,PROFILE_ICH1_Hist_Profile_Data_07_reg).ch1_pf_h15;//hist_profile_data_07_reg.pf_h15;

		// Get Vertical profile data for Y.
		V_Block_Y[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_08_RBUS,PROFILE_ICH1_Hist_Profile_Data_08_reg).ch1_pf_v00;//hist_profile_data_08_reg.pf_v00;
		V_Block_Y[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_08_RBUS,PROFILE_ICH1_Hist_Profile_Data_08_reg).ch1_pf_v01;//hist_profile_data_08_reg.pf_v01;
		V_Block_Y[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_09_RBUS,PROFILE_ICH1_Hist_Profile_Data_09_reg).ch1_pf_v02;//hist_profile_data_09_reg.pf_v02;
		V_Block_Y[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_09_RBUS,PROFILE_ICH1_Hist_Profile_Data_09_reg).ch1_pf_v03;//hist_profile_data_09_reg.pf_v03;
		V_Block_Y[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_10_RBUS,PROFILE_ICH1_Hist_Profile_Data_10_reg).ch1_pf_v04;//hist_profile_data_10_reg.pf_v04;
		V_Block_Y[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_10_RBUS,PROFILE_ICH1_Hist_Profile_Data_10_reg).ch1_pf_v05;//hist_profile_data_10_reg.pf_v05;
		V_Block_Y[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_11_RBUS,PROFILE_ICH1_Hist_Profile_Data_11_reg).ch1_pf_v06;//hist_profile_data_11_reg.pf_v06;
		V_Block_Y[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_11_RBUS,PROFILE_ICH1_Hist_Profile_Data_11_reg).ch1_pf_v07;//hist_profile_data_11_reg.pf_v07;
		V_Block_Y[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_12_RBUS,PROFILE_ICH1_Hist_Profile_Data_12_reg).ch1_pf_v08;//hist_profile_data_12_reg.pf_v08;
		V_Block_Y[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_12_RBUS,PROFILE_ICH1_Hist_Profile_Data_12_reg).ch1_pf_v09;//hist_profile_data_12_reg.pf_v09;
		V_Block_Y[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_13_RBUS,PROFILE_ICH1_Hist_Profile_Data_13_reg).ch1_pf_v10;//hist_profile_data_13_reg.pf_v10;
		V_Block_Y[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_13_RBUS,PROFILE_ICH1_Hist_Profile_Data_13_reg).ch1_pf_v11;//hist_profile_data_13_reg.pf_v11;
		V_Block_Y[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_14_RBUS,PROFILE_ICH1_Hist_Profile_Data_14_reg).ch1_pf_v12;//hist_profile_data_14_reg.pf_v12;
		V_Block_Y[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_14_RBUS,PROFILE_ICH1_Hist_Profile_Data_14_reg).ch1_pf_v13;//hist_profile_data_14_reg.pf_v13;
		V_Block_Y[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_15_RBUS,PROFILE_ICH1_Hist_Profile_Data_15_reg).ch1_pf_v14;//hist_profile_data_15_reg.pf_v14;
		V_Block_Y[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_15_RBUS,PROFILE_ICH1_Hist_Profile_Data_15_reg).ch1_pf_v15;//hist_profile_data_15_reg.pf_v15;
#else
		profile_ich1_hist_profile_data_00_RBUS data_00;
		profile_ich1_hist_profile_data_01_RBUS data_01;
		profile_ich1_hist_profile_data_02_RBUS data_02;
		profile_ich1_hist_profile_data_03_RBUS data_03;
		profile_ich1_hist_profile_data_04_RBUS data_04;
		profile_ich1_hist_profile_data_05_RBUS data_05;
		profile_ich1_hist_profile_data_06_RBUS data_06;
		profile_ich1_hist_profile_data_07_RBUS data_07;
		profile_ich1_hist_profile_data_08_RBUS data_08;
		profile_ich1_hist_profile_data_09_RBUS data_09;
		profile_ich1_hist_profile_data_10_RBUS data_10;
		profile_ich1_hist_profile_data_11_RBUS data_11;
		profile_ich1_hist_profile_data_12_RBUS data_12;
		profile_ich1_hist_profile_data_13_RBUS data_13;
		profile_ich1_hist_profile_data_14_RBUS data_14;
		profile_ich1_hist_profile_data_15_RBUS data_15;

		data_00.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_00_reg);
		data_01.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_01_reg);
		data_02.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_02_reg);
		data_03.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_03_reg);
		data_04.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_04_reg);
		data_05.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_05_reg);
		data_06.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_06_reg);
		data_07.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_07_reg);
		data_08.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_08_reg);
		data_09.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_09_reg);
		data_10.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_10_reg);
		data_11.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_11_reg);
		data_12.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_12_reg);
		data_13.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_13_reg);
		data_14.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_14_reg);
		data_15.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_15_reg);

		// Get Horizontal profile data for Y.
		H_Block_Y[0]   = data_00.ch1_pf_h00;
		H_Block_Y[1]   = data_00.ch1_pf_h01;
		H_Block_Y[2]   = data_01.ch1_pf_h02;
		H_Block_Y[3]   = data_01.ch1_pf_h03;
		H_Block_Y[4]   = data_02.ch1_pf_h04;
		H_Block_Y[5]   = data_02.ch1_pf_h05;
		H_Block_Y[6]   = data_03.ch1_pf_h06;
		H_Block_Y[7]   = data_03.ch1_pf_h07;
		H_Block_Y[8]   = data_04.ch1_pf_h08;
		H_Block_Y[9]   = data_04.ch1_pf_h09;
		H_Block_Y[10] = data_05.ch1_pf_h10;
		H_Block_Y[11] = data_05.ch1_pf_h11;
		H_Block_Y[12] = data_06.ch1_pf_h12;
		H_Block_Y[13] = data_06.ch1_pf_h13;
		H_Block_Y[14] = data_07.ch1_pf_h14;
		H_Block_Y[15] = data_07.ch1_pf_h15;

		// Get Vertical profile data for Y.
		V_Block_Y[0]   = data_08.ch1_pf_v00;
		V_Block_Y[1]   = data_08.ch1_pf_v01;
		V_Block_Y[2]   = data_09.ch1_pf_v02;
		V_Block_Y[3]   = data_09.ch1_pf_v03;
		V_Block_Y[4]   = data_10.ch1_pf_v04;
		V_Block_Y[5]   = data_10.ch1_pf_v05;
		V_Block_Y[6]   = data_11.ch1_pf_v06;
		V_Block_Y[7]   = data_11.ch1_pf_v07;
		V_Block_Y[8]   = data_12.ch1_pf_v08;
		V_Block_Y[9]   = data_12.ch1_pf_v09;
		V_Block_Y[10] = data_13.ch1_pf_v10;
		V_Block_Y[11] = data_13.ch1_pf_v11;
		V_Block_Y[12] = data_14.ch1_pf_v12;
		V_Block_Y[13] = data_14.ch1_pf_v13;
		V_Block_Y[14] = data_15.ch1_pf_v14;
		V_Block_Y[15] = data_15.ch1_pf_v15;
#endif

		//Enable profile
		hist_profile_ctrl_reg.ch1_pf_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile_ctrl_reg.regValue);

		Profile1_Y_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile1_Y_Sum += H_Block_Y[ii];
		}
		//Profile1_Y_Sum = Profile1_Y_Sum << profsum_shift;

		/* calc profile Y APL start*/
		Y_Sum = ProfSum;
		Y_Sum = Y_Sum << (profsum_shift-2);
		if (Profile1_H_Block_size)
		{
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
			Y_Sum=Y_Sum + (Profile1_H_Block_size>>1);
			do_div(Y_Sum, Profile1_H_Block_size);
#else
			Y_Sum = (Y_Sum + (Profile1_H_Block_size>>1)) / Profile1_H_Block_size;
#endif
		}

		SmartPic_clue->Profile_Cal_INFO.ProfileAPL_Y = Y_Sum & 0xffff;
		/* calc profile Y APL end*/

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%500 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### H_Block_Y[%d] =%d ### \n", jj, H_Block_Y[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### V_Block_Y[%d] =%d ### \n", jj, V_Block_Y[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile1_Y_Sum =%d========\n", Profile1_Y_Sum );

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}

char scalerVIP_ReadProfile1_U(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile_ctrl_RBUS hist_profile_ctrl_reg;

	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *H_Block_U = &(SmartPic_clue->Profile_Cal_INFO.H_Block_U[0]);
	unsigned short *V_Block_U = &(SmartPic_clue->Profile_Cal_INFO.V_Block_U[0]);

	hist_profile_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x2;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x1;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x2;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x3;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile_ctrl_reg.regValue);

	if ( hist_profile_ctrl_reg.ch1_pf_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		// Get Horizontal profile data for U.
		H_Block_U[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_00_RBUS,PROFILE_ICH1_Hist_Profile_Data_00_reg).ch1_pf_h00;//hist_profile_data_00_reg.pf_h00;
		H_Block_U[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_00_RBUS,PROFILE_ICH1_Hist_Profile_Data_00_reg).ch1_pf_h01;//hist_profile_data_00_reg.pf_h01;
		H_Block_U[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_01_RBUS,PROFILE_ICH1_Hist_Profile_Data_01_reg).ch1_pf_h02;//hist_profile_data_01_reg.pf_h02;
		H_Block_U[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_01_RBUS,PROFILE_ICH1_Hist_Profile_Data_01_reg).ch1_pf_h03;//hist_profile_data_01_reg.pf_h03;
		H_Block_U[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_02_RBUS,PROFILE_ICH1_Hist_Profile_Data_02_reg).ch1_pf_h04;//hist_profile_data_02_reg.pf_h04;
		H_Block_U[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_02_RBUS,PROFILE_ICH1_Hist_Profile_Data_02_reg).ch1_pf_h05;//hist_profile_data_02_reg.pf_h05;
		H_Block_U[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_03_RBUS,PROFILE_ICH1_Hist_Profile_Data_03_reg).ch1_pf_h06;//hist_profile_data_03_reg.pf_h06;
		H_Block_U[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_03_RBUS,PROFILE_ICH1_Hist_Profile_Data_03_reg).ch1_pf_h07;//hist_profile_data_03_reg.pf_h07;
		H_Block_U[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_04_RBUS,PROFILE_ICH1_Hist_Profile_Data_04_reg).ch1_pf_h08;//hist_profile_data_04_reg.pf_h08;
		H_Block_U[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_04_RBUS,PROFILE_ICH1_Hist_Profile_Data_04_reg).ch1_pf_h09;//hist_profile_data_04_reg.pf_h09;
		H_Block_U[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_05_RBUS,PROFILE_ICH1_Hist_Profile_Data_05_reg).ch1_pf_h10;//hist_profile_data_05_reg.pf_h10;
		H_Block_U[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_05_RBUS,PROFILE_ICH1_Hist_Profile_Data_05_reg).ch1_pf_h11;//hist_profile_data_05_reg.pf_h11;
		H_Block_U[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_06_RBUS,PROFILE_ICH1_Hist_Profile_Data_06_reg).ch1_pf_h12;//hist_profile_data_06_reg.pf_h12;
		H_Block_U[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_06_RBUS,PROFILE_ICH1_Hist_Profile_Data_06_reg).ch1_pf_h13;//hist_profile_data_06_reg.pf_h13;
		H_Block_U[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_07_RBUS,PROFILE_ICH1_Hist_Profile_Data_07_reg).ch1_pf_h14;//hist_profile_data_07_reg.pf_h14;
		H_Block_U[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_07_RBUS,PROFILE_ICH1_Hist_Profile_Data_07_reg).ch1_pf_h15;//hist_profile_data_07_reg.pf_h15;

		// Get Vertical profile data for U.
		V_Block_U[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_08_RBUS,PROFILE_ICH1_Hist_Profile_Data_08_reg).ch1_pf_v00;//hist_profile_data_08_reg.pf_v00;
		V_Block_U[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_08_RBUS,PROFILE_ICH1_Hist_Profile_Data_08_reg).ch1_pf_v01;//hist_profile_data_08_reg.pf_v01;
		V_Block_U[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_09_RBUS,PROFILE_ICH1_Hist_Profile_Data_09_reg).ch1_pf_v02;//hist_profile_data_09_reg.pf_v02;
		V_Block_U[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_09_RBUS,PROFILE_ICH1_Hist_Profile_Data_09_reg).ch1_pf_v03;//hist_profile_data_09_reg.pf_v03;
		V_Block_U[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_10_RBUS,PROFILE_ICH1_Hist_Profile_Data_10_reg).ch1_pf_v04;//hist_profile_data_10_reg.pf_v04;
		V_Block_U[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_10_RBUS,PROFILE_ICH1_Hist_Profile_Data_10_reg).ch1_pf_v05;//hist_profile_data_10_reg.pf_v05;
		V_Block_U[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_11_RBUS,PROFILE_ICH1_Hist_Profile_Data_11_reg).ch1_pf_v06;//hist_profile_data_11_reg.pf_v06;
		V_Block_U[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_11_RBUS,PROFILE_ICH1_Hist_Profile_Data_11_reg).ch1_pf_v07;//hist_profile_data_11_reg.pf_v07;
		V_Block_U[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_12_RBUS,PROFILE_ICH1_Hist_Profile_Data_12_reg).ch1_pf_v08;//hist_profile_data_12_reg.pf_v08;
		V_Block_U[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_12_RBUS,PROFILE_ICH1_Hist_Profile_Data_12_reg).ch1_pf_v09;//hist_profile_data_12_reg.pf_v09;
		V_Block_U[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_13_RBUS,PROFILE_ICH1_Hist_Profile_Data_13_reg).ch1_pf_v10;//hist_profile_data_13_reg.pf_v10;
		V_Block_U[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_13_RBUS,PROFILE_ICH1_Hist_Profile_Data_13_reg).ch1_pf_v11;//hist_profile_data_13_reg.pf_v11;
		V_Block_U[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_14_RBUS,PROFILE_ICH1_Hist_Profile_Data_14_reg).ch1_pf_v12;//hist_profile_data_14_reg.pf_v12;
		V_Block_U[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_14_RBUS,PROFILE_ICH1_Hist_Profile_Data_14_reg).ch1_pf_v13;//hist_profile_data_14_reg.pf_v13;
		V_Block_U[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_15_RBUS,PROFILE_ICH1_Hist_Profile_Data_15_reg).ch1_pf_v14;//hist_profile_data_15_reg.pf_v14;
		V_Block_U[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_15_RBUS,PROFILE_ICH1_Hist_Profile_Data_15_reg).ch1_pf_v15;//hist_profile_data_15_reg.pf_v15;
#else
		profile_ich1_hist_profile_data_00_RBUS data_00;
		profile_ich1_hist_profile_data_01_RBUS data_01;
		profile_ich1_hist_profile_data_02_RBUS data_02;
		profile_ich1_hist_profile_data_03_RBUS data_03;
		profile_ich1_hist_profile_data_04_RBUS data_04;
		profile_ich1_hist_profile_data_05_RBUS data_05;
		profile_ich1_hist_profile_data_06_RBUS data_06;
		profile_ich1_hist_profile_data_07_RBUS data_07;
		profile_ich1_hist_profile_data_08_RBUS data_08;
		profile_ich1_hist_profile_data_09_RBUS data_09;
		profile_ich1_hist_profile_data_10_RBUS data_10;
		profile_ich1_hist_profile_data_11_RBUS data_11;
		profile_ich1_hist_profile_data_12_RBUS data_12;
		profile_ich1_hist_profile_data_13_RBUS data_13;
		profile_ich1_hist_profile_data_14_RBUS data_14;
		profile_ich1_hist_profile_data_15_RBUS data_15;

		data_00.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_00_reg);
		data_01.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_01_reg);
		data_02.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_02_reg);
		data_03.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_03_reg);
		data_04.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_04_reg);
		data_05.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_05_reg);
		data_06.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_06_reg);
		data_07.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_07_reg);
		data_08.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_08_reg);
		data_09.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_09_reg);
		data_10.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_10_reg);
		data_11.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_11_reg);
		data_12.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_12_reg);
		data_13.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_13_reg);
		data_14.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_14_reg);
		data_15.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_15_reg);

		// Get Horizontal profile data for U.
		H_Block_U[0]   = data_00.ch1_pf_h00;
		H_Block_U[1]   = data_00.ch1_pf_h01;
		H_Block_U[2]   = data_01.ch1_pf_h02;
		H_Block_U[3]   = data_01.ch1_pf_h03;
		H_Block_U[4]   = data_02.ch1_pf_h04;
		H_Block_U[5]   = data_02.ch1_pf_h05;
		H_Block_U[6]   = data_03.ch1_pf_h06;
		H_Block_U[7]   = data_03.ch1_pf_h07;
		H_Block_U[8]   = data_04.ch1_pf_h08;
		H_Block_U[9]   = data_04.ch1_pf_h09;
		H_Block_U[10] = data_05.ch1_pf_h10;
		H_Block_U[11] = data_05.ch1_pf_h11;
		H_Block_U[12] = data_06.ch1_pf_h12;
		H_Block_U[13] = data_06.ch1_pf_h13;
		H_Block_U[14] = data_07.ch1_pf_h14;
		H_Block_U[15] = data_07.ch1_pf_h15;

		// Get Vertical profile data for U.
		V_Block_U[0]    = data_08.ch1_pf_v00;
		V_Block_U[1]    = data_08.ch1_pf_v01;
		V_Block_U[2]    = data_09.ch1_pf_v02;
		V_Block_U[3]    = data_09.ch1_pf_v03;
		V_Block_U[4]    = data_10.ch1_pf_v04;
		V_Block_U[5]    = data_10.ch1_pf_v05;
		V_Block_U[6]    = data_11.ch1_pf_v06;
		V_Block_U[7]    = data_11.ch1_pf_v07;
		V_Block_U[8]    = data_12.ch1_pf_v08;
		V_Block_U[9]    = data_12.ch1_pf_v09;
		V_Block_U[10] = data_13.ch1_pf_v10;
		V_Block_U[11] = data_13.ch1_pf_v11;
		V_Block_U[12] = data_14.ch1_pf_v12;
		V_Block_U[13] = data_14.ch1_pf_v13;
		V_Block_U[14] = data_15.ch1_pf_v14;
		V_Block_U[15] = data_15.ch1_pf_v15;
#endif

		//Enable profile
		hist_profile_ctrl_reg.ch1_pf_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile_ctrl_reg.regValue);

		Profile1_U_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile1_U_Sum += H_Block_U[ii];
		}
		//Profile1_U_Sum = Profile1_U_Sum << profsum_shift;

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%500 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### H_Block_U[%d] =%d ### \n", jj, H_Block_U[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### V_Block_U[%d] =%d ### \n", jj, V_Block_U[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile1_U_Sum =%d========\n", Profile1_U_Sum);

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}


char scalerVIP_ReadProfile1_V(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile_ctrl_RBUS hist_profile_ctrl_reg;

	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *H_Block_V = &(SmartPic_clue->Profile_Cal_INFO.H_Block_V[0]);
	unsigned short *V_Block_V = &(SmartPic_clue->Profile_Cal_INFO.V_Block_V[0]);

	hist_profile_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x2;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x1;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x2;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile_ctrl_reg.ch1_pf_hnsr = 0x3;
			hist_profile_ctrl_reg.ch1_pf_vnsr = 0x3;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile_ctrl_reg.regValue);

	if ( hist_profile_ctrl_reg.ch1_pf_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		// Get Horizontal profile data for V.
		H_Block_V[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_00_RBUS,PROFILE_ICH1_Hist_Profile_Data_00_reg).ch1_pf_h00;//hist_profile_data_00_reg.pf_h00;
		H_Block_V[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_00_RBUS,PROFILE_ICH1_Hist_Profile_Data_00_reg).ch1_pf_h01;//hist_profile_data_00_reg.pf_h01;
		H_Block_V[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_01_RBUS,PROFILE_ICH1_Hist_Profile_Data_01_reg).ch1_pf_h02;//hist_profile_data_01_reg.pf_h02;
		H_Block_V[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_01_RBUS,PROFILE_ICH1_Hist_Profile_Data_01_reg).ch1_pf_h03;//hist_profile_data_01_reg.pf_h03;
		H_Block_V[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_02_RBUS,PROFILE_ICH1_Hist_Profile_Data_02_reg).ch1_pf_h04;//hist_profile_data_02_reg.pf_h04;
		H_Block_V[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_02_RBUS,PROFILE_ICH1_Hist_Profile_Data_02_reg).ch1_pf_h05;//hist_profile_data_02_reg.pf_h05;
		H_Block_V[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_03_RBUS,PROFILE_ICH1_Hist_Profile_Data_03_reg).ch1_pf_h06;//hist_profile_data_03_reg.pf_h06;
		H_Block_V[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_03_RBUS,PROFILE_ICH1_Hist_Profile_Data_03_reg).ch1_pf_h07;//hist_profile_data_03_reg.pf_h07;
		H_Block_V[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_04_RBUS,PROFILE_ICH1_Hist_Profile_Data_04_reg).ch1_pf_h08;//hist_profile_data_04_reg.pf_h08;
		H_Block_V[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_04_RBUS,PROFILE_ICH1_Hist_Profile_Data_04_reg).ch1_pf_h09;//hist_profile_data_04_reg.pf_h09;
		H_Block_V[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_05_RBUS,PROFILE_ICH1_Hist_Profile_Data_05_reg).ch1_pf_h10;//hist_profile_data_05_reg.pf_h10;
		H_Block_V[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_05_RBUS,PROFILE_ICH1_Hist_Profile_Data_05_reg).ch1_pf_h11;//hist_profile_data_05_reg.pf_h11;
		H_Block_V[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_06_RBUS,PROFILE_ICH1_Hist_Profile_Data_06_reg).ch1_pf_h12;//hist_profile_data_06_reg.pf_h12;
		H_Block_V[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_06_RBUS,PROFILE_ICH1_Hist_Profile_Data_06_reg).ch1_pf_h13;//hist_profile_data_06_reg.pf_h13;
		H_Block_V[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_07_RBUS,PROFILE_ICH1_Hist_Profile_Data_07_reg).ch1_pf_h14;//hist_profile_data_07_reg.pf_h14;
		H_Block_V[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_07_RBUS,PROFILE_ICH1_Hist_Profile_Data_07_reg).ch1_pf_h15;//hist_profile_data_07_reg.pf_h15;

		// Get Vertical profile data for V.
		V_Block_V[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_08_RBUS,PROFILE_ICH1_Hist_Profile_Data_08_reg).ch1_pf_v00;//hist_profile_data_08_reg.pf_v00;
		V_Block_V[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_08_RBUS,PROFILE_ICH1_Hist_Profile_Data_08_reg).ch1_pf_v01;//hist_profile_data_08_reg.pf_v01;
		V_Block_V[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_09_RBUS,PROFILE_ICH1_Hist_Profile_Data_09_reg).ch1_pf_v02;//hist_profile_data_09_reg.pf_v02;
		V_Block_V[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_09_RBUS,PROFILE_ICH1_Hist_Profile_Data_09_reg).ch1_pf_v03;//hist_profile_data_09_reg.pf_v03;
		V_Block_V[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_10_RBUS,PROFILE_ICH1_Hist_Profile_Data_10_reg).ch1_pf_v04;//hist_profile_data_10_reg.pf_v04;
		V_Block_V[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_10_RBUS,PROFILE_ICH1_Hist_Profile_Data_10_reg).ch1_pf_v05;//hist_profile_data_10_reg.pf_v05;
		V_Block_V[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_11_RBUS,PROFILE_ICH1_Hist_Profile_Data_11_reg).ch1_pf_v06;//hist_profile_data_11_reg.pf_v06;
		V_Block_V[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_11_RBUS,PROFILE_ICH1_Hist_Profile_Data_11_reg).ch1_pf_v07;//hist_profile_data_11_reg.pf_v07;
		V_Block_V[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_12_RBUS,PROFILE_ICH1_Hist_Profile_Data_12_reg).ch1_pf_v08;//hist_profile_data_12_reg.pf_v08;
		V_Block_V[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_12_RBUS,PROFILE_ICH1_Hist_Profile_Data_12_reg).ch1_pf_v09;//hist_profile_data_12_reg.pf_v09;
		V_Block_V[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_13_RBUS,PROFILE_ICH1_Hist_Profile_Data_13_reg).ch1_pf_v10;//hist_profile_data_13_reg.pf_v10;
		V_Block_V[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_13_RBUS,PROFILE_ICH1_Hist_Profile_Data_13_reg).ch1_pf_v11;//hist_profile_data_13_reg.pf_v11;
		V_Block_V[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_14_RBUS,PROFILE_ICH1_Hist_Profile_Data_14_reg).ch1_pf_v12;//hist_profile_data_14_reg.pf_v12;
		V_Block_V[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_14_RBUS,PROFILE_ICH1_Hist_Profile_Data_14_reg).ch1_pf_v13;//hist_profile_data_14_reg.pf_v13;
		V_Block_V[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_15_RBUS,PROFILE_ICH1_Hist_Profile_Data_15_reg).ch1_pf_v14;//hist_profile_data_15_reg.pf_v14;
		V_Block_V[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_15_RBUS,PROFILE_ICH1_Hist_Profile_Data_15_reg).ch1_pf_v15;//hist_profile_data_15_reg.pf_v15;
#else
		profile_ich1_hist_profile_data_00_RBUS data_00;
		profile_ich1_hist_profile_data_01_RBUS data_01;
		profile_ich1_hist_profile_data_02_RBUS data_02;
		profile_ich1_hist_profile_data_03_RBUS data_03;
		profile_ich1_hist_profile_data_04_RBUS data_04;
		profile_ich1_hist_profile_data_05_RBUS data_05;
		profile_ich1_hist_profile_data_06_RBUS data_06;
		profile_ich1_hist_profile_data_07_RBUS data_07;
		profile_ich1_hist_profile_data_08_RBUS data_08;
		profile_ich1_hist_profile_data_09_RBUS data_09;
		profile_ich1_hist_profile_data_10_RBUS data_10;
		profile_ich1_hist_profile_data_11_RBUS data_11;
		profile_ich1_hist_profile_data_12_RBUS data_12;
		profile_ich1_hist_profile_data_13_RBUS data_13;
		profile_ich1_hist_profile_data_14_RBUS data_14;
		profile_ich1_hist_profile_data_15_RBUS data_15;

		data_00.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_00_reg);
		data_01.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_01_reg);
		data_02.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_02_reg);
		data_03.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_03_reg);
		data_04.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_04_reg);
		data_05.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_05_reg);
		data_06.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_06_reg);
		data_07.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_07_reg);
		data_08.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_08_reg);
		data_09.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_09_reg);
		data_10.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_10_reg);
		data_11.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_11_reg);
		data_12.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_12_reg);
		data_13.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_13_reg);
		data_14.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_14_reg);
		data_15.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_15_reg);

		// Get Horizontal profile data for V.
		H_Block_V[0]  = data_00.ch1_pf_h00;
		H_Block_V[1]  = data_00.ch1_pf_h01;
		H_Block_V[2]  = data_01.ch1_pf_h02;
		H_Block_V[3]  = data_01.ch1_pf_h03;
		H_Block_V[4]  = data_02.ch1_pf_h04;
		H_Block_V[5]  = data_02.ch1_pf_h05;
		H_Block_V[6]  = data_03.ch1_pf_h06;
		H_Block_V[7]  = data_03.ch1_pf_h07;
		H_Block_V[8]  = data_04.ch1_pf_h08;
		H_Block_V[9]  = data_04.ch1_pf_h09;
		H_Block_V[10] = data_05.ch1_pf_h10;
		H_Block_V[11] = data_05.ch1_pf_h11;
		H_Block_V[12] = data_06.ch1_pf_h12;
		H_Block_V[13] = data_06.ch1_pf_h13;
		H_Block_V[14] = data_07.ch1_pf_h14;
		H_Block_V[15] = data_07.ch1_pf_h15;

		// Get Vertical profile data for V.
		V_Block_V[0]    = data_08.ch1_pf_v00;
		V_Block_V[1]    = data_08.ch1_pf_v01;
		V_Block_V[2]    = data_09.ch1_pf_v02;
		V_Block_V[3]    = data_09.ch1_pf_v03;
		V_Block_V[4]    = data_10.ch1_pf_v04;
		V_Block_V[5]    = data_10.ch1_pf_v05;
		V_Block_V[6]    = data_11.ch1_pf_v06;
		V_Block_V[7]    = data_11.ch1_pf_v07;
		V_Block_V[8]    = data_12.ch1_pf_v08;
		V_Block_V[9]    = data_12.ch1_pf_v09;
		V_Block_V[10]  = data_13.ch1_pf_v10;
		V_Block_V[11]  = data_13.ch1_pf_v11;
		V_Block_V[12]  = data_14.ch1_pf_v12;
		V_Block_V[13]  = data_14.ch1_pf_v13;
		V_Block_V[14]  = data_15.ch1_pf_v14;
		V_Block_V[15]  = data_15.ch1_pf_v15;
#endif

		//Enable profile
		hist_profile_ctrl_reg.ch1_pf_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile_ctrl_reg.regValue);

		Profile1_V_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile1_V_Sum += H_Block_V[ii];
		}
		//Profile1_V_Sum = Profile1_V_Sum << profsum_shift;

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%500 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### H_Block_V[%d] =%d ### \n", jj, H_Block_V[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### V_Block_V[%d] =%d ### \n", jj, V_Block_V[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile1_V_Sum =%d========\n", Profile1_V_Sum);

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}

char scalerVIP_ReadProfile2_Y(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile2_ctrl_RBUS hist_profile2_ctrl_reg;

	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *Profile2_H_Block_Y = &(SmartPic_clue->Profile_Cal_INFO.Profile2_H_Block_Y[0]);
	unsigned short *Profile2_V_Block_Y = &(SmartPic_clue->Profile_Cal_INFO.Profile2_V_Block_Y[0]);

	hist_profile2_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile2_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x2;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x1;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x3;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x2;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x3;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x3;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile2_ctrl_reg.regValue);

	if ( hist_profile2_ctrl_reg.ch1_pf2_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
		// Get Horizontal profile data for U.
		Profile2_H_Block_Y[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_16_RBUS,PROFILE_ICH1_Hist_Profile_Data_16_reg).ch1_pf_h00_right;//hist_profile_data_16_reg.pf_h00;
		Profile2_H_Block_Y[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_16_RBUS,PROFILE_ICH1_Hist_Profile_Data_16_reg).ch1_pf_h01_right;//hist_profile_data_16_reg.pf_h01;
		Profile2_H_Block_Y[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_17_RBUS,PROFILE_ICH1_Hist_Profile_Data_17_reg).ch1_pf_h02_right;//hist_profile_data_17_reg.pf_h02;
		Profile2_H_Block_Y[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_17_RBUS,PROFILE_ICH1_Hist_Profile_Data_17_reg).ch1_pf_h03_right;//hist_profile_data_17_reg.pf_h03;
		Profile2_H_Block_Y[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_18_RBUS,PROFILE_ICH1_Hist_Profile_Data_18_reg).ch1_pf_h04_right;//hist_profile_data_18_reg.pf_h04;
		Profile2_H_Block_Y[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_18_RBUS,PROFILE_ICH1_Hist_Profile_Data_18_reg).ch1_pf_h05_right;//hist_profile_data_18_reg.pf_h05;
		Profile2_H_Block_Y[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_19_RBUS,PROFILE_ICH1_Hist_Profile_Data_19_reg).ch1_pf_h06_right;//hist_profile_data_19_reg.pf_h06;
		Profile2_H_Block_Y[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_19_RBUS,PROFILE_ICH1_Hist_Profile_Data_19_reg).ch1_pf_h07_right;//hist_profile_data_19_reg.pf_h07;
		Profile2_H_Block_Y[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_20_RBUS,PROFILE_ICH1_Hist_Profile_Data_20_reg).ch1_pf_h08_right;//hist_profile_data_20_reg.pf_h08;
		Profile2_H_Block_Y[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_20_RBUS,PROFILE_ICH1_Hist_Profile_Data_20_reg).ch1_pf_h09_right;//hist_profile_data_20_reg.pf_h09;
		Profile2_H_Block_Y[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_21_RBUS,PROFILE_ICH1_Hist_Profile_Data_21_reg).ch1_pf_h10_right;//hist_profile_data_21_reg.pf_h10;
		Profile2_H_Block_Y[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_21_RBUS,PROFILE_ICH1_Hist_Profile_Data_21_reg).ch1_pf_h11_right;//hist_profile_data_21_reg.pf_h11;
		Profile2_H_Block_Y[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_22_RBUS,PROFILE_ICH1_Hist_Profile_Data_22_reg).ch1_pf_h12_right;//hist_profile_data_22_reg.pf_h12;
		Profile2_H_Block_Y[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_22_RBUS,PROFILE_ICH1_Hist_Profile_Data_22_reg).ch1_pf_h13_right;//hist_profile_data_22_reg.pf_h13;
		Profile2_H_Block_Y[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_23_RBUS,PROFILE_ICH1_Hist_Profile_Data_23_reg).ch1_pf_h14_right;//hist_profile_data_23_reg.pf_h14;
		Profile2_H_Block_Y[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_23_RBUS,PROFILE_ICH1_Hist_Profile_Data_23_reg).ch1_pf_h15_right;//hist_profile_data_23_reg.pf_h15;

		// Get Vertical profile data for U.
		Profile2_V_Block_Y[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_24_RBUS,PROFILE_ICH1_Hist_Profile_Data_24_reg).ch1_pf_v00_right;//hist_profile_data_24_reg.pf_v00;
		Profile2_V_Block_Y[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_24_RBUS,PROFILE_ICH1_Hist_Profile_Data_24_reg).ch1_pf_v01_right;//hist_profile_data_24_reg.pf_v01;
		Profile2_V_Block_Y[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_25_RBUS,PROFILE_ICH1_Hist_Profile_Data_25_reg).ch1_pf_v02_right;//hist_profile_data_25_reg.pf_v02;
		Profile2_V_Block_Y[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_25_RBUS,PROFILE_ICH1_Hist_Profile_Data_25_reg).ch1_pf_v03_right;//hist_profile_data_25_reg.pf_v03;
		Profile2_V_Block_Y[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_26_RBUS,PROFILE_ICH1_Hist_Profile_Data_26_reg).ch1_pf_v04_right;//hist_profile_data_26_reg.pf_v04;
		Profile2_V_Block_Y[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_26_RBUS,PROFILE_ICH1_Hist_Profile_Data_26_reg).ch1_pf_v05_right;//hist_profile_data_26_reg.pf_v05;
		Profile2_V_Block_Y[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_27_RBUS,PROFILE_ICH1_Hist_Profile_Data_27_reg).ch1_pf_v06_right;//hist_profile_data_27_reg.pf_v06;
		Profile2_V_Block_Y[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_27_RBUS,PROFILE_ICH1_Hist_Profile_Data_27_reg).ch1_pf_v07_right;//hist_profile_data_27_reg.pf_v07;
		Profile2_V_Block_Y[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_28_RBUS,PROFILE_ICH1_Hist_Profile_Data_28_reg).ch1_pf_v08_right;//hist_profile_data_28_reg.pf_v08;
		Profile2_V_Block_Y[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_28_RBUS,PROFILE_ICH1_Hist_Profile_Data_28_reg).ch1_pf_v09_right;//hist_profile_data_28_reg.pf_v09;
		Profile2_V_Block_Y[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_29_RBUS,PROFILE_ICH1_Hist_Profile_Data_29_reg).ch1_pf_v10_right;//hist_profile_data_29_reg.pf_v10;
		Profile2_V_Block_Y[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_29_RBUS,PROFILE_ICH1_Hist_Profile_Data_29_reg).ch1_pf_v11_right;//hist_profile_data_29_reg.pf_v11;
		Profile2_V_Block_Y[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_30_RBUS,PROFILE_ICH1_Hist_Profile_Data_30_reg).ch1_pf_v12_right;//hist_profile_data_30_reg.pf_v12;
		Profile2_V_Block_Y[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_30_RBUS,PROFILE_ICH1_Hist_Profile_Data_30_reg).ch1_pf_v13_right;//hist_profile_data_30_reg.pf_v13;
		Profile2_V_Block_Y[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_31_RBUS,PROFILE_ICH1_Hist_Profile_Data_31_reg).ch1_pf_v14_right;//hist_profile_data_31_reg.pf_v14;
		Profile2_V_Block_Y[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_31_RBUS,PROFILE_ICH1_Hist_Profile_Data_31_reg).ch1_pf_v15_right;//hist_profile_data_31_reg.pf_v15;
#else
		profile_ich1_hist_profile_data_16_RBUS data_16;
		profile_ich1_hist_profile_data_17_RBUS data_17;
		profile_ich1_hist_profile_data_18_RBUS data_18;
		profile_ich1_hist_profile_data_19_RBUS data_19;
		profile_ich1_hist_profile_data_20_RBUS data_20;
		profile_ich1_hist_profile_data_21_RBUS data_21;
		profile_ich1_hist_profile_data_22_RBUS data_22;
		profile_ich1_hist_profile_data_23_RBUS data_23;
		profile_ich1_hist_profile_data_24_RBUS data_24;
		profile_ich1_hist_profile_data_25_RBUS data_25;
		profile_ich1_hist_profile_data_26_RBUS data_26;
		profile_ich1_hist_profile_data_27_RBUS data_27;
		profile_ich1_hist_profile_data_28_RBUS data_28;
		profile_ich1_hist_profile_data_29_RBUS data_29;
		profile_ich1_hist_profile_data_30_RBUS data_30;
		profile_ich1_hist_profile_data_31_RBUS data_31;

		data_16.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_16_reg);
		data_17.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_17_reg);
		data_18.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_18_reg);
		data_19.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_19_reg);
		data_20.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_20_reg);
		data_21.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_21_reg);
		data_22.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_22_reg);
		data_23.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_23_reg);
		data_24.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_24_reg);
		data_25.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_25_reg);
		data_26.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_26_reg);
		data_27.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_27_reg);
		data_28.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_28_reg);
		data_29.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_29_reg);
		data_30.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_30_reg);
		data_31.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_31_reg);

		Profile2_H_Block_Y[0]   = data_16.ch1_pf_h00_right;
		Profile2_H_Block_Y[1]   = data_16.ch1_pf_h01_right;
		Profile2_H_Block_Y[2]   = data_17.ch1_pf_h02_right;
		Profile2_H_Block_Y[3]   = data_17.ch1_pf_h03_right;
		Profile2_H_Block_Y[4]   = data_18.ch1_pf_h04_right;
		Profile2_H_Block_Y[5]   = data_18.ch1_pf_h05_right;
		Profile2_H_Block_Y[6]   = data_19.ch1_pf_h06_right;
		Profile2_H_Block_Y[7]   = data_19.ch1_pf_h07_right;
		Profile2_H_Block_Y[8]   = data_20.ch1_pf_h08_right;
		Profile2_H_Block_Y[9]   = data_20.ch1_pf_h09_right;
		Profile2_H_Block_Y[10] = data_21.ch1_pf_h10_right;
		Profile2_H_Block_Y[11] = data_21.ch1_pf_h11_right;
		Profile2_H_Block_Y[12] = data_22.ch1_pf_h12_right;
		Profile2_H_Block_Y[13] = data_22.ch1_pf_h13_right;
		Profile2_H_Block_Y[14] = data_23.ch1_pf_h14_right;
		Profile2_H_Block_Y[15] = data_23.ch1_pf_h15_right;

		Profile2_V_Block_Y[0]   = data_24.ch1_pf_v00_right;
		Profile2_V_Block_Y[1]   = data_24.ch1_pf_v01_right;
		Profile2_V_Block_Y[2]   = data_25.ch1_pf_v02_right;
		Profile2_V_Block_Y[3]   = data_25.ch1_pf_v03_right;
		Profile2_V_Block_Y[4]   = data_26.ch1_pf_v04_right;
		Profile2_V_Block_Y[5]   = data_26.ch1_pf_v05_right;
		Profile2_V_Block_Y[6]   = data_27.ch1_pf_v06_right;
		Profile2_V_Block_Y[7]   = data_27.ch1_pf_v07_right;
		Profile2_V_Block_Y[8]   = data_28.ch1_pf_v08_right;
		Profile2_V_Block_Y[9]   = data_28.ch1_pf_v09_right;
		Profile2_V_Block_Y[10] = data_29.ch1_pf_v10_right;
		Profile2_V_Block_Y[11] = data_29.ch1_pf_v11_right;
		Profile2_V_Block_Y[12] = data_30.ch1_pf_v12_right;
		Profile2_V_Block_Y[13] = data_30.ch1_pf_v13_right;
		Profile2_V_Block_Y[14] = data_31.ch1_pf_v14_right;
		Profile2_V_Block_Y[15] = data_31.ch1_pf_v15_right;
#endif
		//Enable profile
		hist_profile2_ctrl_reg.ch1_pf2_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile_CTRL_reg, hist_profile2_ctrl_reg.regValue);

		Profile2_Y_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile2_Y_Sum += Profile2_H_Block_Y[ii];
		}
		//Profile2_Y_Sum = Profile2_Y_Sum << profsum_shift;

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%600 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile2_H_Block_Y[%d] =%d ### \n", jj, Profile2_H_Block_Y[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile2_V_Block_Y[%d] =%d ### \n", jj, Profile2_V_Block_Y[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile2_Y_Sum =%d========\n", Profile2_Y_Sum);

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}

char scalerVIP_ReadProfile2_U(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile2_ctrl_RBUS hist_profile2_ctrl_reg;

	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *Profile2_H_Block_U = &(SmartPic_clue->Profile_Cal_INFO.Profile2_H_Block_U[0]);
	unsigned short *Profile2_V_Block_U = &(SmartPic_clue->Profile_Cal_INFO.Profile2_V_Block_U[0]);

	hist_profile2_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile2_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x2;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x1;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x3;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x2;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x3;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x3;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile2_CTRL_reg, hist_profile2_ctrl_reg.regValue);

	if ( hist_profile2_ctrl_reg.ch1_pf2_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		// Get Horizontal profile data for U.
		Profile2_H_Block_U[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_16_RBUS,PROFILE_ICH1_Hist_Profile_Data_16_reg).ch1_pf_h00_right;//hist_profile_data_16_reg.pf_h00;
		Profile2_H_Block_U[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_16_RBUS,PROFILE_ICH1_Hist_Profile_Data_16_reg).ch1_pf_h01_right;//hist_profile_data_16_reg.pf_h01;
		Profile2_H_Block_U[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_17_RBUS,PROFILE_ICH1_Hist_Profile_Data_17_reg).ch1_pf_h02_right;//hist_profile_data_17_reg.pf_h02;
		Profile2_H_Block_U[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_17_RBUS,PROFILE_ICH1_Hist_Profile_Data_17_reg).ch1_pf_h03_right;//hist_profile_data_17_reg.pf_h03;
		Profile2_H_Block_U[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_18_RBUS,PROFILE_ICH1_Hist_Profile_Data_18_reg).ch1_pf_h04_right;//hist_profile_data_18_reg.pf_h04;
		Profile2_H_Block_U[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_18_RBUS,PROFILE_ICH1_Hist_Profile_Data_18_reg).ch1_pf_h05_right;//hist_profile_data_18_reg.pf_h05;
		Profile2_H_Block_U[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_19_RBUS,PROFILE_ICH1_Hist_Profile_Data_19_reg).ch1_pf_h06_right;//hist_profile_data_19_reg.pf_h06;
		Profile2_H_Block_U[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_19_RBUS,PROFILE_ICH1_Hist_Profile_Data_19_reg).ch1_pf_h07_right;//hist_profile_data_19_reg.pf_h07;
		Profile2_H_Block_U[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_20_RBUS,PROFILE_ICH1_Hist_Profile_Data_20_reg).ch1_pf_h08_right;//hist_profile_data_20_reg.pf_h08;
		Profile2_H_Block_U[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_20_RBUS,PROFILE_ICH1_Hist_Profile_Data_20_reg).ch1_pf_h09_right;//hist_profile_data_20_reg.pf_h09;
		Profile2_H_Block_U[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_21_RBUS,PROFILE_ICH1_Hist_Profile_Data_21_reg).ch1_pf_h10_right;//hist_profile_data_21_reg.pf_h10;
		Profile2_H_Block_U[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_21_RBUS,PROFILE_ICH1_Hist_Profile_Data_21_reg).ch1_pf_h11_right;//hist_profile_data_21_reg.pf_h11;
		Profile2_H_Block_U[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_22_RBUS,PROFILE_ICH1_Hist_Profile_Data_22_reg).ch1_pf_h12_right;//hist_profile_data_22_reg.pf_h12;
		Profile2_H_Block_U[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_22_RBUS,PROFILE_ICH1_Hist_Profile_Data_22_reg).ch1_pf_h13_right;//hist_profile_data_22_reg.pf_h13;
		Profile2_H_Block_U[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_23_RBUS,PROFILE_ICH1_Hist_Profile_Data_23_reg).ch1_pf_h14_right;//hist_profile_data_23_reg.pf_h14;
		Profile2_H_Block_U[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_23_RBUS,PROFILE_ICH1_Hist_Profile_Data_23_reg).ch1_pf_h15_right;//hist_profile_data_23_reg.pf_h15;

		// Get Vertical profile data for U.
		Profile2_V_Block_U[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_24_RBUS,PROFILE_ICH1_Hist_Profile_Data_24_reg).ch1_pf_v00_right;//hist_profile_data_24_reg.pf_v00;
		Profile2_V_Block_U[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_24_RBUS,PROFILE_ICH1_Hist_Profile_Data_24_reg).ch1_pf_v01_right;//hist_profile_data_24_reg.pf_v01;
		Profile2_V_Block_U[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_25_RBUS,PROFILE_ICH1_Hist_Profile_Data_25_reg).ch1_pf_v02_right;//hist_profile_data_25_reg.pf_v02;
		Profile2_V_Block_U[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_25_RBUS,PROFILE_ICH1_Hist_Profile_Data_25_reg).ch1_pf_v03_right;//hist_profile_data_25_reg.pf_v03;
		Profile2_V_Block_U[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_26_RBUS,PROFILE_ICH1_Hist_Profile_Data_26_reg).ch1_pf_v04_right;//hist_profile_data_26_reg.pf_v04;
		Profile2_V_Block_U[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_26_RBUS,PROFILE_ICH1_Hist_Profile_Data_26_reg).ch1_pf_v05_right;//hist_profile_data_26_reg.pf_v05;
		Profile2_V_Block_U[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_27_RBUS,PROFILE_ICH1_Hist_Profile_Data_27_reg).ch1_pf_v06_right;//hist_profile_data_27_reg.pf_v06;
		Profile2_V_Block_U[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_27_RBUS,PROFILE_ICH1_Hist_Profile_Data_27_reg).ch1_pf_v07_right;//hist_profile_data_27_reg.pf_v07;
		Profile2_V_Block_U[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_28_RBUS,PROFILE_ICH1_Hist_Profile_Data_28_reg).ch1_pf_v08_right;//hist_profile_data_28_reg.pf_v08;
		Profile2_V_Block_U[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_28_RBUS,PROFILE_ICH1_Hist_Profile_Data_28_reg).ch1_pf_v09_right;//hist_profile_data_28_reg.pf_v09;
		Profile2_V_Block_U[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_29_RBUS,PROFILE_ICH1_Hist_Profile_Data_29_reg).ch1_pf_v10_right;//hist_profile_data_29_reg.pf_v10;
		Profile2_V_Block_U[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_29_RBUS,PROFILE_ICH1_Hist_Profile_Data_29_reg).ch1_pf_v11_right;//hist_profile_data_29_reg.pf_v11;
		Profile2_V_Block_U[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_30_RBUS,PROFILE_ICH1_Hist_Profile_Data_30_reg).ch1_pf_v12_right;//hist_profile_data_30_reg.pf_v12;
		Profile2_V_Block_U[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_30_RBUS,PROFILE_ICH1_Hist_Profile_Data_30_reg).ch1_pf_v13_right;//hist_profile_data_30_reg.pf_v13;
		Profile2_V_Block_U[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_31_RBUS,PROFILE_ICH1_Hist_Profile_Data_31_reg).ch1_pf_v14_right;//hist_profile_data_31_reg.pf_v14;
		Profile2_V_Block_U[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_31_RBUS,PROFILE_ICH1_Hist_Profile_Data_31_reg).ch1_pf_v15_right;//hist_profile_data_31_reg.pf_v15;
#else
		profile_ich1_hist_profile_data_16_RBUS data_16;
		profile_ich1_hist_profile_data_17_RBUS data_17;
		profile_ich1_hist_profile_data_18_RBUS data_18;
		profile_ich1_hist_profile_data_19_RBUS data_19;
		profile_ich1_hist_profile_data_20_RBUS data_20;
		profile_ich1_hist_profile_data_21_RBUS data_21;
		profile_ich1_hist_profile_data_22_RBUS data_22;
		profile_ich1_hist_profile_data_23_RBUS data_23;
		profile_ich1_hist_profile_data_24_RBUS data_24;
		profile_ich1_hist_profile_data_25_RBUS data_25;
		profile_ich1_hist_profile_data_26_RBUS data_26;
		profile_ich1_hist_profile_data_27_RBUS data_27;
		profile_ich1_hist_profile_data_28_RBUS data_28;
		profile_ich1_hist_profile_data_29_RBUS data_29;
		profile_ich1_hist_profile_data_30_RBUS data_30;
		profile_ich1_hist_profile_data_31_RBUS data_31;

		data_16.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_16_reg);
		data_17.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_17_reg);
		data_18.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_18_reg);
		data_19.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_19_reg);
		data_20.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_20_reg);
		data_21.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_21_reg);
		data_22.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_22_reg);
		data_23.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_23_reg);
		data_24.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_24_reg);
		data_25.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_25_reg);
		data_26.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_26_reg);
		data_27.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_27_reg);
		data_28.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_28_reg);
		data_29.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_29_reg);
		data_30.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_30_reg);
		data_31.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_31_reg);

		// Get Horizontal profile data for U.
		Profile2_H_Block_U[0]   = data_16.ch1_pf_h00_right;
		Profile2_H_Block_U[1]   = data_16.ch1_pf_h01_right;
		Profile2_H_Block_U[2]   = data_17.ch1_pf_h02_right;
		Profile2_H_Block_U[3]   = data_17.ch1_pf_h03_right;
		Profile2_H_Block_U[4]   = data_18.ch1_pf_h04_right;
		Profile2_H_Block_U[5]   = data_18.ch1_pf_h05_right;
		Profile2_H_Block_U[6]   = data_19.ch1_pf_h06_right;
		Profile2_H_Block_U[7]   = data_19.ch1_pf_h07_right;
		Profile2_H_Block_U[8]   = data_20.ch1_pf_h08_right;
		Profile2_H_Block_U[9]   = data_20.ch1_pf_h09_right;
		Profile2_H_Block_U[10] = data_21.ch1_pf_h10_right;
		Profile2_H_Block_U[11] = data_21.ch1_pf_h11_right;
		Profile2_H_Block_U[12] = data_22.ch1_pf_h12_right;
		Profile2_H_Block_U[13] = data_22.ch1_pf_h13_right;
		Profile2_H_Block_U[14] = data_23.ch1_pf_h14_right;
		Profile2_H_Block_U[15] = data_23.ch1_pf_h15_right;

		// Get Vertical profile data for U.
		Profile2_V_Block_U[0]   = data_24.ch1_pf_v00_right;
		Profile2_V_Block_U[1]   = data_24.ch1_pf_v01_right;
		Profile2_V_Block_U[2]   = data_25.ch1_pf_v02_right;
		Profile2_V_Block_U[3]   = data_25.ch1_pf_v03_right;
		Profile2_V_Block_U[4]   = data_26.ch1_pf_v04_right;
		Profile2_V_Block_U[5]   = data_26.ch1_pf_v05_right;
		Profile2_V_Block_U[6]   = data_27.ch1_pf_v06_right;
		Profile2_V_Block_U[7]   = data_27.ch1_pf_v07_right;
		Profile2_V_Block_U[8]   = data_28.ch1_pf_v08_right;
		Profile2_V_Block_U[9]   = data_28.ch1_pf_v09_right;
		Profile2_V_Block_U[10] = data_29.ch1_pf_v10_right;
		Profile2_V_Block_U[11] = data_29.ch1_pf_v11_right;
		Profile2_V_Block_U[12] = data_30.ch1_pf_v12_right;
		Profile2_V_Block_U[13] = data_30.ch1_pf_v13_right;
		Profile2_V_Block_U[14] = data_31.ch1_pf_v14_right;
		Profile2_V_Block_U[15] = data_31.ch1_pf_v15_right;
#endif

		//Enable profile
		hist_profile2_ctrl_reg.ch1_pf2_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile2_CTRL_reg, hist_profile2_ctrl_reg.regValue);

		Profile2_U_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile2_U_Sum += Profile2_H_Block_U[ii];
		}
		//Profile2_U_Sum = Profile2_U_Sum << profsum_shift;

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%600 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile2_H_Block_U[%d] =%d ### \n", jj, Profile2_H_Block_U[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile2_V_Block_U[%d] =%d ### \n", jj, Profile2_V_Block_U[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile2_U_Sum =%d========\n", Profile2_U_Sum);

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}


char scalerVIP_ReadProfile2_V(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile2_ctrl_RBUS hist_profile2_ctrl_reg;

	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *Profile2_H_Block_V = &(SmartPic_clue->Profile_Cal_INFO.Profile2_H_Block_V[0]);
	unsigned short *Profile2_V_Block_V = &(SmartPic_clue->Profile_Cal_INFO.Profile2_V_Block_V[0]);

	hist_profile2_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile2_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x2;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x1;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x3;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x2;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile2_ctrl_reg.ch1_pf2_hnsr = 0x3;
			hist_profile2_ctrl_reg.ch1_pf2_vnsr = 0x3;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile2_CTRL_reg, hist_profile2_ctrl_reg.regValue);

	if ( hist_profile2_ctrl_reg.ch1_pf2_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		// Get Horizontal profile data for U.
		Profile2_H_Block_V[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_16_RBUS,PROFILE_ICH1_Hist_Profile_Data_16_reg).ch1_pf_h00_right;//hist_profile_data_16_reg.pf_h00;
		Profile2_H_Block_V[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_16_RBUS,PROFILE_ICH1_Hist_Profile_Data_16_reg).ch1_pf_h01_right;//hist_profile_data_16_reg.pf_h01;
		Profile2_H_Block_V[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_17_RBUS,PROFILE_ICH1_Hist_Profile_Data_17_reg).ch1_pf_h02_right;//hist_profile_data_17_reg.pf_h02;
		Profile2_H_Block_V[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_17_RBUS,PROFILE_ICH1_Hist_Profile_Data_17_reg).ch1_pf_h03_right;//hist_profile_data_17_reg.pf_h03;
		Profile2_H_Block_V[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_18_RBUS,PROFILE_ICH1_Hist_Profile_Data_18_reg).ch1_pf_h04_right;//hist_profile_data_18_reg.pf_h04;
		Profile2_H_Block_V[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_18_RBUS,PROFILE_ICH1_Hist_Profile_Data_18_reg).ch1_pf_h05_right;//hist_profile_data_18_reg.pf_h05;
		Profile2_H_Block_V[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_19_RBUS,PROFILE_ICH1_Hist_Profile_Data_19_reg).ch1_pf_h06_right;//hist_profile_data_19_reg.pf_h06;
		Profile2_H_Block_V[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_19_RBUS,PROFILE_ICH1_Hist_Profile_Data_19_reg).ch1_pf_h07_right;//hist_profile_data_19_reg.pf_h07;
		Profile2_H_Block_V[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_20_RBUS,PROFILE_ICH1_Hist_Profile_Data_20_reg).ch1_pf_h08_right;//hist_profile_data_20_reg.pf_h08;
		Profile2_H_Block_V[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_20_RBUS,PROFILE_ICH1_Hist_Profile_Data_20_reg).ch1_pf_h09_right;//hist_profile_data_20_reg.pf_h09;
		Profile2_H_Block_V[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_21_RBUS,PROFILE_ICH1_Hist_Profile_Data_21_reg).ch1_pf_h10_right;//hist_profile_data_21_reg.pf_h10;
		Profile2_H_Block_V[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_21_RBUS,PROFILE_ICH1_Hist_Profile_Data_21_reg).ch1_pf_h11_right;//hist_profile_data_21_reg.pf_h11;
		Profile2_H_Block_V[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_22_RBUS,PROFILE_ICH1_Hist_Profile_Data_22_reg).ch1_pf_h12_right;//hist_profile_data_22_reg.pf_h12;
		Profile2_H_Block_V[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_22_RBUS,PROFILE_ICH1_Hist_Profile_Data_22_reg).ch1_pf_h13_right;//hist_profile_data_22_reg.pf_h13;
		Profile2_H_Block_V[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_23_RBUS,PROFILE_ICH1_Hist_Profile_Data_23_reg).ch1_pf_h14_right;//hist_profile_data_23_reg.pf_h14;
		Profile2_H_Block_V[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_23_RBUS,PROFILE_ICH1_Hist_Profile_Data_23_reg).ch1_pf_h15_right;//hist_profile_data_23_reg.pf_h15;

		// Get Vertical profile data for U.
		Profile2_V_Block_V[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_24_RBUS,PROFILE_ICH1_Hist_Profile_Data_24_reg).ch1_pf_v00_right;//hist_profile_data_24_reg.pf_v00;
		Profile2_V_Block_V[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_24_RBUS,PROFILE_ICH1_Hist_Profile_Data_24_reg).ch1_pf_v01_right;//hist_profile_data_24_reg.pf_v01;
		Profile2_V_Block_V[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_25_RBUS,PROFILE_ICH1_Hist_Profile_Data_25_reg).ch1_pf_v02_right;//hist_profile_data_25_reg.pf_v02;
		Profile2_V_Block_V[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_25_RBUS,PROFILE_ICH1_Hist_Profile_Data_25_reg).ch1_pf_v03_right;//hist_profile_data_25_reg.pf_v03;
		Profile2_V_Block_V[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_26_RBUS,PROFILE_ICH1_Hist_Profile_Data_26_reg).ch1_pf_v04_right;//hist_profile_data_26_reg.pf_v04;
		Profile2_V_Block_V[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_26_RBUS,PROFILE_ICH1_Hist_Profile_Data_26_reg).ch1_pf_v05_right;//hist_profile_data_26_reg.pf_v05;
		Profile2_V_Block_V[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_27_RBUS,PROFILE_ICH1_Hist_Profile_Data_27_reg).ch1_pf_v06_right;//hist_profile_data_27_reg.pf_v06;
		Profile2_V_Block_V[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_27_RBUS,PROFILE_ICH1_Hist_Profile_Data_27_reg).ch1_pf_v07_right;//hist_profile_data_27_reg.pf_v07;
		Profile2_V_Block_V[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_28_RBUS,PROFILE_ICH1_Hist_Profile_Data_28_reg).ch1_pf_v08_right;//hist_profile_data_28_reg.pf_v08;
		Profile2_V_Block_V[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile_data_28_RBUS,PROFILE_ICH1_Hist_Profile_Data_28_reg).ch1_pf_v09_right;//hist_profile_data_28_reg.pf_v09;
		Profile2_V_Block_V[10] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_29_RBUS,PROFILE_ICH1_Hist_Profile_Data_29_reg).ch1_pf_v10_right;//hist_profile_data_29_reg.pf_v10;
		Profile2_V_Block_V[11] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_29_RBUS,PROFILE_ICH1_Hist_Profile_Data_29_reg).ch1_pf_v11_right;//hist_profile_data_29_reg.pf_v11;
		Profile2_V_Block_V[12] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_30_RBUS,PROFILE_ICH1_Hist_Profile_Data_30_reg).ch1_pf_v12_right;//hist_profile_data_30_reg.pf_v12;
		Profile2_V_Block_V[13] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_30_RBUS,PROFILE_ICH1_Hist_Profile_Data_30_reg).ch1_pf_v13_right;//hist_profile_data_30_reg.pf_v13;
		Profile2_V_Block_V[14] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_31_RBUS,PROFILE_ICH1_Hist_Profile_Data_31_reg).ch1_pf_v14_right;//hist_profile_data_31_reg.pf_v14;
		Profile2_V_Block_V[15] = scaler_rtd_t_inl(profile_ich1_hist_profile_data_31_RBUS,PROFILE_ICH1_Hist_Profile_Data_31_reg).ch1_pf_v15_right;//hist_profile_data_31_reg.pf_v15;
#else
		profile_ich1_hist_profile_data_16_RBUS data_16;
		profile_ich1_hist_profile_data_17_RBUS data_17;
		profile_ich1_hist_profile_data_18_RBUS data_18;
		profile_ich1_hist_profile_data_19_RBUS data_19;
		profile_ich1_hist_profile_data_20_RBUS data_20;
		profile_ich1_hist_profile_data_21_RBUS data_21;
		profile_ich1_hist_profile_data_22_RBUS data_22;
		profile_ich1_hist_profile_data_23_RBUS data_23;
		profile_ich1_hist_profile_data_24_RBUS data_24;
		profile_ich1_hist_profile_data_25_RBUS data_25;
		profile_ich1_hist_profile_data_26_RBUS data_26;
		profile_ich1_hist_profile_data_27_RBUS data_27;
		profile_ich1_hist_profile_data_28_RBUS data_28;
		profile_ich1_hist_profile_data_29_RBUS data_29;
		profile_ich1_hist_profile_data_30_RBUS data_30;
		profile_ich1_hist_profile_data_31_RBUS data_31;

		data_16.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_16_reg);
		data_17.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_17_reg);
		data_18.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_18_reg);
		data_19.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_19_reg);
		data_20.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_20_reg);
		data_21.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_21_reg);
		data_22.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_22_reg);
		data_23.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_23_reg);
		data_24.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_24_reg);
		data_25.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_25_reg);
		data_26.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_26_reg);
		data_27.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_27_reg);
		data_28.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_28_reg);
		data_29.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_29_reg);
		data_30.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_30_reg);
		data_31.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_Data_31_reg);

		// Get Horizontal profile data for U.
		Profile2_H_Block_V[0]   = data_16.ch1_pf_h00_right;
		Profile2_H_Block_V[1]   = data_16.ch1_pf_h01_right;
		Profile2_H_Block_V[2]   = data_17.ch1_pf_h02_right;
		Profile2_H_Block_V[3]   = data_17.ch1_pf_h03_right;
		Profile2_H_Block_V[4]   = data_18.ch1_pf_h04_right;
		Profile2_H_Block_V[5]   = data_18.ch1_pf_h05_right;
		Profile2_H_Block_V[6]   = data_19.ch1_pf_h06_right;
		Profile2_H_Block_V[7]   = data_19.ch1_pf_h07_right;
		Profile2_H_Block_V[8]   = data_20.ch1_pf_h08_right;
		Profile2_H_Block_V[9]   = data_20.ch1_pf_h09_right;
		Profile2_H_Block_V[10] = data_21.ch1_pf_h10_right;
		Profile2_H_Block_V[11] = data_21.ch1_pf_h11_right;
		Profile2_H_Block_V[12] = data_22.ch1_pf_h12_right;
		Profile2_H_Block_V[13] = data_22.ch1_pf_h13_right;
		Profile2_H_Block_V[14] = data_23.ch1_pf_h14_right;
		Profile2_H_Block_V[15] = data_23.ch1_pf_h15_right;

		// Get Vertical profile data for U.
		Profile2_V_Block_V[0]   = data_24.ch1_pf_v00_right;
		Profile2_V_Block_V[1]   = data_24.ch1_pf_v01_right;
		Profile2_V_Block_V[2]   = data_25.ch1_pf_v02_right;
		Profile2_V_Block_V[3]   = data_25.ch1_pf_v03_right;
		Profile2_V_Block_V[4]   = data_26.ch1_pf_v04_right;
		Profile2_V_Block_V[5]   = data_26.ch1_pf_v05_right;
		Profile2_V_Block_V[6]   = data_27.ch1_pf_v06_right;
		Profile2_V_Block_V[7]   = data_27.ch1_pf_v07_right;
		Profile2_V_Block_V[8]   = data_28.ch1_pf_v08_right;
		Profile2_V_Block_V[9]   = data_28.ch1_pf_v09_right;
		Profile2_V_Block_V[10] = data_29.ch1_pf_v10_right;
		Profile2_V_Block_V[11] = data_29.ch1_pf_v11_right;
		Profile2_V_Block_V[12] = data_30.ch1_pf_v12_right;
		Profile2_V_Block_V[13] = data_30.ch1_pf_v13_right;
		Profile2_V_Block_V[14] = data_31.ch1_pf_v14_right;
		Profile2_V_Block_V[15] = data_31.ch1_pf_v15_right;
#endif
		//Enable profile
		hist_profile2_ctrl_reg.ch1_pf2_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile2_CTRL_reg, hist_profile2_ctrl_reg.regValue);

		Profile2_V_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile2_V_Sum += Profile2_H_Block_V[ii];
		}
		//Profile2_V_Sum = Profile2_V_Sum << profsum_shift;

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%600 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile2_H_Block_V[%d] =%d ### \n", jj, Profile2_H_Block_V[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile2_V_Block_V[%d] =%d ### \n", jj, Profile2_V_Block_V[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile2_V_Sum =%d========\n", Profile2_V_Sum );

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}

char scalerVIP_ReadProfile3_Y(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile3_ctrl_RBUS hist_profile3_ctrl_reg;

	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *Profile3_H_Block_Y = &(SmartPic_clue->Profile_Cal_INFO.Profile3_H_Block_Y[0]);
	unsigned short *Profile3_V_Block_Y = &(SmartPic_clue->Profile_Cal_INFO.Profile3_V_Block_Y[0]);

	hist_profile3_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile3_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x2;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x1;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x3;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x2;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x3;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x3;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_CTRL_reg, hist_profile3_ctrl_reg.regValue);

	if ( hist_profile3_ctrl_reg.ch1_pf3_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		// Get Horizontal profile data for V.
		Profile3_H_Block_Y[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_00_RBUS,PROFILE_ICH1_Hist_Profile3_Data_00_reg).ch1_pf3_h00;//hist_profile3_data_00_reg.pf_h00;
		Profile3_H_Block_Y[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_00_RBUS,PROFILE_ICH1_Hist_Profile3_Data_00_reg).ch1_pf3_h01;//hist_profile3_data_00_reg.pf_h01;
		Profile3_H_Block_Y[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_01_RBUS,PROFILE_ICH1_Hist_Profile3_Data_01_reg).ch1_pf3_h02;//hist_profile3_data_01_reg.pf_h02;
		Profile3_H_Block_Y[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_01_RBUS,PROFILE_ICH1_Hist_Profile3_Data_01_reg).ch1_pf3_h03;//hist_profile3_data_01_reg.pf_h03;
		Profile3_H_Block_Y[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_02_RBUS,PROFILE_ICH1_Hist_Profile3_Data_02_reg).ch1_pf3_h04;//hist_profile3_data_02_reg.pf_h04;
		Profile3_H_Block_Y[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_02_RBUS,PROFILE_ICH1_Hist_Profile3_Data_02_reg).ch1_pf3_h05;//hist_profile3_data_02_reg.pf_h05;
		Profile3_H_Block_Y[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_03_RBUS,PROFILE_ICH1_Hist_Profile3_Data_03_reg).ch1_pf3_h06;//hist_profile3_data_03_reg.pf_h06;
		Profile3_H_Block_Y[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_03_RBUS,PROFILE_ICH1_Hist_Profile3_Data_03_reg).ch1_pf3_h07;//hist_profile3_data_03_reg.pf_h07;
		Profile3_H_Block_Y[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_04_RBUS,PROFILE_ICH1_Hist_Profile3_Data_04_reg).ch1_pf3_h08;//hist_profile3_data_04_reg.pf_h08;
		Profile3_H_Block_Y[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_04_RBUS,PROFILE_ICH1_Hist_Profile3_Data_04_reg).ch1_pf3_h09;//hist_profile3_data_04_reg.pf_h09;
		Profile3_H_Block_Y[10] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_05_RBUS,PROFILE_ICH1_Hist_Profile3_Data_05_reg).ch1_pf3_h10;//hist_profile3_data_05_reg.pf_h10;
		Profile3_H_Block_Y[11] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_05_RBUS,PROFILE_ICH1_Hist_Profile3_Data_05_reg).ch1_pf3_h11;//hist_profile3_data_05_reg.pf_h11;
		Profile3_H_Block_Y[12] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_06_RBUS,PROFILE_ICH1_Hist_Profile3_Data_06_reg).ch1_pf3_h12;//hist_profile3_data_06_reg.pf_h12;
		Profile3_H_Block_Y[13] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_06_RBUS,PROFILE_ICH1_Hist_Profile3_Data_06_reg).ch1_pf3_h13;//hist_profile3_data_06_reg.pf_h13;
		Profile3_H_Block_Y[14] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_07_RBUS,PROFILE_ICH1_Hist_Profile3_Data_07_reg).ch1_pf3_h14;//hist_profile3_data_07_reg.pf_h14;
		Profile3_H_Block_Y[15] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_07_RBUS,PROFILE_ICH1_Hist_Profile3_Data_07_reg).ch1_pf3_h15;//hist_profile3_data_07_reg.pf_h15;

		// Get Vertical profile data for V.
		Profile3_V_Block_Y[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_08_RBUS,PROFILE_ICH1_Hist_Profile3_Data_08_reg).ch1_pf3_v00;//hist_profile3_data_08_reg.pf_v00;
		Profile3_V_Block_Y[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_08_RBUS,PROFILE_ICH1_Hist_Profile3_Data_08_reg).ch1_pf3_v01;//hist_profile3_data_08_reg.pf_v01;
		Profile3_V_Block_Y[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_09_RBUS,PROFILE_ICH1_Hist_Profile3_Data_09_reg).ch1_pf3_v02;//hist_profile3_data_09_reg.pf_v02;
		Profile3_V_Block_Y[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_09_RBUS,PROFILE_ICH1_Hist_Profile3_Data_09_reg).ch1_pf3_v03;//hist_profile3_data_09_reg.pf_v03;
		Profile3_V_Block_Y[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_10_RBUS,PROFILE_ICH1_Hist_Profile3_Data_10_reg).ch1_pf3_v04;//hist_profile3_data_10_reg.pf_v04;
		Profile3_V_Block_Y[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_10_RBUS,PROFILE_ICH1_Hist_Profile3_Data_10_reg).ch1_pf3_v05;//hist_profile3_data_10_reg.pf_v05;
		Profile3_V_Block_Y[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_11_RBUS,PROFILE_ICH1_Hist_Profile3_Data_11_reg).ch1_pf3_v06;//hist_profile3_data_11_reg.pf_v06;
		Profile3_V_Block_Y[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_11_RBUS,PROFILE_ICH1_Hist_Profile3_Data_11_reg).ch1_pf3_v07;//hist_profile3_data_11_reg.pf_v07;
		Profile3_V_Block_Y[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_12_RBUS,PROFILE_ICH1_Hist_Profile3_Data_12_reg).ch1_pf3_v08;//hist_profile3_data_12_reg.pf_v08;
		Profile3_V_Block_Y[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_12_RBUS,PROFILE_ICH1_Hist_Profile3_Data_12_reg).ch1_pf3_v09;//hist_profile3_data_12_reg.pf_v09;
		Profile3_V_Block_Y[10] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_13_RBUS,PROFILE_ICH1_Hist_Profile3_Data_13_reg).ch1_pf3_v10;//hist_profile3_data_13_reg.pf_v10;
		Profile3_V_Block_Y[11] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_13_RBUS,PROFILE_ICH1_Hist_Profile3_Data_13_reg).ch1_pf3_v11;//hist_profile3_data_13_reg.pf_v11;
		Profile3_V_Block_Y[12] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_14_RBUS,PROFILE_ICH1_Hist_Profile3_Data_14_reg).ch1_pf3_v12;//hist_profile3_data_14_reg.pf_v12;
		Profile3_V_Block_Y[13] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_14_RBUS,PROFILE_ICH1_Hist_Profile3_Data_14_reg).ch1_pf3_v13;//hist_profile3_data_14_reg.pf_v13;
		Profile3_V_Block_Y[14] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_15_RBUS,PROFILE_ICH1_Hist_Profile3_Data_15_reg).ch1_pf3_v14;//hist_profile3_data_15_reg.pf_v14;
		Profile3_V_Block_Y[15] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_15_RBUS,PROFILE_ICH1_Hist_Profile3_Data_15_reg).ch1_pf3_v15;//hist_profile3_data_15_reg.pf_v15;
#else
		profile_ich1_hist_profile3_data_00_RBUS data_00;
		profile_ich1_hist_profile3_data_01_RBUS data_01;
		profile_ich1_hist_profile3_data_02_RBUS data_02;
		profile_ich1_hist_profile3_data_03_RBUS data_03;
		profile_ich1_hist_profile3_data_04_RBUS data_04;
		profile_ich1_hist_profile3_data_05_RBUS data_05;
		profile_ich1_hist_profile3_data_06_RBUS data_06;
		profile_ich1_hist_profile3_data_07_RBUS data_07;
		profile_ich1_hist_profile3_data_08_RBUS data_08;
		profile_ich1_hist_profile3_data_09_RBUS data_09;
		profile_ich1_hist_profile3_data_10_RBUS data_10;
		profile_ich1_hist_profile3_data_11_RBUS data_11;
		profile_ich1_hist_profile3_data_12_RBUS data_12;
		profile_ich1_hist_profile3_data_13_RBUS data_13;
		profile_ich1_hist_profile3_data_14_RBUS data_14;
		profile_ich1_hist_profile3_data_15_RBUS data_15;

		data_00.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_00_reg);
		data_01.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_01_reg);
		data_02.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_02_reg);
		data_03.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_03_reg);
		data_04.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_04_reg);
		data_05.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_05_reg);
		data_06.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_06_reg);
		data_07.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_07_reg);
		data_08.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_08_reg);
		data_09.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_09_reg);
		data_10.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_10_reg);
		data_11.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_11_reg);
		data_12.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_12_reg);
		data_13.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_13_reg);
		data_14.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_14_reg);
		data_15.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_15_reg);

		// Get Horizontal profile data for V.
		Profile3_H_Block_Y[0]   = data_00.ch1_pf3_h00;
		Profile3_H_Block_Y[1]   = data_00.ch1_pf3_h01;
		Profile3_H_Block_Y[2]   = data_01.ch1_pf3_h02;
		Profile3_H_Block_Y[3]   = data_01.ch1_pf3_h03;
		Profile3_H_Block_Y[4]   = data_02.ch1_pf3_h04;
		Profile3_H_Block_Y[5]   = data_02.ch1_pf3_h05;
		Profile3_H_Block_Y[6]   = data_03.ch1_pf3_h06;
		Profile3_H_Block_Y[7]   = data_03.ch1_pf3_h07;
		Profile3_H_Block_Y[8]   = data_04.ch1_pf3_h08;
		Profile3_H_Block_Y[9]   = data_04.ch1_pf3_h09;
		Profile3_H_Block_Y[10] = data_05.ch1_pf3_h10;
		Profile3_H_Block_Y[11] = data_05.ch1_pf3_h11;
		Profile3_H_Block_Y[12] = data_06.ch1_pf3_h12;
		Profile3_H_Block_Y[13] = data_06.ch1_pf3_h13;
		Profile3_H_Block_Y[14] = data_07.ch1_pf3_h14;
		Profile3_H_Block_Y[15] = data_07.ch1_pf3_h15;

		// Get Vertical profile data for V.
		Profile3_V_Block_Y[0]   = data_08.ch1_pf3_v00;
		Profile3_V_Block_Y[1]   = data_08.ch1_pf3_v01;
		Profile3_V_Block_Y[2]   = data_09.ch1_pf3_v02;
		Profile3_V_Block_Y[3]   = data_09.ch1_pf3_v03;
		Profile3_V_Block_Y[4]   = data_10.ch1_pf3_v04;
		Profile3_V_Block_Y[5]   = data_10.ch1_pf3_v05;
		Profile3_V_Block_Y[6]   = data_11.ch1_pf3_v06;
		Profile3_V_Block_Y[7]   = data_11.ch1_pf3_v07;
		Profile3_V_Block_Y[8]   = data_12.ch1_pf3_v08;
		Profile3_V_Block_Y[9]   = data_12.ch1_pf3_v09;
		Profile3_V_Block_Y[10] = data_13.ch1_pf3_v10;
		Profile3_V_Block_Y[11] = data_13.ch1_pf3_v11;
		Profile3_V_Block_Y[12] = data_14.ch1_pf3_v12;
		Profile3_V_Block_Y[13] = data_14.ch1_pf3_v13;
		Profile3_V_Block_Y[14] = data_15.ch1_pf3_v14;
		Profile3_V_Block_Y[15] = data_15.ch1_pf3_v15;
#endif
		//Enable profile
		hist_profile3_ctrl_reg.ch1_pf3_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_CTRL_reg, hist_profile3_ctrl_reg.regValue);

		Profile3_Y_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile3_Y_Sum += Profile3_H_Block_Y[ii];
		}
		//Profile3_Y_Sum = Profile3_Y_Sum << profsum_shift;

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%700 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile3_H_Block_Y[%d] =%d ### \n", jj, Profile3_H_Block_Y[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile3_V_Block_Y[%d] =%d ### \n", jj, Profile3_V_Block_Y[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile3_Y_Sum =%d========\n", Profile3_Y_Sum);

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}

char scalerVIP_ReadProfile3_U(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile3_ctrl_RBUS hist_profile3_ctrl_reg;

	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *Profile3_H_Block_U = &(SmartPic_clue->Profile_Cal_INFO.Profile3_H_Block_U[0]);
	unsigned short *Profile3_V_Block_U = &(SmartPic_clue->Profile_Cal_INFO.Profile3_V_Block_U[0]);

	hist_profile3_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile3_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x2;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x1;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x3;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x2;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x3;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x3;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_CTRL_reg, hist_profile3_ctrl_reg.regValue);

	if ( hist_profile3_ctrl_reg.ch1_pf3_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		// Get Horizontal profile data for U.
		Profile3_H_Block_U[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_00_RBUS,PROFILE_ICH1_Hist_Profile3_Data_00_reg).ch1_pf3_h00;//hist_profile3_data_00_reg.pf_h00;
		Profile3_H_Block_U[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_00_RBUS,PROFILE_ICH1_Hist_Profile3_Data_00_reg).ch1_pf3_h01;//hist_profile3_data_00_reg.pf_h01;
		Profile3_H_Block_U[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_01_RBUS,PROFILE_ICH1_Hist_Profile3_Data_01_reg).ch1_pf3_h02;//hist_profile3_data_01_reg.pf_h02;
		Profile3_H_Block_U[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_01_RBUS,PROFILE_ICH1_Hist_Profile3_Data_01_reg).ch1_pf3_h03;//hist_profile3_data_01_reg.pf_h03;
		Profile3_H_Block_U[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_02_RBUS,PROFILE_ICH1_Hist_Profile3_Data_02_reg).ch1_pf3_h04;//hist_profile3_data_02_reg.pf_h04;
		Profile3_H_Block_U[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_02_RBUS,PROFILE_ICH1_Hist_Profile3_Data_02_reg).ch1_pf3_h05;//hist_profile3_data_02_reg.pf_h05;
		Profile3_H_Block_U[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_03_RBUS,PROFILE_ICH1_Hist_Profile3_Data_03_reg).ch1_pf3_h06;//hist_profile3_data_03_reg.pf_h06;
		Profile3_H_Block_U[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_03_RBUS,PROFILE_ICH1_Hist_Profile3_Data_03_reg).ch1_pf3_h07;//hist_profile3_data_03_reg.pf_h07;
		Profile3_H_Block_U[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_04_RBUS,PROFILE_ICH1_Hist_Profile3_Data_04_reg).ch1_pf3_h08;//hist_profile3_data_04_reg.pf_h08;
		Profile3_H_Block_U[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_04_RBUS,PROFILE_ICH1_Hist_Profile3_Data_04_reg).ch1_pf3_h09;//hist_profile3_data_04_reg.pf_h09;
		Profile3_H_Block_U[10] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_05_RBUS,PROFILE_ICH1_Hist_Profile3_Data_05_reg).ch1_pf3_h10;//hist_profile3_data_05_reg.pf_h10;
		Profile3_H_Block_U[11] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_05_RBUS,PROFILE_ICH1_Hist_Profile3_Data_05_reg).ch1_pf3_h11;//hist_profile3_data_05_reg.pf_h11;
		Profile3_H_Block_U[12] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_06_RBUS,PROFILE_ICH1_Hist_Profile3_Data_06_reg).ch1_pf3_h12;//hist_profile3_data_06_reg.pf_h12;
		Profile3_H_Block_U[13] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_06_RBUS,PROFILE_ICH1_Hist_Profile3_Data_06_reg).ch1_pf3_h13;//hist_profile3_data_06_reg.pf_h13;
		Profile3_H_Block_U[14] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_07_RBUS,PROFILE_ICH1_Hist_Profile3_Data_07_reg).ch1_pf3_h14;//hist_profile3_data_07_reg.pf_h14;
		Profile3_H_Block_U[15] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_07_RBUS,PROFILE_ICH1_Hist_Profile3_Data_07_reg).ch1_pf3_h15;//hist_profile3_data_07_reg.pf_h15;

		// Get Vertical profile data for U.
		Profile3_V_Block_U[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_08_RBUS,PROFILE_ICH1_Hist_Profile3_Data_08_reg).ch1_pf3_v00;//hist_profile3_data_08_reg.pf_v00;
		Profile3_V_Block_U[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_08_RBUS,PROFILE_ICH1_Hist_Profile3_Data_08_reg).ch1_pf3_v01;//hist_profile3_data_08_reg.pf_v01;
		Profile3_V_Block_U[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_09_RBUS,PROFILE_ICH1_Hist_Profile3_Data_09_reg).ch1_pf3_v02;//hist_profile3_data_09_reg.pf_v02;
		Profile3_V_Block_U[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_09_RBUS,PROFILE_ICH1_Hist_Profile3_Data_09_reg).ch1_pf3_v03;//hist_profile3_data_09_reg.pf_v03;
		Profile3_V_Block_U[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_10_RBUS,PROFILE_ICH1_Hist_Profile3_Data_10_reg).ch1_pf3_v04;//hist_profile3_data_10_reg.pf_v04;
		Profile3_V_Block_U[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_10_RBUS,PROFILE_ICH1_Hist_Profile3_Data_10_reg).ch1_pf3_v05;//hist_profile3_data_10_reg.pf_v05;
		Profile3_V_Block_U[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_11_RBUS,PROFILE_ICH1_Hist_Profile3_Data_11_reg).ch1_pf3_v06;//hist_profile3_data_11_reg.pf_v06;
		Profile3_V_Block_U[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_11_RBUS,PROFILE_ICH1_Hist_Profile3_Data_11_reg).ch1_pf3_v07;//hist_profile3_data_11_reg.pf_v07;
		Profile3_V_Block_U[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_12_RBUS,PROFILE_ICH1_Hist_Profile3_Data_12_reg).ch1_pf3_v08;//hist_profile3_data_12_reg.pf_v08;
		Profile3_V_Block_U[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_12_RBUS,PROFILE_ICH1_Hist_Profile3_Data_12_reg).ch1_pf3_v09;//hist_profile3_data_12_reg.pf_v09;
		Profile3_V_Block_U[10] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_13_RBUS,PROFILE_ICH1_Hist_Profile3_Data_13_reg).ch1_pf3_v10;//hist_profile3_data_13_reg.pf_v10;
		Profile3_V_Block_U[11] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_13_RBUS,PROFILE_ICH1_Hist_Profile3_Data_13_reg).ch1_pf3_v11;//hist_profile3_data_13_reg.pf_v11;
		Profile3_V_Block_U[12] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_14_RBUS,PROFILE_ICH1_Hist_Profile3_Data_14_reg).ch1_pf3_v12;//hist_profile3_data_14_reg.pf_v12;
		Profile3_V_Block_U[13] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_14_RBUS,PROFILE_ICH1_Hist_Profile3_Data_14_reg).ch1_pf3_v13;//hist_profile3_data_14_reg.pf_v13;
		Profile3_V_Block_U[14] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_15_RBUS,PROFILE_ICH1_Hist_Profile3_Data_15_reg).ch1_pf3_v14;//hist_profile3_data_15_reg.pf_v14;
		Profile3_V_Block_U[15] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_15_RBUS,PROFILE_ICH1_Hist_Profile3_Data_15_reg).ch1_pf3_v15;//hist_profile3_data_15_reg.pf_v15;
#else
		profile_ich1_hist_profile3_data_00_RBUS data_00;
		profile_ich1_hist_profile3_data_01_RBUS data_01;
		profile_ich1_hist_profile3_data_02_RBUS data_02;
		profile_ich1_hist_profile3_data_03_RBUS data_03;
		profile_ich1_hist_profile3_data_04_RBUS data_04;
		profile_ich1_hist_profile3_data_05_RBUS data_05;
		profile_ich1_hist_profile3_data_06_RBUS data_06;
		profile_ich1_hist_profile3_data_07_RBUS data_07;
		profile_ich1_hist_profile3_data_08_RBUS data_08;
		profile_ich1_hist_profile3_data_09_RBUS data_09;
		profile_ich1_hist_profile3_data_10_RBUS data_10;
		profile_ich1_hist_profile3_data_11_RBUS data_11;
		profile_ich1_hist_profile3_data_12_RBUS data_12;
		profile_ich1_hist_profile3_data_13_RBUS data_13;
		profile_ich1_hist_profile3_data_14_RBUS data_14;
		profile_ich1_hist_profile3_data_15_RBUS data_15;

		data_00.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_00_reg);
		data_01.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_01_reg);
		data_02.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_02_reg);
		data_03.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_03_reg);
		data_04.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_04_reg);
		data_05.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_05_reg);
		data_06.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_06_reg);
		data_07.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_07_reg);
		data_08.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_08_reg);
		data_09.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_09_reg);
		data_10.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_10_reg);
		data_11.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_11_reg);
		data_12.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_12_reg);
		data_13.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_13_reg);
		data_14.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_14_reg);
		data_15.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_15_reg);

		// Get Horizontal profile data for U.
		Profile3_H_Block_U[0]   = data_00.ch1_pf3_h00;
		Profile3_H_Block_U[1]   = data_00.ch1_pf3_h01;
		Profile3_H_Block_U[2]   = data_01.ch1_pf3_h02;
		Profile3_H_Block_U[3]   = data_01.ch1_pf3_h03;
		Profile3_H_Block_U[4]   = data_02.ch1_pf3_h04;
		Profile3_H_Block_U[5]   = data_02.ch1_pf3_h05;
		Profile3_H_Block_U[6]   = data_03.ch1_pf3_h06;
		Profile3_H_Block_U[7]   = data_03.ch1_pf3_h07;
		Profile3_H_Block_U[8]   = data_04.ch1_pf3_h08;
		Profile3_H_Block_U[9]   = data_04.ch1_pf3_h09;
		Profile3_H_Block_U[10] = data_05.ch1_pf3_h10;
		Profile3_H_Block_U[11] = data_05.ch1_pf3_h11;
		Profile3_H_Block_U[12] = data_06.ch1_pf3_h12;
		Profile3_H_Block_U[13] = data_06.ch1_pf3_h13;
		Profile3_H_Block_U[14] = data_07.ch1_pf3_h14;
		Profile3_H_Block_U[15] = data_07.ch1_pf3_h15;

		// Get Vertical profile data for U.
		Profile3_V_Block_U[0]   = data_08.ch1_pf3_v00;
		Profile3_V_Block_U[1]   = data_08.ch1_pf3_v01;
		Profile3_V_Block_U[2]   = data_09.ch1_pf3_v02;
		Profile3_V_Block_U[3]   = data_09.ch1_pf3_v03;
		Profile3_V_Block_U[4]   = data_10.ch1_pf3_v04;
		Profile3_V_Block_U[5]   = data_10.ch1_pf3_v05;
		Profile3_V_Block_U[6]   = data_11.ch1_pf3_v06;
		Profile3_V_Block_U[7]   = data_11.ch1_pf3_v07;
		Profile3_V_Block_U[8]   = data_12.ch1_pf3_v08;
		Profile3_V_Block_U[9]   = data_12.ch1_pf3_v09;
		Profile3_V_Block_U[10] = data_13.ch1_pf3_v10;
		Profile3_V_Block_U[11] = data_13.ch1_pf3_v11;
		Profile3_V_Block_U[12] = data_14.ch1_pf3_v12;
		Profile3_V_Block_U[13] = data_14.ch1_pf3_v13;
		Profile3_V_Block_U[14] = data_15.ch1_pf3_v14;
		Profile3_V_Block_U[15] = data_15.ch1_pf3_v15;
#endif
		//Enable profile
		hist_profile3_ctrl_reg.ch1_pf3_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_CTRL_reg, hist_profile3_ctrl_reg.regValue);

		Profile3_U_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile3_U_Sum += Profile3_H_Block_U[ii];
		}
		//Profile3_U_Sum = Profile3_U_Sum << profsum_shift;

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%700 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile3_H_Block_U[%d] =%d ### \n", jj, Profile3_H_Block_U[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile3_V_Block_U[%d] =%d ### \n", jj, Profile3_V_Block_U[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile3_U_Sum =%d========\n", Profile3_U_Sum);

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}


char scalerVIP_ReadProfile3_V(_clues* SmartPic_clue)
{
	profile_ich1_hist_profile3_ctrl_RBUS hist_profile3_ctrl_reg;

	unsigned char ii;
	#if Print_Profile_Data
	unsigned char jj;
	#endif

	unsigned short *Profile3_H_Block_V = &(SmartPic_clue->Profile_Cal_INFO.Profile3_H_Block_V[0]);
	unsigned short *Profile3_V_Block_V = &(SmartPic_clue->Profile_Cal_INFO.Profile3_V_Block_V[0]);

	hist_profile3_ctrl_reg.regValue = scaler_rtd_inl(PROFILE_ICH1_Hist_Profile3_CTRL_reg);

	// H & V Shift right hnsr bits each line.
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_480I:
		case _MODE_576I:
		case _MODE_480P:
		case _MODE_576P:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x2;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x1;
			break;
		case _MODE_720P50:
		case _MODE_720P60:
		case _MODE_1080I25:
		case _MODE_1080I30:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x3;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x2;
			break;
		case _MODE_1080P50:
		case _MODE_1080P60:
			hist_profile3_ctrl_reg.ch1_pf3_hnsr = 0x3;
			hist_profile3_ctrl_reg.ch1_pf3_vnsr = 0x3;
			break;
	}

	scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_CTRL_reg, hist_profile3_ctrl_reg.regValue);

	if ( hist_profile3_ctrl_reg.ch1_pf3_enable_profile == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		// Get Horizontal profile data for U.
		Profile3_H_Block_V[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_00_RBUS,PROFILE_ICH1_Hist_Profile3_Data_00_reg).ch1_pf3_h00;//hist_profile3_data_00_reg.pf_h00;
		Profile3_H_Block_V[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_00_RBUS,PROFILE_ICH1_Hist_Profile3_Data_00_reg).ch1_pf3_h01;//hist_profile3_data_00_reg.pf_h01;
		Profile3_H_Block_V[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_01_RBUS,PROFILE_ICH1_Hist_Profile3_Data_01_reg).ch1_pf3_h02;//hist_profile3_data_01_reg.pf_h02;
		Profile3_H_Block_V[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_01_RBUS,PROFILE_ICH1_Hist_Profile3_Data_01_reg).ch1_pf3_h03;//hist_profile3_data_01_reg.pf_h03;
		Profile3_H_Block_V[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_02_RBUS,PROFILE_ICH1_Hist_Profile3_Data_02_reg).ch1_pf3_h04;//hist_profile3_data_02_reg.pf_h04;
		Profile3_H_Block_V[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_02_RBUS,PROFILE_ICH1_Hist_Profile3_Data_02_reg).ch1_pf3_h05;//hist_profile3_data_02_reg.pf_h05;
		Profile3_H_Block_V[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_03_RBUS,PROFILE_ICH1_Hist_Profile3_Data_03_reg).ch1_pf3_h06;//hist_profile3_data_03_reg.pf_h06;
		Profile3_H_Block_V[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_03_RBUS,PROFILE_ICH1_Hist_Profile3_Data_03_reg).ch1_pf3_h07;//hist_profile3_data_03_reg.pf_h07;
		Profile3_H_Block_V[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_04_RBUS,PROFILE_ICH1_Hist_Profile3_Data_04_reg).ch1_pf3_h08;//hist_profile3_data_04_reg.pf_h08;
		Profile3_H_Block_V[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_04_RBUS,PROFILE_ICH1_Hist_Profile3_Data_04_reg).ch1_pf3_h09;//hist_profile3_data_04_reg.pf_h09;
		Profile3_H_Block_V[10] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_05_RBUS,PROFILE_ICH1_Hist_Profile3_Data_05_reg).ch1_pf3_h10;//hist_profile3_data_05_reg.pf_h10;
		Profile3_H_Block_V[11] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_05_RBUS,PROFILE_ICH1_Hist_Profile3_Data_05_reg).ch1_pf3_h11;//hist_profile3_data_05_reg.pf_h11;
		Profile3_H_Block_V[12] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_06_RBUS,PROFILE_ICH1_Hist_Profile3_Data_06_reg).ch1_pf3_h12;//hist_profile3_data_06_reg.pf_h12;
		Profile3_H_Block_V[13] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_06_RBUS,PROFILE_ICH1_Hist_Profile3_Data_06_reg).ch1_pf3_h13;//hist_profile3_data_06_reg.pf_h13;
		Profile3_H_Block_V[14] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_07_RBUS,PROFILE_ICH1_Hist_Profile3_Data_07_reg).ch1_pf3_h14;//hist_profile3_data_07_reg.pf_h14;
		Profile3_H_Block_V[15] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_07_RBUS,PROFILE_ICH1_Hist_Profile3_Data_07_reg).ch1_pf3_h15;//hist_profile3_data_07_reg.pf_h15;

		// Get Vertical profile data for U.
		Profile3_V_Block_V[0]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_08_RBUS,PROFILE_ICH1_Hist_Profile3_Data_08_reg).ch1_pf3_v00;//hist_profile3_data_08_reg.pf_v00;
		Profile3_V_Block_V[1]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_08_RBUS,PROFILE_ICH1_Hist_Profile3_Data_08_reg).ch1_pf3_v01;//hist_profile3_data_08_reg.pf_v01;
		Profile3_V_Block_V[2]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_09_RBUS,PROFILE_ICH1_Hist_Profile3_Data_09_reg).ch1_pf3_v02;//hist_profile3_data_09_reg.pf_v02;
		Profile3_V_Block_V[3]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_09_RBUS,PROFILE_ICH1_Hist_Profile3_Data_09_reg).ch1_pf3_v03;//hist_profile3_data_09_reg.pf_v03;
		Profile3_V_Block_V[4]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_10_RBUS,PROFILE_ICH1_Hist_Profile3_Data_10_reg).ch1_pf3_v04;//hist_profile3_data_10_reg.pf_v04;
		Profile3_V_Block_V[5]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_10_RBUS,PROFILE_ICH1_Hist_Profile3_Data_10_reg).ch1_pf3_v05;//hist_profile3_data_10_reg.pf_v05;
		Profile3_V_Block_V[6]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_11_RBUS,PROFILE_ICH1_Hist_Profile3_Data_11_reg).ch1_pf3_v06;//hist_profile3_data_11_reg.pf_v06;
		Profile3_V_Block_V[7]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_11_RBUS,PROFILE_ICH1_Hist_Profile3_Data_11_reg).ch1_pf3_v07;//hist_profile3_data_11_reg.pf_v07;
		Profile3_V_Block_V[8]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_12_RBUS,PROFILE_ICH1_Hist_Profile3_Data_12_reg).ch1_pf3_v08;//hist_profile3_data_12_reg.pf_v08;
		Profile3_V_Block_V[9]   = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_12_RBUS,PROFILE_ICH1_Hist_Profile3_Data_12_reg).ch1_pf3_v09;//hist_profile3_data_12_reg.pf_v09;
		Profile3_V_Block_V[10] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_13_RBUS,PROFILE_ICH1_Hist_Profile3_Data_13_reg).ch1_pf3_v10;//hist_profile3_data_13_reg.pf_v10;
		Profile3_V_Block_V[11] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_13_RBUS,PROFILE_ICH1_Hist_Profile3_Data_13_reg).ch1_pf3_v11;//hist_profile3_data_13_reg.pf_v11;
		Profile3_V_Block_V[12] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_14_RBUS,PROFILE_ICH1_Hist_Profile3_Data_14_reg).ch1_pf3_v12;//hist_profile3_data_14_reg.pf_v12;
		Profile3_V_Block_V[13] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_14_RBUS,PROFILE_ICH1_Hist_Profile3_Data_14_reg).ch1_pf3_v13;//hist_profile3_data_14_reg.pf_v13;
		Profile3_V_Block_V[14] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_15_RBUS,PROFILE_ICH1_Hist_Profile3_Data_15_reg).ch1_pf3_v14;//hist_profile3_data_15_reg.pf_v14;
		Profile3_V_Block_V[15] = scaler_rtd_t_inl(profile_ich1_hist_profile3_data_15_RBUS,PROFILE_ICH1_Hist_Profile3_Data_15_reg).ch1_pf3_v15;//hist_profile3_data_15_reg.pf_v15;
#else
		profile_ich1_hist_profile3_data_00_RBUS data_00;
		profile_ich1_hist_profile3_data_01_RBUS data_01;
		profile_ich1_hist_profile3_data_02_RBUS data_02;
		profile_ich1_hist_profile3_data_03_RBUS data_03;
		profile_ich1_hist_profile3_data_04_RBUS data_04;
		profile_ich1_hist_profile3_data_05_RBUS data_05;
		profile_ich1_hist_profile3_data_06_RBUS data_06;
		profile_ich1_hist_profile3_data_07_RBUS data_07;
		profile_ich1_hist_profile3_data_08_RBUS data_08;
		profile_ich1_hist_profile3_data_09_RBUS data_09;
		profile_ich1_hist_profile3_data_10_RBUS data_10;
		profile_ich1_hist_profile3_data_11_RBUS data_11;
		profile_ich1_hist_profile3_data_12_RBUS data_12;
		profile_ich1_hist_profile3_data_13_RBUS data_13;
		profile_ich1_hist_profile3_data_14_RBUS data_14;
		profile_ich1_hist_profile3_data_15_RBUS data_15;

		data_00.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_00_reg);
		data_01.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_01_reg);
		data_02.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_02_reg);
		data_03.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_03_reg);
		data_04.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_04_reg);
		data_05.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_05_reg);
		data_06.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_06_reg);
		data_07.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_07_reg);
		data_08.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_08_reg);
		data_09.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_09_reg);
		data_10.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_10_reg);
		data_11.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_11_reg);
		data_12.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_12_reg);
		data_13.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_13_reg);
		data_14.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_14_reg);
		data_15.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile3_Data_15_reg);

		// Get Horizontal profile data for V.
		Profile3_H_Block_V[0]   = data_00.ch1_pf3_h00;
		Profile3_H_Block_V[1]   = data_00.ch1_pf3_h01;
		Profile3_H_Block_V[2]   = data_01.ch1_pf3_h02;
		Profile3_H_Block_V[3]   = data_01.ch1_pf3_h03;
		Profile3_H_Block_V[4]   = data_02.ch1_pf3_h04;
		Profile3_H_Block_V[5]   = data_02.ch1_pf3_h05;
		Profile3_H_Block_V[6]   = data_03.ch1_pf3_h06;
		Profile3_H_Block_V[7]   = data_03.ch1_pf3_h07;
		Profile3_H_Block_V[8]   = data_04.ch1_pf3_h08;
		Profile3_H_Block_V[9]   = data_04.ch1_pf3_h09;
		Profile3_H_Block_V[10] = data_05.ch1_pf3_h10;
		Profile3_H_Block_V[11] = data_05.ch1_pf3_h11;
		Profile3_H_Block_V[12] = data_06.ch1_pf3_h12;
		Profile3_H_Block_V[13] = data_06.ch1_pf3_h13;
		Profile3_H_Block_V[14] = data_07.ch1_pf3_h14;
		Profile3_H_Block_V[15] = data_07.ch1_pf3_h15;

		// Get Vertical profile data for V.
		Profile3_V_Block_V[0]   = data_08.ch1_pf3_v00;
		Profile3_V_Block_V[1]   = data_08.ch1_pf3_v01;
		Profile3_V_Block_V[2]   = data_09.ch1_pf3_v02;
		Profile3_V_Block_V[3]   = data_09.ch1_pf3_v03;
		Profile3_V_Block_V[4]   = data_10.ch1_pf3_v04;
		Profile3_V_Block_V[5]   = data_10.ch1_pf3_v05;
		Profile3_V_Block_V[6]   = data_11.ch1_pf3_v06;
		Profile3_V_Block_V[7]   = data_11.ch1_pf3_v07;
		Profile3_V_Block_V[8]   = data_12.ch1_pf3_v08;
		Profile3_V_Block_V[9]   = data_12.ch1_pf3_v09;
		Profile3_V_Block_V[10] = data_13.ch1_pf3_v10;
		Profile3_V_Block_V[11] = data_13.ch1_pf3_v11;
		Profile3_V_Block_V[12] = data_14.ch1_pf3_v12;
		Profile3_V_Block_V[13] = data_14.ch1_pf3_v13;
		Profile3_V_Block_V[14] = data_15.ch1_pf3_v14;
		Profile3_V_Block_V[15] = data_15.ch1_pf3_v15;
#endif

		//Enable profile
		hist_profile3_ctrl_reg.ch1_pf3_enable_profile = 0x1;
		scaler_rtd_outl(PROFILE_ICH1_Hist_Profile3_CTRL_reg, hist_profile3_ctrl_reg.regValue);

		Profile3_V_Sum = 0;
		for( ii=0; ii<16; ii++ ) {
			Profile3_V_Sum += Profile3_H_Block_V[ii];
		}
		//Profile3_V_Sum = Profile3_V_Sum << profsum_shift;

		#if Print_Profile_Data
		if (Profile1_Y_Print_Count%700 ==0)
		{
			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile3_H_Block_V[%d] =%d ### \n", jj, Profile3_H_Block_V[jj]);
			}

			for(jj=0; jj<16; jj++ )
			{
				ROSPrintf( "### Profile3_V_Block_V[%d] =%d ### \n", jj, Profile3_V_Block_V[jj]);
			}

			ROSPrintf( "[ScalerVIP] ========Profile OK, Profile3_V_Sum =%d========\n", Profile3_V_Sum);

			Profile1_Y_Print_Count = 0;
		}

		Profile1_Y_Print_Count++;
		#endif

		return SUCCESS;
	}
	else
	{
		//ROSPrintf( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}

}

void scalerVIP_Difference_H_V_Calculate()
{
	unsigned char ii;
	unsigned char Profile_Block_Num = 16;//set profile h&V block number


	unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	static unsigned short pre_H_Block[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
	static unsigned short pre_V_Block[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

//	unsigned short Difference_H[16], Difference_V[16];
	unsigned int sum_of_difference = 0;

	for (ii=0;ii<Profile_Block_Num;ii++)
	{
		//calculate difference
		Difference_H[ii] = abs(H_Block[ii] - pre_H_Block[ii]);
		Difference_V[ii] = abs(V_Block[ii] - pre_V_Block[ii]);

		//calculate sum of difference
		sum_of_difference = sum_of_difference + Difference_H[ii] + Difference_V[ii];
	}

	//save profile to buffer:pre_H_Block, pre_V_Block
	for (ii=0;ii<Profile_Block_Num;ii++)
	{
		pre_H_Block[ii] = H_Block[ii];
		pre_V_Block[ii] = V_Block[ii];
	}

}

//20130402 Elsie: Still Motion judgement
MOTION_LEVEL scalerVIP_StillMotion(_clues* SmartPic_clue)
{
	unsigned char ii;
	unsigned char Profile_Block_Num = 16;//set profile h&V block number

	static unsigned char exit_motion_cnt_still = 0;
	static unsigned char exit_motion_cnt_very_still = 0;
	static unsigned char very_motion_cnt2 =0;

	MOTION_LEVEL flag_motion_type = MOTION_LEVEL_MOTION;
	static MOTION_LEVEL flag_motion_type_pre = MOTION_LEVEL_MOTION;
	static unsigned char isEvenFrame = 0;

	unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	static unsigned short pre_H_Block[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
	static unsigned short pre_V_Block[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

//	unsigned short Difference_H[16], Difference_V[16];
	unsigned int sum_of_difference = 0;

	//unsigned short H_Block[16], V_Block[16];
	unsigned short threshold_still = 180;

	MOTION_LEVEL MAD_level =0;

	//scalerDrvPrint( "enter scalerVIP_colorProfileStillMotion\n" );

	//Set threshold_still
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_1080PM50:
		case _MODE_1080PM60:
		case _MODE_1080P50:
		case _MODE_1080P60:
			threshold_still = 640;
			break;
		case _MODE_1080I25:
		case _MODE_1080I30:
			threshold_still =300;
			break;
		default:
			threshold_still = 180;	//CVBS, YPbPr
			break;
	}

	MAD_level  =999 ;
	//motion detection
	for (ii=0;ii<Profile_Block_Num;ii++)
	{
		//calculate difference
		Difference_H[ii] = abs(H_Block[ii] - pre_H_Block[ii]);
		Difference_V[ii] = abs(V_Block[ii] - pre_V_Block[ii]);

		//calculate sum of difference
		sum_of_difference = sum_of_difference + Difference_H[ii] + Difference_V[ii];
	}

	if (sum_of_difference <= threshold_still)	//not "very motion"
	{

		MAD_level = scalerVIP_MADStillMotion();	//Using MAD value
		very_motion_cnt2=0;
		if (MAD_level == MOTION_LEVEL_VERY_STILL)	//very still
		{
			very_motion_cnt=0;
			very_still_cnt ++;
			exit_motion_cnt_very_still++;
			if ( exit_motion_cnt_very_still >= 2 )
				flag_motion_type = MOTION_LEVEL_VERY_STILL; //pattern is very still
			else
				flag_motion_type = flag_motion_type_pre;
		}
		else if (MAD_level == MOTION_LEVEL_STILL) //still
		{
			very_motion_cnt++;
			very_still_cnt=0;
			exit_motion_cnt_still++;
			if ( exit_motion_cnt_still >= 2 )
				flag_motion_type = MOTION_LEVEL_STILL; //pattern is still
			else
				flag_motion_type = flag_motion_type_pre;
		}
		else
		{
			flag_motion_type = MOTION_LEVEL_SLOW_MOTION;
			very_motion_cnt++;
			very_still_cnt=0;
			exit_motion_cnt_still = 0;
			exit_motion_cnt_very_still = 0;
		}
		if (very_motion_cnt>20) very_motion_cnt=20;

	}
	else
	{
		very_motion_cnt++;
		very_motion_cnt2 ++;
		very_still_cnt=0;

		if ( very_motion_cnt2 >= 2 )
			flag_motion_type = MOTION_LEVEL_MOTION; //pattern is motion
		else
			flag_motion_type = flag_motion_type_pre; //pattern is motion

		exit_motion_cnt_still = 0;
		exit_motion_cnt_very_still = 0;
	}
#if 0
	if(MA_print_count % 3 == 0)
	{
		ROSPrintf("sum_of_difference=%d,threshold_still=%d\n",sum_of_difference,threshold_still );
		ROSPrintf("flag_motion_type=%d,MAD_level=%d ====\n",flag_motion_type,MAD_level  );
	}
#endif


	//save profile to buffer:pre_H_Block, pre_V_Block
	for (ii=0;ii<Profile_Block_Num;ii++)
	{
		pre_H_Block[ii] = H_Block[ii];
		pre_V_Block[ii] = V_Block[ii];
	}

	isEvenFrame = (isEvenFrame+1) % 2;
	flag_motion_type_pre = flag_motion_type;

	return flag_motion_type;
}

//20130402 Elsie add for motion detection with MAD value.
MOTION_LEVEL scalerVIP_MADStillMotion(void)
{
	unsigned int MAD_counter[3]; //Y,U,V respectively
	unsigned short MAD_threshold_y = 56;
	unsigned short MAD_threshold_c = 56;
	unsigned int MAD_counter_sum = 0;
	unsigned int MAD_counter_sum_threshold;
	static unsigned int preMAD_csum=0;
	_RPC_system_setting_info* RPC_system_info_structure_table = NULL;
	RPC_system_info_structure_table = scaler_GetShare_Memory_RPC_system_setting_info_Struct();

	if((RPC_system_info_structure_table == NULL))
	{
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR, system_info = %x, \n",RPC_system_info_structure_table);
		return MOTION_LEVEL_MOTION;
	}

	di_im_di_rtnr_mad_y_th_RBUS im_di_rtnr_mad_y_th_reg;
	di_im_di_rtnr_mad_c_th_RBUS im_di_rtnr_mad_c_th_reg;

	im_di_rtnr_mad_y_th_reg.regValue = scaler_rtd_inl(DI_IM_DI_RTNR_MAD_Y_TH_reg);
	im_di_rtnr_mad_c_th_reg.regValue = scaler_rtd_inl(DI_IM_DI_RTNR_MAD_C_TH_reg);
	im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = MAD_threshold_y;
	im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1 = MAD_threshold_c;
	if(RPC_system_info_structure_table->Project_ID == VIP_Project_ID_TV006){
	scaler_rtd_outl(DI_IM_DI_RTNR_MAD_Y_TH_reg,im_di_rtnr_mad_y_th_reg.regValue);
	scaler_rtd_outl(DI_IM_DI_RTNR_MAD_C_TH_reg,im_di_rtnr_mad_c_th_reg.regValue);
	}
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
	MAD_counter[0] = scaler_rtd_t_inl(di_im_di_rtnr_mad_y_counter_RBUS,DI_IM_DI_RTNR_MAD_Y_COUNTER_reg).cp_temporal_mad_countery;	//Y
	MAD_counter[1] = scaler_rtd_t_inl(di_im_di_rtnr_mad_u_counter_RBUS,DI_IM_DI_RTNR_MAD_U_COUNTER_reg).cp_temporal_mad_counteru;	//U
	MAD_counter[2] = scaler_rtd_t_inl(di_im_di_rtnr_mad_v_counter_RBUS,DI_IM_DI_RTNR_MAD_V_COUNTER_reg).cp_temporal_mad_counterv;	//V
#else
	di_im_di_rtnr_mad_y_counter_RBUS mad_y;
	di_im_di_rtnr_mad_u_counter_RBUS mad_u;
	di_im_di_rtnr_mad_v_counter_RBUS mad_v;
	mad_y.res1 = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);
	mad_u.res1 = rtd_inl(DI_IM_DI_RTNR_MAD_U_COUNTER_reg);
	mad_v.res1 = rtd_inl(DI_IM_DI_RTNR_MAD_V_COUNTER_reg);

	MAD_counter[0] = mad_y.cp_temporal_mad_countery;
	MAD_counter[1] = mad_u.cp_temporal_mad_counteru;
	MAD_counter[2] = mad_v.cp_temporal_mad_counterv;
#endif
	MAD_counter_sum =  MAD_counter[0] + MAD_counter[1] + MAD_counter[2];

	//Set MAD_counter_sum_threshold
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_1080PM50:
		case _MODE_1080PM60:
		case  _MODE_1080P50:
		case _MODE_1080P60:
			MAD_counter_sum_threshold = 220;
			break;
		case  _MODE_1080I25:
		case  _MODE_1080I30:
			MAD_counter_sum_threshold = 300;	//HDMI
			  if (MAD_counter_sum <= 10 || ( preMAD_csum+MAD_counter_sum)<260 )
			  	{
		   		      preMAD_csum=MAD_counter_sum;
				      return MOTION_LEVEL_VERY_STILL;	//very still
			  	}
			  else if (MAD_counter_sum <= MAD_counter_sum_threshold)
			  	{
			  	  preMAD_csum=MAD_counter_sum;
			         return MOTION_LEVEL_STILL;	//almost still
			  	}
			  else
			  	{
			  	  preMAD_csum=MAD_counter_sum;
			    	  return MOTION_LEVEL_SLOW_MOTION;	//slow motion, suppose it is randomly
				}
			break;
		default:
			MAD_counter_sum_threshold = 72;	//CVBS, YPbPr
			break;
	}

	if(MA_print_count % 9 == 0)
	{
//		ROSPrintf("MAD_counter_sum=%d,threshold=%d\n",MAD_counter_sum,MAD_counter_sum_threshold );
	}


	if (MAD_counter_sum == 0)
		return MOTION_LEVEL_VERY_STILL;	//very still
	else if (MAD_counter_sum <= MAD_counter_sum_threshold)
		return MOTION_LEVEL_STILL;	//almost still
	else
		return MOTION_LEVEL_SLOW_MOTION;	//slow motion, suppose it is randomly
}

#ifdef ISR_FADE_DETECT_FUNCTIOM_ENABLE
//Elsie 20130416: big smooth area & fade in/fade out detection.
unsigned char scalerVIP_BigSmoothAreaDetection_luma(void)
{
#if 0 // rbus sync error!! CSFC 2015/03/04
	unsigned int ii;
	unsigned int max_hist[3],max_hist_ID[3],hist_sum_tmp;
	unsigned char flag_big_smooth_area_luma = 0;
	unsigned char flag_sharpness_on, flag_high_edge_density = 0;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	scalerDrvPrint("enter scalerVIP_ReadHist\n");

	// Luma
	max_hist[0] = max_hist[1] = max_hist[2] = 0;
	max_hist_ID[0] = max_hist_ID[1] = max_hist_ID[2] = 0;
	hist_sum_tmp = 0;
	for(ii=0;ii<COLOR_HISTOGRAM_LEVEL;ii++)
	{
		if(max_hist[0] < reg_HistCnt[ii])
		{
			max_hist[2] = max_hist[1];
			max_hist_ID[2] = max_hist_ID[1];
			max_hist[1] = max_hist[0];
			max_hist_ID[1] = max_hist_ID[0];
			max_hist[0] = reg_HistCnt[ii];
			max_hist_ID[0] = ii;
		}
		else if(max_hist[1] < reg_HistCnt[ii])
		{
			max_hist[2] = max_hist[1];
			max_hist_ID[2] = max_hist_ID[1];
			max_hist[1] = reg_HistCnt[ii];
			max_hist_ID[1] = ii;
		}
		else if(max_hist[2] < reg_HistCnt[ii])
		{
			max_hist[2] = reg_HistCnt[ii];
			max_hist_ID[2] = ii;
		}
	}

	//"edge" density: if there is too many edges, force the return value to false.
	flag_sharpness_on = rtd_t_inl(color_sharp_dm_nr_shp_ctrl_RBUS, COLOR_SHARP_DM_NR_SHP_CTRL_reg).mkiii_en;
	if(flag_sharpness_on == 1)
	{
		color_sharp_dm_auto_shp_data_RBUS dm_auto_shp_data_reg;
		dm_auto_shp_data_reg.regValue = rtd_inl(COLOR_SHARP_DM_AUTO_SHP_DATA_reg);
		unsigned int Hist_HPF[16], Hist_HPF_total = 0;

		if(dm_auto_shp_data_reg.enable == 1)	//histogram after HPF
		{
			Hist_HPF[0] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_00_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_00_reg).lut0;
			Hist_HPF[1] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_01_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_01_reg).lut1;
			Hist_HPF[2] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_02_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_02_reg).lut2;
			Hist_HPF[3] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_03_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_03_reg).lut3;
			Hist_HPF[4] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_04_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_04_reg).lut4;
			Hist_HPF[5] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_05_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_05_reg).lut5;
			Hist_HPF[6] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_06_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_06_reg).lut6;
			Hist_HPF[7] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_07_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_07_reg).lut7;
			Hist_HPF[8] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_08_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_08_reg).lut8;
			Hist_HPF[9] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_09_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_09_reg).lut9;
			Hist_HPF[10] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_10_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_10_reg).lut10;
			Hist_HPF[11] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_11_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_11_reg).lut11;
			Hist_HPF[12] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_12_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_12_reg).lut12;
			Hist_HPF[13] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_13_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_13_reg).lut13;
			Hist_HPF[14] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_14_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_14_reg).lut14;
			Hist_HPF[15] = rtd_t_inl(color_sharp_dm_auto_shp_fir_count_15_RBUS, COLOR_SHARP_DM_AUTO_SHP_FIR_COUNT_15_reg).lut15;

			for(ii=0;ii<16;ii++)
			{
				Hist_HPF_total = Hist_HPF_total + Hist_HPF[ii];
			}
			if(Hist_HPF_total*4/5 > Hist_HPF[0]+Hist_HPF[1])
				flag_high_edge_density = 1;
		}
		dm_auto_shp_data_reg.enable = 1;
		dm_auto_shp_data_reg.shift_bit = 0;
		rtd_outl(COLOR_SHARP_DM_AUTO_SHP_DATA_reg, dm_auto_shp_data_reg.regValue);
	}

	if(flag_high_edge_density == 1)
	{
		flag_big_smooth_area_luma = 0;
	}
	else if((max_hist[0]>>2)>max_hist[1]) 	//max_hist[0]>(max_hist[1]*4)
	{
		flag_big_smooth_area_luma = 1;
	}
	else if(abs(max_hist_ID[0]-max_hist_ID[1])==1)	//nearby
	{
		hist_sum_tmp = max_hist[0] + max_hist[1];
		if((hist_sum_tmp>>2)>max_hist[2])
		{
			flag_big_smooth_area_luma = 1;
		}
		else
		{
			flag_big_smooth_area_luma = 0;
		}
	}
	else
	{
		flag_big_smooth_area_luma = 0;
	}
	return flag_big_smooth_area_luma;
#endif
   return 0 ;
}

unsigned char scalerVIP_BigSmoothAreaDetection_chroma(void)
{
	unsigned int ii,hue_max_hist[3],hue_max_hist_ID[3],hue_hist_01 = 0,hue_hist_sum = 0;
	unsigned char flag_big_smooth_area_chroma = 0;

	// Hue
	hue_max_hist[0] = hue_max_hist[1] = hue_max_hist[2] = 0;
	hue_max_hist_ID[0] = hue_max_hist_ID[1] = hue_max_hist_ID[2] = 0;
	for(ii=0;ii<24;ii++)
	{
		if(hue_max_hist[0] < hue_hist_2[ii])
		{
			hue_max_hist[2] = hue_max_hist[1];
			hue_max_hist_ID[2] = hue_max_hist_ID[1];
			hue_max_hist[1] = hue_max_hist[0];
			hue_max_hist_ID[1] = hue_max_hist_ID[0];
			hue_max_hist[0] = hue_hist_2[ii];
			hue_max_hist_ID[0] = ii;
		}
		else if(hue_max_hist[1] < hue_hist_2[ii])
		{
			hue_max_hist[2] = hue_max_hist[1];
			hue_max_hist_ID[2] = hue_max_hist_ID[1];
			hue_max_hist[1] = hue_hist_2[ii];
			hue_max_hist_ID[1] = ii;
		}
		else if(hue_max_hist[2] < hue_hist_2[ii])
		{
			hue_max_hist[2] = hue_hist_2[ii];
			hue_max_hist_ID[2] = ii;
		}
		hue_hist_sum = hue_hist_sum + hue_hist_2[ii];
	}

	if (hue_max_hist[0]==0)	// pure gray level image, force the return value to true.
	{
		flag_big_smooth_area_chroma = 1;
	}
	else if((hue_max_hist[0]>>2)>hue_max_hist[1])	//max_hist[0]>(max_hist[1]*4)
	{
		flag_big_smooth_area_chroma = 1;
	}
	else if(abs(hue_max_hist_ID[0]-hue_max_hist_ID[1])==1)	//nearby
	{
		hue_hist_01 = hue_max_hist[0] + hue_max_hist[1];
		if((hue_hist_01>>2)>hue_max_hist[2])
		{
			flag_big_smooth_area_chroma = 1;
		}
		else
		{
			flag_big_smooth_area_chroma = 0;
		}
	}
	else
	{
		flag_big_smooth_area_chroma = 0;
	}

	return flag_big_smooth_area_chroma;
}
#endif

unsigned char scalerVIP_ColorbarDetector(_clues* SmartPic_clue)
{
	unsigned char ii, ProfileCount = 0;
	unsigned short thl;
	//unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	//Set threshold_still
	switch (SmartPic_clue->SCALER_DISP_INFO.ucMode_Curr)
	{
		case _MODE_1080PM50:
		case _MODE_1080PM60:
		case _MODE_1080P50:
		case _MODE_1080P60:
			thl = 20;
			break;
		case _MODE_1080I25:
		case _MODE_1080I30:
			thl =10;
			break;
		default:
			thl = 6;	//CVBS, YPbPr
			break;
	}

	for(ii=1;ii<9;ii++)
	{
		if(V_Block[ii]-V_Block[ii-1] < thl)
			ProfileCount++;
	}

	if(ProfileCount == 8)
		return TRUE;
	else
		return FALSE;

}

void scalerVIP_newdcti(unsigned char isColorBar)
{
/*
	idcti_i_dcti_ctrl_1_RBUS i_dcti_ctrl_1_reg;
	i_dcti_ctrl_1_reg.regValue = rtd_inl(IDCTI_I_DCTI_CTRL_1_reg);

	if(isColorBar == TRUE)
	{
		switch (scaler_disp_info[_CHANNEL1].ucMode_Curr)
		{
			case _MODE_480I:
			case _MODE_576I:	//SD
				i_dcti_ctrl_1_reg.data_sel = 1;
				i_dcti_ctrl_1_reg.maxlen = 2;
				i_dcti_ctrl_1_reg.psmth = 0;
				i_dcti_ctrl_1_reg.lp_mode = 1;
				i_dcti_ctrl_1_reg.engdiv = 0;
				i_dcti_ctrl_1_reg.offdiv = 0;
				i_dcti_ctrl_1_reg.uvgain = 16;
				i_dcti_ctrl_1_reg.dcti_mode = 0;
				i_dcti_ctrl_1_reg.cur_sel = 1;
				i_dcti_ctrl_1_reg.dcti_en = 1;
				break;
			case _MODE_480P:
			case _MODE_576P:
			case _MODE_720P50:
			case _MODE_720P60:
			case _MODE_1080I25:
			case _MODE_1080I30:
			case _MODE_1080P50:
			case _MODE_1080P60:		//HD
			default:
				i_dcti_ctrl_1_reg.data_sel = 1;
				i_dcti_ctrl_1_reg.maxlen = 2;
				i_dcti_ctrl_1_reg.psmth = 0;
				i_dcti_ctrl_1_reg.lp_mode = 1;
				i_dcti_ctrl_1_reg.engdiv = 0;
				i_dcti_ctrl_1_reg.offdiv = 1;
				i_dcti_ctrl_1_reg.uvgain = 48;
				i_dcti_ctrl_1_reg.dcti_mode = 0;
				i_dcti_ctrl_1_reg.cur_sel = 1;
				i_dcti_ctrl_1_reg.dcti_en = 1;
				break;
		}
	}
	else
	{
		switch (scaler_disp_info[_CHANNEL1].ucMode_Curr)
		{
			case _MODE_480I:
			case _MODE_576I:	//SD
				i_dcti_ctrl_1_reg.data_sel = 1;
				i_dcti_ctrl_1_reg.maxlen = 2;
				i_dcti_ctrl_1_reg.psmth = 0;
				i_dcti_ctrl_1_reg.lp_mode = 1;
				i_dcti_ctrl_1_reg.engdiv = 0;
				i_dcti_ctrl_1_reg.offdiv = 0;
				i_dcti_ctrl_1_reg.uvgain = 8;
				i_dcti_ctrl_1_reg.dcti_mode = 0;
				i_dcti_ctrl_1_reg.cur_sel = 1;
				i_dcti_ctrl_1_reg.dcti_en = 1;
				break;
			case _MODE_480P:
			case _MODE_576P:
			case _MODE_720P50:
			case _MODE_720P60:
			case _MODE_1080I25:
			case _MODE_1080I30:
			case _MODE_1080P50:
			case _MODE_1080P60:		//HD
			default:
				i_dcti_ctrl_1_reg.data_sel = 1;
				i_dcti_ctrl_1_reg.maxlen = 2;
				i_dcti_ctrl_1_reg.psmth = 0;
				i_dcti_ctrl_1_reg.lp_mode = 1;
				i_dcti_ctrl_1_reg.engdiv = 0;
				i_dcti_ctrl_1_reg.offdiv = 1;
				i_dcti_ctrl_1_reg.uvgain = 16;
				i_dcti_ctrl_1_reg.dcti_mode = 0;
				i_dcti_ctrl_1_reg.cur_sel = 1;
				i_dcti_ctrl_1_reg.dcti_en = 1;
				break;
		}

#if 0
		//D-domain DCTI for colorbar
		dm_dcti_options_RBUS dm_dcti_options_reg;
		dm_dcti_1st_value_RBUS dm_dcti_1st_value_reg;
		dm_dcti_2nd_value_RBUS dm_dcti_2nd_value_reg;

		dm_dcti_options_reg.regValue = rtd_inl(COLOR_DLCTI_DM_DCTI_OPTIONS_reg);
		dm_dcti_1st_value_reg.regValue = rtd_inl(COLOR_DLCTI_DM_DCTI_1ST_VALUE_reg);
		dm_dcti_2nd_value_reg.regValue = rtd_inl(COLOR_DLCTI_DM_DCTI_2ND_VALUE_reg);

		dm_dcti_options_reg.enabled = 1;
		dm_dcti_options_reg.prevent_pe = 0;
		dm_dcti_1st_value_reg.gain_value = 31;
		dm_dcti_1st_value_reg.th_value = 31;
		dm_dcti_2nd_value_reg.gain_value = 0;
		dm_dcti_2nd_value_reg.th_value = 6;
		rtd_outl(COLOR_DLCTI_DM_DCTI_OPTIONS_reg, dm_dcti_options_reg.regValue);
		rtd_outl(COLOR_DLCTI_DM_DCTI_1ST_VALUE_reg, dm_dcti_1st_value_reg.regValue);
		rtd_outl(COLOR_DLCTI_DM_DCTI_2ND_VALUE_reg, dm_dcti_2nd_value_reg.regValue);
#endif
	}

	rtd_outl(IDCTI_I_DCTI_CTRL_1_reg, i_dcti_ctrl_1_reg.regValue);
	*/
}

#if 1

void scalerVIP_luma_level_distribution_Remapping(unsigned int *luma_distribution, unsigned char size)
{
	unsigned char nTotalSize = COLOR_HISTOGRAM_LEVEL;
	unsigned char nSegment = nTotalSize / size;
	unsigned char nIndex = 0, nSegIndx = 0;
	_clues* SmartPic_clue=NULL;
	unsigned short nPoint = 1;
	unsigned int nSumPoint = 0;

	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();

	if (SmartPic_clue == NULL) {
		for (nIndex = 0; nIndex < size; nIndex++) {
			luma_distribution[nIndex] = 0;
		}
		return;
	}

	for (nIndex = 0; nIndex < size; nIndex++) {
		luma_distribution[nIndex] = 0;
	}
	for (nIndex = 0; nIndex < size; nIndex++) {
		nSumPoint = 0;
		for (nSegIndx = 0; nSegIndx < nSegment; nSegIndx++) {
			if (nIndex * nSegment + nSegIndx < nTotalSize) {
				nSumPoint +=  SmartPic_clue->Y_Main_Hist[nIndex * nSegment + nSegIndx];
			}
		}
		luma_distribution[nIndex]  = nSumPoint*nPoint;

	}
}


void scalerVIP_YHist_HueHist_Ratio_Calculate()
{
	unsigned char i;
	unsigned int hue_sum = 0;
	for(i=0;i<24;i++) {
		//hue_hist_total += hue_hist_2[i];
		hue_hist_2[i] = scaler_rtd_inl( COLOR_ICM_HUE_COUNT_00_reg + (i<<2));
		hue_sum += hue_hist_2[i];
	}

	/*for(i=0;i<32;i++)
		y_sum += reg_HistCnt[i];*/
	if((SmartPic_clue->SCALER_DISP_INFO.DispLen*SmartPic_clue->SCALER_DISP_INFO.DispWid)!=0) {
		SmartPic_clue->hue_sumcnt_ratio = hue_sum*1000/(SmartPic_clue->SCALER_DISP_INFO.DispLen*SmartPic_clue->SCALER_DISP_INFO.DispWid);
	}

	if(hue_sum <= 1000) {
		//calculate permillage for Hue
		for(i=0;i<24;i++)
			 hue_hist_ratio[i] = 0;
		colorless_flag =1;
	} else {
		//calculate permillage for Hue
		for(i=0;i<24;i++)
			 hue_hist_ratio[i] = (hue_hist_2[i]/(hue_sum/1000));
		colorless_flag =0;
	}

	SmartPic_clue->colorlessflag = colorless_flag;
	for(i=0;i<24;i++) {
		(SmartPic_clue->Hue_Main_His)[i]	= hue_hist_2[i];
		(SmartPic_clue->Hue_Main_His_Ratio)[i] = hue_hist_ratio[i];
	}

	if((SmartPic_clue->Hist_Y_Total_sum)==0) {
		//calculate permillage for Y
		for(i=0;i<TV006_VPQ_chrm_bin;i++)
			 Y_hist_ratio[i] = 0;
	}
	else
	{
		//calculate permillage for Y
               if( (TV006_VPQ_chrm_bin > COLOR_HISTOGRAM_LEVEL) || ((COLOR_HISTOGRAM_LEVEL%TV006_VPQ_chrm_bin) != 0)) {
			for(i=0;i<TV006_VPQ_chrm_bin;i++)
			 	Y_hist_ratio[i] = 0;
		}
		else
		{
			unsigned int Tmp_Y_Histogram[32] = {0};
			scalerVIP_luma_level_distribution_Remapping(Tmp_Y_Histogram, TV006_VPQ_chrm_bin);
			for(i=0;i<TV006_VPQ_chrm_bin;i++)
				Y_hist_ratio[i] = (Tmp_Y_Histogram[i]*1000/(SmartPic_clue->Hist_Y_Total_sum));
		}
	}

	for(i=0;i<TV006_VPQ_chrm_bin;i++) {
		(SmartPic_clue->Y_Main_Hist_Ratio)[i] = Y_hist_ratio[i];
	}

#if 0
	if(MA_print_count%150==0 )
	{
		ROSPrintf("{");
		for(i=0;i<24;i++)
			ROSPrintf("%d,%d,%d ",hue_hist_ratio[i],(SmartPic_clue->Hue_Main_His)[i],(SmartPic_clue->Hue_Main_His_Ratio)[i]);
		ROSPrintf("}\n");

		ROSPrintf("{");
		for(i=0;i<32;i++)
			ROSPrintf("%d,%d ",Y_hist_ratio[i],(SmartPic_clue->Y_Main_Hist_Ratio)[i]);
		ROSPrintf("}\n");

		ROSPrintf("clf=%d,%d\n",colorless_flag,hue_sum);
	}
#endif
#if 1
	unsigned int printf_Flag = system_info_structure_table->ISR_Printf_Flag.Y_Hue_Sat_Hist_Flag0;
	unsigned int print_delay = (system_info_structure_table->ISR_Printf_Flag.Delay_Time == 0)?(1):(system_info_structure_table->ISR_Printf_Flag.Delay_Time);
	//for debug.
	if(((printf_Flag&_BIT0)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("Y_Hue_Sat cal, Y={");
			for(i=0;i<TV006_VPQ_chrm_bin;i++)
				printk("%d,", SmartPic_clue->Y_Main_Hist_Ratio[i]);
			printk("}\n");
		}
	}
	if(((printf_Flag&_BIT1)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("Y_Hue_Sat cal, Y={");
			for(i=0;i<TV006_VPQ_chrm_bin;i++)
				printk("%d,", SmartPic_clue->Y_Main_Hist_Ratio[i]);
			printk("}\n");
		}
	}

	if(((printf_Flag&_BIT2)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("Y_Hue_Sat cal, Hue={");
			for(i=0;i<COLOR_HUE_HISTOGRAM_LEVEL;i++)
				printk("%d,", SmartPic_clue->Hue_Main_His[i]);
			printk("}\n");
		}
	}
	if(((printf_Flag&_BIT3)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("Y_Hue_Sat cal, Hue_ratio={");
			for(i=0;i<COLOR_HUE_HISTOGRAM_LEVEL;i++)
				printk("%d,", SmartPic_clue->Hue_Main_His_Ratio[i]);
			printk("}\n");
		}
	}
#endif



}

void scalerVIP_Y_U_V_Mad_Calculate(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table, _RPC_system_setting_info* RPC_system_info_structure_table)
{
	unsigned short IphActWid_H=0,IpvActLen_V=0;
	unsigned int RTNR_TempMAD_count_Y=0,RTNR_TempMAD_count_U=0,RTNR_TempMAD_count_V=0;
	unsigned int RTNR_TempMAD_count_Y2=0,RTNR_TempMAD_count_U2=0,RTNR_TempMAD_count_V2=0;
	unsigned int RTNR_TempMAD_count_Y3=0,RTNR_TempMAD_count_U3=0,RTNR_TempMAD_count_V3=0;
	unsigned int RTNR_TempMAD_count_Y4=0,RTNR_TempMAD_count_U4=0,RTNR_TempMAD_count_V4=0;

	unsigned int total_pix; //rtnr_noise_new;
	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);

	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_MAD_HistTh_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_MAD_Hist_Th][0]);

//==============================================================
//========================Set MAD Threshold  =======================

	di_im_di_rtnr_mad_y_th_RBUS im_di_rtnr_mad_y_th_reg;
	di_im_di_rtnr_mad_y_th2_c_th2_RBUS im_di_rtnr_mad_y_th2_c_th2_reg;
	di_im_di_rtnr_mad_c_th_RBUS im_di_rtnr_mad_c_th_reg;
	//di_im_di_rtnr_level_bound_RBUS im_di_rtnr_level_bound_reg;
	di_im_new_mcnr_control3_RBUS di_im_new_mcnr_control3;

	im_di_rtnr_mad_y_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_TH_reg);

	im_di_rtnr_mad_c_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_C_TH_reg);
	im_di_rtnr_mad_y_th2_c_th2_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_TH2_C_TH2_reg);

	di_im_new_mcnr_control3.regValue = rtd_inl(DI_IM_NEW_MCNR_CONTROL3_reg);

	/* get size info from scaler*/
	/*scalerVIP_Get_DI_Width_Height(&IphActWid_H, &IpvActLen_V);*/
	IpvActLen_V = system_info_structure_table->I_Height;
	IphActWid_H = system_info_structure_table->I_Width;

	di_im_di_rtnr_control_RBUS im_di_rtnr_control_reg;
	im_di_rtnr_control_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

	if (pPQA_MAD_HistTh_TBL[0] == 1) {	/* controlled by PQA input table*/
			im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = pPQA_MAD_HistTh_TBL[1];
			im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = pPQA_MAD_HistTh_TBL[2];
			im_di_rtnr_mad_y_th2_c_th2_reg.cp_temporal_mad_y_th3=pPQA_MAD_HistTh_TBL[3];

			im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1 =pPQA_MAD_HistTh_TBL[4];
			im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th2 =pPQA_MAD_HistTh_TBL[5];
			im_di_rtnr_mad_y_th2_c_th2_reg.cp_temporal_mad_c_th3=pPQA_MAD_HistTh_TBL[6]; //big motion

			if(IphActWid_H <=1920)
				di_im_new_mcnr_control3.n_mcnr_mad_hist_shift_en = 0;
			else
				di_im_new_mcnr_control3.n_mcnr_mad_hist_shift_en = 1;

	} else {
		if(IphActWid_H <=960){

			if(im_di_rtnr_control_reg.cp_rtnr_progressive != 1)
			im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = 8;
			else
				im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = 3;

			im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = 0x20;
			im_di_rtnr_mad_y_th2_c_th2_reg.cp_temporal_mad_y_th3=128;


			im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1 =2;
			im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th2 =12;

			im_di_rtnr_mad_y_th2_c_th2_reg.cp_temporal_mad_c_th3=1023;

			di_im_new_mcnr_control3.n_mcnr_mad_hist_shift_en=0;


		}else if(IphActWid_H <=1920){
			im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = 4;
			im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = 0x20;
			im_di_rtnr_mad_y_th2_c_th2_reg.cp_temporal_mad_y_th3=128;

			im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1 =0;
			im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th2 =2;
			im_di_rtnr_mad_y_th2_c_th2_reg.cp_temporal_mad_c_th3=2047; //big motion

			di_im_new_mcnr_control3.n_mcnr_mad_hist_shift_en=0;

		}
		else
		{
			im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = 4;
			im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = 0x20;
			im_di_rtnr_mad_y_th2_c_th2_reg.cp_temporal_mad_y_th3=2047;

			im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1 =0;
			im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th2 =2;
			im_di_rtnr_mad_y_th2_c_th2_reg.cp_temporal_mad_c_th3=2047; //big motion

			di_im_new_mcnr_control3.n_mcnr_mad_hist_shift_en=1;


		}
	}
	rtd_outl(DI_IM_NEW_MCNR_CONTROL3_reg,di_im_new_mcnr_control3.regValue);

	rtd_outl(DI_IM_DI_RTNR_MAD_Y_TH_reg, im_di_rtnr_mad_y_th_reg.regValue);
	rtd_outl(DI_IM_DI_RTNR_MAD_C_TH_reg, im_di_rtnr_mad_c_th_reg.regValue);
	rtd_outl(DI_IM_DI_RTNR_MAD_Y_TH2_C_TH2_reg, im_di_rtnr_mad_y_th2_c_th2_reg.regValue);

//=============================================================
//========================Motion MAD Check =======================
	di_im_di_rtnr_mad_y_counter_RBUS im_di_rtnr_mad_y_counter_reg;
	di_im_di_rtnr_mad_u_counter_RBUS im_di_rtnr_mad_u_counter_reg;
	di_im_di_rtnr_mad_v_counter_RBUS im_di_rtnr_mad_v_counter_reg;

	di_im_di_rtnr_mad_y_counter_2_RBUS im_di_rtnr_mad_y_counter_2_reg;
	di_im_di_rtnr_mad_u_counter_2_RBUS im_di_rtnr_mad_u_counter_2_reg;
	di_im_di_rtnr_mad_v_counter_2_RBUS im_di_rtnr_mad_v_counter_2_reg;

	di_im_di_rtnr_mad_y_counter_3_RBUS im_di_rtnr_mad_y_counter_3_reg;
	di_im_di_rtnr_mad_u_counter_3_RBUS im_di_rtnr_mad_u_counter_3_reg;
	di_im_di_rtnr_mad_v_counter_3_RBUS im_di_rtnr_mad_v_counter_3_reg;


	im_di_rtnr_mad_y_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);
	im_di_rtnr_mad_u_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_U_COUNTER_reg);
	im_di_rtnr_mad_v_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_V_COUNTER_reg);

	im_di_rtnr_mad_y_counter_2_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_2_reg);
	im_di_rtnr_mad_u_counter_2_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_U_COUNTER_2_reg);
	im_di_rtnr_mad_v_counter_2_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_V_COUNTER_2_reg);

	im_di_rtnr_mad_y_counter_3_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_3_reg);
	im_di_rtnr_mad_u_counter_3_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_U_COUNTER_3_reg);
	im_di_rtnr_mad_v_counter_3_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_V_COUNTER_3_reg);


	RTNR_TempMAD_count_Y = im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery;
	RTNR_TempMAD_count_U = im_di_rtnr_mad_u_counter_reg.cp_temporal_mad_counteru;
	RTNR_TempMAD_count_V = im_di_rtnr_mad_v_counter_reg.cp_temporal_mad_counterv;

	RTNR_TempMAD_count_Y2 = im_di_rtnr_mad_y_counter_2_reg.cp_temporal_mad_countery2;
	RTNR_TempMAD_count_U2 = im_di_rtnr_mad_u_counter_2_reg.cp_temporal_mad_counteru2;
	RTNR_TempMAD_count_V2 = im_di_rtnr_mad_v_counter_2_reg.cp_temporal_mad_counterv2;

	RTNR_TempMAD_count_Y3 = im_di_rtnr_mad_y_counter_3_reg.cp_temporal_mad_countery3;
	RTNR_TempMAD_count_U3 = im_di_rtnr_mad_u_counter_3_reg.cp_temporal_mad_counteru3;
	RTNR_TempMAD_count_V3 = im_di_rtnr_mad_v_counter_3_reg.cp_temporal_mad_counterv3;

	//IphActWid_H=(SmartPic_clue->SCALER_DISP_INFO.IphActWid_H);
	//IpvActLen_V=(SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V);

//====================get condition===========================
	total_pix = IphActWid_H*IpvActLen_V;//Active_Region[1]*Active_Region[3];

	if(di_im_new_mcnr_control3.n_mcnr_mad_hist_shift_en==1)
		total_pix =total_pix/4;
	if(total_pix==0)
		return;

	RTNR_TempMAD_count_Y4 = total_pix - (RTNR_TempMAD_count_Y + RTNR_TempMAD_count_Y2 + RTNR_TempMAD_count_Y3);
	RTNR_TempMAD_count_U4 = total_pix - (RTNR_TempMAD_count_U + RTNR_TempMAD_count_U2 + RTNR_TempMAD_count_U3);
	RTNR_TempMAD_count_V4 = total_pix - (RTNR_TempMAD_count_V + RTNR_TempMAD_count_V2 + RTNR_TempMAD_count_V3);

	RTNR_MAD_count_Y_avg = (RTNR_TempMAD_count_Y*1000)/total_pix;
	RTNR_MAD_count_U_avg = (RTNR_TempMAD_count_U*1000)/total_pix;
	RTNR_MAD_count_V_avg = (RTNR_TempMAD_count_V*1000)/total_pix;

	RTNR_MAD_count_Y2_avg = (RTNR_TempMAD_count_Y2*1000)/total_pix;
	RTNR_MAD_count_U2_avg = (RTNR_TempMAD_count_U2*1000)/total_pix;
	RTNR_MAD_count_V2_avg = (RTNR_TempMAD_count_V2*1000)/total_pix;

	RTNR_MAD_count_Y3_avg = (RTNR_TempMAD_count_Y3*1000)/total_pix;
	RTNR_MAD_count_U3_avg = (RTNR_TempMAD_count_U3*1000)/total_pix;
	RTNR_MAD_count_V3_avg = (RTNR_TempMAD_count_V3*1000)/total_pix;

	SmartPic_clue->RTNR_MAD_count_Y_avg_ratio = RTNR_MAD_count_Y_avg;
	SmartPic_clue->RTNR_MAD_count_U_avg_ratio = RTNR_MAD_count_U_avg;
	SmartPic_clue->RTNR_MAD_count_V_avg_ratio = RTNR_MAD_count_V_avg;
	SmartPic_clue->RTNR_MAD_count_Y2_avg_ratio = RTNR_MAD_count_Y2_avg;
	SmartPic_clue->RTNR_MAD_count_U2_avg_ratio = RTNR_MAD_count_U2_avg;
	SmartPic_clue->RTNR_MAD_count_V2_avg_ratio = RTNR_MAD_count_V2_avg;
	SmartPic_clue->RTNR_MAD_count_Y3_avg_ratio = RTNR_MAD_count_Y3_avg;
	SmartPic_clue->RTNR_MAD_count_U3_avg_ratio = RTNR_MAD_count_U3_avg;
	SmartPic_clue->RTNR_MAD_count_V3_avg_ratio = RTNR_MAD_count_V3_avg;

	SmartPic_clue->RTNR_MAD_count_Y4_avg_ratio = (RTNR_TempMAD_count_Y4*1000)/total_pix;;
	SmartPic_clue->RTNR_MAD_count_U4_avg_ratio = (RTNR_TempMAD_count_U4*1000)/total_pix;
	SmartPic_clue->RTNR_MAD_count_V4_avg_ratio = (RTNR_TempMAD_count_V4*1000)/total_pix;

	SmartPic_clue->noise_ratio = RTNR_MAD_count_Y2_avg;

	if( (MA_print_count%debug_print_delay_time==0) && rtd_inl(0xb802e4f4) == 11 ){
		printk(KERN_EMERG "MAD_1=%d=%d,=%d\n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_U_avg,RTNR_MAD_count_V_avg);
		printk(KERN_EMERG "MAD_2=%d=%d,=%d\n",RTNR_MAD_count_Y2_avg,RTNR_MAD_count_U2_avg,RTNR_MAD_count_V2_avg);
		printk(KERN_EMERG "MAD_3=%d=%d,=%d\n",RTNR_MAD_count_Y3_avg,RTNR_MAD_count_U3_avg,RTNR_MAD_count_V3_avg);
		printk(KERN_EMERG "MAD_4=%d=%d,=%d\n",SmartPic_clue->RTNR_MAD_count_Y4_avg_ratio,SmartPic_clue->RTNR_MAD_count_U4_avg_ratio,SmartPic_clue->RTNR_MAD_count_V4_avg_ratio);
		printk(KERN_EMERG "\n H=%d V=%d,pix=%d\n",IphActWid_H,IpvActLen_V,total_pix);
	}

	/*if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
	{
		printk("H=%d V=%d,pix=%d\n",IphActWid_H,IpvActLen_V,total_pix);
		printk("MAD_1=%d=%d,=%d\n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_U_avg,RTNR_MAD_count_V_avg);
		printk("MAD_2=%d=%d,=%d\n",RTNR_MAD_count_Y2_avg,RTNR_MAD_count_U2_avg,RTNR_MAD_count_V2_avg);
		printk("MAD_3=%d=%d,=%d\n",RTNR_MAD_count_Y3_avg,RTNR_MAD_count_U3_avg,RTNR_MAD_count_V3_avg);
	}*/

#if 1
	unsigned int printf_Flag = system_info_structure_table->ISR_Printf_Flag.MAD_Hist_Flag0;
	unsigned int print_delay = (system_info_structure_table->ISR_Printf_Flag.Delay_Time == 0)?(1):(system_info_structure_table->ISR_Printf_Flag.Delay_Time);
	//for debug.
	if(((printf_Flag&_BIT0)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("MAD_1=%d=%d,=%d\n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_U_avg,RTNR_MAD_count_V_avg);
			printk("MAD_2=%d=%d,=%d\n",RTNR_MAD_count_Y2_avg,RTNR_MAD_count_U2_avg,RTNR_MAD_count_V2_avg);
			printk("MAD_3=%d=%d,=%d\n",RTNR_MAD_count_Y3_avg,RTNR_MAD_count_U3_avg,RTNR_MAD_count_V3_avg);
			printk("MAD_4=%d=%d,=%d\n",SmartPic_clue->RTNR_MAD_count_Y4_avg_ratio,SmartPic_clue->RTNR_MAD_count_U4_avg_ratio,SmartPic_clue->RTNR_MAD_count_V4_avg_ratio);
			printk("H=%d V=%d,pix=%d\n",IphActWid_H,IpvActLen_V,total_pix);
		}
	}
#endif
}


void scalerVIP_HMCNR_statistic(void) // this fucntion is for progressive mode
{
	unsigned int total=0;
	unsigned char i=0;

	di_im_di_rtnr_hmcnr_RBUS di_im_di_rtnr_hmcnr_RBUS_reg;
	di_im_di_rtnr_hmcnr_statistic_1_RBUS di_im_di_rtnr_hmcnr_statistic_1_reg;
	di_im_di_rtnr_hmcnr_statistic_2_RBUS di_im_di_rtnr_hmcnr_statistic_2_reg;
	di_im_di_rtnr_hmcnr_statistic_3_RBUS di_im_di_rtnr_hmcnr_statistic_3_reg;
	di_im_di_rtnr_hmcnr_statistic_4_RBUS di_im_di_rtnr_hmcnr_statistic_4_reg;
	di_im_di_rtnr_hmcnr_statistic_5_RBUS di_im_di_rtnr_hmcnr_statistic_5_reg;
	di_im_di_rtnr_hmcnr_statistic_6_RBUS di_im_di_rtnr_hmcnr_statistic_6_reg;


	di_im_di_rtnr_hmcnr_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_reg);

#if 0	//20150706 roger mark for compiler error
	di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_search_range=5;
#endif
	rtd_outl(DI_IM_DI_RTNR_HMCNR_reg,di_im_di_rtnr_hmcnr_RBUS_reg.regValue);
	di_im_di_rtnr_hmcnr_statistic_1_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_STATISTIC_1_reg);
	di_im_di_rtnr_hmcnr_statistic_2_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_STATISTIC_2_reg);
	di_im_di_rtnr_hmcnr_statistic_3_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_STATISTIC_3_reg);
	di_im_di_rtnr_hmcnr_statistic_4_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_STATISTIC_4_reg);
	di_im_di_rtnr_hmcnr_statistic_5_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_STATISTIC_5_reg);
	di_im_di_rtnr_hmcnr_statistic_6_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_STATISTIC_6_reg);


	hmcnr_sttistic[0]=di_im_di_rtnr_hmcnr_statistic_6_reg.hmcnr_l5_sum;
	hmcnr_sttistic[1]=di_im_di_rtnr_hmcnr_statistic_5_reg.hmcnr_l4_sum;
	hmcnr_sttistic[2]=di_im_di_rtnr_hmcnr_statistic_5_reg.hmcnr_l3_sum;
	hmcnr_sttistic[3]=di_im_di_rtnr_hmcnr_statistic_4_reg.hmcnr_l2_sum;
	hmcnr_sttistic[4]=di_im_di_rtnr_hmcnr_statistic_4_reg.hmcnr_l1_sum;
	hmcnr_sttistic[5]=di_im_di_rtnr_hmcnr_statistic_3_reg.hmcnr_c0_sum;
	hmcnr_sttistic[6]=di_im_di_rtnr_hmcnr_statistic_3_reg.hmcnr_r1_sum;
	hmcnr_sttistic[7]=di_im_di_rtnr_hmcnr_statistic_2_reg.hmcnr_r2_sum;
	hmcnr_sttistic[8]=di_im_di_rtnr_hmcnr_statistic_2_reg.hmcnr_r3_sum;
	hmcnr_sttistic[9]=di_im_di_rtnr_hmcnr_statistic_1_reg.hmcnr_r4_sum;
	hmcnr_sttistic[10]=di_im_di_rtnr_hmcnr_statistic_1_reg.hmcnr_r5_sum;

	for(i=0;i<11;i++)
	{

		total+=hmcnr_sttistic[i];
	}

	if(total==0)
		return;
	center = (hmcnr_sttistic[5]*1000)/total;
	L1 = (hmcnr_sttistic[4]*1000)/total;
	R1 = (hmcnr_sttistic[6]*1000)/total;
	others= ((hmcnr_sttistic[6]+hmcnr_sttistic[5]+hmcnr_sttistic[4])*1000)/total;

	SmartPic_clue->motion_ratio = center;

}



unsigned char scalerVIP_ET_Y_MOTION(void)
{
    static unsigned int et_y_sum_1, et_y_count_1, et_y_sum_2, et_y_count_2;
    di_im_di_rtnr_sad_offset_RBUS im_di_rtnr_sad_offset_reg;
    di_im_di_rtnr_ediff_sobel_th_RBUS im_di_rtnr_ediff_sobel_th_reg;
    di_im_di_rtnr_level_bound_RBUS im_di_rtnr_level_bound_reg;
    di_im_di_rtnr_et_count_y_RBUS im_di_et_count_y_reg;
    di_im_di_rtnr_et_sum_y_RBUS im_di_et_sum_y_reg;
    di_im_di_rtnr_ediff_control_RBUS di_im_di_rtnr_ediff_control_RBUS_reg;
	unsigned char ret_value;

	unsigned int total_pixel;
	//unsigned short Active_Region[4]={0};
	unsigned short IphActWid_H=0,IpvActLen_V=0;
	IphActWid_H=(SmartPic_clue->SCALER_DISP_INFO.IphActWid_H);
	IpvActLen_V=(SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V);
	//drvif_color_activeregion_dragon(_CHANNEL1, &Active_Region[0]);
	total_pixel = IphActWid_H*IpvActLen_V;//Active_Region[1] * Active_Region[3];
	//unsigned short noise_ratio=0, motion_ratio=0, noise_th=0;

    im_di_et_count_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_COUNT_Y_reg);
    im_di_et_sum_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_Y_reg);

    im_di_rtnr_sad_offset_reg.regValue = rtd_inl(DI_IM_DI_RTNR_SAD_OFFSET_reg);
    im_di_rtnr_sad_offset_reg.cp_temporal_sad_offset_y = 0;
    rtd_outl(DI_IM_DI_RTNR_SAD_OFFSET_reg, im_di_rtnr_sad_offset_reg.regValue);

    im_di_rtnr_ediff_sobel_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_EDIFF_SOBEL_TH_reg);
    im_di_rtnr_ediff_sobel_th_reg.cp_temporal_sbl_thm_y = 10;
    im_di_rtnr_ediff_sobel_th_reg.cp_temporal_sbl_ths_y = 10;
    rtd_outl(DI_IM_DI_RTNR_EDIFF_SOBEL_TH_reg, im_di_rtnr_ediff_sobel_th_reg.regValue);

    im_di_rtnr_level_bound_reg.regValue = rtd_inl(DI_IM_DI_RTNR_LEVEL_BOUND_reg);
    im_di_rtnr_level_bound_reg.cp_temporal_nl_low_bnd_y = 0x00;
    im_di_rtnr_level_bound_reg.cp_temporal_nl_up_bnd_y = 0xff;
    rtd_outl(DI_IM_DI_RTNR_LEVEL_BOUND_reg, im_di_rtnr_level_bound_reg.regValue);

    di_im_di_rtnr_ediff_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_EDIFF_CONTROL_reg);
    if(MA_print_count % 2 == 0)
    {
            et_y_count_1 = im_di_et_count_y_reg.cp_temporal_same_et_cnt_y;
            et_y_sum_1 = im_di_et_sum_y_reg.cp_temporal_same_et_sad_sum_y;
			total_motion_count = im_di_et_count_y_reg.cp_temporal_same_et_cnt_y;
            di_im_di_rtnr_ediff_control_RBUS_reg.cp_temporal_num_match_l = 5;
    }
    else
    {
            et_y_count_2 = im_di_et_count_y_reg.cp_temporal_same_et_cnt_y;
            et_y_sum_2 = im_di_et_sum_y_reg.cp_temporal_same_et_sad_sum_y;
			noise_flat_motion_count = im_di_et_count_y_reg.cp_temporal_same_et_cnt_y;
            di_im_di_rtnr_ediff_control_RBUS_reg.cp_temporal_num_match_l = 0;
    }
    rtd_outl(DI_IM_DI_RTNR_EDIFF_CONTROL_reg, di_im_di_rtnr_ediff_control_RBUS_reg.regValue);

#if 0
	noise_ratio = 1000-1000*et_y_count_1/(total_pixel+1);
	motion_ratio = 1000-1000*et_y_count_2/(total_pixel+1);
	edge_motion_count = motion_ratio;

	if(motion_ratio<10)
		noise_th=10;
	else
		noise_th = motion_ratio;

	noise_th = (noise_th*5);

	if(Which_Source==VIP_QUALITY_HDMI_720P||Which_Source==VIP_QUALITY_YPbPr_720P)
	{
		if(Sony_Radio_Caculator_flag==1)
		{
			Off_Correction1_Flag = 0;
		}
		else if(noise_ratio>=noise_th)
		{
			Off_Correction1_Flag = 1;
			Off_Correction1_Flag = 0;
		}
		else
		{
			Off_Correction1_Flag = 0;
		}
	}
	else
	{
		Off_Correction1_Flag = 0;
	}

	if(INR_log==1&&noise_meter_sony_log_flag)
	{
		ROSPrintf("et=%d,%d,%d,%d,%d,%d,%d\n",
			noise_ratio,motion_ratio,noise_th,Off_Correction1_Flag,edge_motion_count,Sony_Radio_Caculator_flag,Which_Source);
	}
	return 0;
#endif
#if 1
	// offset table
    unsigned char motion_table[10][10] =
    {
		{0, 1, 2, 3, 4, 5, 6, 7, 8, 9},
		{1, 2, 3, 4, 5, 6, 7, 8, 9, 9},
		{2, 3, 4, 5, 6, 7, 8, 9, 9, 9},
		{3, 4, 5, 6, 7, 8, 9, 9, 9, 9},
		{4, 5, 6, 7, 8, 9, 9, 9, 9, 9},
		{5, 6, 7, 8, 9, 9, 9, 9, 9, 9},
		{6, 7, 8, 9, 9, 9, 9, 9, 9, 9},
		{7, 8, 9, 9, 9, 9, 9, 9, 9, 9},
		{8, 9, 9, 9, 9, 9, 9, 9, 9, 9},
		{9, 9, 9, 9, 9, 9, 9, 9, 9, 9},
    };

    unsigned char mation_x=0, mation_y=0;
    unsigned int motion_value_1=0, motion_value_2 = 0, motion_diff = 0;
    motion_value_1 = (et_y_sum_1 / (et_y_count_1+1));
	total_motion_count_ave = motion_value_1;
    motion_value_2 = (et_y_sum_2 / (et_y_count_2+1));
	noise_flatl_motion_count_ave = motion_value_2;
    motion_diff = ABS(motion_value_1,motion_value_2);
	edge_motion_count_ave = motion_diff;
	edge_motion_count =  ABS(et_y_count_1,et_y_count_2);

    if(Scaler_InputSrcGetMainChType() == _SRC_CVBS)
    {
            if(motion_value_1 <= 20)               //noise 
                    mation_x = 0;
            else if(motion_value_1 <= 40)
                    mation_x = 1;
            else if(motion_value_1 <= 60)
                    mation_x = 2;
            else if(motion_value_1 <= 80)
                    mation_x = 3;
            else if(motion_value_1 <= 100)
                    mation_x = 4;
            else if(motion_value_1 <= 120)
                    mation_x = 5;
            else if(motion_value_1 <= 140)
                    mation_x = 6;
            else
                    mation_x = 7;

            if(motion_diff <= 5)
                    mation_y = 0;
            else if(motion_diff <= 10)
                    mation_y = 1;
            else if(motion_diff <= 15)
                    mation_y = 2;
            else if(motion_diff <= 20)
                    mation_y = 3;
            else if(motion_diff <= 25)
                    mation_y = 4;
            else if(motion_diff <= 30)
                    mation_y = 5;
            else if(motion_diff <= 35)
                    mation_y = 6;
            else
                    mation_y = 7;

    }
    else
    {
		if(motion_value_1 <= 35)			   //noise 
				mation_x = 0;
		else if(motion_value_1 <= 50)
				mation_x = 1;
		else if(motion_value_1 <= 65)
				mation_x = 2;
		else if(motion_value_1 <= 85)
				mation_x = 3;
		else if(motion_value_1 <= 105)
				mation_x = 4;
		else if(motion_value_1 <= 135)
				mation_x = 5;
		else if(motion_value_1 <= 175)
				mation_x = 6;
		else if(motion_value_1 <= 215)
				mation_x = 7;
		else if(motion_value_1 <= 260)
				mation_x = 8;
		else
				mation_x = 9;

		if(motion_diff <= 15)
				mation_y = 0;
		else if(motion_diff <= 25)
				mation_y = 1;
		else if(motion_diff <= 35)
				mation_y = 2;
		else if(motion_diff <= 50)
				mation_y = 3;
		else if(motion_diff <= 65)
				mation_y = 4;
		else if(motion_diff <= 80)
				mation_y = 5;
		else if(motion_diff <= 95)
				mation_y = 6;
		else if(motion_diff <= 115)
				mation_y = 7;
		else if(motion_diff <= 140)
				mation_y = 8;
		else
				mation_y = 9;

    }
	ret_value = motion_table[mation_y][mation_x];

  #if 0
  if(INR_log==1&&noise_meter_sony_log_flag)
  {
	  ROSPrintf("et=%d,%d,%d,%d,\n",
		  total_motion_count_ave,noise_flatl_motion_count_ave,edge_motion_count_ave,edge_motion_count);
  }
  #endif
    return motion_table[mation_y][mation_x];
  #endif
}

unsigned short scalerVIP_ratio_inner_product_base(unsigned int *vector1, unsigned int *vector2, unsigned char length)
{

	unsigned int inner_product=0;
	unsigned char i;
	for(i=0;i<length;i++)
		inner_product += DCCsqrt_table[*(vector1+i)] * DCCsqrt_table[*(vector2+i)];
	return (inner_product/1000)>>10;// permillage = 1000;
}

unsigned short scalerVIP_ratio_inner_product_base_16(unsigned short *vector1, unsigned short *vector2, unsigned char length)
{

	unsigned int inner_product=0;
	unsigned char i;
	for(i=0;i<length;i++)
		inner_product += DCCsqrt_table[*(vector1+i)] * DCCsqrt_table[*(vector2+i)];
	return (inner_product/1000)>>10;// permillage = 1000;
}

unsigned short scalerVIP_ratio_inner_product(unsigned short *vector1, unsigned short *vector2, unsigned char length)
{
/*	unsigned int inner_product=0;
	unsigned char i;
	for(i=0;i<length;i++)
		inner_product += DCCsqrt_table[*(vector1+i)] * DCCsqrt_table[*(vector2+i)];
	return (inner_product/1000)>>10;// permillage = 1000;
*/

	if ((!vector1)||(!vector2))
		return 0;

	if(length>32)
		length=32;

	unsigned int inner_product1=0;
	unsigned int inner_product2=0;
	unsigned char i;
	unsigned int inner_product3=0;
	unsigned int inner_product4=0;

	unsigned short even1[16];
	unsigned short even2[16];

	unsigned short odd1[17];
	unsigned short odd2[17];

	for(i=0;i<length/2;i++)
	{
		even1[i]=( *(vector1+i*2)+ *(vector1+1+i*2));

		even2[i]=( *(vector2+i*2)+ *(vector2+1+i*2));

	//ROSPrintf("even2[%d]=%d,inner_product4=%d \n",inner_product3,inner_product4);


	}


	for(i=0;i<length/2;i++)
		inner_product1 += DCCsqrt_table[*(even1+i)] * DCCsqrt_table[*(even2+i)];

	//return (inner_product/1000)>>10;// permillage = 1000;


	for(i=0;i<length/2+1;i++)
	{
		if(i==0)
		{
			odd1[i]= *(vector1);
			odd2[i]=*(vector2);

		}
		else if(i==length/2)
		{
			odd1[i]= *(vector1+i*2-1);
			odd2[i]= *(vector2+i*2-1);

		}
		else
		{
			odd1[i]=( *(vector1+i*2-1)+ *(vector1+i*2));
			odd2[i]=( *(vector2+i*2-1)+ *(vector2+i*2));
		}
	}



/*
i=0,data1=0 ,data2=d
i=1,data1=135 ,data2=d
i=2,data1=2 ,data2=d
i=3,data1=134 ,data2=d
i=4,data1=135 ,data2=d
i=5,data1=1 ,data2=d
i=6,data1=134 ,data2=d
i=7,data1=135 ,data2=d
i=8,data1=1 ,data2=d
i=9,data1=133 ,data2=d
i=10,data1=1 ,data2=d
i=11,data1=1 ,data2=d
i=12,data1=0 ,data2=d
i=13,data1=1 ,data2=d
i=14,data1=92 ,data2=d
i=15,data1=2 ,data2=

//No.192 ColorBar
unsigned short DynamicOptimizeSystem_192_y[][32]=
{ //#0 cvbs ntsc , #1 cvbs pal  ,#2 hdmi_sd , #3 hdmi_hd
	{12, 44, 84, 13, 127, 0, 0, 1, 136, 0, 119, 0, 0, 1, 103, 0, 119, 0, 0, 1, 103, 0, 82, 0, 0, 0, 0, 0, 0, 44, 0, 0, },
	{0, 77, 5, 3, 132, 1, 1, 7, 127, 2, 133, 0, 1, 128, 6, 1, 134, 0, 1, 2, 131, 1, 0, 0, 1, 0, 0, 0, 1, 92, 0, 0, },
	//{0, 79, 4, 2, 133, 1, 1, 4, 129, 2, 133, 1, 1, 5, 130, 1, 133, 1, 0, 3, 132, 0, 0, 1, 0, 0, 0, 1, 0, 94, 0, 0, }


	{0, 0, 108, 2, 125, 1, 0, 8, 119, 2, 127, 1, 0, 127, 2, 2, 125, 1, 0, 127, 1, 0, 0, 0, 1, 0, 0, 1, 108, 0, 0, 0, }
};

*/

	for(i=0;i<length/2;i++)
	{
		inner_product2 += DCCsqrt_table[*(odd1+i)] * DCCsqrt_table[*(odd2+i)];

		//ROSPrintf("i=%d,data1=%d ,data2=%d \n",i,*(odd1+i),*(odd2+i));


	}
	inner_product3= (inner_product1/1000)>>10;
	inner_product4= (inner_product2/1000)>>10;


	//if(MA_print_count%40==0)
	//ROSPrintf("inner_product3=%d,inner_product4=%d \n",inner_product3,inner_product4);
	if(inner_product3 >inner_product4)
		return inner_product3;
	else
		return inner_product4;

	//return 1;

	//return (inner_product/1000)>>10;// permillage = 1000;




}


unsigned short scalerVIP_ratio_inner_product2(unsigned short *vector1, unsigned short *vector2, unsigned char length)
{
	unsigned int inner_product1=0;
	unsigned int inner_product2=0;
	unsigned char i;
	unsigned int inner_product3=0;
	unsigned int inner_product4=0;

	unsigned short even1[16];
	unsigned short even2[16];

	unsigned short odd1[17];
	unsigned short odd2[17];

	for(i=0;i<length/2;i++)
	{
		even1[i]=( *(vector1+i*2)+ *(vector1+1+i*2));

		even2[i]=( *(vector2+i*2)+ *(vector2+1+i*2));

	//ROSPrintf("even2[%d]=%d,inner_product4=%d \n",inner_product3,inner_product4);


	}


	for(i=0;i<length/2;i++)
		inner_product1 += DCCsqrt_table[*(even1+i)] * DCCsqrt_table[*(even2+i)];

	//return (inner_product/1000)>>10;// permillage = 1000;


	for(i=0;i<length/2+1;i++)
	{
		if(i==0)
		{
			odd1[i]= *(vector1);
			odd2[i]=*(vector2);

		}
		else if(i==length/2)
		{
			odd1[i]= *(vector1+i*2-1);
			odd2[i]= *(vector2+i*2-1);

		}
		else
		{
			odd1[i]=( *(vector1+i*2-1)+ *(vector1+i*2));
			odd2[i]=( *(vector2+i*2-1)+ *(vector2+i*2));
		}
	}



/*
i=0,data1=0 ,data2=d
i=1,data1=135 ,data2=d
i=2,data1=2 ,data2=d
i=3,data1=134 ,data2=d
i=4,data1=135 ,data2=d
i=5,data1=1 ,data2=d
i=6,data1=134 ,data2=d
i=7,data1=135 ,data2=d
i=8,data1=1 ,data2=d
i=9,data1=133 ,data2=d
i=10,data1=1 ,data2=d
i=11,data1=1 ,data2=d
i=12,data1=0 ,data2=d
i=13,data1=1 ,data2=d
i=14,data1=92 ,data2=d
i=15,data1=2 ,data2=

//No.192 ColorBar
unsigned short DynamicOptimizeSystem_192_y[][32]=
{ //#0 cvbs ntsc , #1 cvbs pal  ,#2 hdmi_sd , #3 hdmi_hd
	{12, 44, 84, 13, 127, 0, 0, 1, 136, 0, 119, 0, 0, 1, 103, 0, 119, 0, 0, 1, 103, 0, 82, 0, 0, 0, 0, 0, 0, 44, 0, 0, },
	{0, 77, 5, 3, 132, 1, 1, 7, 127, 2, 133, 0, 1, 128, 6, 1, 134, 0, 1, 2, 131, 1, 0, 0, 1, 0, 0, 0, 1, 92, 0, 0, },
	//{0, 79, 4, 2, 133, 1, 1, 4, 129, 2, 133, 1, 1, 5, 130, 1, 133, 1, 0, 3, 132, 0, 0, 1, 0, 0, 0, 1, 0, 94, 0, 0, }


	{0, 0, 108, 2, 125, 1, 0, 8, 119, 2, 127, 1, 0, 127, 2, 2, 125, 1, 0, 127, 1, 0, 0, 0, 1, 0, 0, 1, 108, 0, 0, 0, }
};

*/

	for(i=0;i<length/2;i++)
	{
		inner_product2 += DCCsqrt_table[*(odd1+i)] * DCCsqrt_table[*(odd2+i)];

		ROSPrintf("i=%d,data1=%d ,data2=%d \n",i,*(odd1+i),*(odd2+i));


	}
	inner_product3= (inner_product1/1000)>>10;
	inner_product4= (inner_product2/1000)>>10;


	//if(MA_print_count%40==0)
	//ROSPrintf("inner_product3=%d,inner_product4=%d \n",inner_product3,inner_product4);


	return 1;

	//return (inner_product/1000)>>10;// permillage = 1000;












}







unsigned short scalerVIP_ratio_difference(unsigned short *vector1, unsigned short *vector2, unsigned char length)
{
	unsigned int difference=0;
	unsigned char i;
	for(i=0;i<length;i++)
	{
		if(i == 0)
			difference += MIN((ABS(*(vector1+i), *(vector2+i))), (ABS(*(vector1+i), *(vector2+i+1))));
		else if(i == (length-1))
			difference += MIN((ABS(*(vector1+i), *(vector2+i))), (ABS(*(vector1+i), *(vector2+i-1))));
		else
			difference += MIN(MIN((ABS(*(vector1+i), *(vector2+i))), (ABS(*(vector1+i), *(vector2+i+1)))), (ABS(*(vector1+i), *(vector2+i-1))));
	}
	return difference;
}
#endif

#ifdef ISR_AMBILIGHT_ENABLE
void scalerVIP_Clip_Into_Range(unsigned char nBit,int * nData1 ,int * nData2,int * nData3)
{
	int nRange=1;
	int nDiff=0,nMax=0;
	nRange = nRange<<nBit ;
	nRange = nRange -1 ;

	//find Max.
	nMax=*nData1;
	if(*nData2 > nMax)
		nMax=*nData2;
	if(*nData3 > nMax)
		nMax=*nData3;

	//offset
	if(nMax>nRange)
	{
		nDiff=nMax-nRange;
		*nData1 = *nData1-nDiff;
		*nData2 = *nData2-nDiff;
		*nData3 = *nData3-nDiff;
	}
	// clip into Range
	*nData1 = (*nData1>nRange)? nRange:(*nData1<0)? 0:*nData1;
	*nData2 = (*nData2>nRange)? nRange:(*nData2<0)? 0:*nData2;
	*nData3 = (*nData3>nRange)? nRange:(*nData3<0)? 0:*nData3;

}

void scalerVIP_yuv2rgb_convert(void)
{
	unsigned short k11 = 1024, k13 = 1432, k22 = 352, k23 = 728, k32 = 1802; // mutiply by 1024
	int R,G,B;
	unsigned char i = 0;
	#if AMBI_DEBUG_TPV
	static unsigned char yuv2rgb_count = 0;
	yuv2rgb_count++;
	#endif
	unsigned short UV_Value=512;

	for(i=0;i<16;i++)
	{
		R = (INT32)(k11*Profile_Y_V[i] + k13*(Profile_V_V[i]-UV_Value));
		G = (INT32)(k11*Profile_Y_V[i] - k22*(Profile_U_V[i]-UV_Value) - k23*(Profile_V_V[i]-UV_Value));
		B = (INT32)(k11*Profile_Y_V[i] + k32*(Profile_U_V[i]-UV_Value));
		#if AMBI_DEBUG_TPV
		if((yuv2rgb_count % 60) == 0)
		{
		    ROSPrintf("\n [ambi_start] Profile_Y_V[%d]=%d, Profile_U_V[%d]=%d,Profile_V_V[%d]=%d",i,Profile_Y_V[i],i,Profile_U_V[i],i,Profile_V_V[i]);
			ROSPrintf("\n [ambi] R=%d, G=%d,B=%d",R,G,B);
		}
		#endif
		R = R>>10;
		G = G>>10;
		B = B>>10;
		#if AMBI_DEBUG_TPV
		if((yuv2rgb_count % 60) == 0)
		{
			ROSPrintf("\n [ambi] shift R=%d, G=%d,B=%d",R,G,B);
		}
		#endif

		// clip into 10 bit
		scalerVIP_Clip_Into_Range(10,&R,&G,&B);
		#if AMBI_DEBUG_TPV
		if((yuv2rgb_count % 60) == 0)
		{
			ROSPrintf("\n [ambi] 10 bit R=%d, G=%d,B=%d",R,G,B);
		}
		#endif
		Profile_R_V[i] = (unsigned short)R;
		Profile_G_V[i] = (unsigned short)G;
		Profile_B_V[i] = (unsigned short)B;
		R = (INT32)(k11*Profile_Y_H[i] + k13*(Profile_V_H[i]-UV_Value));
		G = (INT32)(k11*Profile_Y_H[i] - k22*(Profile_U_H[i]-UV_Value) - k23*(Profile_V_H[i]-UV_Value));
		B = (INT32)(k11*Profile_Y_H[i] + k32*(Profile_U_H[i]-UV_Value));
		#if AMBI_DEBUG_TPV
		if((yuv2rgb_count % 60) == 0)
		{
		    ROSPrintf("\n [ambi] Profile_Y_H[%d]=%d, Profile_U_H[%d]=%d,Profile_V_H[%d]=%d",i,Profile_Y_H[i],i,Profile_U_H[i],i,Profile_V_H[i]);
			ROSPrintf("\n [ambi] R=%d, G=%d,B=%d",R,G,B);
		}
		#endif
		R = R>>10;
		G = G>>10;
		B = B>>10;
		#if AMBI_DEBUG_TPV
		if((yuv2rgb_count % 60) == 0)
		{
			ROSPrintf("\n [ambi] shift R=%d, G=%d,B=%d",R,G,B);
		}
		#endif

		// clip into 10 bit
		scalerVIP_Clip_Into_Range(10,&R,&G,&B);
		#if AMBI_DEBUG_TPV
		if((yuv2rgb_count % 60) == 0)
		{
			ROSPrintf("\n [ambi] 10 bit R=%d, G=%d,B=%d",R,G,B);
		}
		#endif
		Profile_R_H[i] = R;
		Profile_G_H[i] = G;
	        Profile_B_H[i] = B;
	}
}
#endif

#if CB_flag
void scalerVIP_Identify_Pattern_forCB(void)
{
	unsigned short hue_ratio=0;
	unsigned short y_ratio=0;
	unsigned short hue_ratio2=0;
	unsigned short y_ratio2=0;
	//unsigned short hue_ratio3=0;
	//unsigned short y_ratio3=0;
	//unsigned short hue_ratio4=0;
	//unsigned short y_ratio4=0;
	//unsigned short hue_ratio5=0;
	//unsigned short y_ratio5=0;
	//unsigned short hue_ratio6=0;
	//unsigned short y_ratio6=0;


	unsigned char i;
	//sat_hist_ratio
//	unsigned int noise_status = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL);
	//unsigned int noise_relaible = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE);
	//unsigned int motion = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);
	//unsigned char motionl_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION);
	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);
	static unsigned char pre_source=255;

	for(i=0;i<20;i++)//for_CB
	{
		ID_CB_NO[i]=0;
	}

	pre_source = cur_source;

	switch(cur_source)
	{
		case VIP_QUALITY_CVBS_NTSC:
		{
			//=======      TSB3_CH3   =======
			//TSB3_CH3
			y_ratio = scalerVIP_ratio_inner_product(CB_TSB3_CH3_y1[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(CB_TSB3_CH3_hue1[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("CB_TSB3_CH3_y1=%d,CB_TSB3_CH3_hue1=%d \n",y_ratio,hue_ratio);

			//TSB3_CH3 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(CB_TSB3_CH3_y1[1], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(CB_TSB3_CH3_hue1[1], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("CB_TSB3_CH3_y1 2=%d,CB_TSB3_CH3_hue1 2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=990 && hue_ratio >=990)||(y_ratio2 >=990 && hue_ratio2 >=990))
				ID_CB_NO[0]=1;
			else
				ID_CB_NO[0]=0;
//==============================================================================================//
			//TSB3_CH3
			y_ratio = scalerVIP_ratio_inner_product(CB_TSB3_CH3_y2[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(CB_TSB3_CH3_hue2[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("CB_TSB3_CH3_y2=%d,CB_TSB3_CH3_hue2=%d \n",y_ratio,hue_ratio);

			//TSB3_CH3 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(CB_TSB3_CH3_y2[1], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(CB_TSB3_CH3_hue2[1], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("CB_TSB3_CH3_y2 2=%d,CB_TSB3_CH3_hue2 2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=990 && hue_ratio >=990)||(y_ratio2 >=990 && hue_ratio2 >=990))
				ID_CB_NO[1]=1;
			else
				ID_CB_NO[1]=0;

			//TSB3_CH3
			y_ratio = scalerVIP_ratio_inner_product(CB_TSB3_CH3_y3[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(CB_TSB3_CH3_hue3[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("CB_TSB3_CH3_y3=%d,CB_TSB3_CH3_hue3=%d \n",y_ratio,hue_ratio);

			//TSB3_CH3 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(CB_TSB3_CH3_y3[1], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(CB_TSB3_CH3_hue3[1], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("CB_TSB3_CH3_y3 2=%d,CB_TSB3_CH3_hue3 2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=990 && hue_ratio >=990)||(y_ratio2 >=990 && hue_ratio2 >=990))
				ID_CB_NO[2]=1;
			else
				ID_CB_NO[2]=0;
			//========================

			//=======      SONY_CH84   =======
			//SONY_CH84
			y_ratio = scalerVIP_ratio_inner_product(CB_SONY_CH84_y1[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(CB_SONY_CH84_hue1[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("CB_SONY_CH84_y1=%d,CB_SONY_CH84_hue1=%d \n",y_ratio,hue_ratio);

			//SONY_CH84 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(CB_SONY_CH84_y1[1], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(CB_SONY_CH84_hue1[1], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("CB_SONY_CH84_y1 2=%d,CB_SONY_CH84_hue1 2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				ID_CB_NO[3]=1;
			else
				ID_CB_NO[3]=0;
//==============================================================================================//
			//SONY_CH84
			y_ratio = scalerVIP_ratio_inner_product(CB_SONY_CH84_y2[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(CB_SONY_CH84_hue2[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("CB_SONY_CH84_y2=%d,CB_SONY_CH84_hue2=%d \n",y_ratio,hue_ratio);

			//SONY_CH84 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(CB_SONY_CH84_y2[1], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(CB_SONY_CH84_hue2[1], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("CB_SONY_CH84_y2 2=%d,CB_SONY_CH84_hue2 2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				ID_CB_NO[4]=1;
			else
				ID_CB_NO[4]=0;

			//========================

			//=======     USB_Red_Flower_Bee   =======
			//USB_Red_Flower_Bee
			y_ratio = scalerVIP_ratio_inner_product(CB_USB_Red_Flower_Bee_y1[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(CB_USB_Red_Flower_Bee_hue1[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_5==TRUE))
				ROSPrintf("CB_USB_Red_Flower_Bee_y1=%d,CB_USB_Red_Flower_Bee_hue1=%d \n",y_ratio,hue_ratio);

			//USB_Red_Flower_Bee 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(CB_USB_Red_Flower_Bee_y1[1], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(CB_USB_Red_Flower_Bee_hue1[1], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_5==TRUE))
				ROSPrintf("CB_USB_Red_Flower_Bee_y1 2=%d,CB_USB_Red_Flower_Bee_hue1 2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				ID_CB_NO[5]=1;
			else
				ID_CB_NO[5]=0;
//==============================================================================================//
			//USB_Red_Flower_Bee
			y_ratio = scalerVIP_ratio_inner_product(CB_USB_Red_Flower_Bee_y2[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(CB_USB_Red_Flower_Bee_hue2[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_5==TRUE))
				ROSPrintf("CB_USB_Red_Flower_Bee_y2=%d,CB_USB_Red_Flower_Bee_hue2=%d \n",y_ratio,hue_ratio);

			//USB_Red_Flower_Bee 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(CB_USB_Red_Flower_Bee_y2[1], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(CB_USB_Red_Flower_Bee_hue2[1], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_5==TRUE))
				ROSPrintf("CB_USB_Red_Flower_Bee_y2 2=%d,CB_USB_Red_Flower_Bee_hue2 2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				ID_CB_NO[6]=1;
			else
				ID_CB_NO[6]=0;

			//========================

			break;

		}
		case VIP_QUALITY_CVBS_PAL:
		{

			break;
		}
		case VIP_QUALITY_HDMI_480I:
		case VIP_QUALITY_HDMI_576I:
		case VIP_QUALITY_HDMI_480P:
		case VIP_QUALITY_HDMI_576P:
		{


			break;
		}

		case VIP_QUALITY_HDMI_1080I:
		case VIP_QUALITY_HDMI_1080P:
		{


			break;
		}
		default:

			break;



	}

}

void scalerVIP_Set_Parameter_forCB(void)
{
	_RPC_system_setting_info* RPC_system_info_structure_table = NULL;
	RPC_system_info_structure_table = scaler_GetShare_Memory_RPC_system_setting_info_Struct();

	if((RPC_system_info_structure_table == NULL))
	{
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR, RPC_system_info = %x, \n",RPC_system_info_structure_table);
		return;
	}

	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);
	static unsigned char pre_source =255;

    //=======================================   init rbus
	di_im_di_control_RBUS di_control_reg;
	color_sharp_dm_segpk_vpk2_RBUS dm_segpk_vpk2;

	//======================================      read register
	//di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg ); //rord.tsao mark don't change di seeting avoid 3a/5a setting error 2016/02/19
	dm_segpk_vpk2.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_VPK2_reg );

	//============================================   init old value
	static unsigned char ori_ma_controlmode=0;
	static unsigned char ori_vpk_lv=0;

	//========================================= record old value
	if(pre_source !=cur_source)
	{
		ori_ma_controlmode=di_control_reg.ma_controlmode;// write_enable[2]

		ori_vpk_lv=dm_segpk_vpk2.vpk_lv;
	}

	//==========================================
	pre_source = cur_source;

	switch(cur_source)
	{
		case VIP_QUALITY_CVBS_NTSC:
		if(!vd_pwr_ok)
			break;
       //============   TSB3_CH3  ===========
		if( (ID_CB_NO[0]==1) || (ID_CB_NO[1]==1) || (ID_CB_NO[2]==1) )
		{
			di_control_reg.ma_controlmode = 2; // write_enable[2]
			di_control_reg.write_enable_0 = 1;
			dm_segpk_vpk2.vpk_lv = 77;
		}
		//else
		else if( DynamicOptimizeSystem[139] ==0  )
		{
			di_control_reg.ma_controlmode =ori_ma_controlmode; // write_enable[2]
			di_control_reg.write_enable_0 = 1;
			dm_segpk_vpk2.vpk_lv =ori_vpk_lv;

		}
		rtd_outl(COLOR_SHARP_DM_SEGPK_VPK2_reg, dm_segpk_vpk2.regValue);

		/* henry @ mac5 161219 DI write enable bit */
		//di_control_reg.regValue = di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_0_mask;

        //rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);//rord.tsao mark don't change di seeting avoid 3a/5a setting error 2016/02/19

		//==================================================

		//============   USB_Red_Flower_Bee  ===========
        if( (ID_CB_NO[5]==1) || (ID_CB_NO[6]==1) )
        scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_CB_5_6);

		//==================================

		break;
		default:

			break;
	}

}
#endif

void scalerVIP_Identify_Pattern_forLG_K2L(void)
{
	//unsigned short hue_ratio=0;
	//unsigned short y_ratio=0;

	unsigned char i;
	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);
	static unsigned char pre_source=255;

	for(i=0;i<200;i++)//for_LG_demo
	{
		if(i!=123)
		DynamicOptimizeSystem[i]=0;
	}

	pre_source = cur_source;

	switch(cur_source)
	{
		case VIP_QUALITY_TV_NTSC:
		{
//==============================================================================================//
		/*	//RF NTSC flower identify, roger RF color bar issue
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_179_y[0], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_179_hue[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.RF_flower==TRUE))
				ROSPrintf("RF_flower_y=%d,RF_flower_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=990 && hue_ratio >=990)
				DynamicOptimizeSystem[179]=1;
			else
				DynamicOptimizeSystem[179]=0;
		*/ //rord mark 2015/0827
//==============================================================================================//



		}

		default:

			break;
	}

}


void scalerVIP_Set_Parameter_forLG_K2L(void)
{
	_RPC_system_setting_info* RPC_system_info_structure_table = NULL;
	RPC_system_info_structure_table = scaler_GetShare_Memory_RPC_system_setting_info_Struct();

	if((RPC_system_info_structure_table == NULL))
	{
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR, system_info = %x, \n",RPC_system_info_structure_table);
		return;
	}


	vdtop_auto_pos_ctrl_RBUS auto_pos_ctrl_reg;

	static unsigned char ori_VD_Cr_delay = 0;

	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);
	static unsigned char pre_source =255;


	if (cur_source <= VIP_QUALITY_TV_PAL) {
		if (vd_pwr_ok)
			auto_pos_ctrl_reg.regValue = VDPQ_rtd_inl(VDTOP_AUTO_POS_CTRL_reg);
	}

	if(pre_source !=cur_source)
	{
		ori_VD_Cr_delay = auto_pos_ctrl_reg.cr1delay;
	}

	#if 0	//20151019 roger mark, no need and make cr1delay error when channel change
	switch(cur_source) //20150811 roger, RF flower
	{
		case VIP_QUALITY_TV_NTSC:
		if (!vd_pwr_ok)
			return;

		auto_pos_ctrl_reg.regValue = rtd_inl(VDTOP_AUTO_POS_CTRL_reg);

		if(DynamicOptimizeSystem[179] ==1)
		{

			auto_pos_ctrl_reg.cr1delay = 0x8;
		}
		else
		{

			auto_pos_ctrl_reg.cr1delay=ori_VD_Cr_delay;

		}



		rtd_outl(VDTOP_AUTO_POS_CTRL_reg, auto_pos_ctrl_reg.regValue);
		break;

		default:

			break;

	}
	#endif

}



/*#ifdef LG_Demo_flag*/
void scalerVIP_Identify_Pattern_forLGM2(void)
{
	unsigned short hue_ratio=0;
	unsigned short y_ratio=0;
	unsigned short hue_ratio2=0;
	unsigned short y_ratio2=0;
	unsigned short hue_ratio3=0;
	unsigned short y_ratio3=0;
	unsigned short hue_ratio4=0;
	unsigned short y_ratio4=0;
	unsigned short hue_ratio5=0;
	unsigned short y_ratio5=0;
	unsigned short hue_ratio6=0;
	unsigned short y_ratio6=0;


	unsigned char i;
	//sat_hist_ratio
//	unsigned int noise_status = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL);
//	unsigned int noise_relaible = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE);
	unsigned int motion = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);
	unsigned char motionl_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION);
	unsigned char cur_source = 0;
	static unsigned char pre_source=255;
	unsigned char NTSC_IRE00_OSD_Idx=0,NTSC_IRE75_OSD_Idx=1;
	unsigned char SD_OSD_Idx=3,HD_OSD_Idx=4;

	_RPC_system_setting_info* RPC_system_info_structure_table = NULL;
	RPC_system_info_structure_table = scaler_GetShare_Memory_RPC_system_setting_info_Struct();

	if((RPC_system_info_structure_table == NULL)) {
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR, system_info = %x, \n",RPC_system_info_structure_table);
		return;
	}

	cur_source = (RPC_system_info_structure_table->VIP_source);

//ROSPrintf("\n motion %d ,motionl_level=%d \n",motion,motionl_level);
	for(i=0;i<200;i++)//for_LG_demo
	{
		if(i!=123)
		DynamicOptimizeSystem[i]=0;
	}

	pre_source = cur_source;
	//ROSPrintf("\n black=%d \n",system_info_structure_table->OSD_Info.OSD_Film_Mode);
	switch(cur_source)
	{
		case VIP_QUALITY_TV_NTSC:
		{
		#if 0
//==============================================================================================//
			#if 0
			//RF NTSC flower identify, roger RF color bar issue
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_179_y[0], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_179_hue[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.RF_flower==TRUE))
				ROSPrintf("RF_flower_y=%d,RF_flower_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=990 && hue_ratio >=990)
				DynamicOptimizeSystem[179]=1;
			else
				DynamicOptimizeSystem[179]=0;
			#endif
//==============================================================================================//
			//RF NTSC US-14
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_160_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_160_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			y_ratio2= scalerVIP_ratio_inner_product(DynamicOptimizeSystem_160_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_160_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);

			main_display_control_rsv_RBUS main_display_control_rsv_reg;
			main_display_control_rsv_reg.regValue = rtd_inl(PPOVERLAY_Main_Display_Control_RSV_reg);
			vdpq_dma_ctrl4_RBUS vdpq_dma_ctrl4_reg;
			vdpq_dma_ctrl4_reg.regValue = VDPQ_rtd_inl(VDPQ_DMA_CTRL4_reg);
			static unsigned int cnt0 = 0;

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
			{
				ROSPrintf("motion %d ,motionl_level=%d \n",motion,motionl_level);
				ROSPrintf("RTNR_MAD_count_Y_sum_avg=%d \n",RTNR_MAD_count_Y_sum_avg);
				ROSPrintf("dma_3d_on_off=%d \n",vdpq_dma_ctrl4_reg.dma_3d_on_off);
				ROSPrintf("m_force_bg=%d \n", main_display_control_rsv_reg.m_force_bg);
				ROSPrintf("cnt0=%d \n", cnt0);
			}


			if( main_display_control_rsv_reg.m_force_bg == 0){
				cnt0++;
			}
			else
			{
				cnt0=0;
			}

			if(cnt0 <= 800) {
				if((y_ratio >=950)||(y_ratio2 >=950)||(((vdpq_dma_ctrl4_reg.dma_3d_on_off==0)||(cnt0<=10))&&((y_ratio >=920)||(y_ratio2 >=920)))) {
					DynamicOptimizeSystem[160]=1;
				} else {
					DynamicOptimizeSystem[160]=0;
				}
			} else {
				if((y_ratio >=950 && hue_ratio >=950)||(y_ratio2 >=950 && hue_ratio2 >=950))
					DynamicOptimizeSystem[160]=1;
				else
					DynamicOptimizeSystem[160]=0;
			}

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
			{
				ROSPrintf("DynamicOptimizeSystem[160]=%d, TV NTSC US-14 %d,%d,%d,%d \n", DynamicOptimizeSystem[160],y_ratio,hue_ratio,y_ratio2,hue_ratio2);
			}


//==============================================================================================//
			//RF NTSC US-63			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_161_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_161_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_161_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_161_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
            // for All-Direction Zoom
            hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_161_hue_2[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
            hue_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_161_hue_2[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);

			if(cnt0 <= 200) {
				if((y_ratio >=950)||(y_ratio2 >=950)||(((vdpq_dma_ctrl4_reg.dma_3d_on_off==0)||(cnt0<=10))&&((y_ratio >=920)||(y_ratio2 >=920)))) {
					DynamicOptimizeSystem[161]=1;
				} else {
					DynamicOptimizeSystem[161]=0;
				}
			} else {
				if((y_ratio >=950 && ((hue_ratio >=950)||(hue_ratio3 >=950)))||(y_ratio2 >=950 && ((hue_ratio2 >=950)||(hue_ratio4 >=950))))
					DynamicOptimizeSystem[161]=1;
                else
                    DynamicOptimizeSystem[161]=0;
			}

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem[161]=%d, TV NTSC US-63 %d,%d,%d,%d,%d,%d\n", DynamicOptimizeSystem[161],y_ratio,hue_ratio,y_ratio2,hue_ratio2,hue_ratio3,hue_ratio4);

//==============================================================================================//
			//RF NTSC US-02
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_162_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_162_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_162_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_162_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
            // for All-Direction Zoom
            hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_162_hue_2[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
            hue_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_162_hue_2[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			//Gumi MN02
			y_ratio5 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_Gumi_NM02_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio5 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_Gumi_NM02_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);

			#if 0
				if((y_ratio >=950)||(y_ratio2 >=950)) {
					DynamicOptimizeSystem[162]=1;
				} else {
					DynamicOptimizeSystem[162]=0;
				}
			#else
			if(cnt0 <= 200) {
				if((y_ratio >=950)||(y_ratio2 >=950)||(((vdpq_dma_ctrl4_reg.dma_3d_on_off==0)||(cnt0<=10))&&((y_ratio >=920)||(y_ratio2 >=920))) || (y_ratio5 >=960 && hue_ratio5 >=960)) {
					DynamicOptimizeSystem[162]=1;
				} else {
					DynamicOptimizeSystem[162]=0;
				}
			} else {
				if((y_ratio >=950 && ((hue_ratio >=950)||(hue_ratio3 >=950)) )||(y_ratio2 >=950 && ((hue_ratio2 >=950)||(hue_ratio4 >=950)))||(y_ratio5 >=960 && hue_ratio5 >=960))
					DynamicOptimizeSystem[162]=1;
				else{

					DynamicOptimizeSystem[162]=0;
			}
			}
			#endif

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem[162]=%d, TV NTSC US-02 %d,%d,%d,%d,%d,%d\n", DynamicOptimizeSystem[162],y_ratio,hue_ratio,y_ratio2,hue_ratio2,hue_ratio3,hue_ratio4);

//==============================================================================================//
			//RF NTSC US-04
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_163_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_163_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_163_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_163_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);

			#if 0
				if((y_ratio >=950)||(y_ratio2 >=950)) {
					DynamicOptimizeSystem[163]=1;
				} else {
					DynamicOptimizeSystem[163]=0;
				}

			#else
			if(cnt0 <= 200) {
				if((y_ratio >=950)||(y_ratio2 >=950)||(((vdpq_dma_ctrl4_reg.dma_3d_on_off==0)||(cnt0<=10))&&((y_ratio >=920)||(y_ratio2 >=920)))) {
					DynamicOptimizeSystem[163]=1;
				} else {
					DynamicOptimizeSystem[163]=0;
				}
			} else {
				if((y_ratio >=950 && hue_ratio >=950)||(y_ratio2 >=950 && hue_ratio2 >=950))
					DynamicOptimizeSystem[163]=1;
				else
					DynamicOptimizeSystem[163]=0;
			}
			#endif

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
			{
				ROSPrintf("DynamicOptimizeSystem[163]=%d, TV NTSC US-04 %d,%d,%d,%d\n", DynamicOptimizeSystem[163],y_ratio,hue_ratio,y_ratio2,hue_ratio2);
			}
//==============================================================================================//
			//RF NTSC US-13
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_164_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_164_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_164_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_164_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);

			//RF NTSC US-4CH
			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_Gumi_US_4CH_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_Gumi_US_4CH_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);

			//RF NTSC US-14CH
			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_Gumi_US_14CH_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_Gumi_US_14CH_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);

			if(cnt0 <= 200) {
				if((y_ratio >=950)||(y_ratio2 >=950)||(((vdpq_dma_ctrl4_reg.dma_3d_on_off==0)||(cnt0<=10))&&((y_ratio >=920)||(y_ratio2 >=920)))||(y_ratio3 >=960)||(y_ratio4 >=960)) {
					DynamicOptimizeSystem[164]=1;
				} else {
					DynamicOptimizeSystem[164]=0;
				}
			} else {
				if((y_ratio >=950 && hue_ratio >=950)||(y_ratio2 >=950 && hue_ratio2 >=950)||(y_ratio3 >=960 && hue_ratio3 >=960)||(y_ratio4 >=960 && hue_ratio4 >=960))
					DynamicOptimizeSystem[164]=1;
				else {
					if(DynamicOptimizeSystem[164]==1 && ((y_ratio >=950 && hue_ratio >=950)||(y_ratio2 >=950 && hue_ratio2 >=950)||(y_ratio3 >=950 && hue_ratio3 >=950)||(y_ratio4 >=950 && hue_ratio4 >=950)))
					DynamicOptimizeSystem[164]=1;
				else
					DynamicOptimizeSystem[164]=0;
			}
			}
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
			{
				ROSPrintf("DynamicOptimizeSystem[164]=%d, TV NTSC US-13 %d,%d,%d,%d,%d,%d\n", DynamicOptimizeSystem[164],y_ratio,hue_ratio,y_ratio2,hue_ratio2,y_ratio3,hue_ratio3,y_ratio4,hue_ratio4);
			}
//==============================================================================================//
			//RF NTSC US-C
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_165_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_165_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_165_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_165_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);

			if(cnt0 <= 200) {
				if((y_ratio >=950)||(y_ratio2 >=950)||(((vdpq_dma_ctrl4_reg.dma_3d_on_off==0)||(cnt0<=10))&&((y_ratio >=920)||(y_ratio2 >=920)))) {
					DynamicOptimizeSystem[165]=1;
				} else {
					DynamicOptimizeSystem[165]=0;
				}
			} else {
				if((y_ratio >=950 && hue_ratio >=950)||(y_ratio2 >=950 && hue_ratio2 >=950))
					DynamicOptimizeSystem[165]=1;
				else
					DynamicOptimizeSystem[165]=0;
			}
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
			{
				ROSPrintf("DynamicOptimizeSystem[165]=%d, TV NTSC US-C %d,%d,%d,%d\n", DynamicOptimizeSystem[165],y_ratio,hue_ratio,y_ratio2,hue_ratio2);
			}
//==============================================================================================//
	#endif
			break;
		}
		case VIP_QUALITY_CVBS_NTSC:
		{

			//RGB2YUV_BLACK_LEVEL_UNDEFINE = 0,
			//RGB2YUV_BLACK_LEVEL_LOW,
			//RGB2YUV_BLACK_LEVEL_HIGH,
			//RGB2YUV_BLACK_LEVEL_AUTO,
			if(system_info_structure_table->OSD_Info.OSD_Film_Mode==1)//
			{
				NTSC_IRE00_OSD_Idx = NTSC_IRE00_LOW; //osd black level =low
				NTSC_IRE75_OSD_Idx = NTSC_IRE75_LOW;
			}
			else
			{
				NTSC_IRE00_OSD_Idx = NTSC_IRE00_HIGH; //osd black level !=low
				NTSC_IRE75_OSD_Idx = NTSC_IRE75_HIGH;
			}
			//ROSPrintf("[NTSC]  \n IRE00 %d ,IRE75  %d \n",NTSC_IRE00_OSD_Idx,NTSC_IRE75_OSD_Idx);



			//NO.001 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_001_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_001_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_001_y=%d,DynamicOptimizeSystem_001_hue=%d \n",y_ratio,hue_ratio);

			//NO.001 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_001_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_001_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("[NTSC] lg_No_001_y2=%d,lg_No_001_hue2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[1]=1;
			else
				DynamicOptimizeSystem[1]=0;



//==============================================================================================//

			//NO.002 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_002_y=%d,DynamicOptimizeSystem_002_hue=%d \n",y_ratio,hue_ratio);

			//NO.002 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("[NTSC] lg_No_002_y2=%d,lg_No_002_hue2=%d\n",y_ratio2,hue_ratio2);

			if(((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))&&(motionl_level>1))
				DynamicOptimizeSystem[2]=1;
			else
				DynamicOptimizeSystem[2]=0;
//==============================================================================================//

			//NO.004 identify 0IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_004_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_004_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_004_y=%d,DynamicOptimizeSystem_004_hue=%d \n",y_ratio,hue_ratio);

			//NO.004 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_004_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_004_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("[NTSC] lg_No_004_y2=%d,lg_No_004_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[4]=1;
			else
				DynamicOptimizeSystem[4]=0;

//==============================================================================================//

			//NO.005 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_005_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_005_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_5==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_005_y=%d,DynamicOptimizeSystem_005_hue=%d \n",y_ratio,hue_ratio);

			//NO.005 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_005_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_005_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_5==TRUE))
				ROSPrintf("[NTSC] lg_No_005_y2=%d,lg_No_005_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[5]=1;
			else
				DynamicOptimizeSystem[5]=0;

//==============================================================================================//

			//NO.007 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_007_y=%d,DynamicOptimizeSystem_007_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_y2[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_hue2[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_007_y2=%d,DynamicOptimizeSystem_007_hue2=%d \n",y_ratio2,hue_ratio2);

			//NO.007 identify 7.5 IRE
			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("[NTSC] lg_No_007_y3=%d,lg_No_007_hue3=%d \n",y_ratio3,hue_ratio3);

			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_y2[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_hue2[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("[NTSC] lg_No_007_y4=%d,lg_No_007_hue4=%d \n",y_ratio4,hue_ratio4);

			if((((y_ratio >=970 && hue_ratio >=970)||(y_ratio2 >=970 && hue_ratio2 >=970))||
				((y_ratio3 >=980 && hue_ratio3 >=980)||(y_ratio4 >=980 && hue_ratio4 >=980)))&&
				( sat_ratio_mean_value<120) &&motionl_level>1)
			{
				DynamicOptimizeSystem[7]=1;
			}
			else
			{
				DynamicOptimizeSystem[7]=0;
			}

//==============================================================================================//

			//NO.011 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_011_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_011_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_011_y=%d,DynamicOptimizeSystem_011_hue=%d \n",y_ratio,hue_ratio);

			//NO.011 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_011_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_011_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("[NTSC] lg_No_011_y2=%d,lg_No_011_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[11]=1;
			else
				DynamicOptimizeSystem[11]=0;

//==============================================================================================//

			//NO.012 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_012_y=%d,DynamicOptimizeSystem_012_hue=%d \n",y_ratio,hue_ratio);

			//NO.012 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("[NTSC] lg_No_012_y2=%d,lg_No_012_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[12]=1;
			else
				DynamicOptimizeSystem[12]=0;

//==============================================================================================//

			//NO.023 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_023_y=%d,DynamicOptimizeSystem_023_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y2[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue2[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_023_y2=%d,DynamicOptimizeSystem_023_hue2=%d \n",y_ratio2,hue_ratio2);

			//NO.023 identify  7.5 IRE
			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("[NTSC] lg_No_023_y3=%d,lg_No_023_hue3=%d \n",y_ratio3,hue_ratio3);

			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y2[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio4= scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue2[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("[NTSC] lg_No_023_y4=%d,lg_No_023_hue4=%d \n",y_ratio4,hue_ratio4);



			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980)||
				(y_ratio3 >=980 && hue_ratio3 >=980)||(y_ratio4 >=980 && hue_ratio4 >=980))
				DynamicOptimizeSystem[23]=1;
			else
			{
				DynamicOptimizeSystem[23]=0;
			}

//==============================================================================================//

			//NO.024 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_024_y=%d,DynamicOptimizeSystem_024_hue=%d \n",y_ratio,hue_ratio);

			//NO.024 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("[NTSC] lg_No_024_y2=%d,lg_No_024_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||
				(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[24]=1;
			else
				DynamicOptimizeSystem[24]=0;

//==============================================================================================//

			//NO.028 section 2 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_028_y=%d,DynamicOptimizeSystem_028_hue=%d \n",y_ratio,hue_ratio);

			//NO.028 section 2 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_028_y=%d,DynamicOptimizeSystem_028_hue=%d \n",y_ratio2,hue_ratio2);

			//NO.028 section 1 identify 0 IRE
			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_y2[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_hue2[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_028_y2=%d,DynamicOptimizeSystem_028_hue2=%d \n",y_ratio3,hue_ratio3);

			//NO.028 section 1 identify 7.5 IRE
			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_y2[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_hue2[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_028_y2=%d,DynamicOptimizeSystem_028_hue2=%d \n",y_ratio4,hue_ratio4);


			if( (y_ratio >=980 && hue_ratio >=980) || (y_ratio2 >=980 && hue_ratio2 >=980) )
				DynamicOptimizeSystem[28]=1; // section 2 hit
			else if( (y_ratio3 >=980 && hue_ratio3 >=980) || (y_ratio4 >=980 && hue_ratio4 >=980) )
				DynamicOptimizeSystem[28]=2; // section 1 hit
			else
				DynamicOptimizeSystem[28]=0;


//==============================================================================================//
/*
			//NO.032 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_032_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_32==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_032_y=%d \n",y_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_032_y2[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_32==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_032_y2=%d \n",y_ratio2);

			//NO.032 identify 7.5 IRE
			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_032_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_32==TRUE))
				ROSPrintf("[NTSC] lg_No_032_y3=%d \n",y_ratio3);

			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_032_y2[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_32==TRUE))
				ROSPrintf("[NTSC] lg_No_032_y4=%d \n",y_ratio4);


			if((((y_ratio >=980)||(y_ratio2 >=980))||((y_ratio3 >=980)||(y_ratio4 >=980)))&&
				(sat_ratio_mean_value <=35)&&(motion>100))
				DynamicOptimizeSystem[32]=1;
			else
				DynamicOptimizeSystem[32]=0;
*/
//==============================================================================================//

			//NO.035 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_035_y=%d \n",y_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y2[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_035_y2=%d \n",y_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y3[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_035_y3=%d \n",y_ratio3);

			//NO.035 identify 7.5 IRE
			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[NTSC] lg_No_035_y4=%d \n",y_ratio4);

			y_ratio5 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y2[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[NTSC] lg_No_035_y5=%d \n",y_ratio5);

			y_ratio6 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y3[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[NTSC] lg_No_035_y6=%d \n",y_ratio6);


			if((((y_ratio >=970)||(y_ratio2 >=970)||(y_ratio3 >=970))||
				((y_ratio4 >=980)||(y_ratio5 >=980)||(y_ratio6 >=980)))&&(sat_ratio_mean_value <=35))
				DynamicOptimizeSystem[35]=1;
			else
				DynamicOptimizeSystem[35]=0;

//==============================================================================================//

  			//NO.044 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_044_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_044_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_044_y=%d,DynamicOptimizeSystem_044_hue=%d \n",y_ratio,hue_ratio);

			//NO.024 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_044_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_044_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("[NTSC] lg_No_044_y2=%d,lg_No_044_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=945 && hue_ratio >=980)||
				(y_ratio2 >=945 && hue_ratio2 >=980))
				DynamicOptimizeSystem[44]=1;
			else
				DynamicOptimizeSystem[44]=0;

//==============================================================================================//
/*
			//NO.047 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_y[0], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_hue[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_47==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_047_y=%d,DynamicOptimizeSystem_047_hue=%d \n",y_ratio,hue_ratio);
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_y2[0], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_47==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_047_y2=%d \n",y_ratio2);

			//NO.047 identify 7.5 IRE
			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_y[1], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_hue[1], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_47==TRUE))
				ROSPrintf("[NTSC] lg_No_047_y3=%d,lg_No_047_hue3=%d \n",y_ratio3,hue_ratio3);

			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_y2[1], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_47==TRUE))
				ROSPrintf("[NTSC] lg_No_047_y4=%d  \n",y_ratio4);


			//if(((y_ratio >=970 && hue_ratio >=980)||(y_ratio2 >=970 && hue_ratio >=980))||
			//	((y_ratio3 >=970 && hue_ratio2 >=980)||(y_ratio4 >=970 && hue_ratio2 >=980)))
			//	DynamicOptimizeSystem[47]=1;
			//else
			//	DynamicOptimizeSystem[47]=0;
*/

//==============================================================================================//
			//NO.63 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_063_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_063_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_063_y=%d,DynamicOptimizeSystem_063_hue=%d \n",y_ratio,hue_ratio);

			//NO.63 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_063_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_063_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[NTSC] lg_No_063_y2=%d,lg_No_063_hue2=%d \n",y_ratio2,hue_ratio2);

			if(((y_ratio >=980 && hue_ratio >=980)||
				(y_ratio2 >=980 && hue_ratio2 >=980)) &&
				motionl_level<10 && scalerVIP_DI_MiddleWare_GetStatus(STATUS_HIGHFREQUENCY_LEVEL)<10 )
			{
				DynamicOptimizeSystem[63]=1;
			}
			else
			{
				DynamicOptimizeSystem[63]=0;
			}

//==============================================================================================//
			//NO.075 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_075_y=%d,DynamicOptimizeSystem_075_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_y2[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_hue2[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_075_y=%d,DynamicOptimizeSystem_075_hue=%d \n",y_ratio2,hue_ratio2);

			//NO.075 identify 7.5 IRE
			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_075_y2=%d,DynamicOptimizeSystem_075_hue2=%d \n",y_ratio3,hue_ratio3);

			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_y2[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_hue2[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_075_y=%d,DynamicOptimizeSystem_075_hue=%d \n",y_ratio4,hue_ratio4);


			if((y_ratio  >=980 && hue_ratio  >=980)||(y_ratio2 >=980 && hue_ratio2 >=980)||
				(y_ratio3 >=980 && hue_ratio3 >=980)||(y_ratio4 >=980 && hue_ratio4 >=980))
				DynamicOptimizeSystem[75]=1;
			else
				DynamicOptimizeSystem[75]=0;
//==============================================================================================//


			//NO.107 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_107_y=%d,DynamicOptimizeSystem_107_hue=%d \n",y_ratio,hue_ratio);

			//NO.107 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[NTSC] lg_No_107_y2=%d,lg_No_107_hue2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[107]=1;
			else
				DynamicOptimizeSystem[107]=0;

//==============================================================================================//

			//NO.123 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_123_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_123_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_123==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_123_y=%d,DynamicOptimizeSystem_123_hue=%d \n",y_ratio,hue_ratio);

			//NO.123 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_123_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_123_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_123==TRUE))
				ROSPrintf("[NTSC] lg_No_123_y2=%d,lg_No_123_hue2=%d \n",y_ratio2,hue_ratio2);



			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[123]=1;
			else
			{
//				if(SmartPic_clue->SceneChange_NR)
				DynamicOptimizeSystem[123]=0;
			}

			//ROSPrintf("[NTSC] SceneChange=%d \n",SmartPic_clue->SceneChange_NR);

//==============================================================================================//
#if 0 			//NO.132 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_132==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_132_y=%d,DynamicOptimizeSystem_132_hue=%d \n",y_ratio,hue_ratio);

			//NO.132 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_132==TRUE))
				ROSPrintf("[NTSC] lg_No_132_y2=%d,lg_No_132_hue2=%d \n",y_ratio2,hue_ratio2);


			//if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
			//	DynamicOptimizeSystem[132]=1;
			//else
			//	DynamicOptimizeSystem[132]=0;
#endif
//==============================================================================================//

			//NO.133 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_133_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_133_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_133_y=%d,DynamicOptimizeSystem_133_hue=%d \n",y_ratio,hue_ratio);

			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_133_hue2[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_133_y=%d,lg_No_133_hue3=%d \n",y_ratio,hue_ratio3);

			//NO.133 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_133_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_133_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[NTSC] lg_No_133_y2=%d,DynamicOptimizeSystem_133_hue2=%d \n",y_ratio2,hue_ratio2);

			if(((y_ratio >=980 && hue_ratio >=960)||(y_ratio >=980 && hue_ratio3 >=960)||(y_ratio2 >=973 && hue_ratio2 >=973))&&(sat_ratio_mean_value<=35))
				DynamicOptimizeSystem[133]=1;
			else
				DynamicOptimizeSystem[133]=0;

//==============================================================================================//

			//NO.134 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_134_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_134_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_134_y=%d,DynamicOptimizeSystem_134_hue=%d \n",y_ratio,hue_ratio);

			//NO.134 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_134_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_134_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[NTSC] lg_No_134_y2=%d,lg_No_134_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[134]=1;
			else
				DynamicOptimizeSystem[134]=0;

//==============================================================================================//

			//NO.135 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_135_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_135_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_135_y=%d,DynamicOptimizeSystem_135_hue=%d \n",y_ratio,hue_ratio);

			//NO.135 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_135_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_135_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[NTSC] lg_No_135_y2=%d,lg_No_135_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[135]=1;
			else
				DynamicOptimizeSystem[135]=0;

//==============================================================================================//

			//NO.139 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_139_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_139==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_139_y=%d,sat_ratio_mean_value=%d \n",y_ratio,sat_ratio_mean_value);

			//NO.139 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_139_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_139==TRUE))
				ROSPrintf("[NTSC] lg_No_139_y2=%d,sat_ratio_mean_value=%d \n",y_ratio,sat_ratio_mean_value);

			//NO.139 identify//for_LG_demo
			//y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_139_y[2], &Y_hist_ratio[0], 32);
			//if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_139==TRUE))
			//	ROSPrintf("[NTSC] DynamicOptimizeSystem_139_y=%d,sat_ratio_mean_value=%d \n",y_ratio,sat_ratio_mean_value);

			if((y_ratio >=970 || y_ratio2 >=980)&& sat_ratio_mean_value<=40)
				DynamicOptimizeSystem[139]=1;
			else
				DynamicOptimizeSystem[139]=0;

//==============================================================================================//

			//NO.147,148,149,150 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_147_y=%d,DynamicOptimizeSystem_147_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y2[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue2[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_147_y2=%d,DynamicOptimizeSystem_147_hue2=%d \n",y_ratio2,hue_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y3[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue3[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_147_y3=%d,DynamicOptimizeSystem_147_hue3=%d \n",y_ratio3,hue_ratio3);

			//NO.147,148,149,150 identify 7.5 IRE
			y_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio4 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[NTSC] lg_No_147_y4=%d,lg_No_147_hue4=%d \n",y_ratio4,hue_ratio4);

			y_ratio5 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y2[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio5 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue2[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[NTSC] lg_No_147_y5=%d,lg_No_147_hue5=%d \n",y_ratio5,hue_ratio5);

			y_ratio6 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y3[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio6 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue3[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[NTSC] lg_No_147_y6=%d,lg_No_147_hue6=%d \n",y_ratio6,hue_ratio6);

			if((y_ratio >=980&&hue_ratio >=980)||(y_ratio2 >=980&&hue_ratio2 >=980)||(y_ratio3 >=980&&hue_ratio3 >=980)||
				(y_ratio4 >=980&&hue_ratio4 >=980)||(y_ratio5 >=980&&hue_ratio5 >=980)||(y_ratio6 >=980&&hue_ratio6 >=980))
				DynamicOptimizeSystem[147]=1;
			else
				DynamicOptimizeSystem[147]=0;
//==============================================================================================//

			//NO.151  0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_151_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_191==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_151_y=%d \n",y_ratio);

			//NO.151  7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_151_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_192==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_151_y=%d \n",y_ratio2);

			if((y_ratio >=990 ||y_ratio2 >=990)&& sat_ratio_mean_value<=40&&motionl_level>18&&motionl_level<25)
				DynamicOptimizeSystem[151]=1;
			else
				DynamicOptimizeSystem[151]=0;

//==============================================================================================//

			//NO.188 identify LG leaf #44(NTSC) motion black white line 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_188_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_188_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_188_y=%d,DynamicOptimizeSystem_188_hue=%d \n",y_ratio,hue_ratio);

			//NO.188 identify LG leaf #44(NTSC) motion black white
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_188_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_188_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_188_y=%d,DynamicOptimizeSystem_188_hue=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=990 && hue_ratio >=990)||(y_ratio2 >=990 && hue_ratio2 >=990))
				DynamicOptimizeSystem[188]=1;
			else
				DynamicOptimizeSystem[188]=0;

//==============================================================================================//

			//NO.189 identify LG leaf #72 color scrolling text 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_189_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_189_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_189_y=%d,DynamicOptimizeSystem_189_hue=%d \n",y_ratio,hue_ratio);

			//NO.189 identify LG leaf #72 color scrolling text 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_189_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_189_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_189_y=%d,DynamicOptimizeSystem_189_hue=%d \n",y_ratio2,hue_ratio2);



			if((y_ratio >=990 && hue_ratio >=990)||(y_ratio2 >=990 && hue_ratio2 >=990))
				DynamicOptimizeSystem[189]=1;
			else
				DynamicOptimizeSystem[189]=0;


//==============================================================================================//

			//NO.191 identify LG COLORBAR 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_191_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_191_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_191==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_191_y=%d,DynamicOptimizeSystem_191_hue=%d \n",y_ratio,hue_ratio);

			//NO.191 identify LG COLORBAR 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_191_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_191_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_192==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_191_y=%d,DynamicOptimizeSystem_191_hue=%d \n",y_ratio2,hue_ratio2);



			if((y_ratio >=990 && hue_ratio >=990)||(y_ratio2 >=990 && hue_ratio2 >=990))
				DynamicOptimizeSystem[191]=1;
			else
				DynamicOptimizeSystem[191]=0;


//==============================================================================================//

			//NO.192 identify LG MONSCOPE 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_192_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_192==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_192_y=%d,sat_ratio_mean_value=%d\n",y_ratio,sat_ratio_mean_value);

			//NO.192 identify LG MONSCOPE 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_192_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_192==TRUE))
				ROSPrintf("[NTSC] lg_No_192_y2=%d,sat_ratio_mean_value=%d\n",y_ratio,sat_ratio_mean_value);


			if((y_ratio >=970||y_ratio2 >=980 )&& sat_ratio_mean_value<50)
				DynamicOptimizeSystem[192]=1;
			else
				DynamicOptimizeSystem[192]=0;

//==============================================================================================//

			//NO.193 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_193_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_193_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_193==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_193_y=%d,DynamicOptimizeSystem_193_hue=%d \n",y_ratio,hue_ratio);

			//NO.193 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_193_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_193_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_193==TRUE))
				ROSPrintf("[NTSC] lg_No_193_y2=%d,lg_No_193_hue2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=970 && hue_ratio >=970)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[193]=1;
			else
				DynamicOptimizeSystem[193]=0;

//==============================================================================================//

			//NO.194 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_194_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_194_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_194==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_194_y=%d,DynamicOptimizeSystem_194_hue=%d \n",y_ratio,hue_ratio);

			//NO.194 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_194_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_194_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_194==TRUE))
				ROSPrintf("[NTSC] lg_No_194_y2=%d,lg_No_194_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=970 && hue_ratio >=970)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[194]=1;
			else
				DynamicOptimizeSystem[194]=0;

//==============================================================================================//

			//NO.195 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_195_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_195_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_195==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_195_y=%d,DynamicOptimizeSystem_195_hue=%d \n",y_ratio,hue_ratio);

			//NO.195 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_195_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_195_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_195==TRUE))
				ROSPrintf("[NTSC] lg_No_195_y2=%d,lg_No_195_hue2=%d \n",y_ratio2,hue_ratio2);


			if((y_ratio >=970 && hue_ratio>=970)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[195]=1;
			else
				DynamicOptimizeSystem[195]=0;

//==============================================================================================//

			//NO.196 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_196_y[NTSC_IRE00_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_196_hue[NTSC_IRE00_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_196==TRUE))
				ROSPrintf("[NTSC] DynamicOptimizeSystem_196_y=%d,DynamicOptimizeSystem_196_hue=%d \n",y_ratio,hue_ratio);


			//NO.196 identify 7.5 IRE
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_196_y[NTSC_IRE75_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_196_hue[NTSC_IRE75_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_196==TRUE))
				ROSPrintf("[NTSC] lg_No_196_y2=%d,lg_No_196_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=970 && hue_ratio >=970)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[196]=1;
			else
				DynamicOptimizeSystem[196]=0;

			break;

		}
		case VIP_QUALITY_CVBS_PAL:
		{
			//PAL Only One black level Mode

			//NO.001 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_001_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_001_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_001_y=%d,DynamicOptimizeSystem_001_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=970 && hue_ratio >=970)
			{
				DynamicOptimizeSystem[1]=1;
			}
			else
			{
				DynamicOptimizeSystem[1]=0;
			}
			//ROSPrintf(" \n IRE00 %d ,IRE75  %d \n",NTSC_IRE00_OSD_Idx,NTSC_IRE75_OSD_Idx);

			//==============================================================================================//


			//NO.002 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_002_y=%d,DynamicOptimizeSystem_002_hue=%d \n",y_ratio,hue_ratio);

            if(y_ratio >=970 && hue_ratio >=970 && motion<1500 )
				DynamicOptimizeSystem[2]=1;
			else
				DynamicOptimizeSystem[2]=0;

//==============================================================================================//

			//NO.004 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_004_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_004_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_004_y=%d,DynamicOptimizeSystem_004_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980&&motionl_level>16)
			{
				DynamicOptimizeSystem[4]=1;
			}
			else
			{
				DynamicOptimizeSystem[4]=0;
			}

//==============================================================================================//

			//NO.005identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_005_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_005_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_5==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_005_y=%d,DynamicOptimizeSystem_005_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=970 && hue_ratio >=965)
				DynamicOptimizeSystem[5]=1;
			else
				DynamicOptimizeSystem[5]=0;

//==============================================================================================//

			//NO.007 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_007_y=%d,DynamicOptimizeSystem_007_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_y2[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_hue2[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_007_y2=%d,DynamicOptimizeSystem_007_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=970 && hue_ratio >=990)||(y_ratio2 >=970 && hue_ratio2 >=990))
			{
				DynamicOptimizeSystem[7]=1;
			}
			else
			{
				DynamicOptimizeSystem[7]=0;
			}

//==============================================================================================//

      //NO.011 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_011_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_011_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_011_y=%d,DynamicOptimizeSystem_011_hue=%d \n",y_ratio,hue_ratio);

      if(y_ratio >=990 && hue_ratio >=990)
				DynamicOptimizeSystem[11]=1;
			else
				DynamicOptimizeSystem[11]=0;

//==============================================================================================//

			//NO.012 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_012_y=%d,DynamicOptimizeSystem_012_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=990 && hue_ratio >=990&& motionl_level>=7)
			{
				DynamicOptimizeSystem[12]=1;
			}
			else
			{
				DynamicOptimizeSystem[12]=0;
			}

//==============================================================================================//

			//NO.023 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_023_y=%d,DynamicOptimizeSystem_023_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y2[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue2[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_023_y2=%d,DynamicOptimizeSystem_023_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
			{
				DynamicOptimizeSystem[23]=1;
			}
			else
			{
				DynamicOptimizeSystem[23]=0;
			}
//==============================================================================================//

			//NO.024 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_024_y=%d,DynamicOptimizeSystem_024_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=970 && hue_ratio >=980)//for_LG_demo
			{
				DynamicOptimizeSystem[24]=1;
			}
			else
			{
				DynamicOptimizeSystem[24]=0;
			}
//==============================================================================================//

			//NO.028 section2 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_028_y=%d,DynamicOptimizeSystem_028_hue=%d \n",y_ratio,hue_ratio);

			//NO.028 section1 identify
			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_y2[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_hue2[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_028_y2=%d,DynamicOptimizeSystem_028_hue2=%d \n",y_ratio,hue_ratio);


			if( (y_ratio >=980 && hue_ratio >=980) )
				DynamicOptimizeSystem[28]=1; // section 2 hit
			else if( (y_ratio2 >=980 && hue_ratio2 >=980) )
				DynamicOptimizeSystem[28]=2; // section 1 hit
			else
				DynamicOptimizeSystem[28]=0;


//==============================================================================================//

			//NO.035 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_035_y=%d \n",y_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y2[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_hue2[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_035_y2=%d=%d \n",y_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y3[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_035_y3=%d=%d \n",y_ratio3);

			if((y_ratio >=970)||(y_ratio2 >=970)||(y_ratio3 >=970))
			{
				DynamicOptimizeSystem[35]=1;
			}
			else
			{
				DynamicOptimizeSystem[35]=0;
			}
//==============================================================================================//
			//NO.39 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_039_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_039_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_039_y=%d,DynamicOptimizeSystem_039_hue=%d \n",y_ratio,hue_ratio);

			if( (y_ratio >=980) && (hue_ratio >=980) && (scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN)>=2) )
				DynamicOptimizeSystem[39]=1;
			else
				DynamicOptimizeSystem[39]=0;


//==============================================================================================//
#if 0
			//NO.047 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_y[2], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_hue[2], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_47==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_047_y=%d,DynamicOptimizeSystem_047_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_y2[2], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_47==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_047_y2=%d,DynamicOptimizeSystem_047_hue=%d \n",y_ratio2,hue_ratio);


			if((y_ratio >=970 && hue_ratio >=980)||((y_ratio2 >=970 && hue_ratio >=980)))
				DynamicOptimizeSystem[47]=1;
			else
				DynamicOptimizeSystem[47]=0;
# endif

//==============================================================================================//
			//NO.63 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_063_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_063_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_063_y=%d,DynamicOptimizeSystem_063_hue=%d \n",y_ratio,hue_ratio);

			if( (y_ratio >=980 && hue_ratio >=980) && motionl_level<10 && scalerVIP_DI_MiddleWare_GetStatus(STATUS_HIGHFREQUENCY_LEVEL)<10 )
			{
				DynamicOptimizeSystem[63]=1;
			}
			else
			{
				DynamicOptimizeSystem[63]=0;
			}


//==============================================================================================//

			//NO.075 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_075_y=%d,DynamicOptimizeSystem_075_hue=%d \n",y_ratio,hue_ratio);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[75]=1;
			else
				DynamicOptimizeSystem[75]=0;

//==============================================================================================//
			//NO.107 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_107_y=%d,DynamicOptimizeSystem_107_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980&&motionl_level>3)
			{
				DynamicOptimizeSystem[107]=1;
			}
			else
				{
				DynamicOptimizeSystem[107]=0;
			}

//==============================================================================================//

			//NO.123 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_123_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_123_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_123==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_123_y=%d,DynamicOptimizeSystem_123_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=970 && hue_ratio >=970)
				DynamicOptimizeSystem[123]=1;
			else
				DynamicOptimizeSystem[123]=0;

//==============================================================================================//
#if 0
			//NO.132 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_y[PAL_AUTO], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_132==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_132_y=%d,DynamicOptimizeSystem_132_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=970 && hue_ratio >=970)
				DynamicOptimizeSystem[132]=1;
			else
				DynamicOptimizeSystem[132]=0;
#endif
//==============================================================================================//

			//NO.133 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_133_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_133_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_133_y=%d,DynamicOptimizeSystem_133_hue=%d \n",y_ratio,hue_ratio);


			//if((y_ratio >=980 && hue_ratio >=960)&&(sat_ratio_mean_value<=35))
			if((y_ratio >=980 )&&(sat_ratio_mean_value<=35))
				DynamicOptimizeSystem[133]=1;
			else
				DynamicOptimizeSystem[133]=0;

//==============================================================================================//

			//NO.134 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_134_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_134_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_134_y=%d,DynamicOptimizeSystem_134_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[134]=1;
			else
				DynamicOptimizeSystem[134]=0;
//==============================================================================================//

			//NO.135 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_135_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_135_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_133==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_135_y=%d,DynamicOptimizeSystem_135_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[135]=1;
			else
				DynamicOptimizeSystem[135]=0;
//==============================================================================================//

			//NO.139 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_139_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_139==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_139_y=%d,lg_No_139_hue=%d \n",y_ratio,hue_ratio);


			if((y_ratio >=980)&& sat_ratio_mean_value<=40)
				DynamicOptimizeSystem[139]=1;
			else
				DynamicOptimizeSystem[139]=0;

//==============================================================================================//

			//NO.147 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_147_y=%d,DynamicOptimizeSystem_147_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y2[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue2[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_147_y2=%d,DynamicOptimizeSystem_147_hue2=%d \n",y_ratio2,hue_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y3[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue3[PAL_AUTO], &hue_hist_ratio[0], 24);

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_147_y3=%d,DynamicOptimizeSystem_147_hue3=%d \n",y_ratio3,hue_ratio3);

			if((y_ratio >=980&&hue_ratio >=980)||(y_ratio2 >=980&&hue_ratio2 >=980)||(y_ratio3 >=980&&hue_ratio3 >=980))
				DynamicOptimizeSystem[147]=1;
			else
				DynamicOptimizeSystem[147]=0;
//==============================================================================================//

			//NO.151
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_151_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_191==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_151_y=%d \n",y_ratio);

			if((y_ratio >=990 )&& sat_ratio_mean_value<=40&&motionl_level>18&&motionl_level<25)
				DynamicOptimizeSystem[151]=1;
			else
				DynamicOptimizeSystem[151]=0;

//==============================================================================================//

			//NO.188 identify LLG leaf #46(PAL) motion black white
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_188_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_188_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
            hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_188_hue_2[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_188_y=%d,DynamicOptimizeSystem_188_hue=%d,DynamicOptimizeSystem_188_hue_2=%d \n",y_ratio,hue_ratio,hue_ratio2);

			if(y_ratio >=990 && (hue_ratio >=980 || hue_ratio2>= 980))
				DynamicOptimizeSystem[188]=1;
			else
				DynamicOptimizeSystem[188]=0;

//==============================================================================================//

			//NO.189 identify LG leaf #74 color scrolling text
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_189_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_189_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_189_y=%d,DynamicOptimizeSystem_189_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=990 && hue_ratio >=990)
				DynamicOptimizeSystem[189]=1;
			else
				DynamicOptimizeSystem[189]=0;

//==============================================================================================//
#if 0
			//NO.191 identify LG COLORBAR

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_191_y[PAL_AUTO], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_191_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_191==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_191_y=%d,DynamicOptimizeSystem_191_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=990 && hue_ratio >=990)
			{
				DynamicOptimizeSystem[191]=1;
			}
			else

			{
				DynamicOptimizeSystem[191]=0;
			}

#endif
//==============================================================================================//

			//NO.192 identify LG MONSCOPE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_192_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_192==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_192_y=%d,sat_ratio_mean_value=%d\n",y_ratio,sat_ratio_mean_value);

			if(y_ratio >=990 && sat_ratio_mean_value<50)
			{
				DynamicOptimizeSystem[192]=1;
			}
			else

			{
				DynamicOptimizeSystem[192]=0;
			}

//==============================================================================================//

			//NO.193 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_193_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_193_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_193==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_193_y=%d,DynamicOptimizeSystem_193_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=970 && hue_ratio >=970)
				DynamicOptimizeSystem[193]=1;
			else
				DynamicOptimizeSystem[193]=0;

//==============================================================================================//

			//NO.194 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_194_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_194_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_194==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_194_y=%d,DynamicOptimizeSystem_194_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=970 && hue_ratio >=970)
				DynamicOptimizeSystem[194]=1;
			else
				DynamicOptimizeSystem[194]=0;

//==============================================================================================//

			//NO.195 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_195_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_195_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_195==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_195_y=%d,DynamicOptimizeSystem_195_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[195]=1;
			else
				DynamicOptimizeSystem[195]=0;

//==============================================================================================//

			//NO.196 identify 0 IRE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_196_y[PAL_AUTO], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_196_hue[PAL_AUTO], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_196==TRUE))
				ROSPrintf("[PALI] DynamicOptimizeSystem_196_y=%d,DynamicOptimizeSystem_196_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=970 && hue_ratio >=970)
				DynamicOptimizeSystem[196]=1;
			else
				DynamicOptimizeSystem[196]=0;

			break;
		}
		case VIP_QUALITY_HDMI_480I:
		case VIP_QUALITY_HDMI_576I:
		case VIP_QUALITY_HDMI_480P:
		case VIP_QUALITY_HDMI_576P:
		{

			if(system_info_structure_table->OSD_Info.OSD_Film_Mode==1)//
			{
				SD_OSD_Idx = SD_LOW; //osd black level =low
			}
			else
			{
				SD_OSD_Idx = SD_HIGH; //osd black level !=low
			}

			//ROSPrintf(" \n SD_OSD_Idx %d \n",SD_OSD_Idx);
			//NO.01 identify//for_LG_demo
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_001_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_001_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("DynamicOptimizeSystem_001_y=%d,DynamicOptimizeSystem_001_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[1]=1;
			else
				DynamicOptimizeSystem[1]=0;
//==============================================================================================//


			//NO.02 identify//for_LG_demo
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("DynamicOptimizeSystem_002_y=%d,DynamicOptimizeSystem_002_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[2]=1;
			else
				DynamicOptimizeSystem[2]=0;
//==============================================================================================//

			//NO.007 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("DynamicOptimizeSystem_007_y=%d,DynamicOptimizeSystem_007_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_y2[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_007_hue2[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_7==TRUE))
				ROSPrintf("DynamicOptimizeSystem_007_y=%d,DynamicOptimizeSystem_007_hue=%d \n",y_ratio2,hue_ratio2);


			if(((y_ratio >=970 && hue_ratio >=970)||(y_ratio2 >=970 && hue_ratio2 >=970))&&( sat_ratio_mean_value<100) )

				DynamicOptimizeSystem[7]=1;
			else
				DynamicOptimizeSystem[7]=0;

//==============================================================================================//

			//NO.012 identify//for_LG_demo
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("DynamicOptimizeSystem_012_y=%d,DynamicOptimizeSystem_012_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=990 && hue_ratio >=990&&sat_ratio_mean_value<80&&motion<1000)
				DynamicOptimizeSystem[12]=1;
			else
				DynamicOptimizeSystem[12]=0;

//==============================================================================================//

			//NO.023 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("DynamicOptimizeSystem_023_y=%d,DynamicOptimizeSystem_023_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y2[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue2[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("DynamicOptimizeSystem_023_y2=%d,DynamicOptimizeSystem_023_hue2=%d \n",y_ratio2,hue_ratio2);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[23]=1;
			else
			{
				DynamicOptimizeSystem[23]=0;
			}

//==============================================================================================//

			//NO.024 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("DynamicOptimizeSystem_024_y=%d,DynamicOptimizeSystem_024_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)//for_LG_demo
				DynamicOptimizeSystem[24]=1;
			else
				DynamicOptimizeSystem[24]=0;
//==============================================================================================//

			//NO.028 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("DynamicOptimizeSystem_028_y=%d,DynamicOptimizeSystem_028_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_y2[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_028_hue2[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("DynamicOptimizeSystem_028_y2=%d,DynamicOptimizeSystem_028_hue2=%d \n",y_ratio,hue_ratio);


			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
			{
				DynamicOptimizeSystem[28]=1;
			}
			else
			{
				DynamicOptimizeSystem[28]=0;
			}

//==============================================================================================//
#if 0
			//NO.032 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_032_y[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_32==TRUE))
				ROSPrintf("DynamicOptimizeSystem_032_y=%d,noise_relaible=%d,motion=%d \n",y_ratio,noise_relaible,motion);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_032_y2[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_32==TRUE))
				ROSPrintf("DynamicOptimizeSystem_032_y2=%d \n",y_ratio2);

			if((((y_ratio >=980)||(y_ratio2 >=980)))&&(sat_ratio_mean_value <=35)&&(motion>100))
				DynamicOptimizeSystem[32]=1;
			else
				DynamicOptimizeSystem[32]=0;
#endif
//==============================================================================================//
			//NO.035 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("DynamicOptimizeSystem_035_y=%d \n",y_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y2[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("DynamicOptimizeSystem_035_y2=%d \n",y_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y3[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("DynamicOptimizeSystem_035_y3=%d \n",y_ratio3);


			if(((y_ratio >=970)||(y_ratio2 >=970)||(y_ratio3 >=970)) && sat_ratio_mean_value<=40)
			{
				DynamicOptimizeSystem[35]=1;
			}
			else
			{
				DynamicOptimizeSystem[35]=0;
			}
//==============================================================================================//
#if 0
			//NO.047 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_y[3], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_047_hue[3], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_47==TRUE))
				ROSPrintf("DynamicOptimizeSystem_047_y=%d,DynamicOptimizeSystem_047_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=970 && hue_ratio >=990)
				DynamicOptimizeSystem[47]=1;
			else
				DynamicOptimizeSystem[47]=0;
#endif
//==============================================================================================//
#if 0
			//NO.49 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_049_y[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_049_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("DynamicOptimizeSystem_049_y=%d,DynamicOptimizeSystem_049_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980&&sat_ratio_mean_value<110&&sat_ratio_mean_value>81)
			{
				DynamicOptimizeSystem[49]=1;
			}
			else
			{
				DynamicOptimizeSystem[49]=0;
			}
#endif

//==============================================================================================//

			//NO.63 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_063_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_063_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("DynamicOptimizeSystem_063_y=%d,DynamicOptimizeSystem_063_hue=%d \n",y_ratio,hue_ratio);

			if((y_ratio >=980 && hue_ratio >=980)&&motionl_level<10)
			{
				DynamicOptimizeSystem[63]=1;
			}
			else
			{
				DynamicOptimizeSystem[63]=0;
			}


//==============================================================================================//
			//NO.75 identify

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_075_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("DynamicOptimizeSystem_075_y=%d,DynamicOptimizeSystem_075_hue=%d \n",y_ratio,hue_ratio);

			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[75]=1;
			else
				DynamicOptimizeSystem[75]=0;

//==============================================================================================//
			//NO.107 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE)) {
				ROSPrintf("DynamicOptimizeSystem_107_y=%d,DynamicOptimizeSystem_107_hue=%d \n",y_ratio,hue_ratio);
				ROSPrintf("STATUS_MOTION=%d \n",scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION));
			}

			if(y_ratio >=980 && hue_ratio >=980)
			{
				DynamicOptimizeSystem[107]=1;
			}
			else
			{
				DynamicOptimizeSystem[107]=0;
			}
//==============================================================================================//
#if 0
			//NO.123 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_123_y[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_123_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_123==TRUE))
				ROSPrintf("DynamicOptimizeSystem_123_y=%d,DynamicOptimizeSystem_123_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
			{
				DynamicOptimizeSystem[123]=1;
			}
			else
			{

//				if(SmartPic_clue->SceneChange_NR)
				DynamicOptimizeSystem[123]=0;
			}
#endif
//==============================================================================================//
#if 0
			//NO.132 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_y[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_132==TRUE))
				ROSPrintf("DynamicOptimizeSystem_132_y=%d,DynamicOptimizeSystem_132_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=970 && hue_ratio >=970)
				DynamicOptimizeSystem[132]=1;
			else
				DynamicOptimizeSystem[132]=0;
#endif
//==============================================================================================//

			//NO.139 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_139_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			//hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_132_hue[3], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_132==TRUE))
				ROSPrintf("DynamicOptimizeSystem_139_y=%d,lg_No_139_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && sat_ratio_mean_value<=45)
				DynamicOptimizeSystem[139]=1;
			else
				DynamicOptimizeSystem[139]=0;


//==============================================================================================//

			//NO.147 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("DynamicOptimizeSystem_147_y=%d,DynamicOptimizeSystem_147_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y2[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue2[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("DynamicOptimizeSystem_147_y2=%d,DynamicOptimizeSystem_147_hue2=%d \n",y_ratio2,hue_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y3[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue3[SD_OSD_Idx], &hue_hist_ratio[0], 24);

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("DynamicOptimizeSystem_147_y3=%d,DynamicOptimizeSystem_147_hue3=%d \n",y_ratio3,hue_ratio3);

			if((y_ratio >=980&&hue_ratio >=980)||(y_ratio2 >=980&&hue_ratio2 >=980)||(y_ratio3 >=980&&hue_ratio3 >=980))
				DynamicOptimizeSystem[147]=1;
			else
				DynamicOptimizeSystem[147]=0;
//==============================================================================================//

			//NO.151
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_151_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_191==TRUE))
				ROSPrintf("DynamicOptimizeSystem_151_y=%d \n",y_ratio);

			if((y_ratio >=990 )&& sat_ratio_mean_value<=40&&motionl_level>18&&motionl_level<25)
				DynamicOptimizeSystem[151]=1;
			else
				DynamicOptimizeSystem[151]=0;

//==============================================================================================//
			//NO.152
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_152_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_191==TRUE))
				ROSPrintf("DynamicOptimizeSystem_152_y=%d \n",y_ratio);

			if((y_ratio >=990 )&& sat_ratio_mean_value<=40&&motionl_level>30&&motionl_level<60)
				DynamicOptimizeSystem[152]=1;
			else
				DynamicOptimizeSystem[152]=0;

//==============================================================================================//

#if 0
			//NO. SONY DISC TEMPLE

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_180_y1[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("lg_No_180_y=%d \n",y_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_180_y2[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_180_y2=%d \n",y_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_180_y3[SD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_180_y3=%d \n",y_ratio3);

			if((y_ratio >=970)||(y_ratio2 >=970 )||(y_ratio3 >=970 ))
				DynamicOptimizeSystem[180]=1;
			else
			{
				DynamicOptimizeSystem[180]=0;
			}

#endif
//==============================================================================================//
			//NO.174 hqv move tree

			if(RPC_system_info_structure_table->VIP_source==VIP_QUALITY_HDMI_576I)
			{
				y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_174_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
				hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_174_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);

				if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
					ROSPrintf("Dyn_174_y=%d, Dyn_174_hue=%d\n",y_ratio ,hue_ratio);


				if((y_ratio >=980) &&(hue_ratio >=980)&&(sat_ratio_mean_value>125&&sat_ratio_mean_value<140))
					DynamicOptimizeSystem[174]=1;
				else
				{
					DynamicOptimizeSystem[174]=0;
					if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
						ROSPrintf("174_y=%d, 174_Hue=%d ,sat=%d \n",y_ratio,sat_ratio_mean_value,sat_ratio_mean_value );
				}
			}
//==============================================================================================//

			//NO.191 identify LG COLORBAR

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_191_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_191_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_191==TRUE))
				ROSPrintf("DynamicOptimizeSystem_191_y=%d,DynamicOptimizeSystem_191_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=990 && hue_ratio >=990)
				DynamicOptimizeSystem[191]=1;
			else
				DynamicOptimizeSystem[191]=0;

//==============================================================================================//


			//NO.192 identify LG MONSCOPE
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_192_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_192==TRUE))
				ROSPrintf("DynamicOptimizeSystem_192_y=%d,sat_ratio_mean_value=%d\n",y_ratio,sat_ratio_mean_value);

			if(y_ratio >=990 && sat_ratio_mean_value<50)
				DynamicOptimizeSystem[192]=1;
			else
				DynamicOptimizeSystem[192]=0;

//==============================================================================================//

			//NO.195 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_195_y[SD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_195_hue[SD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_195==TRUE))
				ROSPrintf("DynamicOptimizeSystem_195_y=%d,DynamicOptimizeSystem_195_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[195]=1;
			else
				DynamicOptimizeSystem[195]=0;

//==============================================================================================//

			break;
		}

		case VIP_QUALITY_HDMI_1080I:
		case VIP_QUALITY_HDMI_1080P:
		{
			if(system_info_structure_table->OSD_Info.OSD_Film_Mode==1)//
			{
				HD_OSD_Idx = HD_LOW; //osd black level =low
			}
			else // others mapping to HIGH
			{
				HD_OSD_Idx = HD_HIGH; //osd black level !=low
			}

#if 0
			//NO.02 identify//for_LG_demo
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_y[HD_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_002_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("DynamicOptimizeSystem_002_y=%d,DynamicOptimizeSystem_002_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[2]=1;
			else
				DynamicOptimizeSystem[2]=0;
//==============================================================================================//
			//NO.003 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_003_y[HD_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_003_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("DynamicOptimizeSystem_003_y=%d,DynamicOptimizeSystem_003_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[3]=1;
			else
				DynamicOptimizeSystem[3]=0;

//==============================================================================================//
			//NO.004 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_004_y[HD_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_004_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_4==TRUE))
				ROSPrintf("DynamicOptimizeSystem_004_y=%d,DynamicOptimizeSystem_004_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[4]=1;
			else
				DynamicOptimizeSystem[4]=0;
//==============================================================================================//
			//NO.005identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_005_y[HD_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_005_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_5==TRUE))
				ROSPrintf("DynamicOptimizeSystem_005_y=%d,DynamicOptimizeSystem_005_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=970 && hue_ratio >=970)
				DynamicOptimizeSystem[5]=1;
			else
				DynamicOptimizeSystem[5]=0;

//==============================================================================================//
			//NO.012 identify//for_LG_demo
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_y[HD_OSD_Idx], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_012_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("DynamicOptimizeSystem_012_y=%d,DynamicOptimizeSystem_012_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=990 && hue_ratio >=990)//&&sat_ratio_mean_value<80&&motion<1000)
				DynamicOptimizeSystem[12]=1;
			else
				DynamicOptimizeSystem[12]=0;

//==============================================================================================//
#endif
			//NO.014 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_014_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_014_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_12==TRUE))
				ROSPrintf("DynamicOptimizeSystem_014_y=%d,DynamicOptimizeSystem_014_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=990 && hue_ratio >=990)
			{
				DynamicOptimizeSystem[14]=1;
			}
			else
			{
				DynamicOptimizeSystem[14]=0;
			}

//==============================================================================================//
			//NO.023 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("DynamicOptimizeSystem_023_y=%d,DynamicOptimizeSystem_023_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_y2[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_023_hue2[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_23==TRUE))
				ROSPrintf("DynamicOptimizeSystem_023_y2=%d,DynamicOptimizeSystem_023_hue2=%d \n",y_ratio2,hue_ratio2);



			if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980))
				DynamicOptimizeSystem[23]=1;
			else
				DynamicOptimizeSystem[23]=0;

//==============================================================================================//

			//NO.024 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_024_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_24==TRUE))
				ROSPrintf("DynamicOptimizeSystem_024_y=%d,DynamicOptimizeSystem_024_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=1000 && hue_ratio >=980)//for_LG_demo
				DynamicOptimizeSystem[24]=1;
			else
				DynamicOptimizeSystem[24]=0;

//==============================================================================================//
#if 0
			//NO.035 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y[HD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("DynamicOptimizeSystem_035_y=%d \n",y_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y2[HD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("DynamicOptimizeSystem_035_y2=%d \n",y_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_035_y3[HD_OSD_Idx], &Y_hist_ratio[0], 32);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_35==TRUE))
				ROSPrintf("DynamicOptimizeSystem_035_y3=%d \n",y_ratio3);


			if(((y_ratio >=970)||(y_ratio2 >=970)||(y_ratio3 >=970)) && sat_ratio_mean_value<=40)
			{
				DynamicOptimizeSystem[35]=1;
			}
			else
			{
				DynamicOptimizeSystem[35]=0;
			}
#endif
//==============================================================================================//
/*
			//NO 39
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_039_y[4], &Y_hist_ratio[0], 32);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_039_hue[4], &hue_hist_ratio[0], 24);
			y_ratio2 = scalerVIP_ratio_inner_product(lg_No_039_y2[4], &Y_hist_ratio[0], 32);
			hue_ratio2 = scalerVIP_ratio_inner_product(lg_No_039_hue2[4], &hue_hist_ratio[0], 24);
			y_ratio3 = scalerVIP_ratio_inner_product(lg_No_039_y3[4], &Y_hist_ratio[0], 32);
			hue_ratio3 = scalerVIP_ratio_inner_product(lg_No_039_hue3[4], &hue_hist_ratio[0], 24);
			y_ratio4 = scalerVIP_ratio_inner_product(lg_No_039_y4[4], &Y_hist_ratio[0], 32);
			hue_ratio4 = scalerVIP_ratio_inner_product(lg_No_039_hue4[4], &hue_hist_ratio[0], 24);
			y_ratio5 = scalerVIP_ratio_inner_product(lg_No_039_y5[4], &Y_hist_ratio[0], 32);
			hue_ratio5 = scalerVIP_ratio_inner_product(lg_No_039_hue5[4], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
				ROSPrintf("DynamicOptimizeSystem_039_y=%d,DynamicOptimizeSystem_039_hue=%d \n",y_ratio,hue_ratio);

			if((y_ratio >=980 && hue_ratio >=980) || (y_ratio2 >=980 && hue_ratio2 >=980) || (y_ratio3 >=980 && hue_ratio3 >=980) || (y_ratio4 >=980 && hue_ratio4 >=980) || (y_ratio5 >=980 && hue_ratio5 >=980))
				DynamicOptimizeSystem[39]=1;
			else
				DynamicOptimizeSystem[39]=0;
*/
//==============================================================================================//

			//NO 107
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_107_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE)){
				ROSPrintf("DynamicOptimizeSystem_107_y=%d,DynamicOptimizeSystem_107_hue=%d \n",y_ratio,hue_ratio);
				ROSPrintf("PAN_Status=%d,MOTION_Status=%d \n",scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN_SPECIAL_CASE),scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION));
			}

			//if(y_ratio >=980 && hue_ratio >=980 && scalerVIP_DI_MiddleWare_GetStatus(STATUS_HMC) == 1)
			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[107]=1;
			else
				DynamicOptimizeSystem[107]=0;

//==============================================================================================//
			//NO.147 identify
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("DynamicOptimizeSystem_147_y=%d,DynamicOptimizeSystem_147_hue=%d \n",y_ratio,hue_ratio);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y2[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue2[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("DynamicOptimizeSystem_147_y2=%d,DynamicOptimizeSystem_147_hue2=%d \n",y_ratio2,hue_ratio2);

			y_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_y3[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio3 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_147_hue3[HD_OSD_Idx], &hue_hist_ratio[0], 24);

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_147==TRUE))
				ROSPrintf("DynamicOptimizeSystem_147_y3=%d,DynamicOptimizeSystem_147_hue3=%d \n",y_ratio3,hue_ratio);

			if(((y_ratio >=980)||(y_ratio2 >=980)||(y_ratio3 >=980))&&((hue_ratio >=980)||(hue_ratio2 >=980)||(hue_ratio3 >=980)))
				DynamicOptimizeSystem[147]=1;
			else
				DynamicOptimizeSystem[147]=0;

//==============================================================================================//
			//NO.173  film 24 to 30


			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_173_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);

			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_173_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			//if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
			//	ROSPrintf("DynamicOptimizeSystem_173_y=%d,DynamicOptimizeSystem_173_hue=%d \n",y_ratio,hue_ratio);



			if((y_ratio >=980) &&((sat_ratio_mean_value)<55)&&(step_count<3000)&&(hue_ratio >=980)&&scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio()>=90)
				DynamicOptimizeSystem[173]=1;
			else
			{
				DynamicOptimizeSystem[173]=0;
				if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("173_y=%d,sat=%d ,step_count=%d ,ratio=%d\n",y_ratio,sat_ratio_mean_value,step_count,scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio() );
			}






//==============================================================================================//
			//NO.175  mnusli high frequency 22 film


			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_175_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("DynamicOptimizeSystem_175_y=%d,5 \n",y_ratio );


			if((y_ratio >=980) &&((sat_ratio_mean_value)<40)&&(step_count>5500&&step_count<20000))
				DynamicOptimizeSystem[175]=1;
			else
			{
				DynamicOptimizeSystem[175]=0;
				if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("DynamicOptimizeSystem_175_y=%d,sat=%d ,step_count=%d \n",y_ratio,sat_ratio_mean_value,step_count );
			}


//==============================================================================================//
			//NO.176  hqv flower


			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_176_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_176_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);


			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("DynamicOptimizeSystem_176_y=%d,DynamicOptimizeSystem_176_hue=%d  \n",y_ratio,hue_ratio );


			if((y_ratio >=980) && hue_ratio >=980&&((sat_ratio_mean_value)>55&&sat_ratio_mean_value<73))
				DynamicOptimizeSystem[176]=1;
			else
			{
				DynamicOptimizeSystem[176]=0;
				if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
				ROSPrintf("DynamicOptimizeSystem_176_y=%d,DynamicOptimizeSystem_176_hue=%d,sat=%d  \n",y_ratio,hue_ratio,sat_ratio_mean_value );

			}



//==============================================================================================//
			//NO.177

			// qtec_hd contant_ sunrise
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_177_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_177_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);

			y_ratio2 = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_177_y2[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);


			//if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
			//	ROSPrintf("DynamicOptimizeSystem_177_y=%d,DynamicOptimizeSystem_177_hue=%d DynamicOptimizeSystem_177_y2=%d\n",y_ratio,hue_ratio,y_ratio2);


			if((y_ratio >=960||y_ratio2 >=960) && hue_ratio >=970&&((sat_ratio_mean_value)>55&&sat_ratio_mean_value<70)&&(step_count>3000&&step_count<15000)&&
				(cur_source==VIP_QUALITY_HDMI_1080P))
				DynamicOptimizeSystem[177]=1;
			else
			{
				DynamicOptimizeSystem[177]=0;
				if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_2==TRUE))
					ROSPrintf("177_y=%d,177_hue=%d _177_y2=%d?sat=%d ,setp=%d \n",y_ratio,hue_ratio,y_ratio2,sat_ratio_mean_value,step_count);


			}




//==============================================================================================//
			//NO.182

			// lg_hd contant_  Analong noise : boy
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_182_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_182_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_182_y=%d,DynamicOptimizeSystem_182_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[182]=1;
			else
				DynamicOptimizeSystem[182]=0;

//==============================================================================================//
			//NO.183

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_183_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_183_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_183_y=%d,DynamicOptimizeSystem_183_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[183]=1;
			else
				DynamicOptimizeSystem[183]=0;

//==============================================================================================//
			//NO.184

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_184_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_184_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_184_y=%d,DynamicOptimizeSystem_184_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[184]=1;
			else
				DynamicOptimizeSystem[184]=0;

//==============================================================================================//
			//NO.185
			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_185_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_185_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_185_y=%d,DynamicOptimizeSystem_185_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[185]=1;
			else
				DynamicOptimizeSystem[185]=0;

//==============================================================================================//
			//NO.186

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_186_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_186_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_186_y=%d,DynamicOptimizeSystem_186_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[186]=1;
			else
				DynamicOptimizeSystem[186]=0;
//==============================================================================================//
			//NO.187

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_187_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_187_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_187_y=%d,DynamicOptimizeSystem_187_hue=%d \n",y_ratio,hue_ratio);


			if((y_ratio >=980 && hue_ratio >=980)&&(motionl_level>=1&&motionl_level<25))
				DynamicOptimizeSystem[187]=1;
			else
				DynamicOptimizeSystem[187]=0;

//==============================================================================================//
			//NO.197 //qte 1002  building and street ,(streets)

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_197_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin); //street
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_197_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_197_y=%d,DynamicOptimizeSystem_197_hue=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[197]=1;
			else
				DynamicOptimizeSystem[197]=0;

//==============================================================================================//
			//NO.198 //qte 1002  building and street ,(building)

			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_198_y1[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin); //building
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_198_hue1[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_198_y1=%d,DynamicOptimizeSystem_198_hue1=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980&&motionl_level>=2)
				DynamicOptimizeSystem[198]=1;
			else
				DynamicOptimizeSystem[198]=0;

//==============================================================================================//


			y_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_199_y1[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin); //bandbool wonman
			hue_ratio = scalerVIP_ratio_inner_product(DynamicOptimizeSystem_199_hue1[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("DynamicOptimizeSystem_199_y1=%d,DynamicOptimizeSystem_199_hue1=%d \n",y_ratio,hue_ratio);


			if(y_ratio >=980 && hue_ratio >=980)
				DynamicOptimizeSystem[199]=1;
			else
				DynamicOptimizeSystem[199]=0;

//==============================================================================================//

			y_ratio = scalerVIP_ratio_inner_product(SandM_Chroma_Zone_Plate_y[HD_OSD_Idx], &Y_hist_ratio[0], TV006_VPQ_chrm_bin); //bandbool wonman
			hue_ratio = scalerVIP_ratio_inner_product(SandM_Chroma_Zone_Plate_hue[HD_OSD_Idx], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("SandM_Chroma_Zone_Plate_y=%d,SandM_Chroma_Zone_Plate_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=980 && hue_ratio >=980)
				SandM_Chroma_Zone_Plate=1;
			else
				SandM_Chroma_Zone_Plate=0;

//==============================================================================================//


			break;
		}
		case VIP_QUALITY_DTV_480I:
		case VIP_QUALITY_DTV_576I:
		case VIP_QUALITY_DTV_480P:
		case VIP_QUALITY_DTV_576P:
		case VIP_QUALITY_DTV_720P:
		{
//==============================================================================================//
			unsigned short wDI, hDI;
			scalerVIP_Get_DI_Width_Height(&wDI, &hDI);
			//if((MA_print_count%debug_print_delay_time==0))
				//ROSPrintf("cur_source = %d, w = %d, h = %d",  cur_source, wDI, hDI);
			//for CI test patch BitmapDevodeOffset [KTASKWBS-1937][KTASKWBS-1936]
			//if((system_info_structure_table->Input_src_Form == _SRC_FROM_VO) && (system_info_structure_table->Input_src_Type == _SRC_VO))
			if (wDI == 360 && hDI == 144)
			{
				y_ratio = scalerVIP_ratio_inner_product(BitmapDevodeOffset_y_1[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
				hue_ratio = scalerVIP_ratio_inner_product(BitmapDevodeOffset_hue_1[0], &hue_hist_ratio[0], 24);
				y_ratio2 = scalerVIP_ratio_inner_product(BitmapDevodeOffset_y_2[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
				hue_ratio2 = scalerVIP_ratio_inner_product(BitmapDevodeOffset_hue_2[0], &hue_hist_ratio[0], 24);
				y_ratio3 = scalerVIP_ratio_inner_product(BitmapDevodeOffset_y_3[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
				hue_ratio3 = scalerVIP_ratio_inner_product(BitmapDevodeOffset_hue_3[0], &hue_hist_ratio[0], 24);
				if((MA_print_count%debug_print_delay_time==0))
					ROSPrintf("BitmapDevodeOffset_y=%d,BitmapDevodeOffset_hue=%d \n",y_ratio,hue_ratio);

				if((y_ratio >=980 && hue_ratio >=980)||(y_ratio2 >=980 && hue_ratio2 >=980)||(y_ratio3 >=980 && hue_ratio3 >=980))
					CITestPatch[0]=1;
				else
				{
					CITestPatch[0]=0;
				}
			}
			else
			{
				CITestPatch[0]=0;
			}
//==============================================================================================//
			break;
		}

		case VIP_QUALITY_DTV_1080P:
		{
			y_ratio = scalerVIP_ratio_inner_product(LGBirdDemoMovie_ChromaRTNR_y, Y_hist_ratio, TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(LGBirdDemoMovie_ChromaRTNR_hue, hue_hist_ratio, 24);
			LGBirdCRTNRPatchTrigger = 0;
			if(y_ratio >=920 && hue_ratio >=920) {
				LGBirdCRTNRPatch = 1;
			} else
				LGBirdCRTNRPatch = 0;

			if (LGBirdCRTNRPatch != LGBirdCRTNRPatchPre)
				LGBirdCRTNRPatchTrigger = 1;
			LGBirdCRTNRPatchPre = LGBirdCRTNRPatch;
			break;
		}
		case VIP_QUALITY_TV_SECAN:
		{
			y_ratio = scalerVIP_ratio_inner_product(LGPTFatoryMultiC34_y[0], &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(LGPTFatoryMultiC34_hue[0], &hue_hist_ratio[0], 24);
			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("lg_TV_MultiC34_y=%d,lg_TV_MultiC34_hue=%d \n",y_ratio,hue_ratio);

			if(y_ratio >=920 && hue_ratio >=920) {
				LGPTFatoryMultiC34 = 1;
			} else
				LGPTFatoryMultiC34 = 0;
			break;
		}
		case VIP_QUALITY_TV_PAL:
		{
			y_ratio = scalerVIP_ratio_inner_product(LGTVPALBGE52_y, &Y_hist_ratio[0], TV006_VPQ_chrm_bin);
			hue_ratio = scalerVIP_ratio_inner_product(LGTVPALBGE52_hue, &hue_hist_ratio[0], 24);

			if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
				ROSPrintf("lg_TV_DEM_PALBG_y=%d,lg_TV_DEM_PALBG_hue=%d, motion = %d \n",y_ratio,hue_ratio, motion);

			if(y_ratio >=980 && hue_ratio >=955 && motion < 10) {
				LGTVPALBGE52 = 1;
			} else {
				LGTVPALBGE52 = 0;
			}

			break;
		}
		default:

			break;
	}



}

void scalerVIP_Set_Parameter_forLGM2(unsigned char apply)
{
	_system_setting_info* system_info_structure_table = NULL;
	_clues* SmartPic_clue=NULL;
	_RPC_clues* RPC_SmartPic_clue=NULL;
	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();
	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();
	RPC_SmartPic_clue = scaler_GetShare_Memory_RPC_SmartPic_Clue_Struct();
	int soft_move_cnt_th=60;
	if((system_info_structure_table == NULL) || (SmartPic_clue == NULL)|| (RPC_SmartPic_clue == NULL))
	{
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR, system_info = %x, SmartPic_clue=%x, RPC_SmartPic_clue=%x \n",system_info_structure_table, SmartPic_clue, RPC_SmartPic_clue );
		return;
	}


	di_di_smd_waterflag_ctr3_RBUS di_di_smd_waterflag_ctr3;
//	di_di_smd_resurrect_ctrl_RBUS di_di_smd_resurrect_ctrl; Mac5 remove

	static di_di_smd_waterflag_ctr3_RBUS ori_di_di_smd_waterflag_ctr3;
//	static di_di_smd_resurrect_ctrl_RBUS ori_di_di_smd_resurrect_ctrl; Mac5 remove




	di_di_smd_choosecandidate_RBUS 	smd_choosecandidate_reg;
	di_di_smd_refinemv3_RBUS smd_refinemv3_reg;
	di_di_smd_compensate_RBUS smd_compensate_reg;
	di_di_smd_candidatelimitsad_RBUS init_di_smd_candidatelimitsad_reg;
	di_di_smd_additionalcoeff2_RBUS init_di_smd_additionalcoeff2_reg;
	di_di_smd_dummy_RBUS di_smd_dummy_reg;
	di_di_smd_refinemv2_RBUS di_smd_refinemv2_reg;

	di_di_smd_pan1_RBUS init_di_smd_pan1_reg;
	di_di_smd_hardwarepan_modify1_RBUS di_di_smd_hardwarepan_modify1;
	di_di_smd_sampling_gmvc_RBUS di_di_smd_sampling_gmvc;
	di_di_gst_compensate_RBUS di_di_gst_compensate;

	di_di_smd_additionalcoeff1_RBUS init_di_smd_additionalcoeff1_reg;
	di_di_smd_slow_motion_handle1_RBUS di_di_smd_slow_motion_handle1;
	di_di_smd_slow_motion_handle2_RBUS di_di_smd_slow_motion_handle2;

	di_im_di_weave_window_control_RBUS im_di_weave_window_control_reg;
	di_im_di_weave_window_1_start_RBUS im_di_weave_window_1_start_reg;
	di_im_di_weave_window_1_end_RBUS im_di_weave_window_1_end_reg;

	static 	di_im_di_weave_window_control_RBUS ORI_im_di_weave_window_control_reg;
	static	di_im_di_weave_window_1_start_RBUS ORI_im_di_weave_window_1_start_reg;
	static	di_im_di_weave_window_1_end_RBUS ORI_im_di_weave_window_1_end_reg;

	di_im_di_nintra_lowpass_source_RBUS di_im_di_nintra_lowpass_source;
	di_im_di_nintra_search_dir_limit_RBUS di_im_di_nintra_search_dir_limit;
	di_di_gst_ctrl_RBUS init_di_gst_ctrl_reg;
#ifdef CONFIG_HW_SUPPORT_MEMC
	memc_mux_memc_mux_di_ctrl_RBUS color_temp_ctrl_reg;
#endif
	nr_dch1_cp_ctrl_RBUS dch1_cp_ctrl_reg;
	nr_mosquito_ctrl_RBUS nr_mosquito_ctrl_RBUS_reg;
	nr_curve_mapping_w1_1_RBUS curve_mapping_w1_1_reg;
	nr_curve_mapping_w1_2_RBUS curve_mapping_w1_2_reg;
	nr_curve_mapping_w1_3_RBUS curve_mapping_w1_3_reg;


	nr_curve_mapping_w2_1_RBUS curve_mapping_w2_1_reg;
	nr_curve_mapping_step_2_RBUS curve_mapping_step2_reg;
	nr_curve_mapping_step_3_RBUS curve_mapping_step3_reg;
	nr_mosquito_nr_level_ctrl_RBUS nr_mosquito_nr_level_ctrl_RBUS_reg;
	nr_mosquito_nr_level_ctrl_1_RBUS nr_mosquito_nr_level_ctrl_1_RBUS_reg;
	scaleup_dm_uzu_ctrl_RBUS dm_uzu_Ctrl_reg;
	di_im_di_control_RBUS di_control_reg;
	di_im_di_control_RBUS di_control_reg_Prtoect_3AEnable;

	iedge_smooth_edgesmooth_ex_ctrl_RBUS edgesmooth_ex_ctrl_reg;
	iedge_smooth_edgesmooth_ex_ctrl3_RBUS edgesmooth_ex_ctrl3_reg;
	iedge_smooth_edgesmooth_ex_ctrl2_RBUS edgesmooth_ex_ctrl2_reg;

	color_d_vc_global_ctrl_RBUS d_vc_global_ctrl_REG;
	color_sharp_dm_segpk_edgpk3_RBUS color_sharp_dm_segpk_edgpk3;
	color_sharp_dm_peaking_bound_1_RBUS color_sharp_dm_peaking_bound_1_reg;
//	color_sharp_dm_peaking_bound_0_RBUS color_sharp_dm_peaking_bound_0;
//	color_sharp_dm_segpk_edgpk2_RBUS color_sharp_dm_segpk_edgpk2;

	color_sharp_dm_cds_cm0_u_bound_0_RBUS color_sharp_dm_cds_cm0_u_bound_0_reg;
	nr_dch1_spatial_weight_RBUS dch1_Spatial_Weight_Reg;
	//vdpq_yc_sep_control_RBUS YC_SEP_CONTROL_reg;
 	//vdpq_yc_bw_ctrl_RBUS YC_BW_CTRL_reg;
	di_rtnr_ma_snr_strength_control_RBUS	di_rtnr_ma_snr_strength_control;
	color_sharp_dm_peaking_gain_RBUS color_sharp_dm_peaking_gain_reg;

	di_im_di_hmc_adjustable_RBUS di_hmc_adjustable_reg;
	static di_im_di_hmc_adjustable_RBUS ORI_di_hmc_adjustable_reg;

	di_im_di_hmc_adjustable2_RBUS di_hmc_adjustable2_reg;
	static di_im_di_hmc_adjustable2_RBUS ORI_di_hmc_adjustable2_reg;

	di_im_di_hmc_adjustable3_RBUS di_hmc_adjustable3_reg;
	static di_im_di_hmc_adjustable3_RBUS ORI_di_hmc_adjustable3_reg;

	di_im_di_hmc_adjustable4_RBUS di_hmc_adjustable4_reg;
	static di_im_di_hmc_adjustable4_RBUS ORI_di_hmc_adjustable4_reg;

	di_im_di_hmc_pan_control_par_2_RBUS di_hmc_pan_control_par_2_reg;
	di_im_di_hmc_pan_control_par_1_RBUS di_hmc_pan_control_par_1_reg;
	di_im_di_hmc_statistic1_RBUS di_hmc_statistic1_reg;

	di_im_di_framesobel_statistic_RBUS FrameSobel_statistic_Reg;
	static di_im_di_framesobel_statistic_RBUS ORI_FrameSobel_statistic_Reg;


	nr_curve_mapping_w2_2_RBUS curve_mapping_w2_2_reg;

	di_im_di_intra_th_RBUS intra_th_Reg;

	scaleup_dm_mem_crc_ctrl_RBUS dm_mem_crc_ctrl_RBUS_reg;
	//di_im_di_ma_frame_motion_th_a_RBUS frame_motion_a_reg;// frame motion a
	color_sharp_dm_segpk_vpk2_RBUS dm_segpk_vpk2;

	di_im_di_rtnr_new_control_RBUS rtnr_new_Ctrl;

	idcti_i_dcti_ctrl_2_RBUS ich1_newdcti_reg_2;
	idcti_i_dcti_ctrl_1_RBUS ich1_newdcti_reg_1;
	color_sharp_shp_dcti_ctrl_1_RBUS dm_dcti_REG_1;
	color_sharp_shp_dcti_ctrl_2_RBUS dm_dcti_REG_2;

	//vdpq_adap_bpf_y_th3_RBUS vdpq_adap_bpf_y_th3_reg;

	scaleup_dm_uzu_ctrl_RBUS dm_uzu_Ctrl;

	scaleup_dm_uzumain_v_partial_drop_RBUS dm_uzu_main_v_partial_drop_RBUS_reg;

	vdtop_auto_pos_ctrl_RBUS auto_pos_ctrl_reg;

	di_im_new_mcnr_control_RBUS di_im_new_mcnr_control;

	mpegnr_ich1_mpegnr2_RBUS ich1_MPEGNR2_reg;

	di_im_di_ma_frame_motion_th_a_RBUS di_ma_frame_motion_th_a_reg;
	di_im_di_ma_frame_motion_th_b_RBUS di_ma_frame_motion_th_b_reg;
	di_im_di_ma_frame_motion_th_c_RBUS di_ma_frame_motion_th_c_reg;
	di_im_di_nintra_control_RBUS di_im_di_nintra_control;
	di_di_smd_control_candidatelist_RBUS di_smd_control_candiate_reg;

	di_im_di_hmc_pan_dummy_2_RBUS di_pan_dummy2_reg;
	di_im_di_hmc_pan_dummy_3_RBUS di_pan_dummy3_reg;

	di_im_di_btr_control_RBUS di_im_di_btr_control_reg;

  	vdpq_postp_secam_fix_ctrl_RBUS postp_secam_fix_ctrl_reg;
	vdpq_postp_secam_fix_y_detect0_RBUS postp_secam_fix_y_detect0_reg;
	vdpq_postp_secam_fix_y_detect1_RBUS postp_secam_fix_y_detect1_reg;

	iedge_smooth_edgesmooth_mess_direction1_RBUS edgesmooth_mess_direction1_reg;
	scaleup_dm_dir_uzu_conf_RBUS dm_dir_uzu_conf_Reg;

	di_im_di_hmc_me_refine_ctrl_2_RBUS di_hmc_me_refine_ctrl2_reg;
	static di_im_di_hmc_me_refine_ctrl_2_RBUS ORI_di_hmc_me_refine_ctrl2_reg;

	/*LG internal TV signal "E-52"*/
	di_tnrxc_mkii_ctrl_RBUS tnrxc_mkii_ctrl_reg;

	static di_im_di_ma_frame_motion_th_a_RBUS ORI_di_ma_frame_motion_th_a_reg;
	static di_im_di_ma_frame_motion_th_b_RBUS ORI_di_ma_frame_motion_th_b_reg;
	static di_im_di_ma_frame_motion_th_c_RBUS ORI_di_ma_frame_motion_th_c_reg;
	static di_di_smd_control_candidatelist_RBUS ORI_di_smd_control_candiate_reg;
	static di_im_di_nintra_control_RBUS ori_di_im_di_nintra_control;

	static di_im_di_hmc_pan_dummy_2_RBUS ORI_di_pan_dummy2_reg;
	static di_im_di_hmc_pan_dummy_3_RBUS ORI_di_pan_dummy3_reg;

	static di_im_di_btr_control_RBUS ORI_di_im_di_btr_control_reg;

  	static vdpq_postp_secam_fix_ctrl_RBUS ORI_postp_secam_fix_ctrl_reg;
	static vdpq_postp_secam_fix_y_detect0_RBUS ORI_postp_secam_fix_y_detect0_reg;
	static vdpq_postp_secam_fix_y_detect1_RBUS ORI_postp_secam_fix_y_detect1_reg;

	static di_im_di_hmc_pan_control_par_1_RBUS ORI_di_hmc_pan_control_par_1_reg;
	static di_im_di_hmc_statistic1_RBUS ORI_di_hmc_statistic1_reg;

	static di_di_gst_ctrl_RBUS ORI_init_di_gst_ctrl_reg;
#ifdef CONFIG_HW_SUPPORT_MEMC
	static memc_mux_memc_mux_di_ctrl_RBUS ORI_color_temp_ctrl_reg;
#endif

	/*LG internal TV signal "E-52"*/
	static di_tnrxc_mkii_ctrl_RBUS ORI_tnrxc_mkii_ctrl_reg;

	static vdtop_auto_pos_ctrl_RBUS ORI_auto_pos_ctrl_reg;

	static unsigned int ori_ULTRI_value=0;
	static unsigned short ori_smd_upperbound_sad_forjudgemv=0;
	static unsigned short ori_smd_rang_sad=0;
	static unsigned char  ori_smd_firmware_pan_sad_th=0;
	static unsigned char ori_smd_firmware_pan=0;
	static unsigned char ori_smd_hardware_pan_en=0;
	static unsigned char ori_smd_apply_result_mode=0;
	static unsigned char ori_smd_firmwarepan_sadmax=0;
	static unsigned char ori_smd_close2gmv_mvselect=0;
	static unsigned char ori_smd_close2gmv_fw_en=0;
	static unsigned char ori_gst_subpixel_compensate_en=0;
	static unsigned char ori_gst_subpixel_hardwarepan_en=0;
	static unsigned char ori_smd_en=0;
	static unsigned char ori_smd_result_en=0;
	static unsigned char ori_smd_acc_smd_en =0;
	static unsigned char ori_smd_spatialfreqnomatch_off =0;
	static unsigned char ori_smd_outofrange_content_new = 0 ;

	static unsigned short ori_cp_sresultweight=0;
	static unsigned short ori_mosquito_en=0;
	static unsigned short ori_curve_mapping_w1_3=0,ori_curve_mapping_w1_4=0,ori_curve_mapping_w1_5=0;//,ori_curve_mapping_w2_2_2=0;
	static unsigned short ori_curve_mapping_w1_2=0,ori_curve_mapping_step6=0,ori_curve_mapping_step7=0,ori_curve_mapping_step8=0;
	static unsigned short ori_curve_mapping_w1_6=0,ori_curve_mapping_w1_7=0;
	static unsigned short ori_curve_mapping_w1_8=0;

#ifdef ISR_ICM_ADJUST_FUNCTIOM_ENABLE
	static int ori_dsatbysat[SATSEGMAX];
#endif
	static unsigned short ori_mosquito_nr_positive_shift=0;
	//static unsigned short ori_mosquito_nr_bi_nlevel_max=0;
	static unsigned short ori_mosquito_far_var_gain=0;
//	static unsigned char gReg123=0;
//	static unsigned char gRegW_MonScope=FALSE;
	static unsigned char ori_Intr_di_range=0;
	static unsigned char org_edgesmoothex_en=0,ori_edgesmoothex_edgeupbud=0;
	static unsigned char m_edgesmooth_en;
	static unsigned char ori_gain_pos=0;
	static unsigned char ori_gain_neg=0;
	static unsigned char ori_gain_LV_Gain=0;
	static unsigned char ori_cp_fixedweight1y=0;
	static unsigned char ori_cp_fixedweight2y=0;
	//VD register setting moved to scalerVideo.c, willy 20150713
	//static unsigned char ori_chroma_bw_lo=0;
	static unsigned char ori_ma_snr_edge_curve_slope=0;
	static unsigned char ori_ma_snr_output_clamp=0;
	static unsigned char ori_edgesmooth_ex_up_bounmd=0;
	static unsigned char ori_edgesmooth_edge_en=0,ori_edgesmooth_top2diff_step_bit=0;
	static unsigned char ori_edgesmooth_t2df_en=0;

	static unsigned char ori_text_gain_pos=0;
	static unsigned char ori_text_gain_neg=0;

	static unsigned char ori_hmc_sub_pixel_diff_thd=0;
	static unsigned char ori_hmc_mv_refine_mor_zero_th2=0;

	//static short p_47_count=0;
	static unsigned char ori_curve_mapping_w2_2=0;
	static unsigned char ori_curve_mapping_w2_3=0;
	static unsigned char ori_curve_mapping_w2_4=0;
	static unsigned char ori_curve_mapping_w2_5=0;

	static unsigned char ori_vcti_select=0;
	static unsigned char ori_vcti_en=0;
	static scaleup_dm_mem_crc_ctrl_RBUS ori_dm_mem_crc_ctrl_RBUS_reg;
	static unsigned char ori_vcti_low_pass_filter_en =0;
	static unsigned char ori_spatialenablec = 0;
	static unsigned char ori_mosquito_edgethd=0;
	static unsigned char ori_cds_enable=0;

	static unsigned char ori_vpk_gain_neg=0;
	static unsigned char ori_vpk_gain_pos=0;

	static unsigned char ori_rtnr_sad_method=0;

	static unsigned char ori_I_uvsync_en=0;
	static unsigned char ori_I_uvgain=0;
	static unsigned char ori_I_lp_mode=0;
	static unsigned char ori_I_vlp_mode=0;
	static unsigned char ori_I_blending_mode=0;
	static unsigned char ori_I_cur_sel=0;
	static unsigned char ori_I_data_sel=0;
	static unsigned char ori_I_maxlen =0;

	static unsigned char ori_D_uvgain =0;
	static unsigned char ori_D_vlp_mode =0;
	static unsigned char ori_D_data_sel =0;
	static unsigned char ori_D_engdiv =0;
	static unsigned char ori_D_offdiv =0;
	static unsigned char ori_D_maxlen =0;
	static unsigned char ori_vc_snr_lpf_sel=0;
	static unsigned char ori_sresultweight_adjust_shift=0;
	static unsigned char ori_gst_gst_static_disable=0;
	static unsigned char ori_gst_min_sad_compare_diable=0;
	static unsigned char ori_gst_min_sad_nolimit_en=0;
	static unsigned char ori_smd_weave_dynamic=0;

	static unsigned char ori_gst_mv_limit=0;

    	static unsigned char ori_film_enable=0;

	unsigned char Motion_Th_c[7]={12,26,37,47,56,63,70};
	unsigned char Motion_Th_c_can[7] = {6,10,14,18,22,26,30};
	unsigned char Motion_Th[15]={8,10,13,16,17,28,36,45,53,57,64,67,68,69,72};

	static unsigned char ori_nintra_lp_src_yclamp_th=0;
	static di_im_di_nintra_search_dir_limit_RBUS ori_di_im_di_nintra_search_dir_limit;
	static di_di_smd_compensate_RBUS ori_smd_compensate_reg;
	static di_di_smd_refinemv2_RBUS ori_di_smd_refinemv2_reg;

	static unsigned char ori_dm_uzu_hor_mode_sel = 0;
	static unsigned char ori_dm_uzu_y_consttab_sel =0;

	static unsigned char ori_n_mcnr_offset = 0;
	static unsigned char ori_mess_4direction_thd;
	static unsigned char ori_conf_lowbnd=0;
	static unsigned int kernel_init_count=0;

	static unsigned int start_count = 0;
	static unsigned char set_p2i_value = 0;

	di_im_di_hmc_pan_control_RBUS di_im_di_hmc_pan_control_reg;

	di_im_di_film_sawtooth_filmframe_th_RBUS im_di_film_sawtooth_filmframe_th_reg;
	static di_im_di_film_sawtooth_filmframe_th_RBUS ORI_im_di_film_sawtooth_filmframe_th_reg;
	di_im_di_film_static_sum_th_RBUS film_static_sum_th_reg;
	static di_im_di_film_static_sum_th_RBUS ORI_film_static_sum_th_reg;
	di_im_di_film_motion_sum_th_RBUS film_motion_sum_th_reg;
	static di_im_di_film_motion_sum_th_RBUS ORI_film_motion_sum_th_reg;

	di_im_new_mcnr_pan_condition_RBUS di_im_new_mcnr_pan_condition;







	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);
	RPC_ICM_Global_Ctrl 	*g_ICM_Global_Ctrl_Struct= &(system_info_structure_table->PQ_Setting_Info.S_RPC_ICM_Global_Ctrl);
	static unsigned char pre_source =255;
	unsigned char i=0;

	//ROSPrintf("\n rord vip current %d \n ",cur_source);

	if((apply==0)) // reset init value;
	{
		for(i=0;i<200;i++)
		{
			DynamicOptimizeSystem[i]=0;
		}
		if(Stop_Polling.Stop_Reset_Pattern==1)
			return;
		//ROSPrintf("\n cur_source %d , pre_source %d \n",cur_source,pre_source);
	}



	init_di_smd_additionalcoeff1_reg.regValue=rtd_inl(DI_DI_SMD_AdditionalCoeff1_reg);

	smd_choosecandidate_reg.regValue = rtd_inl(DI_DI_SMD_ChooseCandidate_reg);

	smd_refinemv3_reg.regValue =  rtd_inl(DI_DI_SMD_RefineMV3_reg);
	smd_compensate_reg.regValue =  rtd_inl(DI_DI_SMD_Compensate_reg);

	init_di_smd_candidatelimitsad_reg.regValue =  rtd_inl(DI_DI_SMD_CandidateLimitSAD_reg);
	init_di_smd_additionalcoeff2_reg.regValue =  rtd_inl(DI_DI_SMD_AdditionalCoeff2_reg);
	di_smd_dummy_reg.regValue =  rtd_inl(DI_DI_SMD_dummy_reg);

	di_smd_refinemv2_reg.regValue = rtd_inl(DI_DI_SMD_RefineMV2_reg);

	init_di_smd_pan1_reg.regValue =rtd_inl(DI_DI_SMD_Pan1_reg);
	di_di_smd_hardwarepan_modify1.regValue=rtd_inl(DI_DI_SMD_HardwarePan_Modify1_reg);
	di_di_smd_sampling_gmvc.regValue = rtd_inl(DI_DI_SMD_Sampling_GMVc_reg);
	di_di_gst_compensate.regValue = rtd_inl(DI_DI_GST_Compensate_reg);

	di_di_smd_slow_motion_handle1.regValue= rtd_inl(DI_DI_SMD_Slow_Motion_handle1_reg);
	di_di_smd_slow_motion_handle2.regValue= rtd_inl(DI_DI_SMD_Slow_Motion_handle2_reg);

	di_im_di_nintra_lowpass_source.regValue	= rtd_inl(DI_IM_DI_NINTRA_LOWPASS_SOURCE_reg);

	di_im_di_nintra_search_dir_limit.regValue= rtd_inl(DI_IM_DI_NINTRA_SEARCH_DIR_LIMIT_reg);

	init_di_gst_ctrl_reg.regValue = rtd_inl(DI_DI_GST_Ctrl_reg);
#ifdef CONFIG_HW_SUPPORT_MEMC
	color_temp_ctrl_reg.regValue = rtd_inl(MEMC_MUX_MEMC_MUX_DI_CTRL_reg);
#endif
	dch1_cp_ctrl_reg.regValue = rtd_inl(NR_DCH1_CP_Ctrl_reg);
	dm_uzu_main_v_partial_drop_RBUS_reg.regValue = rtd_inl(SCALEUP_DM_UZUMAIN_V_PARTIAL_DROP_reg);
	nr_mosquito_ctrl_RBUS_reg.regValue = rtd_inl(NR_MOSQUITO_CTRL_reg);
	curve_mapping_w1_1_reg.regValue = rtd_inl(NR_CURVE_MAPPING_W1_1_reg);
	curve_mapping_w1_2_reg.regValue = rtd_inl(NR_CURVE_MAPPING_W1_2_reg);
	curve_mapping_w1_3_reg.regValue = rtd_inl(NR_CURVE_MAPPING_W1_3_reg);

	curve_mapping_w2_1_reg.regValue = rtd_inl(NR_CURVE_MAPPING_W2_1_reg);
	curve_mapping_step2_reg.regValue = rtd_inl(NR_CURVE_MAPPING_STEP_2_reg);
	curve_mapping_step3_reg.regValue = rtd_inl(NR_CURVE_MAPPING_STEP_3_reg);
	di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
	edgesmooth_ex_ctrl_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg);
	edgesmooth_ex_ctrl3_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg);
	d_vc_global_ctrl_REG.regValue = rtd_inl(COLOR_D_VC_Global_CTRL_reg);

	nr_mosquito_nr_level_ctrl_RBUS_reg.regValue = rtd_inl(NR_MOSQUITO_NR_LEVEL_CTRL_reg);
	nr_mosquito_nr_level_ctrl_1_RBUS_reg.regValue= rtd_inl(NR_MOSQUITO_NR_LEVEL_CTRL_1_reg);
	dm_uzu_Ctrl_reg.regValue = rtd_inl(SCALEUP_DM_UZU_Ctrl_reg);

	dch1_Spatial_Weight_Reg.regValue = rtd_inl(NR_DCH1_Spatial_Weight_reg);

	// No.191 monoscope
	color_sharp_dm_segpk_edgpk3.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg);
	color_sharp_dm_peaking_bound_1_reg.regValue= rtd_inl(COLOR_SHARP_DM_PEAKING_BOUND_1_reg);


	di_rtnr_ma_snr_strength_control.regValue=	rtd_inl(DI_RTNR_MA_SNR_STRENGTH_CONTROL_reg);

	edgesmooth_ex_ctrl2_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg);

	color_sharp_dm_peaking_gain_reg.regValue = rtd_inl(COLOR_SHARP_DM_PEAKING_GAIN_reg);

	di_hmc_adjustable_reg.regValue = rtd_inl(DI_IM_DI_HMC_ADJUSTABLE_reg);
	di_hmc_pan_control_par_2_reg.regValue = rtd_inl(DI_IM_DI_HMC_PAN_CONTROL_PAR_2_reg);
	di_hmc_pan_control_par_1_reg.regValue = rtd_inl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg);
	di_hmc_statistic1_reg.regValue = rtd_inl(DI_IM_DI_HMC_STATISTIC1_reg);

	di_hmc_adjustable3_reg.regValue = rtd_inl(DI_IM_DI_HMC_ADJUSTABLE3_reg);
	di_hmc_adjustable4_reg.regValue = rtd_inl(DI_IM_DI_HMC_ADJUSTABLE4_reg);


	dm_segpk_vpk2.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_VPK2_reg );



	im_di_weave_window_control_reg.regValue = rtd_inl(DI_IM_DI_WEAVE_WINDOW_CONTROL_reg);
	im_di_weave_window_1_start_reg.regValue = rtd_inl(DI_IM_DI_WEAVE_WINDOW_1_START_reg);
	im_di_weave_window_1_end_reg.regValue = rtd_inl(DI_IM_DI_WEAVE_WINDOW_1_END_reg);

	di_ma_frame_motion_th_a_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg);
	di_ma_frame_motion_th_b_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg);
	di_ma_frame_motion_th_c_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg);


    /*
	if(system_info_structure_table->Input_src_Form == _SRC_FROM_VDC && vd_pwr_ok) //only VDC format can read it.avoid vd ip had close
	{
		//YC_BW_CTRL_reg.regValue = rtd_inl(VDPQ_YC_BW_CTRL_reg);
		// outer if function currently useless, willy 20150605
		//vdpq_adap_bpf_y_th3_reg.regValue = rtd_inl(VDPQ_ADAP_BPF_Y_TH3_reg);
	}
	// set as the IC default value, willy 20150605
	//vdpq_adap_bpf_y_th3_reg.regValue = 0;
    */

	curve_mapping_w2_1_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W2_1_reg);
	curve_mapping_w2_2_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W2_2_reg);

	di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
	intra_th_Reg.regValue = rtd_inl(DI_IM_DI_INTRA_TH_reg);
	dm_mem_crc_ctrl_RBUS_reg.regValue= rtd_inl(SCALEUP_DM_MEM_CRC_CTRL_reg);

	//frame_motion_a_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg);
	color_sharp_dm_cds_cm0_u_bound_0_reg.regValue = rtd_inl(COLOR_SHARP_DM_CDS_CM0_U_BOUND_0_reg);

	rtnr_new_Ctrl.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_CONTROL_reg);

	ich1_newdcti_reg_2.regValue = rtd_inl(IDCTI_I_DCTI_CTRL_2_reg);
	ich1_newdcti_reg_1.regValue = rtd_inl(IDCTI_I_DCTI_CTRL_1_reg);
	dm_dcti_REG_1.regValue = rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_1_reg);
	dm_dcti_REG_2.regValue = rtd_inl(COLOR_SHARP_SHP_DCTI_CTRL_2_reg);

	dm_uzu_Ctrl.regValue = rtd_inl(SCALEUP_DM_UZU_Ctrl_reg);

	if (cur_source <= VIP_QUALITY_TV_PAL) {
		if (vd_pwr_ok)
			auto_pos_ctrl_reg.regValue = VDPQ_rtd_inl(VDTOP_AUTO_POS_CTRL_reg);
	}

	// special setting for LG139, willy 20151005
	di_ma_frame_motion_th_a_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg);
	di_ma_frame_motion_th_b_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg);
	di_ma_frame_motion_th_c_reg.regValue = rtd_inl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg);
	di_smd_control_candiate_reg.regValue = rtd_inl(DI_DI_SMD_Control_CandidateList_reg);
	di_im_di_nintra_control.regValue = rtd_inl(DI_IM_DI_NINTRA_CONTROL_reg);

	di_pan_dummy2_reg.regValue = rtd_inl(DI_IM_DI_HMC_PAN_DUMMY_2_reg);
	di_pan_dummy3_reg.regValue = rtd_inl(DI_IM_DI_HMC_PAN_DUMMY_3_reg);

	di_im_di_btr_control_reg.regValue = rtd_inl(DI_IM_DI_BTR_CONTROL_reg);

	di_hmc_adjustable2_reg.regValue = rtd_inl(DI_IM_DI_HMC_ADJUSTABLE2_reg);

	if(cur_source == VIP_QUALITY_TV_SECAN){
	    	postp_secam_fix_ctrl_reg.regValue =VDPQ_rtd_inl(VDPQ_POSTP_SECAM_FIX_CTRL_reg);
		postp_secam_fix_y_detect0_reg.regValue = VDPQ_rtd_inl(VDPQ_POSTP_SECAM_FIX_Y_DETECT0_reg);
		postp_secam_fix_y_detect1_reg.regValue = VDPQ_rtd_inl(VDPQ_POSTP_SECAM_FIX_Y_DETECT1_reg);
	}
	di_im_new_mcnr_control.regValue = rtd_inl(DI_IM_NEW_MCNR_CONTROL_reg);

	edgesmooth_mess_direction1_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_Mess_Direction1_reg);

	dm_dir_uzu_conf_Reg.regValue = rtd_inl(SCALEUP_DM_DIR_UZU_Conf_reg);
	di_im_di_hmc_pan_control_reg.regValue = rtd_inl(DI_IM_DI_HMC_PAN_CONTROL_reg);
	di_hmc_me_refine_ctrl2_reg.regValue = rtd_inl(DI_IM_DI_HMC_ME_REFINE_CTRL_2_reg);
	FrameSobel_statistic_Reg.regValue = rtd_inl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg);



	di_di_smd_waterflag_ctr3.regValue = rtd_inl(DI_DI_SMD_WaterFlag_Ctr3_reg);
//	di_di_smd_resurrect_ctrl.regValue = rtd_inl(DI_DI_SMD_Resurrect_Ctrl_reg); Mac5 remove




	im_di_film_sawtooth_filmframe_th_reg.regValue = rtd_inl(DI_IM_DI_FILM_SAWTOOTH_FILMFRAME_TH_reg);
	film_static_sum_th_reg.regValue = rtd_inl(DI_IM_DI_FILM_STATIC_SUM_TH_reg);
	film_motion_sum_th_reg.regValue = rtd_inl(DI_IM_DI_FILM_MOTION_SUM_TH_reg);


	/*LG internal TV signal "E-52"*/
	tnrxc_mkii_ctrl_reg.regValue = rtd_inl(DI_TNRXC_MkII_CTRL_reg);

	//when timing change ,need kernel quality handle load table finiished ,wait 120 times if still not flag form kernel , start work
	if((pre_source !=cur_source )&&(kernel_quality_init==0)&&(kernel_init_count<120))
	{
		kernel_init_count++;
		return;
	}

	if(pre_source !=cur_source)
	{

		//ROSPrintf(" \n rord ini =%d \n",kernel_quality_init);
		//ROSPrintf(" \n rord count =%d \n",kernel_init_count);

		ori_smd_upperbound_sad_forjudgemv=di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv;
		ori_smd_rang_sad = smd_choosecandidate_reg.smd_reliablerange_sad_th;

		ori_smd_firmware_pan_sad_th = init_di_smd_pan1_reg.smd_firmware_pan_sad_th;

		ori_smd_firmware_pan=init_di_smd_pan1_reg.smd_firmware_pan;
		ori_smd_hardware_pan_en=init_di_smd_pan1_reg.smd_hardware_pan_en;
		ori_smd_apply_result_mode=init_di_smd_pan1_reg.smd_apply_result_mode;
		ori_smd_firmwarepan_sadmax=di_di_smd_hardwarepan_modify1.smd_firmwarepan_sadmax;
		ori_smd_close2gmv_mvselect=di_di_smd_sampling_gmvc.smd_close2gmv_mvselect;
//		ori_smd_close2gmv_fw_en =di_di_smd_sampling_gmvc.smd_close2gmv_fw_en; Mac5 remove
		ori_gst_subpixel_compensate_en=di_di_gst_compensate.gst_subpixel_compensate_en;
		ori_gst_subpixel_hardwarepan_en = di_di_gst_compensate.gst_subpixel_hardwarepan_en;
		ori_smd_en = di_smd_control_candiate_reg.smd_en;
		ori_smd_result_en = init_di_smd_additionalcoeff1_reg.smd_result_en;


		ori_di_di_smd_waterflag_ctr3.regValue = di_di_smd_waterflag_ctr3.regValue;
//		ori_di_di_smd_resurrect_ctrl.regValue = di_di_smd_resurrect_ctrl.regValue; Mac5 remove



		ori_smd_acc_smd_en =di_di_smd_slow_motion_handle1.smd_acc_smd_en;
		ori_smd_spatialfreqnomatch_off =di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off;
		ori_smd_outofrange_content_new = di_di_smd_slow_motion_handle1.smd_outofrange_content_new;

		ori_gst_gst_static_disable = di_di_smd_slow_motion_handle1.gst_gst_static_disable;
		ori_gst_min_sad_compare_diable = di_di_smd_slow_motion_handle1.gst_min_sad_compare_diable;
		ori_gst_min_sad_nolimit_en = di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en;
		ori_smd_weave_dynamic = di_di_smd_slow_motion_handle1.smd_weave_dynamic;

		ori_gst_mv_limit = di_di_smd_slow_motion_handle2.gst_mv_limit;

		ori_nintra_lp_src_yclamp_th = di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th;
		ori_di_im_di_nintra_search_dir_limit.regValue= di_im_di_nintra_search_dir_limit.regValue;


		ori_cp_sresultweight=dch1_cp_ctrl_reg.cp_sresultweight;
		ori_spatialenablec = dch1_cp_ctrl_reg.cp_spatialenablec;
		ori_vc_snr_lpf_sel = dch1_cp_ctrl_reg.vc_snr_lpf_sel;
		ori_sresultweight_adjust_shift = dch1_cp_ctrl_reg.sresultweight_adjust_shift;

		ori_mosquito_en=nr_mosquito_ctrl_RBUS_reg.mosquito_detect_en;
		ori_curve_mapping_w1_3 =curve_mapping_w1_1_reg.curvemapping_w1_3;
		ori_curve_mapping_w1_4=curve_mapping_w1_2_reg.curvemapping_w1_4;
		ori_curve_mapping_w1_5=curve_mapping_w1_2_reg.curvemapping_w1_5;
		ori_curve_mapping_w1_2=curve_mapping_w1_1_reg.curvemapping_w1_2;
		ori_curve_mapping_w1_6=curve_mapping_w1_2_reg.curvemapping_w1_6;
		ori_curve_mapping_w1_7=curve_mapping_w1_2_reg.curvemapping_w1_7;
		ori_curve_mapping_w1_8=curve_mapping_w1_3_reg.curvemapping_w1_8;

		ori_curve_mapping_step6=curve_mapping_step2_reg.curvemapping_step6;
		ori_curve_mapping_step7=curve_mapping_step3_reg.curvemapping_step7;
		ori_curve_mapping_step8=curve_mapping_step3_reg.curvemapping_step8;

		ori_ma_snr_edge_curve_slope=di_rtnr_ma_snr_strength_control.rtnr_ma_snr_edge_curve_slope;
		ori_ma_snr_output_clamp=di_rtnr_ma_snr_strength_control.rtnr_ma_snr_output_clamp;

#ifdef ISR_ICM_ADJUST_FUNCTIOM_ENABLE
		scalerVIP_INT32_Copy((g_ICM_Global_Ctrl_Struct->dSatBySat),SATSEGMAX,ori_dsatbysat);
		scalerVIP_INT32_Copy(&(g_ICM_Global_Ctrl_Struct->dHue),1,&g_dhue);
		scalerVIP_INT32_Copy((g_ICM_Global_Ctrl_Struct->dSatBySat),SATSEGMAX,g_dsatbysat);
		scalerVIP_INT32_Copy((g_ICM_Global_Ctrl_Struct->dItnByItn),ITNSEGMAX,g_ditnbyitn);
#endif

		ori_mosquito_nr_positive_shift=nr_mosquito_nr_level_ctrl_RBUS_reg.mosquitonr_nlevel_positive_shift;
		//ori_mosquito_nr_bi_nlevel_max=nr_mosquito_nr_level_ctrl_RBUS_reg.mosquitonr_bi_nlevel_max;
		ori_mosquito_far_var_gain=nr_mosquito_nr_level_ctrl_1_RBUS_reg.far_var_gain;
		ori_ULTRI_value = dm_uzu_Ctrl_reg.regValue; // what is this????? assign a register value to a specific bit?
		ori_Intr_di_range = di_control_reg.regValue; // what is this????? assign a register value to a specific bit?
		org_edgesmoothex_en = edgesmooth_ex_ctrl_reg.edgesmoothex_en;
		ori_edgesmoothex_edgeupbud = edgesmooth_ex_ctrl3_reg.edge_upbnd;
		m_edgesmooth_en = d_vc_global_ctrl_REG.m_edgesmooth_en;

		ori_gain_pos=color_sharp_dm_segpk_edgpk3.gain_pos;
		ori_gain_neg=color_sharp_dm_segpk_edgpk3.gain_neg;
		ori_gain_LV_Gain=color_sharp_dm_peaking_bound_1_reg.lv;

		ori_cp_fixedweight1y = dch1_Spatial_Weight_Reg.cp_fixedweight1y;
		ori_cp_fixedweight2y = dch1_Spatial_Weight_Reg.cp_fixedweight2y;

		ori_edgesmooth_ex_up_bounmd = edgesmooth_ex_ctrl2_reg.t2df_upbnd;
		ori_edgesmooth_top2diff_step_bit =edgesmooth_ex_ctrl2_reg.t2df_stepbit;
		ori_edgesmooth_edge_en= edgesmooth_ex_ctrl_reg.edge_en;
		ori_edgesmooth_t2df_en = edgesmooth_ex_ctrl_reg.t2df_en;

		ori_text_gain_pos =color_sharp_dm_peaking_gain_reg.gain_pos;
		ori_text_gain_neg = color_sharp_dm_peaking_gain_reg.gain_neg;

		ORI_di_hmc_adjustable_reg.regValue= di_hmc_adjustable_reg.regValue;
		ori_hmc_sub_pixel_diff_thd = di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd;
		ORI_di_hmc_adjustable3_reg.regValue= di_hmc_adjustable3_reg.regValue;
		ORI_di_hmc_adjustable4_reg.regValue= di_hmc_adjustable4_reg.regValue;

		ori_curve_mapping_w2_2 = curve_mapping_w2_1_reg.curvemapping_w2_2;
		ori_curve_mapping_w2_3 = curve_mapping_w2_1_reg.curvemapping_w2_3;
		ori_curve_mapping_w2_4 = curve_mapping_w2_2_reg.curvemapping_w2_4;
		ori_curve_mapping_w2_5 = curve_mapping_w2_2_reg.curvemapping_w2_5;

		ori_vcti_select = dm_mem_crc_ctrl_RBUS_reg.vcti_select;
		ori_vcti_en = dm_mem_crc_ctrl_RBUS_reg.vcti_en;
		ori_dm_mem_crc_ctrl_RBUS_reg.regValue = dm_mem_crc_ctrl_RBUS_reg.regValue;
		ori_vcti_low_pass_filter_en = dm_uzu_main_v_partial_drop_RBUS_reg.vcti_low_pass_filter_en;
		ori_mosquito_edgethd = nr_mosquito_ctrl_RBUS_reg.mosquito_edgethd;
		//ori_frame_motion_a_reg = frame_motion_a_reg.ma_framestha;
		ori_cp_sresultweight = dch1_cp_ctrl_reg.cp_sresultweight;

		ori_cds_enable=color_sharp_dm_cds_cm0_u_bound_0_reg.cds_enable;


		ori_vpk_gain_neg=dm_segpk_vpk2.vpk_gain_neg;
		ori_vpk_gain_pos=dm_segpk_vpk2.vpk_gain_pos;

//		ori_rtnr_sad_method = rtnr_new_Ctrl.rtnr_sad_method; // mac5 remove new rtnr


		ori_I_uvsync_en=ich1_newdcti_reg_2.uvsync_en;
		ori_I_uvgain=ich1_newdcti_reg_1.uvgain;
		ori_I_lp_mode=ich1_newdcti_reg_1.lp_mode;
		ori_I_vlp_mode=ich1_newdcti_reg_2.vlp_mode;
		ori_I_blending_mode=ich1_newdcti_reg_2.blending_mode;
		ori_I_cur_sel=ich1_newdcti_reg_1.cur_sel;
		ori_I_data_sel=ich1_newdcti_reg_1.data_sel;
		ori_I_maxlen =ich1_newdcti_reg_1.maxlen;

		ori_D_uvgain=dm_dcti_REG_1.uvgain;
		ori_D_vlp_mode=dm_dcti_REG_2.vlp_mode;
		ori_D_data_sel=dm_dcti_REG_1.data_sel;
		ori_D_engdiv=dm_dcti_REG_1.engdiv;
		ori_D_offdiv=dm_dcti_REG_1.offdiv;
		ori_D_maxlen=dm_dcti_REG_1.maxlen;

		ori_film_enable = di_control_reg.film_enable;

		ori_dm_uzu_hor_mode_sel = dm_uzu_Ctrl.hor_mode_sel;
		ori_dm_uzu_y_consttab_sel = dm_uzu_Ctrl.h_y_consttab_sel;
		ORI_auto_pos_ctrl_reg.regValue= auto_pos_ctrl_reg.regValue;

		ORI_di_ma_frame_motion_th_a_reg.regValue = di_ma_frame_motion_th_a_reg.regValue;
		ORI_di_ma_frame_motion_th_b_reg.regValue = di_ma_frame_motion_th_b_reg.regValue;
		ORI_di_ma_frame_motion_th_c_reg.regValue = di_ma_frame_motion_th_c_reg.regValue;
		ORI_di_smd_control_candiate_reg.regValue = di_smd_control_candiate_reg.regValue;
		ori_di_im_di_nintra_control.regValue = di_im_di_nintra_control.regValue;

		ORI_di_pan_dummy2_reg.regValue = di_pan_dummy2_reg.regValue;
		ORI_di_pan_dummy3_reg.regValue = di_pan_dummy3_reg.regValue;

		ORI_di_im_di_btr_control_reg.regValue = di_im_di_btr_control_reg.regValue;

		ORI_di_hmc_adjustable2_reg.regValue = di_hmc_adjustable2_reg.regValue;

		ORI_postp_secam_fix_ctrl_reg.regValue = postp_secam_fix_ctrl_reg.regValue;
		ORI_postp_secam_fix_y_detect0_reg.regValue = postp_secam_fix_ctrl_reg.regValue;
		ORI_postp_secam_fix_y_detect1_reg.regValue = postp_secam_fix_ctrl_reg.regValue;

		ori_n_mcnr_offset = di_im_new_mcnr_control.n_mcnr_offset;

		ORI_im_di_weave_window_control_reg.regValue = im_di_weave_window_control_reg.regValue;
		ORI_im_di_weave_window_1_start_reg.regValue = im_di_weave_window_1_start_reg.regValue;
		ORI_im_di_weave_window_1_end_reg.regValue = im_di_weave_window_1_end_reg.regValue;

		ori_mess_4direction_thd = edgesmooth_mess_direction1_reg.mess_4direction_thd;
		ori_conf_lowbnd =dm_dir_uzu_conf_Reg.conf_lowbnd;

		ORI_di_hmc_pan_control_par_1_reg.regValue = di_hmc_pan_control_par_1_reg.regValue;
		ORI_di_hmc_statistic1_reg.regValue = di_hmc_statistic1_reg.regValue;
		ORI_di_hmc_me_refine_ctrl2_reg.regValue = di_hmc_me_refine_ctrl2_reg.regValue;

		ORI_FrameSobel_statistic_Reg.regValue = FrameSobel_statistic_Reg.regValue;


		ori_smd_compensate_reg.regValue = smd_compensate_reg.regValue;

		ori_di_smd_refinemv2_reg.regValue= di_smd_refinemv2_reg.regValue;

		ORI_tnrxc_mkii_ctrl_reg.regValue = tnrxc_mkii_ctrl_reg.regValue;
		ORI_init_di_gst_ctrl_reg.regValue= init_di_gst_ctrl_reg.regValue;
#ifdef CONFIG_HW_SUPPORT_MEMC
		ORI_color_temp_ctrl_reg.regValue=color_temp_ctrl_reg.regValue;
#endif

		ORI_im_di_film_sawtooth_filmframe_th_reg.regValue = im_di_film_sawtooth_filmframe_th_reg.regValue;
		ORI_film_static_sum_th_reg.regValue = film_static_sum_th_reg.regValue;
		ORI_film_motion_sum_th_reg.regValue = film_motion_sum_th_reg.regValue;



		set_p2i_value = 0;
		soft_move_cnt =0;

	}

	kernel_quality_init = 0 ;
	kernel_init_count =0;
	pre_source = cur_source;

	init_di_smd_additionalcoeff1_reg.smd_result_en=ori_smd_result_en;
	rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg,init_di_smd_additionalcoeff1_reg.regValue);

	switch(cur_source)
	{
		case VIP_QUALITY_CVBS_NTSC:
		{
			if(!vd_pwr_ok)
				break;

			//************** INI VALE START    ***************************************************


			//#1
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_en=ori_smd_en;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			//#2
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			edgesmooth_ex_ctrl_reg.edge_en =ori_edgesmooth_edge_en;;
			edgesmooth_ex_ctrl_reg.t2df_en =ori_edgesmooth_t2df_en;
			edgesmooth_ex_ctrl2_reg.t2df_stepbit=ori_edgesmooth_top2diff_step_bit;

			//#7
			edgesmooth_ex_ctrl2_reg.t2df_upbnd =ori_edgesmooth_ex_up_bounmd;
//			di_pan_dummy2_reg.panConti_str = ORI_di_pan_dummy2_reg.panConti_str; Mac5 rord fix me by henry
//			di_pan_dummy3_reg.panDeb_str = ORI_di_pan_dummy3_reg.panDeb_str; Mac5 rord fix me by henry

			//#12
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			//#23 #24
			init_di_smd_additionalcoeff1_reg.smd_result_en=ori_smd_result_en;

			//#28
			di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = ori_nintra_lp_src_yclamp_th;
			di_im_di_nintra_search_dir_limit.regValue=ori_di_im_di_nintra_search_dir_limit.regValue;

			//#63
			di_di_smd_slow_motion_handle1.smd_acc_smd_en =ori_smd_acc_smd_en;
			di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=ori_smd_spatialfreqnomatch_off;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			// di_im_new_mcnr_control.n_mcnr_offset ; don't set value in here, it control by mcnr
			//edgesmooth_mess_direction1_reg.mess_4direction_thd = ori_mess_4direction_thd;

			//#75
//			di_pan_dummy2_reg.panConti_str = ORI_di_pan_dummy2_reg.panConti_str; Mac5 rord fix me by henry
//			di_pan_dummy3_reg.panDeb_str = ORI_di_pan_dummy3_reg.panDeb_str; Mac5 rord fix me by henry
			di_hmc_adjustable2_reg.hmc_mv_refine_mor_noise_th = ORI_di_hmc_adjustable2_reg.hmc_mv_refine_mor_noise_th;

			//#107
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			smd_refinemv3_reg.smd_sfreq_diff_gain =4;
			smd_refinemv3_reg.smd_sfreq_diff_th =25;
			smd_refinemv3_reg.smd_sfreq_drop_th =80;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_max=0xd2;
			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x40;

			init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=gSmd_gain;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=gSmd_offset;
			di_smd_dummy_reg.smd_partialweave =0;

			di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = ori_hmc_sub_pixel_diff_thd;

			di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =ori_gst_min_sad_nolimit_en;
			di_di_smd_slow_motion_handle1.gst_gst_static_disable =ori_gst_gst_static_disable;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			di_di_smd_slow_motion_handle1.smd_outofrange_content_new = ori_smd_outofrange_content_new;
			di_di_smd_slow_motion_handle2.gst_mv_limit = ori_gst_mv_limit;
			//di_di_smd_slow_motion_handle1.smd_acc_smd_en =ori_smd_acc_smd_en;
			//di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=ori_smd_spatialfreqnomatch_off;

			im_di_weave_window_control_reg.fixedwindow1 = ORI_im_di_weave_window_control_reg.fixedwindow1;
			im_di_weave_window_1_start_reg.regValue = ORI_im_di_weave_window_1_start_reg.regValue;
			im_di_weave_window_1_end_reg.regValue = ORI_im_di_weave_window_1_end_reg.regValue;

			di_hmc_statistic1_reg.regValue = ORI_di_hmc_statistic1_reg.regValue;
			di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = ORI_di_hmc_pan_control_par_1_reg.hme_sum_max_ratio;
			FrameSobel_statistic_Reg.regValue = ORI_FrameSobel_statistic_Reg.regValue;
			di_hmc_adjustable_reg.regValue = ORI_di_hmc_adjustable_reg.regValue;
			di_hmc_adjustable2_reg.regValue= ORI_di_hmc_adjustable2_reg.regValue;
			di_hmc_adjustable3_reg.regValue= ORI_di_hmc_adjustable3_reg.regValue;
			di_hmc_adjustable4_reg.regValue= ORI_di_hmc_adjustable4_reg.regValue;


			//#139
			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			//di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_c_reg.ma_framesthc = ORI_di_ma_frame_motion_th_c_reg.ma_framesthc;
			di_ma_frame_motion_th_c_reg.ma_framehthc = ORI_di_ma_frame_motion_th_c_reg.ma_framehthc;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = ORI_di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv;

			dch1_cp_ctrl_reg.sresultweight_adjust_shift = ori_sresultweight_adjust_shift;
			dch1_cp_ctrl_reg.vc_snr_lpf_sel = ori_vc_snr_lpf_sel;
			curve_mapping_w1_2_reg.curvemapping_w1_6 = ori_curve_mapping_w1_6;
			curve_mapping_w1_2_reg.curvemapping_w1_7 = ori_curve_mapping_w1_7;
			curve_mapping_step3_reg.curvemapping_step8=ori_curve_mapping_step8;

			//#147,148,149,150
			dch1_Spatial_Weight_Reg.cp_fixedweight1y = ori_cp_fixedweight1y;
			dch1_Spatial_Weight_Reg.cp_fixedweight2y = ori_cp_fixedweight2y;

			//#151

			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_b_reg.ma_framerlvthb = ORI_di_ma_frame_motion_th_b_reg.ma_framerlvthb;
			di_ma_frame_motion_th_b_reg.ma_framemthb = ORI_di_ma_frame_motion_th_b_reg.ma_framemthb;

			dm_dir_uzu_conf_Reg.conf_lowbnd = ori_conf_lowbnd;
			di_im_di_nintra_control.nintra_intersection_check_en =ori_di_im_di_nintra_control.nintra_intersection_check_en;
			di_im_di_nintra_control.nintra_preline_dir_check2_en = ori_di_im_di_nintra_control.nintra_preline_dir_check2_en;

			//#188
			di_im_di_btr_control_reg.btr_blendtemporalrecoveryen = ORI_di_im_di_btr_control_reg.btr_blendtemporalrecoveryen;

			//#189
			di_hmc_statistic1_reg.ma_hmc_lineratio = ORI_di_hmc_statistic1_reg.ma_hmc_lineratio;
			di_hmc_me_refine_ctrl2_reg.hmc_fw_ctrl_bypass = ORI_di_hmc_me_refine_ctrl2_reg.hmc_fw_ctrl_bypass;
			di_hmc_adjustable_reg.hmc_mv_refine_en = ORI_di_hmc_adjustable_reg.hmc_mv_refine_en;
			di_hmc_adjustable2_reg.hme_x_continued_counter = ORI_di_hmc_adjustable2_reg.hme_x_continued_counter;
			init_di_smd_additionalcoeff1_reg.smd_result_en = ori_smd_result_en;
			di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = ORI_di_hmc_pan_control_par_1_reg.hme_sum_max_ratio;

			//#192
			dch1_cp_ctrl_reg.cp_sresultweight =ori_cp_sresultweight;
			curve_mapping_w1_1_reg.curvemapping_w1_3 =ori_curve_mapping_w1_3;
			curve_mapping_w1_2_reg.curvemapping_w1_4 =ori_curve_mapping_w1_4;
			curve_mapping_w1_2_reg.curvemapping_w1_5 =ori_curve_mapping_w1_5;
			edgesmooth_ex_ctrl3_reg.edge_upbnd = ori_edgesmoothex_edgeupbud;

			//VPAN case
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = ORI_di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv;

			//************** INI VALE END    ***************************************************

			if(DynamicOptimizeSystem[1] ==1)
			{
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_compensate_reg.smd_compensate_teeth_th =200;
			}
			else if(DynamicOptimizeSystem[2] ==1)
			{
				drvif_color_rtnr_c_th_isr(_CHANNEL1,&Motion_Th_c[0]);
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
  				edgesmooth_ex_ctrl_reg.edge_en=0;
				edgesmooth_ex_ctrl_reg.t2df_en=0;
				edgesmooth_ex_ctrl2_reg.t2df_stepbit=3;
			}
			else if(DynamicOptimizeSystem[7] ==1)
			{
				edgesmooth_ex_ctrl2_reg.t2df_upbnd =60;
//				di_pan_dummy2_reg.panConti_str = 12; Mac5 rord fix me by henry
//				di_pan_dummy3_reg.panDeb_str = 80; Mac5 rord fix me by henry

			}
			else if(DynamicOptimizeSystem[12] ==1)
			{
				//drvif_color_newrtnr_sad_th(1,&Motion_Th[0]);//for sad edge th setting
				//drvif_color_newrtnr_sad_th(0,&Motion_Th[0]);//for sad nonedge th setting
				drvif_color_rtnr_y_th_isr(_CHANNEL1,&Motion_Th[0]);

				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_compensate_reg.smd_compensate_teeth_th =200;

			}
			else if((DynamicOptimizeSystem[23]==1)||(DynamicOptimizeSystem[24]==1))
			{
				init_di_smd_additionalcoeff1_reg.smd_result_en=0;
			}
			else if(DynamicOptimizeSystem[28] ==1)
			{
				di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = 255;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th1=40;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th2=40;
			}
			else if(DynamicOptimizeSystem[28] ==2)
			{
				dm_dir_uzu_conf_Reg.conf_lowbnd = 30;
			}
			else if(DynamicOptimizeSystem[63] ==1)
			{
				di_di_smd_slow_motion_handle1.smd_acc_smd_en =1;
				di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=1;
				di_di_smd_slow_motion_handle1.smd_weave_dynamic = 3;

				di_im_new_mcnr_control.n_mcnr_offset =0;
				edgesmooth_mess_direction1_reg.mess_4direction_thd = 6;


			}
			else if(DynamicOptimizeSystem[75] ==1)
			{
				drvif_color_rtnr_c_th_isr(_CHANNEL1,&Motion_Th_c_can[0]);
//				di_pan_dummy2_reg.panConti_str = 12; Mac5 rord fix me by henry
//				di_pan_dummy3_reg.panDeb_str = 80; Mac5 rord fix me by henry
				di_hmc_adjustable2_reg.hmc_mv_refine_mor_noise_th = 13; // special HMC setting for LG#75 and LG#107, jimmy 20151203
			}
			else if(DynamicOptimizeSystem[107]==1)
			{
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 170;//125; willy, 20151224
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				smd_refinemv3_reg.smd_sfreq_diff_gain =0;
				smd_refinemv3_reg.smd_sfreq_diff_th =0;
				smd_refinemv3_reg.smd_sfreq_drop_th =0;
				smd_compensate_reg.smd_compensate_teeth_th =5;

				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_max=0xff;
				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x7f;

				init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain = 6;//2; willy, 20151224
				init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=0x1f;
				di_smd_dummy_reg.smd_partialweave =3;

				di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = 160;

				di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =1;
				di_di_smd_slow_motion_handle1.gst_gst_static_disable =1;
				di_di_smd_slow_motion_handle1.smd_weave_dynamic = 3;
				di_di_smd_slow_motion_handle1.smd_outofrange_content_new = 0;
				di_di_smd_slow_motion_handle2.gst_mv_limit = 1;
				//di_di_smd_slow_motion_handle1.smd_acc_smd_en =1;
				//di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=1;


				di_hmc_statistic1_reg.ma_hmc_lineratio = 24;
				rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);
				di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = 18;

				FrameSobel_statistic_Reg.regValue = 0xc51f4200;
				di_hmc_adjustable_reg.regValue= 0x8FFD0004;
				di_hmc_adjustable2_reg.regValue= 0x0732c014; // special HMC setting for LG#75 and LG#107, jimmy 20151203
				di_hmc_adjustable3_reg.regValue= 0x2819141e;
				di_hmc_adjustable4_reg.regValue= 0x850a0c0c;



				if(RTNR_MAD_count_Y2_avg==0)
					start_count = 30;
				//select windown fix weave
				if(start_count==0) {
					im_di_weave_window_control_reg.fixedwindow1 = 1;
					im_di_weave_window_1_start_reg.regValue = 0x00460030;
					im_di_weave_window_1_end_reg.regValue = 0x008e00ec;
				} else {
					start_count--;
				}

			}
			else if(DynamicOptimizeSystem[139] ==1)
			{
				di_ma_frame_motion_th_a_reg.ma_framestha = 25;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 25;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha = 20;
				di_ma_frame_motion_th_a_reg.ma_framemtha = 9;

				di_ma_frame_motion_th_b_reg.ma_framesthb = 25;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 25;

				di_ma_frame_motion_th_c_reg.ma_framesthc = 20;
				di_ma_frame_motion_th_c_reg.ma_framehthc = 20;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 0;

				dch1_cp_ctrl_reg.sresultweight_adjust_shift = 0;
				dch1_cp_ctrl_reg.vc_snr_lpf_sel = 0;
				curve_mapping_w1_2_reg.curvemapping_w1_6 = 3;
				curve_mapping_w1_2_reg.curvemapping_w1_7 = 3;
				curve_mapping_step3_reg.curvemapping_step8=42;

			}
			else if(DynamicOptimizeSystem[147])
			{
				dch1_Spatial_Weight_Reg.cp_fixedweight1y = 1;
				dch1_Spatial_Weight_Reg.cp_fixedweight2y = 1;
			}
			else if(DynamicOptimizeSystem[151])
			{
				di_ma_frame_motion_th_a_reg.ma_framestha = 50;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 70;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha = 50;
				di_ma_frame_motion_th_a_reg.ma_framemtha = 70;
				di_ma_frame_motion_th_b_reg.ma_framesthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 70;
				di_ma_frame_motion_th_b_reg.ma_framerlvthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framemthb = 70;



				dm_dir_uzu_conf_Reg.conf_lowbnd = 63;
				di_im_di_nintra_control.nintra_intersection_check_en =0;
				di_im_di_nintra_control.nintra_preline_dir_check2_en = 0;

			}
			else if(DynamicOptimizeSystem[188])
			{
				di_im_di_btr_control_reg.btr_blendtemporalrecoveryen = 0;
				init_di_smd_additionalcoeff1_reg.smd_result_en = 0;
			}
			else if(DynamicOptimizeSystem[189])
			{
				di_hmc_statistic1_reg.ma_hmc_lineratio += 24;
				di_hmc_me_refine_ctrl2_reg.hmc_fw_ctrl_bypass = 0;
				di_hmc_adjustable_reg.hmc_mv_refine_en = 0;
				di_hmc_adjustable2_reg.hme_x_continued_counter = 5;
				init_di_smd_additionalcoeff1_reg.smd_result_en = 0;
				di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = 12;

				rtd_outl(DI_IM_DI_HMC_ME_REFINE_CTRL_2_reg, di_hmc_me_refine_ctrl2_reg.regValue);

			}
			else if(DynamicOptimizeSystem[192])
			{
				dch1_cp_ctrl_reg.cp_sresultweight =15;
				curve_mapping_w1_1_reg.curvemapping_w1_3 =8;
				curve_mapping_w1_2_reg.curvemapping_w1_4 =0;
				curve_mapping_w1_2_reg.curvemapping_w1_5 =0;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = 100;
			}
			else if(scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN) >= 2)
			{
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 0;
			}


			//#1
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);

			//#2
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
 			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg, edgesmooth_ex_ctrl_reg.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg, edgesmooth_ex_ctrl2_reg.regValue);

			//#7
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg, edgesmooth_ex_ctrl2_reg.regValue);

			//#23 #24
			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);

			//#28
			rtd_outl(DI_IM_DI_NINTRA_LOWPASS_SOURCE_reg,di_im_di_nintra_lowpass_source.regValue);
			rtd_outl(DI_IM_DI_NINTRA_SEARCH_DIR_LIMIT_reg,di_im_di_nintra_search_dir_limit.regValue);

			//#63

			// protect di 3Abit,reduce r/w time .
			di_control_reg_Prtoect_3AEnable.regValue= rtd_inl(DI_IM_DI_CONTROL_reg);
			di_control_reg.ma_3aenable = di_control_reg_Prtoect_3AEnable.ma_3aenable; // write_enable[16]

			/* henry @ mac5 161219 DI write enable bit */
			//di_control_reg.regValue = di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_5_mask;
			di_control_reg.write_enable_1 = 1;
			//rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);//rord.tsao mark don't change di seeting avoid 3a/5a setting error 2016/02/19
			rtd_outl(DI_IM_DI_INTRA_TH_reg, intra_th_Reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(DI_IM_NEW_MCNR_CONTROL_reg,di_im_new_mcnr_control.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_Mess_Direction1_reg,edgesmooth_mess_direction1_reg.regValue);

			//#75
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_2_reg, di_pan_dummy2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_3_reg, di_pan_dummy3_reg.regValue);

			//#107

			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_RefineMV3_reg, smd_refinemv3_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);
			rtd_outl(DI_DI_SMD_CandidateLimitSAD_reg, init_di_smd_candidatelimitsad_reg.regValue);
			rtd_outl(DI_DI_SMD_AdditionalCoeff2_reg, init_di_smd_additionalcoeff2_reg.regValue);
			rtd_outl(DI_DI_SMD_dummy_reg, di_smd_dummy_reg.regValue);

			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_2_reg, di_hmc_pan_control_par_2_reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle2_reg, di_di_smd_slow_motion_handle2.regValue);

			rtd_outl(DI_IM_DI_WEAVE_WINDOW_CONTROL_reg, im_di_weave_window_control_reg.regValue);
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_1_START_reg, im_di_weave_window_1_start_reg.regValue);
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_1_END_reg, im_di_weave_window_1_end_reg.regValue);


			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg,di_hmc_pan_control_par_1_reg.regValue);
			rtd_outl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg,FrameSobel_statistic_Reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg, di_hmc_adjustable2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE3_reg, di_hmc_adjustable3_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE4_reg, di_hmc_adjustable4_reg.regValue);


			//#139
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);			//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step3_reg.regValue);		//LGE control

			//#147,148,149,150
			rtd_outl(NR_DCH1_Spatial_Weight_reg, dch1_Spatial_Weight_Reg.regValue);

			//#151

			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);

			rtd_outl(SCALEUP_DM_DIR_UZU_Conf_reg, dm_dir_uzu_conf_Reg.regValue);
			rtd_outl(DI_IM_DI_NINTRA_CONTROL_reg,di_im_di_nintra_control.regValue);

			//#188
			rtd_outl(DI_IM_DI_BTR_CONTROL_reg, di_im_di_btr_control_reg.regValue);
			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);

			//#189
			rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg, di_hmc_adjustable2_reg.regValue);
			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg,di_hmc_pan_control_par_1_reg.regValue);

			//#192
			//rtd_outl(NR_CURVE_MAPPING_W1_1_reg, curve_mapping_w1_1_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);		//LGE control
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg,edgesmooth_ex_ctrl3_reg.regValue);
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);

			// VPAN
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);

			// VD Setting related register control, created by willy, 20151114
			if( DynamicOptimizeSystem[1] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_1);

			if( DynamicOptimizeSystem[2] == 1 )
			{
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_2);
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_DOS_2_TNR_XC);
			}

			if( DynamicOptimizeSystem[7] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_7);

			if( DynamicOptimizeSystem[11] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_11);

			if( DynamicOptimizeSystem[12] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_12);

			if( DynamicOptimizeSystem[28] != 0 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_28);

			if( DynamicOptimizeSystem[63] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_63);

			if( DynamicOptimizeSystem[107] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_107);

			if( DynamicOptimizeSystem[123] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_123);

			if( DynamicOptimizeSystem[134] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_134);

			if( DynamicOptimizeSystem[139] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_139);

			if( DynamicOptimizeSystem[189] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_NTSC_VIP_DOS_LEAF_72);

		}
		break;

		case VIP_QUALITY_CVBS_PAL:
		{
			if(!vd_pwr_ok)
				break;
			//************** INI VALE START    ***************************************************
			//#1
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_en=ori_smd_en;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			//#2
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			edgesmooth_ex_ctrl_reg.edge_en =ori_edgesmooth_edge_en;;
			edgesmooth_ex_ctrl_reg.t2df_en =ori_edgesmooth_t2df_en;
			edgesmooth_ex_ctrl2_reg.t2df_stepbit=ori_edgesmooth_top2diff_step_bit;
	            //di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha; // 20160202, willy, smooth the noisy line, removed by MissKim
	            //di_ma_frame_motion_th_b_reg.ma_framerlvthb = ORI_di_ma_frame_motion_th_b_reg.ma_framerlvthb;
	            //di_ma_frame_motion_th_c_reg.ma_framerlvthc = ORI_di_ma_frame_motion_th_c_reg.ma_framerlvthc;
	            //dm_dir_uzu_conf_Reg.conf_lowbnd = ori_conf_lowbnd;

			//#7
			edgesmooth_ex_ctrl2_reg.t2df_upbnd =ori_edgesmooth_ex_up_bounmd;
//			di_pan_dummy2_reg.panConti_str = ORI_di_pan_dummy2_reg.panConti_str; Mac5 rord fix me by henry
//			di_pan_dummy3_reg.panDeb_str = ORI_di_pan_dummy3_reg.panDeb_str; Mac5 rord fix me by henry

			//#12
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			//#23 #24
			init_di_smd_additionalcoeff1_reg.smd_result_en=ori_smd_result_en;

			//#28
			di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = ori_nintra_lp_src_yclamp_th;
			di_im_di_nintra_search_dir_limit.regValue=ori_di_im_di_nintra_search_dir_limit.regValue;
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;

			//#39
          		di_control_reg.film_enable = ori_film_enable;// write_enable[16]

			/* henry @ mac5 161219 DI write enable bit */
			di_control_reg.write_enable_5 = 1;
			//di_control_reg.regValue = di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_5_mask;

			//#63
			di_di_smd_slow_motion_handle1.smd_acc_smd_en =ori_smd_acc_smd_en;
			di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=ori_smd_spatialfreqnomatch_off;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			// di_im_new_mcnr_control.n_mcnr_offset ; don't set value in here, it control by mcnr
			//edgesmooth_mess_direction1_reg.mess_4direction_thd = ori_mess_4direction_thd;

			//#75
//			di_pan_dummy2_reg.panConti_str = ORI_di_pan_dummy2_reg.panConti_str; Mac5 rord fix me by henry
//			di_pan_dummy3_reg.panDeb_str = ORI_di_pan_dummy3_reg.panDeb_str; Mac5 rord fix me by henry
			di_hmc_adjustable2_reg.hmc_mv_refine_mor_noise_th = ORI_di_hmc_adjustable2_reg.hmc_mv_refine_mor_noise_th;

			//#107
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			smd_refinemv3_reg.smd_sfreq_diff_gain =4;
			smd_refinemv3_reg.smd_sfreq_diff_th =25;
			smd_refinemv3_reg.smd_sfreq_drop_th =80;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;
			smd_compensate_reg.smd_compensate_avg = ori_smd_compensate_reg.smd_compensate_avg;

			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_max=0xd2;
			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x40;

			init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=gSmd_gain;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=gSmd_offset;
			di_smd_dummy_reg.smd_partialweave =0;

			di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = ori_hmc_sub_pixel_diff_thd;

			di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =ori_gst_min_sad_nolimit_en;
			di_di_smd_slow_motion_handle1.gst_gst_static_disable =ori_gst_gst_static_disable;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			di_di_smd_slow_motion_handle1.smd_outofrange_content_new = ori_smd_outofrange_content_new;
			di_di_smd_slow_motion_handle2.gst_mv_limit = ori_gst_mv_limit;
			//di_di_smd_slow_motion_handle1.smd_acc_smd_en =ori_smd_acc_smd_en;
			//di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=ori_smd_spatialfreqnomatch_off;

			im_di_weave_window_control_reg.fixedwindow1 = ORI_im_di_weave_window_control_reg.fixedwindow1;
			im_di_weave_window_control_reg.fixedwindowmode = ORI_im_di_weave_window_control_reg.fixedwindowmode;
			im_di_weave_window_1_start_reg.regValue = ORI_im_di_weave_window_1_start_reg.regValue;
			im_di_weave_window_1_end_reg.regValue = ORI_im_di_weave_window_1_end_reg.regValue;

			di_hmc_statistic1_reg.regValue = ORI_di_hmc_statistic1_reg.regValue;
			di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = ORI_di_hmc_pan_control_par_1_reg.hme_sum_max_ratio;
			FrameSobel_statistic_Reg.regValue = ORI_FrameSobel_statistic_Reg.regValue;
			di_hmc_adjustable_reg.regValue= ORI_di_hmc_adjustable_reg.regValue;
			di_hmc_adjustable2_reg.regValue= ORI_di_hmc_adjustable2_reg.regValue;
			di_hmc_adjustable3_reg.regValue= ORI_di_hmc_adjustable3_reg.regValue;
			di_hmc_adjustable4_reg.regValue= ORI_di_hmc_adjustable4_reg.regValue;




			//#139
			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_c_reg.ma_framesthc = ORI_di_ma_frame_motion_th_c_reg.ma_framesthc;
			di_ma_frame_motion_th_c_reg.ma_framehthc = ORI_di_ma_frame_motion_th_c_reg.ma_framehthc;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = ORI_di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv;

			dch1_cp_ctrl_reg.sresultweight_adjust_shift = ori_sresultweight_adjust_shift;
			dch1_cp_ctrl_reg.vc_snr_lpf_sel = ori_vc_snr_lpf_sel;
			curve_mapping_w1_2_reg.curvemapping_w1_6 = ori_curve_mapping_w1_6;
			curve_mapping_w1_2_reg.curvemapping_w1_7 = ori_curve_mapping_w1_7;
			curve_mapping_w1_3_reg.curvemapping_w1_8 = ori_curve_mapping_w1_8;
			curve_mapping_step3_reg.curvemapping_step8=ori_curve_mapping_step8;

			//#147,148,149,150
			dch1_Spatial_Weight_Reg.cp_fixedweight1y = ori_cp_fixedweight1y;
			dch1_Spatial_Weight_Reg.cp_fixedweight2y = ori_cp_fixedweight2y;

			//#151

			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_b_reg.ma_framerlvthb = ORI_di_ma_frame_motion_th_b_reg.ma_framerlvthb;
			di_ma_frame_motion_th_b_reg.ma_framemthb = ORI_di_ma_frame_motion_th_b_reg.ma_framemthb;


			dm_dir_uzu_conf_Reg.conf_lowbnd = ori_conf_lowbnd;
			di_im_di_nintra_control.nintra_intersection_check_en =ori_di_im_di_nintra_control.nintra_intersection_check_en;
			di_im_di_nintra_control.nintra_preline_dir_check2_en = ori_di_im_di_nintra_control.nintra_preline_dir_check2_en;

			//#188
			di_im_di_btr_control_reg.btr_blendtemporalrecoveryen = ORI_di_im_di_btr_control_reg.btr_blendtemporalrecoveryen;

			//#189
			di_hmc_statistic1_reg.ma_hmc_lineratio = ORI_di_hmc_statistic1_reg.ma_hmc_lineratio;
			di_hmc_me_refine_ctrl2_reg.hmc_fw_ctrl_bypass = ORI_di_hmc_me_refine_ctrl2_reg.hmc_fw_ctrl_bypass;
			di_hmc_adjustable_reg.hmc_mv_refine_en = ORI_di_hmc_adjustable_reg.hmc_mv_refine_en;
			di_hmc_adjustable2_reg.hme_x_continued_counter = ORI_di_hmc_adjustable2_reg.hme_x_continued_counter;
			init_di_smd_additionalcoeff1_reg.smd_result_en = ori_smd_result_en;
			di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = ORI_di_hmc_pan_control_par_1_reg.hme_sum_max_ratio;

			//#192

			dch1_cp_ctrl_reg.cp_sresultweight =ori_cp_sresultweight;
			curve_mapping_w1_1_reg.curvemapping_w1_3 =ori_curve_mapping_w1_3;
			curve_mapping_w1_2_reg.curvemapping_w1_4 =ori_curve_mapping_w1_4;
			curve_mapping_w1_2_reg.curvemapping_w1_5 =ori_curve_mapping_w1_5;
			edgesmooth_ex_ctrl3_reg.edge_upbnd = ori_edgesmoothex_edgeupbud;

			//VPAN case
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = ORI_di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv;

			//************** INI VALE END    ***************************************************

			if(DynamicOptimizeSystem[1] ==1)
			{
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_compensate_reg.smd_compensate_teeth_th =200;

			}
			else if(DynamicOptimizeSystem[2] ==1)
			{
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
  				edgesmooth_ex_ctrl_reg.edge_en=0;
				edgesmooth_ex_ctrl_reg.t2df_en=0;
				edgesmooth_ex_ctrl2_reg.t2df_stepbit=3;
		                //di_ma_frame_motion_th_a_reg.ma_framerlvtha = 1; // 20160202, willy, smooth the noisy line, removed by MissKim
		                //di_ma_frame_motion_th_b_reg.ma_framerlvthb = 1;
		                //di_ma_frame_motion_th_c_reg.ma_framerlvthc = 1;
		                //dm_dir_uzu_conf_Reg.conf_lowbnd = 50;
			}
			else if(DynamicOptimizeSystem[7] ==1)
			{
				edgesmooth_ex_ctrl2_reg.t2df_upbnd =60;
//				di_pan_dummy2_reg.panConti_str = 12; Mac5 rord fix me by henry
//				di_pan_dummy3_reg.panDeb_str = 80; Mac5 rord fix me by henry

			}
			else if(DynamicOptimizeSystem[12] ==1)
			{
				//drvif_color_newrtnr_sad_th(1,&Motion_Th[0]);//for sad edge th setting
				//drvif_color_newrtnr_sad_th(0,&Motion_Th[0]);//for sad nonedge th setting
				drvif_color_rtnr_y_th_isr(_CHANNEL1,&Motion_Th[0]);

				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_compensate_reg.smd_compensate_teeth_th =200;

			}
			else if((DynamicOptimizeSystem[23]==1)||(DynamicOptimizeSystem[24]==1))
			{
				init_di_smd_additionalcoeff1_reg.smd_result_en=0;
			}
			else if(DynamicOptimizeSystem[28] ==1)
			{
				di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = 30;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th1=16;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th2=16;
			}
			else if(DynamicOptimizeSystem[28] == 2)
			{
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 255;
                		dm_dir_uzu_conf_Reg.conf_lowbnd = 30;
			}
			else if(DynamicOptimizeSystem[39] == 1)
			{
                		di_control_reg.film_enable = 17;// write_enable[16]

				/* henry @ mac5 161219 DI write enable bit */
				di_control_reg.write_enable_5 = 1;
				//di_control_reg.regValue = di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_5_mask;
			}
			else if(DynamicOptimizeSystem[63] ==1)
			{
				di_di_smd_slow_motion_handle1.smd_acc_smd_en =1;
				di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=1;
				di_di_smd_slow_motion_handle1.smd_weave_dynamic = 3;

				di_im_new_mcnr_control.n_mcnr_offset =0;
				edgesmooth_mess_direction1_reg.mess_4direction_thd = 6;

				// 20160106 jimmy, turn up RTNR C for cloth cross color
				drvif_color_rtnr_c_th_isr(_CHANNEL1,&Motion_Th_c[0]);

			}
			else if(DynamicOptimizeSystem[75] ==1)
			{
				drvif_color_rtnr_c_th_isr(_CHANNEL1,&Motion_Th_c_can[0]);
//				di_pan_dummy2_reg.panConti_str = 12; Mac5 rord fix me by henry
//				di_pan_dummy3_reg.panDeb_str = 80; Mac5 rord fix me by henry
				di_hmc_adjustable2_reg.hmc_mv_refine_mor_noise_th = 13; // special HMC setting for LG#75, jimmy 20151203
			}
			else if(DynamicOptimizeSystem[107]==1)
			{
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 170;//125; willy, 20151224
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 10;//0; willy, 20151224
				smd_refinemv3_reg.smd_sfreq_diff_gain =0;
				smd_refinemv3_reg.smd_sfreq_diff_th =0;
				smd_refinemv3_reg.smd_sfreq_drop_th =0;
				smd_compensate_reg.smd_compensate_teeth_th =5;
                		smd_compensate_reg.smd_compensate_avg = 148; // willy, 20151224

				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_max=0xff;
				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x7f;

				init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain = 6;//2; willy, 20151224
				init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=0x1f;
				di_smd_dummy_reg.smd_partialweave =3;

				di_hmc_adjustable_reg.hmc_mv_refine_mor_en = 1;
				di_hmc_adjustable_reg.hmc_mv_refine_y_th = 160;
				di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = 160;


				di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =1;
				di_di_smd_slow_motion_handle1.gst_gst_static_disable =1;
				di_di_smd_slow_motion_handle1.smd_weave_dynamic = 0;//3; willy, 20151224
				di_di_smd_slow_motion_handle1.smd_outofrange_content_new = 0;
				di_di_smd_slow_motion_handle2.gst_mv_limit = 1;
				//di_di_smd_slow_motion_handle1.smd_acc_smd_en =1;
				//di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=1;



				di_hmc_statistic1_reg.ma_hmc_lineratio = 24;
				rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);
				di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = 18;

				FrameSobel_statistic_Reg.regValue = 0xc51f4200;
				di_hmc_adjustable_reg.regValue= 0x8FFD0004;
				di_hmc_adjustable2_reg.regValue= 0x0732c014; // special HMC setting for LG#75 and LG#107, jimmy 20151203
				di_hmc_adjustable3_reg.regValue= 0x2819141e;
				di_hmc_adjustable4_reg.regValue= 0x850a0c0c;



		                // weave window to do intra
		                im_di_weave_window_control_reg.fixedwindow1 = 1;
		                im_di_weave_window_control_reg.fixedwindowmode = 0;
		                im_di_weave_window_1_start_reg.regValue = 0x00500033;
		                im_di_weave_window_1_end_reg.regValue = 0x00a700d3;

			}
			else if(DynamicOptimizeSystem[139] ==1)
			{
				di_ma_frame_motion_th_a_reg.ma_framestha = 20;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 20;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha = 20;
				di_ma_frame_motion_th_a_reg.ma_framemtha = 50;
				di_ma_frame_motion_th_b_reg.ma_framesthb = 20;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 20;
				di_ma_frame_motion_th_c_reg.ma_framesthc = 20;
				di_ma_frame_motion_th_c_reg.ma_framehthc = 20;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 0;

				dch1_cp_ctrl_reg.sresultweight_adjust_shift = 0;
				dch1_cp_ctrl_reg.vc_snr_lpf_sel = 0;
				curve_mapping_w1_2_reg.curvemapping_w1_6 = 3;
				curve_mapping_w1_2_reg.curvemapping_w1_7 = 3;
				curve_mapping_w1_3_reg.curvemapping_w1_8 = 6;
				curve_mapping_step3_reg.curvemapping_step8=42;

			}
			else if(DynamicOptimizeSystem[147])
			{
				dch1_Spatial_Weight_Reg.cp_fixedweight1y = 1;
				dch1_Spatial_Weight_Reg.cp_fixedweight2y = 1;
			}
			else if(DynamicOptimizeSystem[151])
			{

				di_ma_frame_motion_th_a_reg.ma_framestha = 50;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 50;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha = 50;
				di_ma_frame_motion_th_a_reg.ma_framemtha = 50;
				di_ma_frame_motion_th_b_reg.ma_framesthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framerlvthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framemthb = 50;

				dm_dir_uzu_conf_Reg.conf_lowbnd = 63;
				di_im_di_nintra_control.nintra_intersection_check_en =0;
				di_im_di_nintra_control.nintra_preline_dir_check2_en = 0;
			}
			else if(DynamicOptimizeSystem[188])
			{
				di_im_di_btr_control_reg.btr_blendtemporalrecoveryen = 0;
			}
			else if(DynamicOptimizeSystem[189])
			{
				di_hmc_statistic1_reg.ma_hmc_lineratio += 24;
				di_hmc_me_refine_ctrl2_reg.hmc_fw_ctrl_bypass = 0;
				di_hmc_adjustable_reg.hmc_mv_refine_en = 0;
				di_hmc_adjustable2_reg.hme_x_continued_counter = 0;
				init_di_smd_additionalcoeff1_reg.smd_result_en = 0;
				di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = 12;

				rtd_outl(DI_IM_DI_HMC_ME_REFINE_CTRL_2_reg, di_hmc_me_refine_ctrl2_reg.regValue);

			}
			else if(DynamicOptimizeSystem[192])
			{
				dch1_cp_ctrl_reg.cp_sresultweight =15;
				curve_mapping_w1_1_reg.curvemapping_w1_3 =8;
				curve_mapping_w1_2_reg.curvemapping_w1_4 =0;
				curve_mapping_w1_2_reg.curvemapping_w1_5 =0;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = 100;
			}
			else if(scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN) >= 2)
			{
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 0;
			}


			//#1
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);

			//#2
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
 			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg, edgesmooth_ex_ctrl_reg.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg, edgesmooth_ex_ctrl2_reg.regValue);
            //rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue); // 20160202, willy, smooth the noisy line, removed by MissKim
			//rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			//rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);

			//#7
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg, edgesmooth_ex_ctrl2_reg.regValue);

			//#23 #24
			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);

			//#28
			rtd_outl(DI_IM_DI_NINTRA_LOWPASS_SOURCE_reg,di_im_di_nintra_lowpass_source.regValue);
			rtd_outl(DI_IM_DI_NINTRA_SEARCH_DIR_LIMIT_reg,di_im_di_nintra_search_dir_limit.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);

            //#39
            //rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);//rord.tsao mark don't change di seeting avoid 3a/5a setting error 2016/02/19

			//#63

			// protect di 3Abit,reduce r/w time .
			di_control_reg_Prtoect_3AEnable.regValue= rtd_inl(DI_IM_DI_CONTROL_reg);
			di_control_reg.ma_3aenable = di_control_reg_Prtoect_3AEnable.ma_3aenable; // write_enable[16]

			/* henry @ mac5 161219 DI write enable bit */
			di_control_reg.write_enable_1 = 1;
			//di_control_reg.regValue = di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_1_mask;

			//rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);//rord.tsao mark don't change di seeting avoid 3a/5a setting error 2016/02/19
			rtd_outl(DI_IM_DI_INTRA_TH_reg, intra_th_Reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(DI_IM_NEW_MCNR_CONTROL_reg,di_im_new_mcnr_control.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_Mess_Direction1_reg,edgesmooth_mess_direction1_reg.regValue);

			//#75
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_2_reg, di_pan_dummy2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_3_reg, di_pan_dummy3_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg, di_hmc_adjustable2_reg.regValue);

			//#107

			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_RefineMV3_reg, smd_refinemv3_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);
			rtd_outl(DI_DI_SMD_CandidateLimitSAD_reg, init_di_smd_candidatelimitsad_reg.regValue);
			rtd_outl(DI_DI_SMD_AdditionalCoeff2_reg, init_di_smd_additionalcoeff2_reg.regValue);
			rtd_outl(DI_DI_SMD_dummy_reg, di_smd_dummy_reg.regValue);

			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_2_reg, di_hmc_pan_control_par_2_reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle2_reg, di_di_smd_slow_motion_handle2.regValue);


			rtd_outl(DI_IM_DI_WEAVE_WINDOW_CONTROL_reg, im_di_weave_window_control_reg.regValue);
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_1_START_reg, im_di_weave_window_1_start_reg.regValue);
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_1_END_reg, im_di_weave_window_1_end_reg.regValue);


			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg,di_hmc_pan_control_par_1_reg.regValue);
			rtd_outl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg,FrameSobel_statistic_Reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg, di_hmc_adjustable2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE3_reg, di_hmc_adjustable3_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE4_reg, di_hmc_adjustable4_reg.regValue);


			//#139
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_3_reg, curve_mapping_w1_3_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step3_reg.regValue);	//LGE control

			//#147,148,149,150
			rtd_outl(NR_DCH1_Spatial_Weight_reg, dch1_Spatial_Weight_Reg.regValue);

			//#151

			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);

			rtd_outl(SCALEUP_DM_DIR_UZU_Conf_reg, dm_dir_uzu_conf_Reg.regValue);
			rtd_outl(DI_IM_DI_NINTRA_CONTROL_reg,di_im_di_nintra_control.regValue);

			//#188
			rtd_outl(DI_IM_DI_BTR_CONTROL_reg, di_im_di_btr_control_reg.regValue);

			//#189
			rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg, di_hmc_adjustable2_reg.regValue);
			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg,di_hmc_pan_control_par_1_reg.regValue);

			//#192
			//rtd_outl(NR_CURVE_MAPPING_W1_1_reg, curve_mapping_w1_1_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);		//LGE control
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg,edgesmooth_ex_ctrl3_reg.regValue);
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);

			// VPAN
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);

			// VD Setting related register control, created by willy, 20151114
			if( DynamicOptimizeSystem[2] == 1 )
			{
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_2);
				scalerVideo_ApplyVDSetting(VDPQ_PAL_DOS_2_TNR_XC);
			}

			if( DynamicOptimizeSystem[7] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_7);

			if( DynamicOptimizeSystem[11] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_11);

			if( DynamicOptimizeSystem[12] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_12);

			if( DynamicOptimizeSystem[28] != 0 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_28);

			if( DynamicOptimizeSystem[63] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_63);

			if( DynamicOptimizeSystem[107] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_107);

			if( DynamicOptimizeSystem[123] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_123);

			if( DynamicOptimizeSystem[134] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_134);

			if( DynamicOptimizeSystem[139] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_139);

			if( DynamicOptimizeSystem[189] == 1 )
				scalerVideo_ApplyVDSetting(VDPQ_PAL_VIP_DOS_LEAF_74);

		}
		break;

		case VIP_QUALITY_HDMI_480I:
		case VIP_QUALITY_YPbPr_480I:
		{

			//************** INI VALE START    ***************************************************
			//#1
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_en=ori_smd_en;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			//#2
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_di_smd_slow_motion_handle1.gst_gst_static_disable = ori_gst_gst_static_disable;
			di_di_smd_slow_motion_handle1.gst_min_sad_compare_diable =ori_gst_min_sad_compare_diable;
			edgesmooth_ex_ctrl_reg.edge_en =ori_edgesmooth_edge_en;;
			edgesmooth_ex_ctrl_reg.t2df_en =ori_edgesmooth_t2df_en;

			//#7
			edgesmooth_ex_ctrl2_reg.t2df_upbnd =ori_edgesmooth_ex_up_bounmd;
//			di_pan_dummy2_reg.panConti_str = ORI_di_pan_dummy2_reg.panConti_str; Mac5 rord fix me by henry
//			di_pan_dummy3_reg.panDeb_str = ORI_di_pan_dummy3_reg.panDeb_str; Mac5 rord fix me by henry

			//#12
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			//#23 #24
			init_di_smd_additionalcoeff1_reg.smd_result_en=ori_smd_result_en;

			//#28
			di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = ori_nintra_lp_src_yclamp_th;
			di_im_di_nintra_search_dir_limit.regValue=ori_di_im_di_nintra_search_dir_limit.regValue;

			//#63
			di_di_smd_slow_motion_handle1.smd_acc_smd_en =ori_smd_acc_smd_en;
			di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=ori_smd_spatialfreqnomatch_off;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			//edgesmooth_mess_direction1_reg.mess_4direction_thd = ori_mess_4direction_thd;

			//#75
//			di_pan_dummy2_reg.panConti_str = ORI_di_pan_dummy2_reg.panConti_str; Mac5 rord fix me by henry
//			di_pan_dummy3_reg.panDeb_str = ORI_di_pan_dummy3_reg.panDeb_str; Mac5 rord fix me by henry
			//#107
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			smd_refinemv3_reg.smd_sfreq_diff_gain =4;
			smd_refinemv3_reg.smd_sfreq_diff_th =25;
			smd_refinemv3_reg.smd_sfreq_drop_th =80;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;
			smd_compensate_reg.smd_compensate_avg = ori_smd_compensate_reg.smd_compensate_avg;

			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_max=0xd2;
			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x40;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=gSmd_gain;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=gSmd_offset;
			di_smd_dummy_reg.smd_partialweave =0;

			di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = ori_hmc_sub_pixel_diff_thd;

			di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =ori_gst_min_sad_nolimit_en;
			di_di_smd_slow_motion_handle1.gst_gst_static_disable =ori_gst_gst_static_disable;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			di_di_smd_slow_motion_handle1.smd_outofrange_content_new = ori_smd_outofrange_content_new;
			di_di_smd_slow_motion_handle2.gst_mv_limit = ori_gst_mv_limit;
			//di_di_smd_slow_motion_handle1.smd_acc_smd_en =ori_smd_acc_smd_en;
			//di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=ori_smd_spatialfreqnomatch_off;
			im_di_weave_window_control_reg.fixedwindow1 = ORI_im_di_weave_window_control_reg.fixedwindow1;
			im_di_weave_window_control_reg.fixedwindowmode = ORI_im_di_weave_window_control_reg.fixedwindowmode;

			di_hmc_statistic1_reg.regValue = ORI_di_hmc_statistic1_reg.regValue;
			di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = ORI_di_hmc_pan_control_par_1_reg.hme_sum_max_ratio;
			FrameSobel_statistic_Reg.regValue = ORI_FrameSobel_statistic_Reg.regValue;
			di_hmc_adjustable_reg.regValue = ORI_di_hmc_adjustable_reg.regValue;
			di_hmc_adjustable2_reg.regValue= ORI_di_hmc_adjustable2_reg.regValue;
			di_hmc_adjustable3_reg.regValue= ORI_di_hmc_adjustable3_reg.regValue;
			di_hmc_adjustable4_reg.regValue= ORI_di_hmc_adjustable4_reg.regValue;




			//#139
			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_c_reg.ma_framesthc = ORI_di_ma_frame_motion_th_c_reg.ma_framesthc;
			di_ma_frame_motion_th_c_reg.ma_framehthc = ORI_di_ma_frame_motion_th_c_reg.ma_framehthc;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = ORI_di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv;

			dch1_cp_ctrl_reg.sresultweight_adjust_shift = ori_sresultweight_adjust_shift;
			dch1_cp_ctrl_reg.vc_snr_lpf_sel = ori_vc_snr_lpf_sel;
			curve_mapping_w1_2_reg.curvemapping_w1_6 = ori_curve_mapping_w1_6;
			curve_mapping_w1_2_reg.curvemapping_w1_7 = ori_curve_mapping_w1_7;
			//curve_mapping_w1_3_reg.curvemapping_w1_8 = ori_curve_mapping_w1_8;

			curve_mapping_step3_reg.curvemapping_step8=ori_curve_mapping_step8;

			//#147,148,149,150
			dch1_Spatial_Weight_Reg.cp_fixedweight1y = ori_cp_fixedweight1y;
			dch1_Spatial_Weight_Reg.cp_fixedweight2y = ori_cp_fixedweight2y;

			//#151

			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_b_reg.ma_framerlvthb = ORI_di_ma_frame_motion_th_b_reg.ma_framerlvthb;
			di_ma_frame_motion_th_b_reg.ma_framemthb = ORI_di_ma_frame_motion_th_b_reg.ma_framemthb;

			dm_dir_uzu_conf_Reg.conf_lowbnd = ori_conf_lowbnd;
			di_im_di_nintra_control.nintra_intersection_check_en =ori_di_im_di_nintra_control.nintra_intersection_check_en;
			di_im_di_nintra_control.nintra_preline_dir_check2_en = ori_di_im_di_nintra_control.nintra_preline_dir_check2_en;

			//#152
			di_hmc_adjustable_reg.hmc_mv_refine_en =ORI_di_hmc_adjustable_reg.hmc_mv_refine_en;
			di_hmc_adjustable_reg.mc_dynamic_threshold_clip_en = ORI_di_hmc_adjustable_reg.mc_dynamic_threshold_clip_en;

			//#192
			dch1_cp_ctrl_reg.cp_sresultweight = ori_cp_sresultweight;
			curve_mapping_w1_1_reg.curvemapping_w1_2=ori_curve_mapping_w1_2;
			curve_mapping_w1_1_reg.curvemapping_w1_3=ori_curve_mapping_w1_3;
			curve_mapping_w1_2_reg.curvemapping_w1_4=ori_curve_mapping_w1_4;
			curve_mapping_w1_2_reg.curvemapping_w1_5=ori_curve_mapping_w1_5;
			curve_mapping_step2_reg.curvemapping_step6=ori_curve_mapping_step6;
			curve_mapping_step3_reg.curvemapping_step7=ori_curve_mapping_step7;
			curve_mapping_step3_reg.curvemapping_step8=ori_curve_mapping_step8;
			edgesmooth_ex_ctrl3_reg.edge_upbnd=ori_edgesmoothex_edgeupbud;

			//************** INI VALE END    ***************************************************

			if(DynamicOptimizeSystem[1] ==1)
			{
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_compensate_reg.smd_compensate_teeth_th =200;
			}
			else if(DynamicOptimizeSystem[2] ==1)
			{
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_di_smd_slow_motion_handle1.gst_gst_static_disable = 1;
				di_di_smd_slow_motion_handle1.gst_min_sad_compare_diable =1;
				edgesmooth_ex_ctrl_reg.edge_en=0;
				edgesmooth_ex_ctrl_reg.t2df_en =0;
			}
			else if(DynamicOptimizeSystem[7] ==1)
			{
				edgesmooth_ex_ctrl2_reg.t2df_upbnd =60;
//				di_pan_dummy2_reg.panConti_str = 12; Mac5 rord fix me by henry
//				di_pan_dummy3_reg.panDeb_str = 80; Mac5 rord fix me by henry

			}
			else if(DynamicOptimizeSystem[12] ==1)
			{
				//drvif_color_newrtnr_sad_th(1,&Motion_Th[0]);//for sad edge th setting
				//drvif_color_newrtnr_sad_th(0,&Motion_Th[0]);//for sad nonedge th setting
				drvif_color_rtnr_y_th_isr(_CHANNEL1,&Motion_Th[0]);



				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_compensate_reg.smd_compensate_teeth_th =200;

			}
			else if((DynamicOptimizeSystem[23]==1)||(DynamicOptimizeSystem[24]==1))
			{
				init_di_smd_additionalcoeff1_reg.smd_result_en=0;

			}
			else if(DynamicOptimizeSystem[28] ==1)
			{
				di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = 255;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th1=40;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th2=40;
			}
			else if(DynamicOptimizeSystem[63] ==1)
			{
				di_di_smd_slow_motion_handle1.smd_acc_smd_en =1;
				di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=1;
        			di_di_smd_slow_motion_handle1.smd_weave_dynamic = 3;
				edgesmooth_mess_direction1_reg.mess_4direction_thd = 6;

			}
			else if(DynamicOptimizeSystem[75] ==1)
			{
//				di_pan_dummy2_reg.panConti_str = 12; Mac5 rord fix me by henry
//				di_pan_dummy3_reg.panDeb_str = 80; Mac5 rord fix me by henry

			}
			else if(DynamicOptimizeSystem[107]==1)
			{
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=225;
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				smd_refinemv3_reg.smd_sfreq_diff_gain =0;
				smd_refinemv3_reg.smd_sfreq_diff_th =0;
				smd_refinemv3_reg.smd_sfreq_drop_th =0;
				smd_compensate_reg.smd_compensate_teeth_th =5;
				smd_compensate_reg.smd_compensate_avg = 152;

				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_max=0xff;
				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x7f;

				init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=6;
				init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=0x1f;
				di_smd_dummy_reg.smd_partialweave =3;

				di_hmc_adjustable_reg.hmc_mv_refine_mor_en = 1;
        		di_hmc_adjustable2_reg.hmc_mv_refine_cur_motion_en = 0;
				di_hmc_adjustable_reg.hmc_mv_refine_y_th = 120;
				di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = 180;


				di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =1;
				di_di_smd_slow_motion_handle1.gst_gst_static_disable =1;
				di_di_smd_slow_motion_handle1.smd_weave_dynamic = 3;
				di_di_smd_slow_motion_handle1.smd_outofrange_content_new = 0;
				di_di_smd_slow_motion_handle2.gst_mv_limit = 1;
				//di_di_smd_slow_motion_handle1.smd_acc_smd_en =1;
				//di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=1;

				di_hmc_statistic1_reg.ma_hmc_lineratio = 24;
				rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);
				di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = 18;

				FrameSobel_statistic_Reg.regValue = 0xc51f4200;
				di_hmc_adjustable_reg.regValue= 0x8FFD0004;
				di_hmc_adjustable2_reg.regValue= 0x0732c014; // special HMC setting for LG#75 and LG#107, jimmy 20151203
				di_hmc_adjustable3_reg.regValue= 0x2819141e;
				di_hmc_adjustable4_reg.regValue= 0x850a0c0c;

				di_hmc_adjustable3_reg.hmc_fail_follow_ma_result_en = 1;

				 //weave window --> fix intra on LG logo!
				if(scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION)<=4)
				{
					im_di_weave_window_control_reg.fixedwindow1 = 0;
					im_di_weave_window_control_reg.fixedwindowmode = 0;
				}
				else
				{
					im_di_weave_window_control_reg.fixedwindow1 = 1;
					im_di_weave_window_control_reg.fixedwindowmode = 3;
				}
				im_di_weave_window_1_start_reg.xstart_25_13 =64 ;
				im_di_weave_window_1_start_reg.ystart_25_13=192 ;
				im_di_weave_window_1_end_reg.xend_25_13 = 112;
				im_di_weave_window_1_end_reg.yend_25_13 =214 ;


			}
			else if(DynamicOptimizeSystem[139] ==1)
			{
				di_ma_frame_motion_th_a_reg.ma_framestha = 20;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 20;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha = 7;
				di_ma_frame_motion_th_a_reg.ma_framemtha = 50;
				di_ma_frame_motion_th_b_reg.ma_framesthb = 20;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 20;
				di_ma_frame_motion_th_c_reg.ma_framesthc = 20;
				di_ma_frame_motion_th_c_reg.ma_framehthc = 20;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 0;

				dch1_cp_ctrl_reg.sresultweight_adjust_shift = 0;
				dch1_cp_ctrl_reg.vc_snr_lpf_sel = 0;
				curve_mapping_w1_2_reg.curvemapping_w1_6 = 3;
				curve_mapping_w1_2_reg.curvemapping_w1_7 = 3;
				//curve_mapping_w1_3_reg.curvemapping_w1_8 = 12;
				curve_mapping_step3_reg.curvemapping_step8=42;

			}
			else if(DynamicOptimizeSystem[147])
			{
				dch1_Spatial_Weight_Reg.cp_fixedweight1y = 1;
				dch1_Spatial_Weight_Reg.cp_fixedweight2y = 1;
			}
			else if(DynamicOptimizeSystem[151])
			{

				di_ma_frame_motion_th_a_reg.ma_framestha = 50;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 70;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha = 50;
				di_ma_frame_motion_th_a_reg.ma_framemtha = 70;
				di_ma_frame_motion_th_b_reg.ma_framesthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 70;
				di_ma_frame_motion_th_b_reg.ma_framerlvthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framemthb = 70;

				dm_dir_uzu_conf_Reg.conf_lowbnd = 63;
				di_im_di_nintra_control.nintra_intersection_check_en =0;
				di_im_di_nintra_control.nintra_preline_dir_check2_en = 0;
			}
			else if(DynamicOptimizeSystem[152]) //don't need reset value
			{
        		di_im_di_ma_others_th_RBUS di_im_di_ma_others_th_reg;
				di_hmc_me_refine_ctrl2_reg.hmc_fw_ctrl_bypass = 0;
				di_im_di_hmc_pan_control_reg.pan_me_fw_control_motion_vector_det = 0;
				// hme setting
				di_hmc_statistic1_reg.ma_hmc_lineratio = 24;
				di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = 18;
				di_hmc_adjustable2_reg.hme_x_continued_counter = 0;
				// hmc setting
				di_hmc_adjustable_reg.hmc_mv_refine_en = 0;
				FrameSobel_statistic_Reg.hmc_dynamic_threshold_en = 0;
        		di_im_di_ma_others_th_reg.ma_horicomth = 40;
				di_hmc_adjustable3_reg.hmc_fail_follow_ma_result_en = 1;

				rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_reg, di_im_di_hmc_pan_control_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);

				rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg,di_hmc_pan_control_par_1_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_ME_REFINE_CTRL_2_reg,di_hmc_me_refine_ctrl2_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg,di_hmc_adjustable_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg,di_hmc_adjustable2_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_ADJUSTABLE3_reg,di_hmc_adjustable3_reg.regValue);
				rtd_outl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg,FrameSobel_statistic_Reg.regValue);
				rtd_outl(DI_IM_DI_MA_OTHERS_TH_reg,di_im_di_ma_others_th_reg.regValue);

			}
			else if(DynamicOptimizeSystem[192])
			{
				dch1_cp_ctrl_reg.cp_sresultweight =15;
				curve_mapping_w1_1_reg.curvemapping_w1_2=8;
				curve_mapping_w1_1_reg.curvemapping_w1_3=0;
				curve_mapping_w1_2_reg.curvemapping_w1_4=0;
				curve_mapping_w1_2_reg.curvemapping_w1_5=0;
				curve_mapping_step2_reg.curvemapping_step6=14;
				curve_mapping_step3_reg.curvemapping_step7=30;
				curve_mapping_step3_reg.curvemapping_step8=62;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = 100;
			}


			//#1

			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);

			//#2
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg,di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg, edgesmooth_ex_ctrl_reg.regValue);

			//#7
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg, edgesmooth_ex_ctrl2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_2_reg, di_pan_dummy2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_3_reg, di_pan_dummy3_reg.regValue);


			//#23 #24

			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);


			//#28
			rtd_outl(DI_IM_DI_NINTRA_LOWPASS_SOURCE_reg,di_im_di_nintra_lowpass_source.regValue);
			rtd_outl(DI_IM_DI_NINTRA_SEARCH_DIR_LIMIT_reg,di_im_di_nintra_search_dir_limit.regValue);

			//#63
			// protect di 3Abit,reduce r/w time .
			di_control_reg_Prtoect_3AEnable.regValue= rtd_inl(DI_IM_DI_CONTROL_reg);
			di_control_reg.ma_3aenable = di_control_reg_Prtoect_3AEnable.ma_3aenable;
			di_control_reg.write_enable_1 = 1;
			//rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);//rord.tsao mark don't change di seeting avoid 3a/5a setting error 2016/02/19
			rtd_outl(DI_IM_DI_INTRA_TH_reg, intra_th_Reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_Mess_Direction1_reg,edgesmooth_mess_direction1_reg.regValue);

			//#75
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_2_reg, di_pan_dummy2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_3_reg, di_pan_dummy3_reg.regValue);

			//#107

			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_RefineMV3_reg, smd_refinemv3_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);

			rtd_outl(DI_DI_SMD_CandidateLimitSAD_reg, init_di_smd_candidatelimitsad_reg.regValue);
			rtd_outl(DI_DI_SMD_AdditionalCoeff2_reg, init_di_smd_additionalcoeff2_reg.regValue);
			rtd_outl(DI_DI_SMD_dummy_reg, di_smd_dummy_reg.regValue);

			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_2_reg, di_hmc_pan_control_par_2_reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle2_reg, di_di_smd_slow_motion_handle2.regValue);

			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg,di_hmc_pan_control_par_1_reg.regValue);
			rtd_outl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg,FrameSobel_statistic_Reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg, di_hmc_adjustable2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE3_reg, di_hmc_adjustable3_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE4_reg, di_hmc_adjustable4_reg.regValue);

			rtd_outl(DI_IM_DI_WEAVE_WINDOW_CONTROL_reg, im_di_weave_window_control_reg.regValue);
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_1_START_reg, im_di_weave_window_1_start_reg.regValue);
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_1_END_reg, im_di_weave_window_1_end_reg.regValue);

			//#139
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_3_reg, curve_mapping_w1_3_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step3_reg.regValue);	//LGE control


			//#147,148,149,150
			rtd_outl(NR_DCH1_Spatial_Weight_reg, dch1_Spatial_Weight_Reg.regValue);

			//#151
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);

			rtd_outl(SCALEUP_DM_DIR_UZU_Conf_reg, dm_dir_uzu_conf_Reg.regValue);
			rtd_outl(DI_IM_DI_NINTRA_CONTROL_reg,di_im_di_nintra_control.regValue);

			//#152
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);

			//#192
			//rtd_outl(NR_CURVE_MAPPING_W1_1_reg, curve_mapping_w1_1_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_2_reg, curve_mapping_step2_reg.regValue);	//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step3_reg.regValue);	//LGE control
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg,edgesmooth_ex_ctrl3_reg.regValue);

		}
		break;
		case VIP_QUALITY_HDMI_576I:
		case VIP_QUALITY_YPbPr_576I:
		{
			//************** INI VALE START    ***************************************************

			//#1
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_en=ori_smd_en;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			//#2
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_di_smd_slow_motion_handle1.gst_gst_static_disable = ori_gst_gst_static_disable;
			di_di_smd_slow_motion_handle1.gst_min_sad_compare_diable =ori_gst_min_sad_compare_diable;
			edgesmooth_ex_ctrl_reg.edge_en =ori_edgesmooth_edge_en;;
			edgesmooth_ex_ctrl_reg.t2df_en =ori_edgesmooth_t2df_en;

			//#7
			edgesmooth_ex_ctrl2_reg.t2df_upbnd =ori_edgesmooth_ex_up_bounmd;
//			di_pan_dummy2_reg.panConti_str = ORI_di_pan_dummy2_reg.panConti_str; Mac5 rord fix me by henry
//			di_pan_dummy3_reg.panDeb_str = ORI_di_pan_dummy3_reg.panDeb_str; Mac5 rord fix me by henry

			//#12
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;

			//#23 #24
			init_di_smd_additionalcoeff1_reg.smd_result_en=ori_smd_result_en;

			//#28
			di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = ori_nintra_lp_src_yclamp_th;
			di_im_di_nintra_search_dir_limit.regValue=ori_di_im_di_nintra_search_dir_limit.regValue;

			//#63
			di_di_smd_slow_motion_handle1.smd_acc_smd_en =ori_smd_acc_smd_en;
			di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=ori_smd_spatialfreqnomatch_off;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			//edgesmooth_mess_direction1_reg.mess_4direction_thd = ori_mess_4direction_thd;

			//#75
//			di_pan_dummy2_reg.panConti_str = ORI_di_pan_dummy2_reg.panConti_str; Mac5 rord fix me by henry
//			di_pan_dummy3_reg.panDeb_str = ORI_di_pan_dummy3_reg.panDeb_str; Mac5 rord fix me by henry

			//#107
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ori_smd_upperbound_sad_forjudgemv;
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;
			smd_refinemv3_reg.smd_sfreq_diff_gain =4;
			smd_refinemv3_reg.smd_sfreq_diff_th =25;
			smd_refinemv3_reg.smd_sfreq_drop_th =80;
			smd_compensate_reg.smd_compensate_teeth_th =ori_smd_compensate_reg.smd_compensate_teeth_th;
			smd_compensate_reg.smd_compensate_avg = ori_smd_compensate_reg.smd_compensate_avg;

			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_max=0xd2;
			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x40;

			init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=gSmd_gain;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=gSmd_offset;
			di_smd_dummy_reg.smd_partialweave =0;

			di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = ori_hmc_sub_pixel_diff_thd;

			di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =ori_gst_min_sad_nolimit_en;
			di_di_smd_slow_motion_handle1.gst_gst_static_disable =ori_gst_gst_static_disable;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			di_di_smd_slow_motion_handle1.smd_outofrange_content_new = ori_smd_outofrange_content_new;
			di_di_smd_slow_motion_handle2.gst_mv_limit = ori_gst_mv_limit;
			//di_di_smd_slow_motion_handle1.smd_acc_smd_en =ori_smd_acc_smd_en;
			//di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=ori_smd_spatialfreqnomatch_off;

			di_hmc_statistic1_reg.regValue = ORI_di_hmc_statistic1_reg.regValue;
			di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = ORI_di_hmc_pan_control_par_1_reg.hme_sum_max_ratio;
			FrameSobel_statistic_Reg.regValue = ORI_FrameSobel_statistic_Reg.regValue;
			di_hmc_adjustable_reg.regValue = ORI_di_hmc_adjustable_reg.regValue;
			di_hmc_adjustable2_reg.regValue= ORI_di_hmc_adjustable2_reg.regValue;
			di_hmc_adjustable3_reg.regValue= ORI_di_hmc_adjustable3_reg.regValue;
			di_hmc_adjustable4_reg.regValue= ORI_di_hmc_adjustable4_reg.regValue;



			//#139
			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_c_reg.ma_framesthc = ORI_di_ma_frame_motion_th_c_reg.ma_framesthc;
			di_ma_frame_motion_th_c_reg.ma_framehthc = ORI_di_ma_frame_motion_th_c_reg.ma_framehthc;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = ORI_di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv;

			dch1_cp_ctrl_reg.sresultweight_adjust_shift = ori_sresultweight_adjust_shift;
			dch1_cp_ctrl_reg.vc_snr_lpf_sel = ori_vc_snr_lpf_sel;
			curve_mapping_w1_2_reg.curvemapping_w1_6 = ori_curve_mapping_w1_6;
			curve_mapping_w1_2_reg.curvemapping_w1_7 = ori_curve_mapping_w1_7;
			curve_mapping_w1_3_reg.curvemapping_w1_8 = ori_curve_mapping_w1_8;
			curve_mapping_step3_reg.curvemapping_step8=ori_curve_mapping_step8;


			//#147,148,149,150
			dch1_Spatial_Weight_Reg.cp_fixedweight1y = ori_cp_fixedweight1y;
			dch1_Spatial_Weight_Reg.cp_fixedweight2y = ori_cp_fixedweight2y;

			//#151
			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_b_reg.ma_framerlvthb = ORI_di_ma_frame_motion_th_b_reg.ma_framerlvthb;
			di_ma_frame_motion_th_b_reg.ma_framemthb = ORI_di_ma_frame_motion_th_b_reg.ma_framemthb;

			dm_dir_uzu_conf_Reg.conf_lowbnd = ori_conf_lowbnd;
			di_im_di_nintra_control.nintra_intersection_check_en =ori_di_im_di_nintra_control.nintra_intersection_check_en;
			di_im_di_nintra_control.nintra_preline_dir_check2_en = ori_di_im_di_nintra_control.nintra_preline_dir_check2_en;

			//#152
			di_hmc_adjustable_reg.hmc_mv_refine_en =ORI_di_hmc_adjustable_reg.hmc_mv_refine_en;
			di_hmc_adjustable_reg.mc_dynamic_threshold_clip_en = ORI_di_hmc_adjustable_reg.mc_dynamic_threshold_clip_en;

			//#192
			dch1_cp_ctrl_reg.cp_sresultweight = ori_cp_sresultweight;
			curve_mapping_w1_1_reg.curvemapping_w1_2=ori_curve_mapping_w1_2;
			curve_mapping_w1_1_reg.curvemapping_w1_3=ori_curve_mapping_w1_3;
			curve_mapping_w1_2_reg.curvemapping_w1_4=ori_curve_mapping_w1_4;
			curve_mapping_w1_2_reg.curvemapping_w1_5=ori_curve_mapping_w1_5;
			curve_mapping_step2_reg.curvemapping_step6=ori_curve_mapping_step6;
			curve_mapping_step3_reg.curvemapping_step7=ori_curve_mapping_step7;
			curve_mapping_step3_reg.curvemapping_step8=ori_curve_mapping_step8;
			edgesmooth_ex_ctrl3_reg.edge_upbnd=ori_edgesmoothex_edgeupbud;

			//************** INI VALE END    ***************************************************

			if(DynamicOptimizeSystem[1] ==1)
			{
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_compensate_reg.smd_compensate_teeth_th =200;
			}
			else if(DynamicOptimizeSystem[2] ==1)
			{
				di_di_smd_slow_motion_handle1.gst_gst_static_disable = 1;
				di_di_smd_slow_motion_handle1.gst_min_sad_compare_diable =1;
				di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = 30;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th1=16;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th2=16;

				edgesmooth_ex_ctrl_reg.edge_en=0;
				edgesmooth_ex_ctrl_reg.t2df_en =0;
			}
			else if(DynamicOptimizeSystem[7] ==1)
			{
				edgesmooth_ex_ctrl2_reg.t2df_upbnd =60;
//				di_pan_dummy2_reg.panConti_str = 12; Mac5 rord fix me by henry
//				di_pan_dummy3_reg.panDeb_str = 80; Mac5 rord fix me by henry

			}
			else if(DynamicOptimizeSystem[12] ==1)
			{
				//drvif_color_newrtnr_sad_th(1,&Motion_Th[0]);//for sad edge th setting
				//drvif_color_newrtnr_sad_th(0,&Motion_Th[0]);//for sad nonedge th setting
				drvif_color_rtnr_y_th_isr(_CHANNEL1,&Motion_Th[0]);

				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_compensate_reg.smd_compensate_teeth_th =200;

			}
			else if((DynamicOptimizeSystem[23]==1)||(DynamicOptimizeSystem[24]==1))
			{
				init_di_smd_additionalcoeff1_reg.smd_result_en=0;

			}
			else if(DynamicOptimizeSystem[28] ==1)
			{
				di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = 30;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th1=16;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th2=16;
			}
			else if(DynamicOptimizeSystem[63] ==1)
			{
				di_di_smd_slow_motion_handle1.smd_acc_smd_en =1;
				di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=1;
        			di_di_smd_slow_motion_handle1.smd_weave_dynamic = 3;
				edgesmooth_mess_direction1_reg.mess_4direction_thd = 6;

			}
			else if(DynamicOptimizeSystem[75] ==1)
			{
//				di_pan_dummy2_reg.panConti_str = 12; Mac5 rord fix me by henry
//				di_pan_dummy3_reg.panDeb_str = 80; Mac5 rord fix me by henry
			}
			else if(DynamicOptimizeSystem[107]==1)
			{
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=125;
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;
				smd_refinemv3_reg.smd_sfreq_diff_gain =0;
				smd_refinemv3_reg.smd_sfreq_diff_th =0;
				smd_refinemv3_reg.smd_sfreq_drop_th =0;
				smd_compensate_reg.smd_compensate_teeth_th =5;
				smd_compensate_reg.smd_compensate_avg = 152;

				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_max=0xff;
				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x7f;

				init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=2;
				init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=0x1f;
				di_smd_dummy_reg.smd_partialweave =3;

				di_hmc_adjustable_reg.hmc_mv_refine_mor_en = 1;
				di_hmc_adjustable_reg.hmc_mv_refine_y_th = 120;
				di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = 180;


				di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =1;
				di_di_smd_slow_motion_handle1.gst_gst_static_disable =1;
				di_di_smd_slow_motion_handle1.smd_weave_dynamic = 0;
				di_di_smd_slow_motion_handle1.smd_outofrange_content_new=0;
				di_di_smd_slow_motion_handle2.gst_mv_limit = 1;
				//di_di_smd_slow_motion_handle1.smd_acc_smd_en =1;
				//di_di_smd_slow_motion_handle1.smd_spatialfreqnomatch_off=1;

				di_hmc_statistic1_reg.ma_hmc_lineratio = 24;
				rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);
				di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = 18;

				FrameSobel_statistic_Reg.regValue = 0xc51f4200;
				di_hmc_adjustable_reg.regValue= 0x8FFD0004;
				di_hmc_adjustable2_reg.regValue= 0x0732c014; // special HMC setting for LG#75 and LG#107, jimmy 20151203
				di_hmc_adjustable3_reg.regValue= 0x2819141e;
				di_hmc_adjustable4_reg.regValue= 0x850a0c0c;

				di_hmc_adjustable3_reg.hmc_fail_follow_ma_result_en = 1;

				//weave window --> fix intra on LG logo!
				if(scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION)<=4)
				{
					im_di_weave_window_control_reg.fixedwindow1 = 0;
					im_di_weave_window_control_reg.fixedwindowmode = 0;
				}
				else
				{
					im_di_weave_window_control_reg.fixedwindow1 = 1;
					im_di_weave_window_control_reg.fixedwindowmode = 3;
				}
				im_di_weave_window_1_start_reg.xstart_25_13 =64 ;
				im_di_weave_window_1_start_reg.ystart_25_13=229 ;
				im_di_weave_window_1_end_reg.xend_25_13 = 105;
				im_di_weave_window_1_end_reg.yend_25_13 =252 ;

			}
			else if(DynamicOptimizeSystem[139] ==1)
			{
				di_ma_frame_motion_th_a_reg.ma_framestha = 20;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 20;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha = 20;
				di_ma_frame_motion_th_a_reg.ma_framemtha = 50;
				di_ma_frame_motion_th_b_reg.ma_framesthb = 20;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 20;
				di_ma_frame_motion_th_c_reg.ma_framesthc = 20;
				di_ma_frame_motion_th_c_reg.ma_framehthc = 20;
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv = 0;

				dch1_cp_ctrl_reg.sresultweight_adjust_shift = 0;
				dch1_cp_ctrl_reg.vc_snr_lpf_sel = 0;
				curve_mapping_w1_2_reg.curvemapping_w1_6 = 0;
				curve_mapping_w1_2_reg.curvemapping_w1_7 = 0;
				curve_mapping_w1_3_reg.curvemapping_w1_8 = 7;
				curve_mapping_step3_reg.curvemapping_step8=42;

			}
			else if(DynamicOptimizeSystem[147])
			{
				dch1_Spatial_Weight_Reg.cp_fixedweight1y = 1;
				dch1_Spatial_Weight_Reg.cp_fixedweight2y = 1;
			}
			else if(DynamicOptimizeSystem[151])
			{

				di_ma_frame_motion_th_a_reg.ma_framestha = 50;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 50;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha = 50;
				di_ma_frame_motion_th_a_reg.ma_framemtha = 50;
				di_ma_frame_motion_th_b_reg.ma_framesthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framerlvthb = 50;
				di_ma_frame_motion_th_b_reg.ma_framemthb = 50;

				dm_dir_uzu_conf_Reg.conf_lowbnd = 63;
				di_im_di_nintra_control.nintra_intersection_check_en =0;
				di_im_di_nintra_control.nintra_preline_dir_check2_en = 0;
			}
			else if(DynamicOptimizeSystem[152]) //don't need reset value
			{
        		di_im_di_ma_others_th_RBUS di_im_di_ma_others_th_reg;
				di_hmc_me_refine_ctrl2_reg.hmc_fw_ctrl_bypass = 0;
				di_im_di_hmc_pan_control_reg.pan_me_fw_control_motion_vector_det = 0;
				// hme setting
				di_hmc_statistic1_reg.ma_hmc_lineratio = 24;
				di_hmc_pan_control_par_1_reg.hme_sum_max_ratio = 18;
				di_hmc_adjustable2_reg.hme_x_continued_counter = 0;
				// hmc setting
				di_hmc_adjustable_reg.hmc_mv_refine_en = 0;
				FrameSobel_statistic_Reg.hmc_dynamic_threshold_en = 0;
        		di_im_di_ma_others_th_reg.ma_horicomth = 40;
				di_hmc_adjustable3_reg.hmc_fail_follow_ma_result_en = 1;

				rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_reg, di_im_di_hmc_pan_control_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);

				rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg,di_hmc_pan_control_par_1_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_ME_REFINE_CTRL_2_reg,di_hmc_me_refine_ctrl2_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg,di_hmc_adjustable_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg,di_hmc_adjustable2_reg.regValue);
				rtd_outl(DI_IM_DI_HMC_ADJUSTABLE3_reg,di_hmc_adjustable3_reg.regValue);
				rtd_outl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg,FrameSobel_statistic_Reg.regValue);
				rtd_outl(DI_IM_DI_MA_OTHERS_TH_reg,di_im_di_ma_others_th_reg.regValue);

			}
			else if(DynamicOptimizeSystem[192])
			{
				dch1_cp_ctrl_reg.cp_sresultweight =15;
				curve_mapping_w1_1_reg.curvemapping_w1_2=8;
				curve_mapping_w1_1_reg.curvemapping_w1_3=0;
				curve_mapping_w1_2_reg.curvemapping_w1_4=0;
				curve_mapping_w1_2_reg.curvemapping_w1_5=0;
				curve_mapping_step2_reg.curvemapping_step6=14;
				curve_mapping_step3_reg.curvemapping_step7=30;
				curve_mapping_step3_reg.curvemapping_step8=62;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = 100;
			}


			//#1

			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);

			//#2
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg,di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg, edgesmooth_ex_ctrl_reg.regValue);

			//#7
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg, edgesmooth_ex_ctrl2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_2_reg, di_pan_dummy2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_3_reg, di_pan_dummy3_reg.regValue);

			//#12
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);


			//#23 #24

			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);


			//#28
			rtd_outl(DI_IM_DI_NINTRA_LOWPASS_SOURCE_reg,di_im_di_nintra_lowpass_source.regValue);
			rtd_outl(DI_IM_DI_NINTRA_SEARCH_DIR_LIMIT_reg,di_im_di_nintra_search_dir_limit.regValue);

			//#63
			// protect di 3Abit,reduce r/w time .
			di_control_reg_Prtoect_3AEnable.regValue= rtd_inl(DI_IM_DI_CONTROL_reg);
			di_control_reg.ma_3aenable = di_control_reg_Prtoect_3AEnable.ma_3aenable;// write_enable[16]

			/* henry @ mac5 161219 DI write enable bit */
			di_control_reg.write_enable_1 = 1;
			//di_control_reg.regValue = di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_1_mask;

			//rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);//rord.tsao mark don't change di seeting avoid 3a/5a setting error 2016/02/19
			rtd_outl(DI_IM_DI_INTRA_TH_reg, intra_th_Reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_Mess_Direction1_reg,edgesmooth_mess_direction1_reg.regValue);

			//#75
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_2_reg, di_pan_dummy2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_DUMMY_3_reg, di_pan_dummy3_reg.regValue);

			//#107

			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
			rtd_outl(DI_DI_SMD_RefineMV3_reg, smd_refinemv3_reg.regValue);
			rtd_outl(DI_DI_SMD_Compensate_reg, smd_compensate_reg.regValue);

			rtd_outl(DI_DI_SMD_CandidateLimitSAD_reg, init_di_smd_candidatelimitsad_reg.regValue);
			rtd_outl(DI_DI_SMD_AdditionalCoeff2_reg, init_di_smd_additionalcoeff2_reg.regValue);
			rtd_outl(DI_DI_SMD_dummy_reg, di_smd_dummy_reg.regValue);

			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_2_reg, di_hmc_pan_control_par_2_reg.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(DI_DI_SMD_Slow_Motion_handle2_reg, di_di_smd_slow_motion_handle2.regValue);

			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_1_reg,di_hmc_pan_control_par_1_reg.regValue);
			rtd_outl(DI_IM_DI_FRAMESOBEL_STATISTIC_reg,FrameSobel_statistic_Reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE2_reg, di_hmc_adjustable2_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE3_reg, di_hmc_adjustable3_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE4_reg, di_hmc_adjustable4_reg.regValue);

			//#139
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_3_reg, curve_mapping_w1_3_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step3_reg.regValue);	//LGE control

			//#147,148,149,150
			rtd_outl(NR_DCH1_Spatial_Weight_reg, dch1_Spatial_Weight_Reg.regValue);

			//#151

			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);

			rtd_outl(SCALEUP_DM_DIR_UZU_Conf_reg, dm_dir_uzu_conf_Reg.regValue);
			rtd_outl(DI_IM_DI_NINTRA_CONTROL_reg,di_im_di_nintra_control.regValue);
			//#152
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);

			//#192
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);
			//rtd_outl(NR_CURVE_MAPPING_W1_1_reg, curve_mapping_w1_1_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_3_reg, curve_mapping_w1_3_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_2_reg, curve_mapping_step2_reg.regValue);	//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step3_reg.regValue);	//LGE control
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg,edgesmooth_ex_ctrl3_reg.regValue);

		}
		break;
		case VIP_QUALITY_HDMI_1080I:
		case VIP_QUALITY_YPbPr_1080I:
		{
			//************** INI VALE START    ***************************************************

			//#14
			di_smd_control_candiate_reg.smd_en=ori_smd_en;
			smd_choosecandidate_reg.smd_reliablerange_sad_th = gSmd_weak_move;

			//#23,#24,#39
			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_smd_control_candiate_reg.smd_en=ori_smd_en;;

			//#107

			di_hmc_adjustable_reg.hmc_mv_refine_y_th = ORI_di_hmc_adjustable_reg.hmc_mv_refine_y_th;
			di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = ori_hmc_sub_pixel_diff_thd;

			di_im_di_btr_control_reg.btr_blendtemporalrecoveryen = ORI_di_im_di_btr_control_reg.btr_blendtemporalrecoveryen;

			init_di_gst_ctrl_reg.regValue = ORI_init_di_gst_ctrl_reg.regValue;
			init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x40;
			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=125;
			smd_choosecandidate_reg.smd_reliablerange_sad_th = 50;
			di_smd_refinemv2_reg.regValue = ori_di_smd_refinemv2_reg.regValue;

			init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=2;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=0x1f;

			di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =ori_gst_min_sad_nolimit_en;
			di_di_smd_slow_motion_handle1.gst_gst_static_disable =ori_gst_gst_static_disable;
			di_di_smd_slow_motion_handle1.smd_weave_dynamic = ori_smd_weave_dynamic;
			init_di_smd_additionalcoeff1_reg.smd_result_en = ori_smd_result_en;

			im_di_weave_window_control_reg.fixedwindow1 = ORI_im_di_weave_window_control_reg.fixedwindow1;
			im_di_weave_window_1_start_reg.xstart_25_13 =ORI_im_di_weave_window_1_start_reg.xstart_25_13;
			im_di_weave_window_1_start_reg.ystart_25_13=ORI_im_di_weave_window_1_start_reg.ystart_25_13;
			im_di_weave_window_1_end_reg.xend_25_13 = ORI_im_di_weave_window_1_end_reg.xend_25_13;
			im_di_weave_window_1_end_reg.yend_25_13 =ORI_im_di_weave_window_1_end_reg.yend_25_13;

			im_di_weave_window_control_reg.fixedwindow1 = 0;
			im_di_weave_window_1_start_reg.xstart_25_13 =0;
			im_di_weave_window_1_start_reg.ystart_25_13=0;
			im_di_weave_window_1_end_reg.xend_25_13 = 0;
			im_di_weave_window_1_end_reg.yend_25_13 =0;

			di_ma_frame_motion_th_a_reg.regValue = ORI_di_ma_frame_motion_th_a_reg.regValue;
			di_ma_frame_motion_th_b_reg.regValue = ORI_di_ma_frame_motion_th_b_reg.regValue;
			di_ma_frame_motion_th_c_reg.regValue = ORI_di_ma_frame_motion_th_c_reg.regValue;


			//#176

			im_di_film_sawtooth_filmframe_th_reg.regValue =ORI_im_di_film_sawtooth_filmframe_th_reg.regValue;
			film_static_sum_th_reg.regValue= ORI_film_static_sum_th_reg.regValue;
			film_motion_sum_th_reg.regValue= ORI_film_motion_sum_th_reg.regValue;



			//#178

			di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=ORI_di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv;
			smd_choosecandidate_reg.smd_reliablerange_sad_th=gSmd_weak_move;
//			di_di_smd_resurrect_ctrl.smd_mv_not_gmv_resurrect_en=ori_di_di_smd_resurrect_ctrl.smd_mv_not_gmv_resurrect_en; Mac5 remove
//			di_di_smd_resurrect_ctrl.smd_resurrect_noacc_en=ori_di_di_smd_resurrect_ctrl.smd_resurrect_noacc_en; Mac5 remove
//			di_di_smd_sampling_gmvc.smd_close2gmv_fw_en=ori_smd_close2gmv_fw_en; Mac5 remove
			init_di_smd_additionalcoeff1_reg.smd_result_en = ori_smd_result_en;


			//#182

			//#187
			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha =ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framemtha = ORI_di_ma_frame_motion_th_a_reg.ma_framemtha;

			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_b_reg.ma_framerlvthb = ORI_di_ma_frame_motion_th_b_reg.ma_framerlvthb;
			di_ma_frame_motion_th_b_reg.ma_framemthb= ORI_di_ma_frame_motion_th_b_reg.ma_framemthb;

			//#197
			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;

			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;

			//#198

			di_ma_frame_motion_th_a_reg.ma_framestha = ORI_di_ma_frame_motion_th_a_reg.ma_framestha;
			di_ma_frame_motion_th_a_reg.ma_framerlvtha = ORI_di_ma_frame_motion_th_a_reg.ma_framerlvtha;
			di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;

			di_ma_frame_motion_th_b_reg.ma_framesthb = ORI_di_ma_frame_motion_th_b_reg.ma_framesthb;
			di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
			di_ma_frame_motion_th_b_reg.ma_framerlvthb = ORI_di_ma_frame_motion_th_b_reg.ma_framerlvthb;

			di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = ori_nintra_lp_src_yclamp_th;
			di_im_di_nintra_search_dir_limit.nintra_hdiff_th1=ori_di_im_di_nintra_search_dir_limit.nintra_hdiff_th1;
			di_im_di_nintra_control.regValue=ori_di_im_di_nintra_control.regValue;

			//#Spears & Munsil ADVANCED VUDEO - EVALUATION - Chroma Zone Plate
#ifdef CONFIG_HW_SUPPORT_MEMC
			color_temp_ctrl_reg.regValue = ORI_color_temp_ctrl_reg.regValue;
#endif
			//************** INI VALE END    ***************************************************

			if(DynamicOptimizeSystem[14]==1)
			{
				di_smd_control_candiate_reg.smd_en=1;
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 200;
			}
			else if(DynamicOptimizeSystem[23]==1)
			{
				di_ma_frame_motion_th_a_reg.ma_framestha =0x02;
				di_smd_control_candiate_reg.smd_en=0;

			}
			else if(DynamicOptimizeSystem[24]==1)
			{
				di_ma_frame_motion_th_a_reg.ma_framestha =0x02;
				di_smd_control_candiate_reg.smd_en=0;


			}
			else if(DynamicOptimizeSystem[39]==1)
			{
				di_ma_frame_motion_th_a_reg.ma_framestha =0x02;
				di_smd_control_candiate_reg.smd_en=0;


			}
			else if(DynamicOptimizeSystem[107]==1)
			{
				init_di_gst_ctrl_reg.gst_fmv2weave_p =15;
				init_di_gst_ctrl_reg.gst_fmv2weave_n =15;
				init_di_smd_candidatelimitsad_reg.smd_gmv_sad_th=0x7f;

				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=40;
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 120;

				init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=7;
				init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=0x1f;

				di_smd_refinemv2_reg.smd_mvs_hchanged_en =1;
				di_smd_refinemv2_reg.smd_mvs_vchanged_en =1;

				di_di_smd_slow_motion_handle1.gst_min_sad_nolimit_en =1;
				di_di_smd_slow_motion_handle1.gst_gst_static_disable =1;
				di_di_smd_slow_motion_handle1.smd_weave_dynamic = 3;
				init_di_smd_additionalcoeff1_reg.smd_result_en =1;

				di_hmc_adjustable_reg.hmc_mv_refine_y_th = 150;
				di_hmc_pan_control_par_2_reg.hmc_sub_pixel_diff_thd = 150;
				di_im_di_btr_control_reg.btr_blendtemporalrecoveryen = 0;
				di_hmc_statistic1_reg.ma_hmc_lineratio =di_hmc_statistic1_reg.ma_hmc_lineratio+12;
				if(di_hmc_statistic1_reg.ma_hmc_lineratio>12)
					di_hmc_statistic1_reg.ma_hmc_lineratio=12;
				rtd_outl(DI_IM_DI_HMC_STATISTIC1_reg, di_hmc_statistic1_reg.regValue);

			 //weave window --> fix intra on LG logo!
				if(scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION)<=3)
				{
					im_di_weave_window_control_reg.fixedwindow1 = 0;
					im_di_weave_window_control_reg.fixedwindowmode = 0;
				}
				else
				{
				im_di_weave_window_control_reg.fixedwindow1 = 1;
					im_di_weave_window_control_reg.fixedwindowmode = 3;
				}
				im_di_weave_window_1_start_reg.xstart_25_13 =140 ;
				im_di_weave_window_1_start_reg.ystart_25_13=431 ;
				im_di_weave_window_1_end_reg.xend_25_13 = 250;
				im_di_weave_window_1_end_reg.yend_25_13 =493 ;

			}
			else if(DynamicOptimizeSystem[176] ==1) // hqv flower 22 film
			{
				im_di_film_sawtooth_filmframe_th_reg.film22_sawtooththl=10;
				im_di_film_sawtooth_filmframe_th_reg.film_sawtooththl =10;
				im_di_film_sawtooth_filmframe_th_reg.film_frmotionthl =10;
				film_static_sum_th_reg.film22_fistaticsthl =10;
				film_motion_sum_th_reg.film22_fieldmotionsumthl =10;
				film_motion_sum_th_reg.film22_debounce_fieldnum =1;

			}
			else if( (DynamicOptimizeSystem[182]==1) || (DynamicOptimizeSystem[183]==1) || (DynamicOptimizeSystem[184]==1) || (DynamicOptimizeSystem[185]==1) || (DynamicOptimizeSystem[186]==1) )
			{
	 			ich1_MPEGNR2_reg.regValue = rtd_inl(MPEGNR_ICH1_MPEGNR2_reg);
				ich1_MPEGNR2_reg.cp_mpegenable_x=0;
				scaler_rtd_outl(MPEGNR_ICH1_MPEGNR2_reg, ich1_MPEGNR2_reg.regValue);
 			}
			else if(DynamicOptimizeSystem[187] ==1) // qtec Makilo file #59
			{
				di_ma_frame_motion_th_a_reg.ma_framestha = 30;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 30;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha =30;
				di_ma_frame_motion_th_a_reg.ma_framemtha=30;

				di_ma_frame_motion_th_b_reg.ma_framesthb = 30;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 30;
				di_ma_frame_motion_th_b_reg.ma_framerlvthb =30;
				di_ma_frame_motion_th_b_reg.ma_framemthb=30;

 			}
#if 0		// Qtec build vertical line dot noise issue. (pattern in/out dot noise)
			else if(DynamicOptimizeSystem[197] ==1) //qtec build (streets)
			{
				di_ma_frame_motion_th_a_reg.ma_framestha = 20;
				di_ma_frame_motion_th_b_reg.ma_framesthb = 20;

				di_ma_frame_motion_th_a_reg.ma_framehtha = 30;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 30;
 			}
#endif
			else if(DynamicOptimizeSystem[198] ==1) //qtec building
			{
				di_ma_frame_motion_th_a_reg.ma_framestha = 1;
				di_ma_frame_motion_th_a_reg.ma_framerlvtha =1;
				di_ma_frame_motion_th_a_reg.ma_framehtha = 1;

				di_ma_frame_motion_th_b_reg.ma_framesthb = 1;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 1;
				di_ma_frame_motion_th_b_reg.ma_framerlvthb =1;

				di_im_di_nintra_lowpass_source.nintra_lp_src_yclamp_th = 0;
				di_im_di_nintra_search_dir_limit.nintra_hdiff_th1=3;
				di_im_di_nintra_control.nintra_min_second_dir_check2_en=0;
				di_im_di_nintra_control.nintra_min_second_dir_check_en =0;

 			}
#ifdef CONFIG_HW_SUPPORT_MEMC
			else if(SandM_Chroma_Zone_Plate == 1)
			{
				color_temp_ctrl_reg.temporal_enable = 0;
			}
#endif
			di_im_new_mcnr_control4_RBUS di_im_new_mcnr_control4;
			di_im_new_mcnr_pan_condition_RBUS di_im_new_mcnr_pan_condition;

			di_im_new_mcnr_pan_condition.regValue = rtd_inl(DI_IM_NEW_MCNR_PAN_CONDITION_reg);
			di_im_new_mcnr_control4.regValue = rtd_inl(DI_IM_NEW_MCNR_CONTROL4_reg);

			if(scalerVIP_DI_MiddleWare_MCNR_Get_V_Pan_Flag()==1&&sat_ratio_mean_value<50) //tokoy night street
			{
				di_smd_control_candiate_reg.smd_upperbound_sad_forjudgemv=170;
				smd_choosecandidate_reg.smd_reliablerange_sad_th=0;
//				di_di_smd_resurrect_ctrl.smd_mv_not_gmv_resurrect_en=1; Mac5 remove
//				di_di_smd_resurrect_ctrl.smd_resurrect_noacc_en=1; Mac5 remove
//				di_di_smd_sampling_gmvc.smd_close2gmv_fw_en=1; Mac5 remove

				init_di_smd_additionalcoeff1_reg.smd_result_en=1;
//				di_di_smd_waterflag_ctr3.smd_fw_gmvy= 5;//-(di_im_new_mcnr_control4.n_mcnr_v_pan_mv-6)+3; Mac5 remove
//				di_di_smd_hardwarepan_modify1.smd_fw_gmvx=-(di_im_new_mcnr_pan_condition.h_pan_mv_value-15)+3; Mac5 remove
			}
			else
			{
				init_di_smd_additionalcoeff1_reg.smd_result_en=ori_smd_result_en;
			}

			if(soft_move==1)
				soft_move_cnt++;
			else
				soft_move_cnt--;

			if (soft_move_cnt>80)
				soft_move_cnt=80;
			if (soft_move_cnt<0)
				soft_move_cnt=0;


			if((soft_move==1)&&soft_move_cnt>soft_move_cnt_th)
			{
				soft_move_cnt_th =45;

				edgesmooth_ex_ctrl2_reg.t2df_stepbit=3;
				edgesmooth_ex_ctrl2_reg.t2df_upbnd =40 ;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = 30;

			}
			else
			{
				soft_move_cnt_th =60 ;
				edgesmooth_ex_ctrl2_reg.t2df_stepbit=ori_edgesmooth_top2diff_step_bit;
				edgesmooth_ex_ctrl2_reg.t2df_upbnd =ori_edgesmooth_ex_up_bounmd;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = ori_edgesmoothex_edgeupbud;

			}

			//rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg,edgesmooth_ex_ctrl2_reg.regValue);
			//rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg,edgesmooth_ex_ctrl3_reg.regValue);



			//ROSPrintf("\n sssss %d \n ",scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN_SPECIAL_CASE));
			//#14
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);

			//#23
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);


			//#24
			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);

			//ROSPrintf("\n ddd %d \n",im_di_weave_window_control_reg.regValue);
			//#107
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_CONTROL_reg, im_di_weave_window_control_reg.regValue);
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_1_START_reg, im_di_weave_window_1_start_reg.regValue);
			rtd_outl(DI_IM_DI_WEAVE_WINDOW_1_END_reg, im_di_weave_window_1_end_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_ADJUSTABLE_reg, di_hmc_adjustable_reg.regValue);
			rtd_outl(DI_IM_DI_HMC_PAN_CONTROL_PAR_2_reg, di_hmc_pan_control_par_2_reg.regValue);

			rtd_outl(DI_DI_GST_Ctrl_reg,init_di_gst_ctrl_reg.regValue);
			rtd_outl(DI_DI_SMD_CandidateLimitSAD_reg, init_di_smd_candidatelimitsad_reg.regValue);
#ifdef CONFIG_HW_SUPPORT_MEMC
			rtd_outl(MEMC_MUX_MEMC_MUX_DI_CTRL_reg, color_temp_ctrl_reg.regValue);
#endif
			rtd_outl(DI_DI_SMD_AdditionalCoeff2_reg, init_di_smd_additionalcoeff2_reg.regValue);

			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);

			rtd_outl(DI_DI_SMD_Slow_Motion_handle1_reg, di_di_smd_slow_motion_handle1.regValue);
			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);
			//rtd_outl(DI_DI_SMD_SLOW_MOTION_HANDLE2_reg, di_di_smd_slow_motion_handle2.regValue);

			rtd_outl(DI_DI_SMD_RefineMV2_reg, di_smd_refinemv2_reg.regValue);




			rtd_outl(DI_IM_DI_BTR_CONTROL_reg, di_im_di_btr_control_reg.regValue);

			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);


			//#173
			di_im_di_film_mask_detection_RBUS film_mask_detection_reg;
			film_mask_detection_reg.regValue = rtd_inl(DI_IM_DI_FILM_MASK_DETECTION_reg);

			if(DynamicOptimizeSystem[173]==1)
			{
				film_mask_detection_reg.film_mask_en = 0;
			}
			else
			{
				film_mask_detection_reg.film_mask_en = 1;
			}

			rtd_outl(DI_IM_DI_FILM_MASK_DETECTION_reg, film_mask_detection_reg.regValue);





			//#176


			rtd_outl(DI_IM_DI_FILM_SAWTOOTH_FILMFRAME_TH_reg, im_di_film_sawtooth_filmframe_th_reg.regValue);
			rtd_outl(DI_IM_DI_FILM_STATIC_SUM_TH_reg, film_static_sum_th_reg.regValue);
			rtd_outl(DI_IM_DI_FILM_MOTION_SUM_TH_reg, film_motion_sum_th_reg.regValue);

			//#178





			rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);
			rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
//			rtd_outl(DI_DI_SMD_Resurrect_Ctrl_reg, di_di_smd_resurrect_ctrl.regValue); Mac5 remove
			rtd_outl(DI_DI_SMD_Sampling_GMVc_reg, di_di_smd_sampling_gmvc.regValue);

			rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);

			rtd_outl(DI_DI_SMD_WaterFlag_Ctr3_reg, di_di_smd_waterflag_ctr3.regValue);

			rtd_outl(DI_DI_SMD_HardwarePan_Modify1_reg, di_di_smd_hardwarepan_modify1.regValue);


			//#187
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);

			//#197
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);

			//#198
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			rtd_outl(DI_IM_DI_NINTRA_LOWPASS_SOURCE_reg,di_im_di_nintra_lowpass_source.regValue);
			rtd_outl(DI_IM_DI_NINTRA_SEARCH_DIR_LIMIT_reg,di_im_di_nintra_search_dir_limit.regValue);
			rtd_outl(DI_IM_DI_NINTRA_CONTROL_reg,di_im_di_nintra_control.regValue);

			di_im_new_mcnr_pan_condition.regValue = rtd_inl(DI_IM_NEW_MCNR_PAN_CONDITION_reg);

			//Pan Case
			if(scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN_SPECIAL_CASE)< 15)
			{
				if(DynamicOptimizeSystem[107]==1)
				{
					di_ma_frame_motion_th_a_reg.regValue = 0x12270033;//0x2c272e3a;
					di_ma_frame_motion_th_b_reg.regValue = 0x60560a4b;//0x54565060;
					di_ma_frame_motion_th_c_reg.regValue = 0x76781462;//0x7678787d;

				}
				else if(DI_Video_Broken==1)
				{
					di_ma_frame_motion_th_a_reg.regValue = 0x05040a05;//0x2c272e3a;
					di_ma_frame_motion_th_b_reg.regValue = 0x180a0c14;//0x54565060;
					di_ma_frame_motion_th_c_reg.regValue = 0x32141018;//0x7678787d;
				}
				else if(DI_Res_Pat_pan_65ppf == 1)
				{
					di_ma_frame_motion_th_a_reg.ma_framerlvtha =0x0;
				}
				else
				{
					/*rock_rau 20150922 Q-tek monoscope pan flicker issue(original setting)*/
					di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
					di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
					di_ma_frame_motion_th_c_reg.ma_framehthc = ORI_di_ma_frame_motion_th_c_reg.ma_framehthc;

				}
			}
			else if((scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN_SPECIAL_CASE) < 30)&&
				(di_im_new_mcnr_pan_condition.h_pan_mv_value==0))
			{
				di_ma_frame_motion_th_a_reg.ma_framehtha = 0x0a;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 0x12;
				di_ma_frame_motion_th_c_reg.ma_framehthc = 0x16;
			}
			else if ((scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN_SPECIAL_CASE) > 30)&&
				(di_im_new_mcnr_pan_condition.h_pan_mv_value==0))
			{
				di_ma_frame_motion_th_a_reg.ma_framehtha = 0x14;
				di_ma_frame_motion_th_b_reg.ma_framehthb = 0x16;
				di_ma_frame_motion_th_c_reg.ma_framehthc = 0x18;
			}

			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);

		}
		break;
		case VIP_QUALITY_HDMI_1080P:
		case VIP_QUALITY_YPbPr_1080P:
		{
#ifdef CONFIG_HW_SUPPORT_MEMC
			//#Spears & Munsil ADVANCED VUDEO - EVALUATION - Chroma Zone Plate
			color_temp_ctrl_reg.regValue = ORI_color_temp_ctrl_reg.regValue;


			if(SandM_Chroma_Zone_Plate == 1)
			{
				color_temp_ctrl_reg.temporal_enable = 0;
			}

			rtd_outl(MEMC_MUX_MEMC_MUX_DI_CTRL_reg, color_temp_ctrl_reg.regValue);
#endif
		}
		break;
		case VIP_QUALITY_TV_SECAN:
		{

			if(LGPTFatoryMultiC34 == 1)
			{
				postp_secam_fix_ctrl_reg.regValue = 0x4000ff0c;
				postp_secam_fix_y_detect0_reg.regValue = 0xbf01a4a4;
				postp_secam_fix_y_detect1_reg.regValue = 0x3f3f0800;

				/*For color bar H-line flick*/
				tnrxc_mkii_ctrl_reg.regValue = 0x14b40401;
			}
			else
			{
				postp_secam_fix_ctrl_reg.regValue = ORI_postp_secam_fix_ctrl_reg.regValue;
				postp_secam_fix_y_detect0_reg.regValue = ORI_postp_secam_fix_y_detect0_reg.regValue;
				postp_secam_fix_y_detect1_reg.regValue = ORI_postp_secam_fix_y_detect1_reg.regValue;

				/*For color bar H-line flick*/
				tnrxc_mkii_ctrl_reg.regValue = ORI_tnrxc_mkii_ctrl_reg.regValue;
			}
			rtd_outl(DI_TNRXC_MkII_CTRL_reg, tnrxc_mkii_ctrl_reg.regValue);
#if 0
			VDPQ_rtd_outl(VDPQ_POSTP_SECAM_FIX_CTRL_reg, postp_secam_fix_ctrl_reg.regValue);
			VDPQ_rtd_outl(VDPQ_POSTP_SECAM_FIX_Y_DETECT0_reg, postp_secam_fix_y_detect0_reg.regValue);
			VDPQ_rtd_outl(VDPQ_POSTP_SECAM_FIX_Y_DETECT1_reg, postp_secam_fix_y_detect1_reg.regValue);
#endif
		}
		break;
		case VIP_QUALITY_TV_PAL:
		{
			LGTVPALBGE52 = 1;//[KTASKWBS-3528] fix LGE channel E-52 Shake issue.
			// fix enable tnr XC (original only LGTVPALBGE52 pattern enable)

			if( LGTVPALBGE52 == 1 )
			{
				tnrxc_mkii_ctrl_reg.regValue = 0x14b40401;
			}
			else
			{
				tnrxc_mkii_ctrl_reg.regValue = ORI_tnrxc_mkii_ctrl_reg.regValue;
			}
			rtd_outl(DI_TNRXC_MkII_CTRL_reg, tnrxc_mkii_ctrl_reg.regValue);
		}
		break;
		case VIP_QUALITY_HDMI_480P:
		case VIP_QUALITY_HDMI_576P:
		{

			//************** INI VALE START    ***************************************************

			//#147,148,149,150
			dch1_Spatial_Weight_Reg.cp_fixedweight1y = ori_cp_fixedweight1y;
			dch1_Spatial_Weight_Reg.cp_fixedweight2y = ori_cp_fixedweight2y;

			//#192
			dch1_cp_ctrl_reg.cp_sresultweight = ori_cp_sresultweight;
			curve_mapping_w1_1_reg.curvemapping_w1_2=ori_curve_mapping_w1_2;
			curve_mapping_w1_1_reg.curvemapping_w1_3=ori_curve_mapping_w1_3;
			curve_mapping_w1_2_reg.curvemapping_w1_4=ori_curve_mapping_w1_4;
			curve_mapping_w1_2_reg.curvemapping_w1_5=ori_curve_mapping_w1_5;
			curve_mapping_step2_reg.curvemapping_step6=ori_curve_mapping_step6;
			curve_mapping_step3_reg.curvemapping_step7=ori_curve_mapping_step7;
			curve_mapping_step3_reg.curvemapping_step8=ori_curve_mapping_step8;
			edgesmooth_ex_ctrl3_reg.edge_upbnd=ori_edgesmoothex_edgeupbud;

			//************** INI VALE END    ***************************************************

			if(DynamicOptimizeSystem[147] ==1)
			{
				dch1_Spatial_Weight_Reg.cp_fixedweight1y = 1;
				dch1_Spatial_Weight_Reg.cp_fixedweight2y = 1;
 			}
			else if(DynamicOptimizeSystem[192])
			{
				dch1_cp_ctrl_reg.cp_sresultweight =15;
				curve_mapping_w1_1_reg.curvemapping_w1_2=8;
				curve_mapping_w1_1_reg.curvemapping_w1_3=0;
				curve_mapping_w1_2_reg.curvemapping_w1_4=0;
				curve_mapping_w1_2_reg.curvemapping_w1_5=0;
				curve_mapping_step2_reg.curvemapping_step6=14;
				curve_mapping_step3_reg.curvemapping_step7=30;
				curve_mapping_step3_reg.curvemapping_step8=62;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = 100;
			}

			//#147,148,149,150
			rtd_outl(NR_DCH1_Spatial_Weight_reg, dch1_Spatial_Weight_Reg.regValue);

			//#192
			rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_cp_ctrl_reg.regValue);
			//rtd_outl(NR_CURVE_MAPPING_W1_1_reg, curve_mapping_w1_1_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);		//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_2_reg, curve_mapping_step2_reg.regValue);	//LGE control
			//rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step3_reg.regValue);	//LGE control
			rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg,edgesmooth_ex_ctrl3_reg.regValue);

		}
		break;
		case VIP_QUALITY_DTV_480I:
		case VIP_QUALITY_DTV_576I:
		case VIP_QUALITY_DTV_480P:
		case VIP_QUALITY_DTV_576P:
		case VIP_QUALITY_DTV_720P:
		{
			di_smd_control_candiate_reg.regValue = rtd_inl(DI_DI_SMD_Control_CandidateList_reg);
			if(CITestPatch[0] == 1)
			{
				di_ma_frame_motion_th_a_reg.regValue = 0;
				di_ma_frame_motion_th_b_reg.regValue = 0;
				di_ma_frame_motion_th_c_reg.regValue = 0;
				di_smd_control_candiate_reg.smd_en=0;
				rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
				rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
				rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);
				rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);

			}
			else
			{
				di_ma_frame_motion_th_a_reg.regValue = ORI_di_ma_frame_motion_th_a_reg.regValue;
				di_ma_frame_motion_th_b_reg.regValue = ORI_di_ma_frame_motion_th_b_reg.regValue;
				di_ma_frame_motion_th_c_reg.regValue = ORI_di_ma_frame_motion_th_c_reg.regValue;
				di_smd_control_candiate_reg.smd_en=ori_smd_en;
				rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
				rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
				rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);
				rtd_outl(DI_DI_SMD_Control_CandidateList_reg, di_smd_control_candiate_reg.regValue);

			}


			//static unsigned char ori_film_status = 0;
			//static unsigned char ori_film_sawtooth_choose = 0;
			//ROSPrintf("\n DTV_SD_p2i =%d \n ",DTV_SD_p2i);
#ifdef CONFIG_RTK_KDEV_VGIP_INTERRUPT
			unsigned char DTV_SD_p2i = RPC_SmartPic_clue->VCPU_setting_info.VCPU_DTV_SD_p2i;
#else
			extern unsigned char DTV_SD_p2i;
#endif
			di_im_di_film_sawtooth_filmframe_th_RBUS film_sawtooth_filmframe_th_reg;
#ifdef CONFIG_HW_SUPPORT_MEMC

			if(((rtd_inl(0xb809d620)>>13)&0x7f)!=0) //this is for dtv patch
			{
				di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
				film_sawtooth_filmframe_th_reg.regValue = rtd_inl(DI_IM_DI_FILM_SAWTOOTH_FILMFRAME_TH_reg);

				if((DTV_SD_p2i ==1)&&((set_p2i_value==0)||di_control_reg.film_enable!=28))
				{
					//ROSPrintf("\n DTV_SD_p2i 1 =%d \n ",DTV_SD_p2i);


					set_p2i_value =1;
					//ori_film_status = di_control_reg.film_enable;
					//ori_film_sawtooth_choose = di_control_reg.film_sawtooth_choose;

					di_control_reg.film_enable = 28;// write_enable[16]

					/* henry @ mac5 161219 DI write enable bit */
					di_control_reg.write_enable_5 = 1;
					//di_control_reg.regValue = di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_5_mask;

					di_control_reg.film_sawtooth_choose = 3;
					film_sawtooth_filmframe_th_reg.film_frmotionthl = 2;

					rtd_outl(DI_IM_DI_CONTROL_reg,di_control_reg.regValue);
					rtd_outl(DI_IM_DI_FILM_SAWTOOTH_FILMFRAME_TH_reg,film_sawtooth_filmframe_th_reg.regValue);
				}
				else if ((DTV_SD_p2i ==0)&&(set_p2i_value==1))
				{

					//ROSPrintf("\n DTV_SD_p2i 2 =%d \n ",DTV_SD_p2i);
					//set_value =0;

					//di_control_reg.film_enable = ori_film_status ;
					//di_control_reg.film_sawtooth_choose= ori_film_sawtooth_choose;

					//rtd_outl(DI_IM_DI_CONTROL_reg,di_control_reg.regValue);

				}


				/*else if ((DTV_SD_p2i ==0)&&(set_value==1))
				{
					set_value =0;
					di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
					di_control_reg.film_enable = ori_film_status ;
					di_control_reg.film_sawtooth_choose= ori_film_sawtooth_choose;
					rtd_outl(DI_IM_DI_CONTROL_reg,di_control_reg.regValue);

				}*/

			}
#endif


		}
		break;
		case VIP_QUALITY_DTV_1080I:
		{

			if(soft_move==1)
				soft_move_cnt++;
			else
				soft_move_cnt--;

			if (soft_move_cnt>80)
				soft_move_cnt=80;
			if (soft_move_cnt<0)
				soft_move_cnt=0;


			if((soft_move==1)&&soft_move_cnt>soft_move_cnt_th)
			{
				soft_move_cnt_th =45;

				edgesmooth_ex_ctrl2_reg.t2df_stepbit=3;
				edgesmooth_ex_ctrl2_reg.t2df_upbnd =40 ;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = 30;

			}
			else
			{
				soft_move_cnt_th =60 ;
				edgesmooth_ex_ctrl2_reg.t2df_stepbit=ori_edgesmooth_top2diff_step_bit;
				edgesmooth_ex_ctrl2_reg.t2df_upbnd =ori_edgesmooth_ex_up_bounmd;
				edgesmooth_ex_ctrl3_reg.edge_upbnd = ori_edgesmoothex_edgeupbud;

			}

			//rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg,edgesmooth_ex_ctrl2_reg.regValue);
			//rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg,edgesmooth_ex_ctrl3_reg.regValue);



			if(DI_Video_Broken==1)
			{
				di_ma_frame_motion_th_a_reg.regValue = 0x05040a05;//0x2c272e3a;
				di_ma_frame_motion_th_b_reg.regValue = 0x180a0c14;//0x54565060;
				di_ma_frame_motion_th_c_reg.regValue = 0x32141018;//0x7678787d;

			}
			else
			{

				di_ma_frame_motion_th_a_reg.ma_framehtha = ORI_di_ma_frame_motion_th_a_reg.ma_framehtha;
				di_ma_frame_motion_th_b_reg.ma_framehthb = ORI_di_ma_frame_motion_th_b_reg.ma_framehthb;
				di_ma_frame_motion_th_c_reg.ma_framehthc = ORI_di_ma_frame_motion_th_c_reg.ma_framehthc;


			}

			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_A_reg, di_ma_frame_motion_th_a_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_B_reg, di_ma_frame_motion_th_b_reg.regValue);
			rtd_outl(DI_IM_DI_MA_FRAME_MOTION_TH_C_reg, di_ma_frame_motion_th_c_reg.regValue);


		}


		break;
		case VIP_QUALITY_DTV_1080P:
		{
			static di_im_di_rtnr_c_th0_th3_RBUS di_im_di_rtnr_c_th0_th3_RBUS_reg_save;
			di_im_di_rtnr_c_th0_th3_RBUS di_im_di_rtnr_c_th0_th3_RBUS_reg;
			di_im_di_rtnr_c_th0_th3_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_C_TH0_TH3_reg);

			static di_im_di_rtnr_c_th4_th6_RBUS di_im_di_rtnr_c_th4_th6_RBUS_reg_save;
			di_im_di_rtnr_c_th4_th6_RBUS di_im_di_rtnr_c_th4_th6_RBUS_reg;
			di_im_di_rtnr_c_th4_th6_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_C_TH4_TH6_reg);

			if (LGBirdCRTNRPatchTrigger) {
				if (LGBirdCRTNRPatch) {
					di_im_di_rtnr_c_th0_th3_RBUS_reg_save.regValue = di_im_di_rtnr_c_th0_th3_RBUS_reg.regValue;
					di_im_di_rtnr_c_th4_th6_RBUS_reg_save.regValue = di_im_di_rtnr_c_th4_th6_RBUS_reg.regValue;
					di_im_di_rtnr_c_th0_th3_RBUS_reg.regValue = 0;
					di_im_di_rtnr_c_th4_th6_RBUS_reg.regValue = 0;
				} else {
					di_im_di_rtnr_c_th0_th3_RBUS_reg.regValue = di_im_di_rtnr_c_th0_th3_RBUS_reg_save.regValue;
					di_im_di_rtnr_c_th4_th6_RBUS_reg.regValue = di_im_di_rtnr_c_th4_th6_RBUS_reg_save.regValue;
				}
				rtd_outl(DI_IM_DI_RTNR_C_TH0_TH3_reg, di_im_di_rtnr_c_th0_th3_RBUS_reg.regValue);
				rtd_outl(DI_IM_DI_RTNR_C_TH4_TH6_reg, di_im_di_rtnr_c_th4_th6_RBUS_reg.regValue);
			} else if (!LGBirdCRTNRPatch) {
				di_im_di_rtnr_c_th0_th3_RBUS_reg_save.regValue = di_im_di_rtnr_c_th0_th3_RBUS_reg.regValue;
				di_im_di_rtnr_c_th4_th6_RBUS_reg_save.regValue = di_im_di_rtnr_c_th4_th6_RBUS_reg.regValue;
			}

		}
		break;


	}


// new structure end


}

/*#endif*/

void scalerVIP_INT32_Copy(int * pwTemp ,int nSize,int * pwCopyTemp)
{
	int i;
	if (pwTemp) {
		for (i = 0; i < (nSize); i++)
			pwCopyTemp[i] = pwTemp[i];
	}
}

#ifdef ISR_ICM_ADJUST_FUNCTIOM_ENABLE
unsigned char scalerVIP_icm_global_adjust(int g_dhue_cur, int g_dsatbysat_cur[SATSEGMAX], int g_ditnbyitn_cur[ITNSEGMAX])
{
    int k, timeout;
	int h, si;
	int h_sta, h_end, si_sta, si_end;

	COLORELEM_ISR ICM_TAB[ITNSEGMAX][SATSEGMAX][HUESEGMAX];

    color_icm_dm_icm_3d_tab_sram_ctrl_RBUS        dm_icm_3d_tab_sram_ctrl_reg;
	color_icm_dm_icm_3d_tab_write_hsi_00_RBUS     dm_icm_3d_tab_write_hsi_00_reg;
	color_icm_dm_icm_3d_tab_write_hsi_01_RBUS     dm_icm_3d_tab_write_hsi_01_reg;
	color_icm_dm_icm_3d_tab_write_hsi_10_RBUS     dm_icm_3d_tab_write_hsi_10_reg;
	color_icm_dm_icm_3d_tab_write_hsi_11_RBUS     dm_icm_3d_tab_write_hsi_11_reg;
	color_icm_dm_icm_3d_tab_write_hsi_20_RBUS     dm_icm_3d_tab_write_hsi_20_reg;
	color_icm_dm_icm_3d_tab_write_hsi_21_RBUS     dm_icm_3d_tab_write_hsi_21_reg;
	color_icm_dm_icm_3d_tab_write_hsi_30_RBUS     dm_icm_3d_tab_write_hsi_30_reg;
	color_icm_dm_icm_3d_tab_write_hsi_31_RBUS     dm_icm_3d_tab_write_hsi_31_reg;
	color_icm_dm_icm_3d_tab_write_hsi_40_RBUS     dm_icm_3d_tab_write_hsi_40_reg;
	color_icm_dm_icm_3d_tab_write_hsi_41_RBUS     dm_icm_3d_tab_write_hsi_41_reg;
	color_icm_dm_icm_3d_tab_write_hsi_50_RBUS     dm_icm_3d_tab_write_hsi_50_reg;
	color_icm_dm_icm_3d_tab_write_hsi_51_RBUS     dm_icm_3d_tab_write_hsi_51_reg;
	color_icm_dm_icm_3d_tab_write_hsi_60_RBUS     dm_icm_3d_tab_write_hsi_60_reg;
	color_icm_dm_icm_3d_tab_write_hsi_61_RBUS     dm_icm_3d_tab_write_hsi_61_reg;
	color_icm_dm_icm_3d_tab_write_hsi_70_RBUS     dm_icm_3d_tab_write_hsi_70_reg;
	color_icm_dm_icm_3d_tab_write_hsi_71_RBUS     dm_icm_3d_tab_write_hsi_71_reg;
	color_icm_dm_icm_3d_tab_write_hsi_80_RBUS     dm_icm_3d_tab_write_hsi_80_reg;
	color_icm_dm_icm_3d_tab_write_hsi_81_RBUS     dm_icm_3d_tab_write_hsi_81_reg;
	color_icm_dm_icm_3d_tab_write_hsi_90_RBUS     dm_icm_3d_tab_write_hsi_90_reg;
	color_icm_dm_icm_3d_tab_write_hsi_91_RBUS     dm_icm_3d_tab_write_hsi_91_reg;
	color_icm_dm_icm_3d_tab_write_hsi_a0_RBUS     dm_icm_3d_tab_write_hsi_a0_reg;
	color_icm_dm_icm_3d_tab_write_hsi_a1_RBUS     dm_icm_3d_tab_write_hsi_a1_reg;
	color_icm_dm_icm_3d_tab_write_hsi_b0_RBUS     dm_icm_3d_tab_write_hsi_b0_reg;
	color_icm_dm_icm_3d_tab_write_hsi_b1_RBUS     dm_icm_3d_tab_write_hsi_b1_reg;

	color_icm_dm_icm_3d_tab_read_hsi_00_RBUS      dm_icm_3d_tab_read_hsi_00_reg;
	color_icm_dm_icm_3d_tab_read_hsi_01_RBUS      dm_icm_3d_tab_read_hsi_01_reg;
	color_icm_dm_icm_3d_tab_read_hsi_10_RBUS      dm_icm_3d_tab_read_hsi_10_reg;
	color_icm_dm_icm_3d_tab_read_hsi_11_RBUS      dm_icm_3d_tab_read_hsi_11_reg;
	color_icm_dm_icm_3d_tab_read_hsi_20_RBUS      dm_icm_3d_tab_read_hsi_20_reg;
	color_icm_dm_icm_3d_tab_read_hsi_21_RBUS      dm_icm_3d_tab_read_hsi_21_reg;
	color_icm_dm_icm_3d_tab_read_hsi_30_RBUS      dm_icm_3d_tab_read_hsi_30_reg;
	color_icm_dm_icm_3d_tab_read_hsi_31_RBUS      dm_icm_3d_tab_read_hsi_31_reg;
	color_icm_dm_icm_3d_tab_read_hsi_40_RBUS      dm_icm_3d_tab_read_hsi_40_reg;
	color_icm_dm_icm_3d_tab_read_hsi_41_RBUS      dm_icm_3d_tab_read_hsi_41_reg;
	color_icm_dm_icm_3d_tab_read_hsi_50_RBUS      dm_icm_3d_tab_read_hsi_50_reg;
	color_icm_dm_icm_3d_tab_read_hsi_51_RBUS      dm_icm_3d_tab_read_hsi_51_reg;

	h_sta = 0;
	h_end = HUESEGMAX - 1;
	si_sta = 0;
	si_end = SATSEGMAX - 1;

	// 1.read back
	dm_icm_3d_tab_sram_ctrl_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_SRAM_CTRL_reg);
    dm_icm_3d_tab_sram_ctrl_reg.sram_type = 0; // base on H,S axis => Read/Write to I axis
	dm_icm_3d_tab_sram_ctrl_reg.write_random_access_en = 0; //clear
	for(si = si_sta; si <= si_end; si++)
	{
		for(h = h_sta; h <= h_end; h++)
		{
			dm_icm_3d_tab_sram_ctrl_reg.sram_addrres_h = h;
			dm_icm_3d_tab_sram_ctrl_reg.sram_addrres_s = si;
			for(k = 0; k < 2; k++)
			{
				dm_icm_3d_tab_sram_ctrl_reg.read_sel = k;
				dm_icm_3d_tab_sram_ctrl_reg.read_en = 1;
				rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_SRAM_CTRL_reg, dm_icm_3d_tab_sram_ctrl_reg.regValue);
				timeout = 20;
				do
				{
					dm_icm_3d_tab_sram_ctrl_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_SRAM_CTRL_reg);
				}while(dm_icm_3d_tab_sram_ctrl_reg.read_en && (timeout-- > 0));
				if(timeout <= 0)
				{
					//printf("drvif_color_icm_global_adjust read icm table error: sram_addrres_h = %d, sram_addrres_s = %d\n",h, si);
					return false;
				}

				dm_icm_3d_tab_read_hsi_00_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_00_reg);
				dm_icm_3d_tab_read_hsi_01_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_01_reg);
				dm_icm_3d_tab_read_hsi_10_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_10_reg);
				dm_icm_3d_tab_read_hsi_11_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_11_reg);
				dm_icm_3d_tab_read_hsi_20_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_20_reg);
				dm_icm_3d_tab_read_hsi_21_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_21_reg);
				dm_icm_3d_tab_read_hsi_30_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_30_reg);
				dm_icm_3d_tab_read_hsi_31_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_31_reg);
				dm_icm_3d_tab_read_hsi_40_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_40_reg);
				dm_icm_3d_tab_read_hsi_41_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_41_reg);
				dm_icm_3d_tab_read_hsi_50_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_50_reg);
				dm_icm_3d_tab_read_hsi_51_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_READ_HSI_51_reg);

				ICM_TAB[k * 6 + 0][si][h].H = dm_icm_3d_tab_read_hsi_00_reg.read_table_h0;
				ICM_TAB[k * 6 + 0][si][h].S = dm_icm_3d_tab_read_hsi_00_reg.read_table_s0;
				ICM_TAB[k * 6 + 0][si][h].I = dm_icm_3d_tab_read_hsi_01_reg.read_table_i0;
				ICM_TAB[k * 6 + 1][si][h].H = dm_icm_3d_tab_read_hsi_10_reg.read_table_h1;
				ICM_TAB[k * 6 + 1][si][h].S = dm_icm_3d_tab_read_hsi_10_reg.read_table_s1;
				ICM_TAB[k * 6 + 1][si][h].I = dm_icm_3d_tab_read_hsi_11_reg.read_table_i1;
				ICM_TAB[k * 6 + 2][si][h].H = dm_icm_3d_tab_read_hsi_20_reg.read_table_h2;
				ICM_TAB[k * 6 + 2][si][h].S = dm_icm_3d_tab_read_hsi_20_reg.read_table_s2;
				ICM_TAB[k * 6 + 2][si][h].I = dm_icm_3d_tab_read_hsi_21_reg.read_table_i2;
				ICM_TAB[k * 6 + 3][si][h].H = dm_icm_3d_tab_read_hsi_30_reg.read_table_h3;
				ICM_TAB[k * 6 + 3][si][h].S = dm_icm_3d_tab_read_hsi_30_reg.read_table_s3;
				ICM_TAB[k * 6 + 3][si][h].I = dm_icm_3d_tab_read_hsi_31_reg.read_table_i3;
				ICM_TAB[k * 6 + 4][si][h].H = dm_icm_3d_tab_read_hsi_40_reg.read_table_h4;
				ICM_TAB[k * 6 + 4][si][h].S = dm_icm_3d_tab_read_hsi_40_reg.read_table_s4;
				ICM_TAB[k * 6 + 4][si][h].I = dm_icm_3d_tab_read_hsi_41_reg.read_table_i4;
				ICM_TAB[k * 6 + 5][si][h].H = dm_icm_3d_tab_read_hsi_50_reg.read_table_h5;
				ICM_TAB[k * 6 + 5][si][h].S = dm_icm_3d_tab_read_hsi_50_reg.read_table_s5;
				ICM_TAB[k * 6 + 5][si][h].I = dm_icm_3d_tab_read_hsi_51_reg.read_table_i5;

				// (1)subtract previous global hue/sat/itn
				ICM_TAB[k * 6 + 0][si][h].H -= g_dhue;
				ICM_TAB[k * 6 + 1][si][h].H -= g_dhue;
				ICM_TAB[k * 6 + 2][si][h].H -= g_dhue;
				ICM_TAB[k * 6 + 3][si][h].H -= g_dhue;
				ICM_TAB[k * 6 + 4][si][h].H -= g_dhue;
				ICM_TAB[k * 6 + 5][si][h].H -= g_dhue;

				ICM_TAB[k * 6 + 0][si][h].S -= g_dsatbysat[si];
				ICM_TAB[k * 6 + 1][si][h].S -= g_dsatbysat[si];
				ICM_TAB[k * 6 + 2][si][h].S -= g_dsatbysat[si];
				ICM_TAB[k * 6 + 3][si][h].S -= g_dsatbysat[si];
				ICM_TAB[k * 6 + 4][si][h].S -= g_dsatbysat[si];
				ICM_TAB[k * 6 + 5][si][h].S -= g_dsatbysat[si];

				ICM_TAB[k * 6 + 0][si][h].I -= g_ditnbyitn[k * 6 + 0];
				ICM_TAB[k * 6 + 1][si][h].I -= g_ditnbyitn[k * 6 + 1];
				ICM_TAB[k * 6 + 2][si][h].I -= g_ditnbyitn[k * 6 + 2];
				ICM_TAB[k * 6 + 3][si][h].I -= g_ditnbyitn[k * 6 + 3];
				ICM_TAB[k * 6 + 4][si][h].I -= g_ditnbyitn[k * 6 + 4];
				ICM_TAB[k * 6 + 5][si][h].I -= g_ditnbyitn[k * 6 + 5];

				// (2)add current global hue/sat/itn
				ICM_TAB[k * 6 + 0][si][h].H = (ICM_TAB[k * 6 + 0][si][h].H + g_dhue_cur + HUERANGE) % HUERANGE;
				ICM_TAB[k * 6 + 1][si][h].H = (ICM_TAB[k * 6 + 1][si][h].H + g_dhue_cur + HUERANGE) % HUERANGE;
				ICM_TAB[k * 6 + 2][si][h].H = (ICM_TAB[k * 6 + 2][si][h].H + g_dhue_cur + HUERANGE) % HUERANGE;
				ICM_TAB[k * 6 + 3][si][h].H = (ICM_TAB[k * 6 + 3][si][h].H + g_dhue_cur + HUERANGE) % HUERANGE;
				ICM_TAB[k * 6 + 4][si][h].H = (ICM_TAB[k * 6 + 4][si][h].H + g_dhue_cur + HUERANGE) % HUERANGE;
				ICM_TAB[k * 6 + 5][si][h].H = (ICM_TAB[k * 6 + 5][si][h].H + g_dhue_cur + HUERANGE) % HUERANGE;

				ICM_TAB[k * 6 + 0][si][h].S = CLIP(0, SATRANGEEX, ICM_TAB[k * 6 + 0][si][h].S + g_dsatbysat_cur[si]);
				ICM_TAB[k * 6 + 1][si][h].S = CLIP(0, SATRANGEEX, ICM_TAB[k * 6 + 1][si][h].S + g_dsatbysat_cur[si]);
				ICM_TAB[k * 6 + 2][si][h].S = CLIP(0, SATRANGEEX, ICM_TAB[k * 6 + 2][si][h].S + g_dsatbysat_cur[si]);
				ICM_TAB[k * 6 + 3][si][h].S = CLIP(0, SATRANGEEX, ICM_TAB[k * 6 + 3][si][h].S + g_dsatbysat_cur[si]);
				ICM_TAB[k * 6 + 4][si][h].S = CLIP(0, SATRANGEEX, ICM_TAB[k * 6 + 4][si][h].S + g_dsatbysat_cur[si]);
				ICM_TAB[k * 6 + 5][si][h].S = CLIP(0, SATRANGEEX, ICM_TAB[k * 6 + 5][si][h].S + g_dsatbysat_cur[si]);

				ICM_TAB[k * 6 + 0][si][h].I = CLIP(0, ITNRANGEEX, ICM_TAB[k * 6 + 0][si][h].I + g_ditnbyitn_cur[k * 6 + 0]);
				ICM_TAB[k * 6 + 1][si][h].I = CLIP(0, ITNRANGEEX, ICM_TAB[k * 6 + 1][si][h].I + g_ditnbyitn_cur[k * 6 + 1]);
				ICM_TAB[k * 6 + 2][si][h].I = CLIP(0, ITNRANGEEX, ICM_TAB[k * 6 + 2][si][h].I + g_ditnbyitn_cur[k * 6 + 2]);
				ICM_TAB[k * 6 + 3][si][h].I = CLIP(0, ITNRANGEEX, ICM_TAB[k * 6 + 3][si][h].I + g_ditnbyitn_cur[k * 6 + 3]);
				ICM_TAB[k * 6 + 4][si][h].I = CLIP(0, ITNRANGEEX, ICM_TAB[k * 6 + 4][si][h].I + g_ditnbyitn_cur[k * 6 + 4]);
				ICM_TAB[k * 6 + 5][si][h].I = CLIP(0, ITNRANGEEX, ICM_TAB[k * 6 + 5][si][h].I + g_ditnbyitn_cur[k * 6 + 5]);
			}
   		}
	}
	// 2.write
	dm_icm_3d_tab_sram_ctrl_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_SRAM_CTRL_reg);
	dm_icm_3d_tab_sram_ctrl_reg.sram_type = 0; // base on H,S axis => Read/Write to I axis
	dm_icm_3d_tab_sram_ctrl_reg.write_random_access_en = 0; //block write
	rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_SRAM_CTRL_reg, dm_icm_3d_tab_sram_ctrl_reg.regValue);
	for(si = si_sta; si <= si_end; si++)
	{
		for(h = h_sta; h <= h_end; h++)
		{
			dm_icm_3d_tab_sram_ctrl_reg.sram_addrres_h = h;
			dm_icm_3d_tab_sram_ctrl_reg.sram_addrres_s = si;

			dm_icm_3d_tab_write_hsi_00_reg.write_table_h0 = ICM_TAB[0 ][si][h].H;
			dm_icm_3d_tab_write_hsi_00_reg.write_table_s0 = ICM_TAB[0 ][si][h].S;
			dm_icm_3d_tab_write_hsi_01_reg.write_table_i0 = ICM_TAB[0 ][si][h].I;
			dm_icm_3d_tab_write_hsi_10_reg.write_table_h1 = ICM_TAB[1 ][si][h].H;
			dm_icm_3d_tab_write_hsi_10_reg.write_table_s1 = ICM_TAB[1 ][si][h].S;
			dm_icm_3d_tab_write_hsi_11_reg.write_table_i1 = ICM_TAB[1 ][si][h].I;
			dm_icm_3d_tab_write_hsi_20_reg.write_table_h2 = ICM_TAB[2 ][si][h].H;
			dm_icm_3d_tab_write_hsi_20_reg.write_table_s2 = ICM_TAB[2 ][si][h].S;
			dm_icm_3d_tab_write_hsi_21_reg.write_table_i2 = ICM_TAB[2 ][si][h].I;
			dm_icm_3d_tab_write_hsi_30_reg.write_table_h3 = ICM_TAB[3 ][si][h].H;
			dm_icm_3d_tab_write_hsi_30_reg.write_table_s3 = ICM_TAB[3 ][si][h].S;
			dm_icm_3d_tab_write_hsi_31_reg.write_table_i3 = ICM_TAB[3 ][si][h].I;
			dm_icm_3d_tab_write_hsi_40_reg.write_table_h4 = ICM_TAB[4 ][si][h].H;
			dm_icm_3d_tab_write_hsi_40_reg.write_table_s4 = ICM_TAB[4 ][si][h].S;
			dm_icm_3d_tab_write_hsi_41_reg.write_table_i4 = ICM_TAB[4 ][si][h].I;
			dm_icm_3d_tab_write_hsi_50_reg.write_table_h5 = ICM_TAB[5 ][si][h].H;
			dm_icm_3d_tab_write_hsi_50_reg.write_table_s5 = ICM_TAB[5 ][si][h].S;
			dm_icm_3d_tab_write_hsi_51_reg.write_table_i5 = ICM_TAB[5 ][si][h].I;
			dm_icm_3d_tab_write_hsi_60_reg.write_table_h6 = ICM_TAB[6 ][si][h].H;
			dm_icm_3d_tab_write_hsi_60_reg.write_table_s6 = ICM_TAB[6 ][si][h].S;
			dm_icm_3d_tab_write_hsi_61_reg.write_table_i6 = ICM_TAB[6 ][si][h].I;
			dm_icm_3d_tab_write_hsi_70_reg.write_table_h7 = ICM_TAB[7 ][si][h].H;
			dm_icm_3d_tab_write_hsi_70_reg.write_table_s7 = ICM_TAB[7 ][si][h].S;
			dm_icm_3d_tab_write_hsi_71_reg.write_table_i7 = ICM_TAB[7 ][si][h].I;
			dm_icm_3d_tab_write_hsi_80_reg.write_table_h8 = ICM_TAB[8 ][si][h].H;
			dm_icm_3d_tab_write_hsi_80_reg.write_table_s8 = ICM_TAB[8 ][si][h].S;
			dm_icm_3d_tab_write_hsi_81_reg.write_table_i8 = ICM_TAB[8 ][si][h].I;
			dm_icm_3d_tab_write_hsi_90_reg.write_table_h9 = ICM_TAB[9 ][si][h].H;
			dm_icm_3d_tab_write_hsi_90_reg.write_table_s9 = ICM_TAB[9 ][si][h].S;
			dm_icm_3d_tab_write_hsi_91_reg.write_table_i9 = ICM_TAB[9 ][si][h].I;
			dm_icm_3d_tab_write_hsi_a0_reg.write_table_ha = ICM_TAB[10][si][h].H;
			dm_icm_3d_tab_write_hsi_a0_reg.write_table_sa = ICM_TAB[10][si][h].S;
			dm_icm_3d_tab_write_hsi_a1_reg.write_table_ia = ICM_TAB[10][si][h].I;
			dm_icm_3d_tab_write_hsi_b0_reg.write_table_hb = ICM_TAB[11][si][h].H;
			dm_icm_3d_tab_write_hsi_b0_reg.write_table_sb = ICM_TAB[11][si][h].S;
			dm_icm_3d_tab_write_hsi_b1_reg.write_table_ib = ICM_TAB[11][si][h].I;

			//write
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_00_reg, dm_icm_3d_tab_write_hsi_00_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_01_reg, dm_icm_3d_tab_write_hsi_01_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_10_reg, dm_icm_3d_tab_write_hsi_10_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_11_reg, dm_icm_3d_tab_write_hsi_11_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_20_reg, dm_icm_3d_tab_write_hsi_20_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_21_reg, dm_icm_3d_tab_write_hsi_21_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_30_reg, dm_icm_3d_tab_write_hsi_30_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_31_reg, dm_icm_3d_tab_write_hsi_31_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_40_reg, dm_icm_3d_tab_write_hsi_40_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_41_reg, dm_icm_3d_tab_write_hsi_41_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_50_reg, dm_icm_3d_tab_write_hsi_50_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_51_reg, dm_icm_3d_tab_write_hsi_51_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_60_reg, dm_icm_3d_tab_write_hsi_60_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_61_reg, dm_icm_3d_tab_write_hsi_61_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_70_reg, dm_icm_3d_tab_write_hsi_70_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_71_reg, dm_icm_3d_tab_write_hsi_71_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_80_reg, dm_icm_3d_tab_write_hsi_80_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_81_reg, dm_icm_3d_tab_write_hsi_81_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_90_reg, dm_icm_3d_tab_write_hsi_90_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_91_reg, dm_icm_3d_tab_write_hsi_91_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_A0_reg, dm_icm_3d_tab_write_hsi_a0_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_A1_reg, dm_icm_3d_tab_write_hsi_a1_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_B0_reg, dm_icm_3d_tab_write_hsi_b0_reg.regValue);
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_WRITE_HSI_B1_reg, dm_icm_3d_tab_write_hsi_b1_reg.regValue);

			dm_icm_3d_tab_sram_ctrl_reg.write_en = 1;
			rtd_outl(COLOR_ICM_DM_ICM_3D_TAB_SRAM_CTRL_reg, dm_icm_3d_tab_sram_ctrl_reg.regValue);
			timeout = 100;
			do
			{
				dm_icm_3d_tab_sram_ctrl_reg.regValue = rtd_inl(COLOR_ICM_DM_ICM_3D_TAB_SRAM_CTRL_reg);
			}
			while(dm_icm_3d_tab_sram_ctrl_reg.write_en && (timeout-- > 0));

			if(timeout <= 0)
			{
				//printf("drvif_color_icm_global_adjust write icm table error: sram_addrres_h = %d, sram_addrres_s = %d\n",h, si);
				return false;
			}
		}
	}
	// 3. update current global hue/sat/itn
	//g_dhue
	g_dhue = g_dhue_cur;
	//g_dsatbysat
	g_dsatbysat[0]	= g_dsatbysat_cur[0];
	g_dsatbysat[1]	= g_dsatbysat_cur[1];
	g_dsatbysat[2]	= g_dsatbysat_cur[2];
	g_dsatbysat[3]	= g_dsatbysat_cur[3];
	g_dsatbysat[4]	= g_dsatbysat_cur[4];
	g_dsatbysat[5]	= g_dsatbysat_cur[5];
	g_dsatbysat[6]	= g_dsatbysat_cur[6];
	g_dsatbysat[7]	= g_dsatbysat_cur[7];
	g_dsatbysat[8]	= g_dsatbysat_cur[8];
	g_dsatbysat[9]	= g_dsatbysat_cur[9];
	g_dsatbysat[10]	= g_dsatbysat_cur[10];
	g_dsatbysat[11]	= g_dsatbysat_cur[11];
	//g_ditnbyitn
	g_ditnbyitn[0]	= g_ditnbyitn_cur[0];
	g_ditnbyitn[1]	= g_ditnbyitn_cur[1];
	g_ditnbyitn[2]	= g_ditnbyitn_cur[2];
	g_ditnbyitn[3]	= g_ditnbyitn_cur[3];
	g_ditnbyitn[4]	= g_ditnbyitn_cur[4];
	g_ditnbyitn[5]	= g_ditnbyitn_cur[5];
	g_ditnbyitn[6]	= g_ditnbyitn_cur[6];
	g_ditnbyitn[7]	= g_ditnbyitn_cur[7];
	g_ditnbyitn[8]	= g_ditnbyitn_cur[8];
	g_ditnbyitn[9]	= g_ditnbyitn_cur[9];
	g_ditnbyitn[10]	= g_ditnbyitn_cur[10];
	g_ditnbyitn[11]	= g_ditnbyitn_cur[11];
	return true;
}
#endif


int scalerVIP_2_Complement(unsigned int nVal,unsigned char nBitValid)
{
	return ((nVal >> nBitValid) ? (nVal | (short)(~((1 << (nBitValid+1)) - 1))) : (nVal));
}


void scalerVIP_Set_Stop_Polling(void)
{
//#ifdef VIP_CONFIG_DUAL_CHANNEL
	color_dcc_d_dcc_fwused_1_RBUS d_dcc_fwused_1_reg;
	d_dcc_fwused_1_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_1_reg);
	Stop_Polling.Stop_All= d_dcc_fwused_1_reg.regValue &0x01;
	Stop_Polling.Stop_Di_Hmc=(d_dcc_fwused_1_reg.regValue>>1) &0x01;
	Stop_Polling.Stop_Dcc= (d_dcc_fwused_1_reg.regValue>>2) &0x01;
	Stop_Polling.Stop_Auto_Nr=(d_dcc_fwused_1_reg.regValue>>3) &0x01;
	Stop_Polling.Stop_Dcti_for_colorbar=(d_dcc_fwused_1_reg.regValue>>4) &0x01;
	Stop_Polling.Stop_Noise_Mpeg=(d_dcc_fwused_1_reg.regValue>>5) &0x01;
	Stop_Polling.Stop_Dcr=(d_dcc_fwused_1_reg.regValue>>6) &0x01;
	Stop_Polling.Stop_Film_Mode_Detector=(d_dcc_fwused_1_reg.regValue>>7) &0x01;
	Stop_Polling.Stop_VD_Noise=(d_dcc_fwused_1_reg.regValue>>8) &0x01;
	Stop_Polling.Stop_Di_Smd=(d_dcc_fwused_1_reg.regValue>>9) &0x01;

	Stop_Polling.Stop_pattern_Monscope=(d_dcc_fwused_1_reg.regValue>>10) &0x01;
	Stop_Polling.Stop_pattern_ColorBar=(d_dcc_fwused_1_reg.regValue>>11) &0x01;
	Stop_Polling.Stop_pattern_No2=(d_dcc_fwused_1_reg.regValue>>12) &0x01;
	Stop_Polling.Stop_pattern_No4=(d_dcc_fwused_1_reg.regValue>>13) &0x01;
	Stop_Polling.Stop_pattern_No23=(d_dcc_fwused_1_reg.regValue>>14) &0x01;
	Stop_Polling.Stop_pattern_No24=(d_dcc_fwused_1_reg.regValue>>15) &0x01;
	Stop_Polling.Stop_pattern_No47=(d_dcc_fwused_1_reg.regValue>>16) &0x01;
	Stop_Polling.Stop_pattern_No107=(d_dcc_fwused_1_reg.regValue>>17) &0x01;
	Stop_Polling.Stop_pattern_No154=(d_dcc_fwused_1_reg.regValue>>18) &0x01;
	Stop_Polling.Stop_Reset_Pattern=(d_dcc_fwused_1_reg.regValue>>19) &0x01;

//#endif

}
void scalerVIP_Set_Start_Print_Info()
{
//#ifdef VIP_CONFIG_DUAL_CHANNEL
	static unsigned char init=0;
	unsigned char i=0;
	unsigned int DCC_Histogram_Mean_value = 0;
	DCC_Histogram_Mean_value = SmartPic_clue->Hist_Y_Mean_Value;

	color_dcc_d_dcc_fwused_2_RBUS  d_dcc_fwused_2_reg;
	color_dcc_d_dcc_fwused_3_RBUS  d_dcc_fwused_3_reg;

	d_dcc_fwused_2_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_2_reg);
	d_dcc_fwused_3_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_3_reg);

	if (init == TRUE && d_dcc_fwused_2_reg.delay_time == 0)
	{
		init = FALSE;
	}

	if(init==FALSE)
	{
		init =TRUE;

		d_dcc_fwused_2_reg.delay_time= 150; //default dealy time=150
		d_dcc_fwused_2_reg.fw_2 =0;
		rtd_outl(COLOR_DCC_D_DCC_FWUSED_2_reg, d_dcc_fwused_2_reg.regValue);
	}
	//else
	{
		Start_Print.Delay_Time= d_dcc_fwused_2_reg.delay_time &0xff;
		Start_Print.Y_Hist=( d_dcc_fwused_2_reg.regValue>>8) &0x01;
		Start_Print.Hue_Hist= (d_dcc_fwused_2_reg.regValue>>9) &0x01;
		Start_Print.Sat_Mean=(d_dcc_fwused_2_reg.regValue>>10) &0x01;
		Start_Print.Dcc_1=(d_dcc_fwused_2_reg.regValue>>11) &0x01;
		Start_Print.Dcc_2=(d_dcc_fwused_2_reg.regValue>>12) &0x01;
		Start_Print.DCC_3=(d_dcc_fwused_2_reg.regValue>>13) &0x01;
		Start_Print.Rtnr_1=(d_dcc_fwused_2_reg.regValue>>14) &0x01;
		Start_Print.Rtnr_2=(d_dcc_fwused_2_reg.regValue>>15) &0x01;
		Start_Print.Mpeg_Nr=(d_dcc_fwused_2_reg.regValue>>16) &0x01;
		Start_Print.Snr=(d_dcc_fwused_2_reg.regValue>>17) &0x01;
		Start_Print.Sharpness_1=(d_dcc_fwused_2_reg.regValue>>18) &0x01;
		Start_Print.Sharpness_2=(d_dcc_fwused_2_reg.regValue>>19) &0x01;
		Start_Print.DI_1=(d_dcc_fwused_2_reg.regValue>>20) &0x01;
		Start_Print.DI_2=(d_dcc_fwused_2_reg.regValue>>21) &0x01;
		Start_Print.Film_Mode=(d_dcc_fwused_2_reg.regValue>>22) &0x01;
		Start_Print.HIST=(d_dcc_fwused_2_reg.regValue>>23) &0x01;
		Start_Print.Reverse_2=(d_dcc_fwused_2_reg.regValue>>24) &0x01;
		Start_Print.Reverse_3=(d_dcc_fwused_2_reg.regValue>>25) &0x01;

		Start_Print.ID_Pattern_ALL=(d_dcc_fwused_3_reg.regValue>>0) &0x01;
		Start_Print.ID_Pattern_2=(d_dcc_fwused_3_reg.regValue>>1) &0x01;
		Start_Print.ID_Pattern_4=(d_dcc_fwused_3_reg.regValue>>2) &0x01;
		Start_Print.ID_Pattern_5=(d_dcc_fwused_3_reg.regValue>>3) &0x01;
		Start_Print.ID_Pattern_7=(d_dcc_fwused_3_reg.regValue>>4) &0x01;
		Start_Print.ID_Pattern_12=(d_dcc_fwused_3_reg.regValue>>5) &0x01;
		Start_Print.ID_Pattern_23=(d_dcc_fwused_3_reg.regValue>>6) &0x01;
		Start_Print.ID_Pattern_24=(d_dcc_fwused_3_reg.regValue>>7) &0x01;
		Start_Print.ID_Pattern_35=(d_dcc_fwused_3_reg.regValue>>8) &0x01;
		Start_Print.ID_Pattern_47=(d_dcc_fwused_3_reg.regValue>>9) &0x01;
		Start_Print.ID_Pattern_107=(d_dcc_fwused_3_reg.regValue>>10) &0x01;
		Start_Print.ID_Pattern_123=(d_dcc_fwused_3_reg.regValue>>11) &0x01;
		Start_Print.ID_Pattern_132=(d_dcc_fwused_3_reg.regValue>>12) &0x01;
		Start_Print.ID_Pattern_133=(d_dcc_fwused_3_reg.regValue>>13) &0x01;
		Start_Print.ID_Pattern_154=(d_dcc_fwused_3_reg.regValue>>14) &0x01;
		Start_Print.ID_Pattern_191=(d_dcc_fwused_3_reg.regValue>>15) &0x01;
		Start_Print.ID_Pattern_192=(d_dcc_fwused_3_reg.regValue>>16) &0x01;
		Start_Print.ID_Pattern_193=(d_dcc_fwused_3_reg.regValue>>17) &0x01;
		Start_Print.ID_Pattern_194=(d_dcc_fwused_3_reg.regValue>>18) &0x01;
		Start_Print.ID_Pattern_195=(d_dcc_fwused_3_reg.regValue>>19) &0x01;
		Start_Print.ID_Pattern_139=(d_dcc_fwused_3_reg.regValue>>20) &0x01;
		Start_Print.ID_Pattern_196=(d_dcc_fwused_3_reg.regValue>>21) &0x01;
		Start_Print.ID_Pattern_14=(d_dcc_fwused_3_reg.regValue>>22) &0x01;
		Start_Print.someothers=(d_dcc_fwused_3_reg.regValue>>23) &0x01;
		Start_Print.ID_Pattern_32=(d_dcc_fwused_3_reg.regValue>>24) &0x01;
		Start_Print.ID_Pattern_147=(d_dcc_fwused_3_reg.regValue>>25) &0x01;
		Start_Print.Reverse_10=(d_dcc_fwused_3_reg.regValue>>26) &0x01;
		Start_Print.Reverse_11=(d_dcc_fwused_3_reg.regValue>>27) &0x01;
		Start_Print.VD_LOG_ENABLE=(d_dcc_fwused_3_reg.regValue>>28) &0x01;
		Start_Print.ColorBar=(d_dcc_fwused_3_reg.regValue>>29) &0x01;
		Start_Print.Slow_Motion1=(d_dcc_fwused_3_reg.regValue>>30) &0x01;
		Start_Print.Slow_Motion2=(d_dcc_fwused_3_reg.regValue>>31) &0x01;

	}
	if(Start_Print.Delay_Time ==0)
	{
		Start_Print.Delay_Time =1;
	}

	// print   Y_hist_ratio
	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Y_Hist==TRUE))
	{
		ROSPrintf("{");
		for(i=0;i<TV006_VPQ_chrm_bin;i++)
			ROSPrintf("%d, ",Y_hist_ratio[i]);
		ROSPrintf("}\n");

	}

	// print   hue_hist_ratio
	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Hue_Hist==TRUE))
	{

		ROSPrintf("{");
		for(i=0;i<24;i++)
			ROSPrintf("%d, ",hue_hist_ratio[i]);
		ROSPrintf("}\n");

	}

	// print   sat_mean_value
	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Sat_Mean==TRUE))
	{
		ROSPrintf("sat_mean_value=%d \n", sat_ratio_mean_value);
	}

	// print   DCC_Histogram_Mean_value
	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Dcc_1==TRUE))
	{
		ROSPrintf(" DCC_Histogram_Mean_value=%d\n", DCC_Histogram_Mean_value);
	}

	// print   RTNR_MAD_count_Y_sum_avg
	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Rtnr_2==TRUE))
	{
		ROSPrintf(" RTNR_MAD_count_Y_sum_avg=%d\n", RTNR_MAD_count_Y_sum_avg);
	}

	// print   Identiy ID Pattern
	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_ALL==TRUE))
	{
		for(i=0;i<200;i++)
		{
			if(DynamicOptimizeSystem[i]!=0)
			{
				ROSPrintf("source=%d,No[%d]=%d \n",(RPC_system_info_structure_table->VIP_source),i,DynamicOptimizeSystem[i]);
			}
		}
	}

}
void scalerVIP_Sat_Hist_Calculate(void)
{
	//change according to sirius by leonard_wu@20140224

	unsigned char i, j, hidx;
	unsigned int sum = 0;
	unsigned short mean_tmp = 0;
	//unsigned short tmptmp = 0;
	//unsigned short Y_mean = 0;

	unsigned char total_sat_hist = 1;
	int timeout = 10;

	color_icm_d_auto_sat_hist_read_ctrl_RBUS		d_auto_sat_hist_read_ctrl_reg;
	color_icm_d_auto_sat_hist_read_flag_RBUS		d_auto_sat_hist_read_flag_reg;
	color_icm_d_auto_sat_hist_cnt_00_or_16_RBUS	d_auto_sat_hist_cnt_00_or_16_reg;

	//write clear first
	d_auto_sat_hist_read_flag_reg.regValue = rtd_inl(COLOR_ICM_D_AUTO_SAT_HIST_READ_FLAG_reg);
	d_auto_sat_hist_read_flag_reg.sat_hist_sram_read_consistent_flag = 0;
	rtd_outl(COLOR_ICM_D_AUTO_SAT_HIST_READ_FLAG_reg, d_auto_sat_hist_read_flag_reg.regValue);
	d_auto_sat_hist_read_flag_reg.sat_hist_sram_read_consistent_flag = 1;
	rtd_outl(COLOR_ICM_D_AUTO_SAT_HIST_READ_FLAG_reg, d_auto_sat_hist_read_flag_reg.regValue);

	//read sat hist 0; if you want to read all 4 hists, set total_sat_hist = 4 and sat_hist should be change too.
	total_sat_hist = 1;
	for(hidx = 0; hidx < total_sat_hist; hidx++)
	{
		sum = 0;
		mean_tmp = 0;
		for(i = 0; i < 2; i++)
		{
			d_auto_sat_hist_read_ctrl_reg.regValue = rtd_inl(COLOR_ICM_D_AUTO_SAT_HIST_READ_CTRL_reg);
			d_auto_sat_hist_read_ctrl_reg.sram_read = 1;
			d_auto_sat_hist_read_ctrl_reg.hist_ctrl = hidx;
			d_auto_sat_hist_read_ctrl_reg.cnt_block = i;
			rtd_outl(COLOR_ICM_D_AUTO_SAT_HIST_READ_CTRL_reg, d_auto_sat_hist_read_ctrl_reg.regValue);

			//histogram has been update from SRAM to registers?
			timeout = 10;
			do{
				d_auto_sat_hist_read_ctrl_reg.regValue = rtd_inl(COLOR_ICM_D_AUTO_SAT_HIST_READ_CTRL_reg);
			}while(d_auto_sat_hist_read_ctrl_reg.sram_read && (timeout-- > 0));

			if(timeout < 0)
				goto FINISH; //read back data error

			//read histogram from registers
			for(j = 0; j < 16; j++)
			{
				d_auto_sat_hist_cnt_00_or_16_reg.regValue = rtd_inl(COLOR_ICM_D_AUTO_SAT_HIST_CNT_00_OR_16_reg + (j * 4));
				sat_hist[i * 16 + j] = d_auto_sat_hist_cnt_00_or_16_reg.sat_hist_cnt_00_or_16;
        sum = sum + (sat_hist[i * 16 + j] >> 1); // shift 1 bit to avoid overflow when calculating ratio
			}
			//Y_mean = tmptmp>>5;

			//check consistent
			d_auto_sat_hist_read_flag_reg.regValue = rtd_inl(COLOR_ICM_D_AUTO_SAT_HIST_READ_FLAG_reg);

			if(d_auto_sat_hist_read_flag_reg.sat_hist_sram_read_consistent_flag)
				goto FINISH; //read back data error

		}
		//
		if(sum != 0)
		{
			for(i = 0; i < 32; i++)
			{
        sat_hist_ratio[i] = (sat_hist[i]>>1) * 1000 / sum; // shift 1 bit to match the sum
				mean_tmp += sat_hist_ratio[i] * (i + 1);//sat_hist_ratio[i]*(i+1)/COLOR_AutoSat_HISTOGRAM_LEVEL;
				//tmptmp += Y_hist_ratio[i]*(i+1);

				(SmartPic_clue->Sat_Main_His)[i] = sat_hist[i];
				(SmartPic_clue->Sat_Main_His_Ratio)[i]= sat_hist_ratio[i];

			}


		}
		if((SmartPic_clue->SCALER_DISP_INFO.DispLen*SmartPic_clue->SCALER_DISP_INFO.DispWid)!=0)
		{
      SmartPic_clue->sat_sumcnt_ratio = sum*1000/((SmartPic_clue->SCALER_DISP_INFO.DispLen*SmartPic_clue->SCALER_DISP_INFO.DispWid)>>1); // shift 1 bit to match the sum
		}
		sat_ratio_mean_value = mean_tmp >> 5;	//COLOR_AutoSat_HISTOGRAM_LEVEL = 32 ;

		SmartPic_clue->sat_ratio_mean_value = sat_ratio_mean_value;

    }



FINISH:
#if 1
	if(MA_print_count%100 == 0 && meanSat_meanValue_printf_log_flag)
		ROSPrintf("sat_mean_value=%d, Histogram_Mean_value=%d\n", sat_ratio_mean_value,(SmartPic_clue->Hist_Y_Mean_Value));
#endif
#if 0
	if(MA_print_count%300==0)
	{
		//ROSPrintf("sat_mean_value=%d,mean_tmp=%d,Histogram_Mean_value=%d,tmptmp=%d,Y_mean=%d\n",
			//sat_mean_value,mean_tmp,(SmartPic_clue->Hist_Y_Mean_Value),tmptmp,Y_mean);
		for(i=0;i<32;i++)
			ROSPrintf("%d,",sat_hist_ratio[i]);
		ROSPrintf("\n");
		for(i=0;i<TV006_VPQ_chrm_bin;i++)
			ROSPrintf("%d,",Y_hist_ratio[i]);
		ROSPrintf("\n");
	}
#endif
#if 1
	unsigned int printf_Flag = system_info_structure_table->ISR_Printf_Flag.Y_Hue_Sat_Hist_Flag0;
	unsigned int print_delay = (system_info_structure_table->ISR_Printf_Flag.Delay_Time == 0)?(1):(system_info_structure_table->ISR_Printf_Flag.Delay_Time);
	//for debug.
	if(((printf_Flag&_BIT4)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("Y_Hue_Sat cal, Sat={");
			for(i=0;i<COLOR_AutoSat_HISTOGRAM_LEVEL;i++)
				printk("%d,", SmartPic_clue->Sat_Main_His[i]);
			printk("}\n");
		}
	}
	if(((printf_Flag&_BIT5)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("Y_Hue_Sat cal, sat_ratio={");
			for(i=0;i<COLOR_AutoSat_HISTOGRAM_LEVEL;i++)
				printk("%d,", SmartPic_clue->Sat_Main_His_Ratio[i]);
			printk("}\n");
		}
	}

#endif


}

void scalerVIP_FMV_HMCbin_hist_ratio_Cal(SLR_VIP_TABLE* Share_Memory_VIP_TABLE_Struct, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table)
{
	unsigned int *FMV_hist, *HMC_bin_hist;
	unsigned int *FMV_hist_ratio, *HMC_bin_hist_ratio;
	unsigned char i, GMV, MV_Sel;
	unsigned int sum;
	di_im_di_pan_detection_statistic_1_RBUS im_di_pan_detection_statistic_1_reg;
	di_im_di_pan_detection_statistic_2_RBUS im_di_pan_detection_statistic_2_reg;
	di_im_di_pan_detection_statistic_3_RBUS im_di_pan_detection_statistic_3_reg;
	di_im_di_pan_detection_statistic_4_RBUS im_di_pan_detection_statistic_4_reg;
	di_im_di_pan_detection_statistic_5_RBUS im_di_pan_detection_statistic_5_reg;
	di_im_di_pan_detection_statistic_6_RBUS im_di_pan_detection_statistic_6_reg;
	di_im_di_pan_detection_statistic_7_RBUS im_di_pan_detection_statistic_7_reg;
	di_im_di_pan_detection_statistic_8_RBUS im_di_pan_detection_statistic_8_reg;
	di_im_di_pan_detection_statistic_9_RBUS im_di_pan_detection_statistic_9_reg;
	di_im_di_pan_detection_statistic_10_RBUS im_di_pan_detection_statistic_10_reg;
	di_im_di_pan_detection_statistic_11_RBUS im_di_pan_detection_statistic_11_reg;
	di_im_di_pan_detection_statistic_12_RBUS im_di_pan_detection_statistic_12_reg;
	di_im_di_pan_detection_statistic_13_RBUS im_di_pan_detection_statistic_13_reg;
	di_im_di_pan_detection_statistic_14_RBUS im_di_pan_detection_statistic_14_reg;
	di_im_di_pan_detection_statistic_15_RBUS im_di_pan_detection_statistic_15_reg;
	di_im_di_pan_detection_statistic_16_RBUS im_di_pan_detection_statistic_16_reg;
	di_im_di_pan_detection_statistic_17_RBUS im_di_pan_detection_statistic_17_reg;
	di_di_gst_fmvhisa_RBUS di_gst_fmvhisa_reg;
	di_di_gst_fmvhisb_RBUS di_gst_fmvhisb_reg;
	di_di_gst_fmvhisc_RBUS di_gst_fmvhisc_reg;
	di_di_gst_fmvhisd_RBUS di_gst_fmvhisd_reg;
	di_di_gst_fmvhise_RBUS di_gst_fmvhise_reg;
	di_di_gst_fmvhisf_RBUS di_gst_fmvhisf_reg;
	di_di_gst_fmvhisg_RBUS di_gst_fmvhisg_reg;
	di_di_gst_fmvhish_RBUS di_gst_fmvhish_reg;
	di_di_gst_fmvhisi_RBUS di_gst_fmvhisi_reg;
	di_di_gst_fmvhisj_RBUS di_gst_fmvhisj_reg;
	di_di_gst_fmvhisk_RBUS di_gst_fmvhisk_reg;
	di_di_smd_sampling_gmvb_RBUS di_di_smd_sampling_gmvb_reg;
	di_di_smd_sampling_gmvc_RBUS di_di_smd_sampling_gmvc_reg;
	di_di_smd_gmvcoeff3_RBUS di_di_smd_gmvcoeff3_reg;

	im_di_pan_detection_statistic_1_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_1_reg);
	im_di_pan_detection_statistic_2_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_2_reg);
	im_di_pan_detection_statistic_3_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_3_reg);
	im_di_pan_detection_statistic_4_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_4_reg);
	im_di_pan_detection_statistic_5_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_5_reg);
	im_di_pan_detection_statistic_6_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_6_reg);
	im_di_pan_detection_statistic_7_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_7_reg);
	im_di_pan_detection_statistic_8_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_8_reg);
	im_di_pan_detection_statistic_9_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_9_reg);
	im_di_pan_detection_statistic_10_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_10_reg);
	im_di_pan_detection_statistic_11_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_11_reg);
	im_di_pan_detection_statistic_12_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_12_reg);
	im_di_pan_detection_statistic_13_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_13_reg);
	im_di_pan_detection_statistic_14_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_14_reg);
	im_di_pan_detection_statistic_15_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_15_reg);
	im_di_pan_detection_statistic_16_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_16_reg);
	im_di_pan_detection_statistic_17_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_STATISTIC_17_reg);
	di_gst_fmvhisa_reg.regValue = rtd_inl(DI_DI_GST_FMVHisA_reg);
	di_gst_fmvhisb_reg.regValue = rtd_inl(DI_DI_GST_FMVHisB_reg);
	di_gst_fmvhisc_reg.regValue = rtd_inl(DI_DI_GST_FMVHisC_reg);
	di_gst_fmvhisd_reg.regValue = rtd_inl(DI_DI_GST_FMVHisD_reg);
	di_gst_fmvhise_reg.regValue = rtd_inl(DI_DI_GST_FMVHisE_reg);
	di_gst_fmvhisf_reg.regValue = rtd_inl(DI_DI_GST_FMVHisF_reg);
	di_gst_fmvhisg_reg.regValue = rtd_inl(DI_DI_GST_FMVHisG_reg);
	di_gst_fmvhish_reg.regValue = rtd_inl(DI_DI_GST_FMVHisH_reg);
	di_gst_fmvhisi_reg.regValue = rtd_inl(DI_DI_GST_FMVHisI_reg);
	di_gst_fmvhisj_reg.regValue = rtd_inl(DI_DI_GST_FMVHisJ_reg);
	di_gst_fmvhisk_reg.regValue = rtd_inl(DI_DI_GST_FMVHisK_reg);

	FMV_hist = SmartPic_clue->FMV_hist;
	FMV_hist_ratio = SmartPic_clue->FMV_hist_Ratio;
	HMC_bin_hist = SmartPic_clue->HMC_bin_hist;
	HMC_bin_hist_ratio = SmartPic_clue->HMC_bin_hist_Ratio;

	// get Global FMV
	di_di_smd_sampling_gmvb_reg.regValue = rtd_inl(DI_DI_SMD_Sampling_GMVb_reg);
	di_di_smd_sampling_gmvc_reg.regValue = rtd_inl(DI_DI_SMD_Sampling_GMVc_reg);
	di_di_smd_gmvcoeff3_reg.regValue = rtd_inl(DI_DI_SMD_GMVCoeff3_reg);
	MV_Sel = di_di_smd_sampling_gmvc_reg.smd_close2gmv_mvselect;
	if(MV_Sel==0)
		GMV = di_di_smd_sampling_gmvb_reg.smd_gmvb_y;
	else if(MV_Sel==1)
		GMV = di_di_smd_sampling_gmvc_reg.smd_gmvc_y;
	else
		GMV = di_di_smd_gmvcoeff3_reg.smd_gmv1_y;

	SmartPic_clue->GMV = GMV;

	HMC_bin_hist[0] = im_di_pan_detection_statistic_9_reg.hmc_r16_pixelsum;
	HMC_bin_hist[1] = im_di_pan_detection_statistic_9_reg.hmc_r15_pixelsum;
	HMC_bin_hist[2] = im_di_pan_detection_statistic_10_reg.hmc_r14_pixelsum;
	HMC_bin_hist[3] = im_di_pan_detection_statistic_10_reg.hmc_r13_pixelsum;
	HMC_bin_hist[4] = im_di_pan_detection_statistic_11_reg.hmc_r12_pixelsum;
	HMC_bin_hist[5] = im_di_pan_detection_statistic_11_reg.hmc_r11_pixelsum;
	HMC_bin_hist[6] = im_di_pan_detection_statistic_12_reg.hmc_r10_pixelsum;
	HMC_bin_hist[7] = im_di_pan_detection_statistic_12_reg.hmc_r9_pixelsum;
	HMC_bin_hist[8] = im_di_pan_detection_statistic_13_reg.hmc_r8_pixelsum;
	HMC_bin_hist[9] = im_di_pan_detection_statistic_1_reg.hmc_r7_pixelsum;
	HMC_bin_hist[10] = im_di_pan_detection_statistic_1_reg.hmc_r6_pixelsum;
	HMC_bin_hist[11] = im_di_pan_detection_statistic_2_reg.hmc_r5_pixelsum;
	HMC_bin_hist[12] = im_di_pan_detection_statistic_2_reg.hmc_r4_pixelsum;
	HMC_bin_hist[13] = im_di_pan_detection_statistic_3_reg.hmc_r3_pixelsum;
	HMC_bin_hist[14] = im_di_pan_detection_statistic_3_reg.hmc_r2_pixelsum;
	HMC_bin_hist[15] = im_di_pan_detection_statistic_4_reg.hmc_r1_pixelsum;
	HMC_bin_hist[16] = im_di_pan_detection_statistic_4_reg.hmc_c0_pixelsum;
	HMC_bin_hist[17] = im_di_pan_detection_statistic_5_reg.hmc_l1_pixelsum;
	HMC_bin_hist[18] = im_di_pan_detection_statistic_5_reg.hmc_l2_pixelsum;
	HMC_bin_hist[19] = im_di_pan_detection_statistic_6_reg.hmc_l3_pixelsum;
	HMC_bin_hist[20] = im_di_pan_detection_statistic_6_reg.hmc_l4_pixelsum;
	HMC_bin_hist[21] = im_di_pan_detection_statistic_7_reg.hmc_l5_pixelsum;
	HMC_bin_hist[22] = im_di_pan_detection_statistic_7_reg.hmc_l6_pixelsum;
	HMC_bin_hist[23] = im_di_pan_detection_statistic_8_reg.hmc_l7_pixelsum;
	HMC_bin_hist[24] = im_di_pan_detection_statistic_13_reg.hmc_l8_pixelsum;
	HMC_bin_hist[25] = im_di_pan_detection_statistic_14_reg.hmc_l9_pixelsum;
	HMC_bin_hist[26] = im_di_pan_detection_statistic_14_reg.hmc_l10_pixelsum;
	HMC_bin_hist[27] = im_di_pan_detection_statistic_15_reg.hmc_l11_pixelsum;
	HMC_bin_hist[28] = im_di_pan_detection_statistic_15_reg.hmc_l12_pixelsum;
	HMC_bin_hist[29] = im_di_pan_detection_statistic_16_reg.hmc_l13_pixelsum;
	HMC_bin_hist[30] = im_di_pan_detection_statistic_16_reg.hmc_l14_pixelsum;
	HMC_bin_hist[31] = im_di_pan_detection_statistic_17_reg.hmc_l15_pixelsum;
	HMC_bin_hist[32] = im_di_pan_detection_statistic_17_reg.hmc_l16_pixelsum;
	FMV_hist[0] =  di_gst_fmvhisa_reg.gst_fmv_his00;
	FMV_hist[1] =  di_gst_fmvhisa_reg.gst_fmv_his01;
	FMV_hist[2] =  di_gst_fmvhisb_reg.gst_fmv_his02;
	FMV_hist[3] =  di_gst_fmvhisb_reg.gst_fmv_his03;
	FMV_hist[4] =  di_gst_fmvhisc_reg.gst_fmv_his04;
	FMV_hist[5] =  di_gst_fmvhisc_reg.gst_fmv_his05;
	FMV_hist[6] =  di_gst_fmvhisd_reg.gst_fmv_his06;
	FMV_hist[7] =  di_gst_fmvhisd_reg.gst_fmv_his07;
	FMV_hist[8] =  di_gst_fmvhise_reg.gst_fmv_his08;
	FMV_hist[9] =  di_gst_fmvhise_reg.gst_fmv_his09;
	FMV_hist[10] = di_gst_fmvhisf_reg.gst_fmv_his10;
	FMV_hist[11] = di_gst_fmvhisg_reg.gst_fmv_his11;
	FMV_hist[12] = di_gst_fmvhisg_reg.gst_fmv_his12;
	FMV_hist[13] = di_gst_fmvhish_reg.gst_fmv_his13;
	FMV_hist[14] = di_gst_fmvhish_reg.gst_fmv_his14;
	FMV_hist[15] = di_gst_fmvhisi_reg.gst_fmv_his15;
	FMV_hist[16] = di_gst_fmvhisi_reg.gst_fmv_his16;
	FMV_hist[17] = di_gst_fmvhisj_reg.gst_fmv_his17;
	FMV_hist[18] = di_gst_fmvhisj_reg.gst_fmv_his18;
	FMV_hist[19] = di_gst_fmvhisk_reg.gst_fmv_his19;
	FMV_hist[20] = di_gst_fmvhisk_reg.gst_fmv_his20;

	sum = 1;
	for(i=0;i<FMV_Hist_Bin_Num;i++)
		sum = sum + FMV_hist[i];
	for(i=0;i<FMV_Hist_Bin_Num;i++)
		FMV_hist_ratio[i] = FMV_hist[i]*1000/sum;
	sum = 1;
	for(i=0;i<HMC_Hist_Bin_Num;i++)
		sum = sum + HMC_bin_hist[i];
	for(i=0;i<HMC_Hist_Bin_Num;i++)
		HMC_bin_hist_ratio[i] = HMC_bin_hist[i]*1000/sum;

#if 1
	unsigned int printf_Flag = system_info_structure_table->ISR_Printf_Flag.FMC_HMC_Flag0;
	unsigned int print_delay = (system_info_structure_table->ISR_Printf_Flag.Delay_Time == 0)?(1):(system_info_structure_table->ISR_Printf_Flag.Delay_Time);
	//for debug.
	if(((printf_Flag&_BIT0)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("FMV HMC cal, FMV={");
			for(i=0;i<FMV_Hist_Bin_Num;i++)
				printk("%d,", SmartPic_clue->FMV_hist_Ratio[i]);
			printk("}\n");
		}
	}
	if(((printf_Flag&_BIT1)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("FMV HMC cal, HMC={");
			for(i=0;i<FMV_Hist_Bin_Num;i++)
				printk("%d,", SmartPic_clue->HMC_bin_hist_Ratio[i]);
			printk("}\n");
		}
	}

#endif

}

#ifdef ISR_NR_IMPULSE_FUNCTIOM_ENABLE
//RenChen sync from L3300
void drvif_color_noisereduction_impulse(unsigned char channel, unsigned char level, unsigned char bNoiseReductionMode)
{
	unsigned char impulse_check[1];
	unsigned char i, impulse_check_count=0,check_loop_count=0;

	nr_dch1_cp_ctrl_RBUS dch1_CP_Ctrl_reg;
	dch1_CP_Ctrl_reg.regValue = scaler_rtd_inl(NR_DCH1_CP_Ctrl_reg);
	 if(level==0)
	 {
	 	dch1_CP_Ctrl_reg.cp_impulseenable = 0x0;
	 }
    	else
    	{
		dch1_CP_Ctrl_reg.cp_impulseenable = 0x1;//enable impulse NR
    	}
	scaler_rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_CP_Ctrl_reg.regValue);


	impulse_check[0] = dch1_CP_Ctrl_reg.cp_impulseenable;
	//=========for check double buffer write error=================================
	do{
		BusyCheckRegBit(VGIP_VGIP_CHN1_STATUS_reg, _BIT26,0x0001FFFF);//frank@0430 change wait vsync start
		//WaitFor_IEN_STOP1();

		dch1_CP_Ctrl_reg.regValue = scaler_rtd_inl(NR_DCH1_CP_Ctrl_reg);
		impulse_check_count = 0;
		check_loop_count++;

		for(i=0;i<1;i++)
		{
			switch(i)
			{
				case 0:
					if(impulse_check[0] == dch1_CP_Ctrl_reg.cp_impulseenable)
						impulse_check_count++;
					else
					{
						dch1_CP_Ctrl_reg.cp_impulseenable=impulse_check[0];
					}
					break;
				default:
					break;
			}

		}

		if(impulse_check_count<1)
		{

			scaler_rtd_outl(NR_DCH1_CP_Ctrl_reg, dch1_CP_Ctrl_reg.regValue);
		}
		else
			printf("cp_impulseenable reg write setting [OK]\n");

	}while(impulse_check_count<1 && check_loop_count<6 );
	//=================================================================
}
#endif

//Main function END

#if 0
// Hawaii add for Edge Peaking 20131022
unsigned int drvif_color_2parts_linear_interpolation(unsigned int min, unsigned int max, unsigned int middle ,unsigned int OSD_sharp_level)  //OSD_sharp_level=0~100
{
	unsigned int data;

	if(OSD_sharp_level<=50)
	{
		data = (unsigned int)(min+(middle-min)*OSD_sharp_level/50);
	}
	else
	{
		data = (unsigned int)(middle+(max-middle)*(OSD_sharp_level-50)/50);

	}
	return data;

}
// Hawaii add for Edge Peaking 20131022
int check_range(int data, int min, int max)
{
	if (data < min) data = min;
	if (data > max) data = max;
	return data;
}

void scalerVIP_RTNR_K_force(void)
{
	if(RTNR_K_force_level != 0)
	{
		di_im_di_rtnr_k_force_modify_RBUS im_di_rtnr_k_force_modify_reg;
		im_di_rtnr_k_force_modify_reg.regValue = rtd_inl(DI_IM_DI_RTNR_K_FORCE_MODIFY_reg);
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_00 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_01 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_02 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_03 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_04 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_10 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_11 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_12 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_13 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_14 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_20 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_21 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_22 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_23 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_0_24 = 1;
		im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_offset = RTNR_K_force_offset;
		if(MA_print_count%RTNR_K_force_level == 0)
		{
			im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_en_y = 1;
		}
		else
		{
			im_di_rtnr_k_force_modify_reg.cp_rtnr_k_force_modify_en_y = 0;
		}
		rtd_outl(DI_IM_DI_RTNR_K_FORCE_MODIFY_reg, im_di_rtnr_k_force_modify_reg.regValue);
	}
}
#endif


//Elsie 20131025: move from AP
INT32* sRGB_Hue_Sat_Table;
void scalerVIP_sRGB_Hue_Sat_Table(unsigned long arg)
{
	sRGB_Hue_Sat_Table = (INT32*)arg;
}

unsigned int* pGamma_Table=NULL;
void scalerVIP_Set_Gamma_Table(unsigned int arg)
{
	pGamma_Table = (unsigned int*)arg;
}

#if 0
void scalerVIP_sRGB_HueSat_Write(void)
{
	srgb_srgb_ctrl_RBUS  SRGB_ctrl_reg;
	srgb_srgb_access_ctrl_RBUS  SRGB_access_ctrl_reg;
	srgb_srgb_access_port_RBUS	 SRGB_access_port_reg;
	signed short ii, jj, kk, mm;
	signed short index_gain[2];

	if(sRGB_Hue_Sat_Table)
	{
		for(mm = 0; mm < 3; mm++)
		{
			// channel switch  SRGB_ACCESS_CTRL_reg
			SRGB_access_ctrl_reg.regValue=rtd_inl(SRGB_SRGB_ACCESS_CTRL_reg);
			switch(mm)
			{
				case 0:  // start with RR, GR, BR channels
					SRGB_access_ctrl_reg.srgb_rgb_sel=1;
					break;
				case 1:  // start with RG, GG, BG channels
					SRGB_access_ctrl_reg.srgb_rgb_sel=2;
					break;
				case 2:  // start with RB, GB, BB channels
					SRGB_access_ctrl_reg.srgb_rgb_sel=3;
					break;
			}
			rtd_outl(SRGB_SRGB_ACCESS_CTRL_reg, SRGB_access_ctrl_reg.regValue);

			for (ii =0; ii < 32; ii++)
			{
				wait_for_sRGB_fifo_empty_isr();
				for(jj = mm*3; jj < (mm*3 + 3); jj++)
				{
					index_gain[0] = *(sRGB_Hue_Sat_Table+jj*33+ii);// & 0xfff00 ; // RR GR BR RG GG BG RB GB BB
					kk = *(sRGB_Hue_Sat_Table+jj*33+ii+1) - *(sRGB_Hue_Sat_Table+jj*33+ii); // grid distance  = 256 (8-bit), gain = >> 8  << 5
					index_gain[1] = kk >>2; // 3 -> 2 fix bit error by March 20090629;
					index_gain[1]&=0x3ff;

					// write fifo  SRGB_ACCESS_PORT_reg
					SRGB_access_port_reg.srgb_index=index_gain[0];
					SRGB_access_port_reg.srgb_gain=index_gain[1];
					//RTD_Log(LOGGER_INFO,"sRGB =============%x\n",SRGB_access_port_reg.regValue);
					rtd_outl(SRGB_SRGB_ACCESS_PORT_reg, SRGB_access_port_reg.regValue);
				}
			}
		}

		// close table access
		SRGB_access_ctrl_reg.regValue=rtd_inl(SRGB_SRGB_ACCESS_CTRL_reg);
		SRGB_access_ctrl_reg.srgb_rgb_sel=0;
		rtd_outl(SRGB_SRGB_ACCESS_CTRL_reg, SRGB_access_ctrl_reg.regValue);

	 	 // enable sRGB  SRGB_CTRL_reg
		SRGB_ctrl_reg.regValue=rtd_inl(SRGB_SRGB_CTRL_reg);
		 // main always tab-1
		SRGB_ctrl_reg.srgb_m_tab_sel=1;
		rtd_outl(SRGB_SRGB_CTRL_reg, SRGB_ctrl_reg.regValue);

		sRGB_Hue_Sat_Table = NULL;
	}
}
#else
void scalerVIP_sRGB_HueSat_Write(void)
{
	srgb_srgb_ctrl_RBUS  SRGB_ctrl_reg;
	srgb_srgb_access_ctrl_RBUS  SRGB_access_ctrl_reg;
	srgb_srgb_access_port_RBUS	 SRGB_access_port_reg;
	signed short ii, jj, kk, mm;
	signed short index_gain[2];

	if(sRGB_Hue_Sat_Table && pGamma_Table == NULL)
	{
		 // disable sRGB  and tab_size = 64
		  SRGB_ctrl_reg.regValue=rtd_inl(SRGB_sRGB_CTRL_reg);
		 //Elsie 20140724: table size has been fixed to 128
		 // SRGB_ctrl_reg.srgb_tab_size_sel=0; // [0] tab_size=128; [1] tab_size=64;//jyyang20161215
		  SRGB_ctrl_reg.srgb_m_tab_sel=0; // disable sRGB
		//  SRGB_ctrl_reg.srgb_s_tab_sel=0; //20150917 roger, set the same setting to sub, for LGE zoom function//jyyang20161215
		  rtd_outl(SRGB_sRGB_CTRL_reg, SRGB_ctrl_reg.regValue);

		for(mm = 0; mm < 3; mm++)
		{
			// channel switch  SRGB_ACCESS_CTRL_reg
			SRGB_access_ctrl_reg.regValue=rtd_inl(SRGB_sRGB_Access_CTRL_reg);
			switch(mm)
			{
				case 0:  // start with RR, GR, BR channels
					SRGB_access_ctrl_reg.srgb_rgb_sel=1;
					break;
				case 1:  // start with RG, GG, BG channels
					SRGB_access_ctrl_reg.srgb_rgb_sel=2;
					break;
				case 2:  // start with RB, GB, BB channels
					SRGB_access_ctrl_reg.srgb_rgb_sel=3;
					break;
			}
			//SRGB_access_ctrl_reg.srgb_tab_sel=0; // write in table1//jyyang20161215
			rtd_outl(SRGB_sRGB_Access_CTRL_reg, SRGB_access_ctrl_reg.regValue);

			for (ii =0; ii < 128; ii++)
			{
				#if 0 //jyyang20161215
				if(ii == 64)
				{
					SRGB_access_ctrl_reg.regValue = rtd_inl(SRGB_sRGB_Access_CTRL_reg);
					SRGB_access_ctrl_reg.srgb_tab_sel=1; // write in table2
					rtd_outl(SRGB_sRGB_Access_CTRL_reg, SRGB_access_ctrl_reg.regValue);
				}
				#endif
				wait_for_sRGB_fifo_empty_isr();
				for(jj = mm*3; jj < (mm*3 + 3); jj++)
				{
					index_gain[0] = *(sRGB_Hue_Sat_Table+jj*129+ii);// & 0xfff00 ; // RR GR BR RG GG BG RB GB BB
					kk = *(sRGB_Hue_Sat_Table+jj*129+ii+1) - *(sRGB_Hue_Sat_Table+jj*129+ii); // grid distance  = 256 (8-bit), gain = >> 8  << 5
					index_gain[1] = kk >>2; // 3 -> 2 fix bit error by March 20090629;
					index_gain[1]&=0x3ff;

					// write fifo  SRGB_ACCESS_PORT_reg
					SRGB_access_port_reg.srgb_index=index_gain[0];
					SRGB_access_port_reg.srgb_gain=index_gain[1];
					//RTD_Log(LOGGER_INFO,"sRGB =============%x\n",SRGB_access_port_reg.regValue);
					rtd_outl(SRGB_sRGB_ACCESS_PORT_reg, SRGB_access_port_reg.regValue);
				}
			}
			wait_for_sRGB_fifo_empty_isr();
		}

		// close table access
		SRGB_access_ctrl_reg.regValue=rtd_inl(SRGB_sRGB_Access_CTRL_reg);
		SRGB_access_ctrl_reg.srgb_rgb_sel=0;
		rtd_outl(SRGB_sRGB_Access_CTRL_reg, SRGB_access_ctrl_reg.regValue);

	 	 // enable sRGB  SRGB_CTRL_reg
		SRGB_ctrl_reg.regValue=rtd_inl(SRGB_sRGB_CTRL_reg);
		//SRGB_ctrl_reg.srgb_tab_size_sel=0; // [0] tab_size=128; [1] tab_size=64; //jyyang20161215
		SRGB_ctrl_reg.srgb_m_tab_sel=1; // main always tab-1
		//SRGB_ctrl_reg.srgb_s_tab_sel=1; //20150917 roger, set the same setting to sub, for LGE zoom function //jyyang20161215
		rtd_outl(SRGB_sRGB_CTRL_reg, SRGB_ctrl_reg.regValue);

		sRGB_Hue_Sat_Table = NULL;
		/*
		if(MA_print_count%360==0)
 		{
			ROSPrintf("scalerVIP_sRGB_HueSat_Write End\n");
		}
		*/
	}


}

#endif
#if 0
void drvif_color_colorwritegamma_isr(unsigned int *pArray)
{
#ifdef TEST_SKIP_WRITE_GAMMA
	return;
#endif
	/*VIPprintf("gamma start ===================\n");*/
	unsigned short ii, cnt = 10000;
	gamma_gamma_port_RBUS gamma_port_REG;
	gamma_gamma_ctrl_1_RBUS gamma_ctrl_1_REG;
	unsigned char status = 1;

	/*Thur modified for compile 20090113*/
	/*BusyCheckRegBit(DDOMAIN_MAIN_DISPLAY_CONTROL_RSV_reg,_BIT10, 0x0001FFFF);*/
	/*frank@0902 mark to speed code */ /*BusyCheckRegBit(PPOVERLAY_Main_Display_Control_RSV_reg,_BIT10, 0x0001FFFF);*/
	/*ROS_ENTER_CRITICAL();*/

	/*rtdf_clearBits(GAMMA_GAMMA_CTRL_1_reg, _BIT6);*/
	gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
	/*gamma_ctrl_1_REG.gamma_ax_tab_sel = 0;*/ /* write table1 [jyyang@ Mac3] only main channel and one 512 table*/
	rtd_outl(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);

	for (ii = 0; ii < 512; ii++) { /* Num of index: Mac2 = 128, Sirius = 512 (jyyang_2013/12/25)*/

		#if 0
		if (ii == 256) {
			gamma_ctrl_1_REG.regValue = IoReg_Read32(GAMMA_GAMMA_CTRL_1_reg);
			gamma_ctrl_1_REG.gamma_ax_tab_sel = 1;/* write table2*/
			IoReg_Write32(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
		} /*[jyyang@ Mac3] only main channel and one 512 table*/
		#endif
		status = 1;
		cnt = 10000;
		/*
		gamma_port_REG.index 	= (pArray[ii*3] << 2) + ((pArray[ii*3 + 1] >> 6)&0x03);
		gamma_port_REG.d0 		= pArray[ii*3 + 1]&0x1f;
		gamma_port_REG.d1 		= pArray[ii*3 + 2]&0x1f;
		*/
		gamma_port_REG.regValue = pArray[ii];
		/*if (ii % 31 == 0)*/
			/*VIPprintf("GAMMA[%d] = 0x%x\n", ii, pArray[ii]);*/
		rtd_outl(GAMMA_GAMMA_PORT_reg, gamma_port_REG.regValue);

		while ((cnt--) && (status) && ((ii % 16) == 15)) { /*20071217 jason(jeffery) modified*/

			gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
			status =  (gamma_ctrl_1_REG.gamma_fifo_empty == 1) ? 0 : 1;
		}
	}
	/*VIPprintf("gamma end ===================\n");*/
	/*ROS_EXIT_CRITICAL();*/

}
#else
void drvif_color_colorwritegamma_isr(unsigned int *pArray , VIP_GAMMA_CHANNEL_RGB_ISR Channel)
{

#if 0 //off line write
	/*VIPprintf("gamma start ===================\n");*/
	unsigned short ii, cnt = 10000;
	gamma_gamma_port_RBUS gamma_port_REG;
	gamma_gamma_ctrl_1_RBUS gamma_ctrl_1_REG;
	gamma_gamma_ctrl_2_RBUS gamma_ctrl_2_REG;

	unsigned char status = 1;

	unsigned int p0, p1, p;
	unsigned int index0, index1;
	unsigned int delta0, delta1;

	gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
	gamma_ctrl_2_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_2_reg);

	gamma_ctrl_1_REG.gamma_ax_rw_sel = 1; //1= writing 0:read
	gamma_ctrl_1_REG.gamma_ax_tab_sel = 0; // 0 = select table1

	gamma_ctrl_2_REG.gamma_m_tab_sel = 0;  // 0:disable gamma 1:table1 2: table2
	gamma_ctrl_2_REG.gamma_tab_size_sel = 1;  // 0:table size 512 1:table:size 256

	gamma_ctrl_1_REG.gamma_ax_ch_sel = Channel;



	rtd_outl(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
	rtd_outl(GAMMA_GAMMA_CTRL_2_reg, gamma_ctrl_2_REG.regValue);


	for (ii = 0; ii < 512; ii+=2) { /* Num of index: Mac2 = 128, Sirius = 512 (jyyang_2013/12/25)*/

		#if 0
		if (ii == 256) {
			gamma_ctrl_1_REG.regValue = IoReg_Read32(GAMMA_GAMMA_CTRL_1_reg);
			gamma_ctrl_1_REG.gamma_ax_tab_sel = 1;/* write table2*/
			IoReg_Write32(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
		} /*[jyyang@ Mac3] only main channel and one 512 table*/
		#endif
		status = 1;
		cnt = 10000;
		/*
		gamma_port_REG.index 	= (pArray[ii*3] << 2) + ((pArray[ii*3 + 1] >> 6)&0x03);
		gamma_port_REG.d0 		= pArray[ii*3 + 1]&0x1f;
		gamma_port_REG.d1 		= pArray[ii*3 + 2]&0x1f;
		*/
		p0 = pArray[ii];
		p1 = pArray[ii+1];
		index0 = p0>>16;
		delta0 = ((p0>>8)+p0)&0xff;
		index1 = p1>>16;
		delta1 = ((p1>>8)+p1)&0xff;
		p = ((index0)<<16) + ((delta0&0xff)<<8 )+ (delta1&0xff);
		gamma_port_REG.regValue = p;
		/*if (ii % 31 == 0)*/
			/*VIPprintf("GAMMA[%d] = 0x%x\n", ii, pArray[ii]);*/
		rtd_outl(GAMMA_GAMMA_PORT_reg, gamma_port_REG.regValue);

		while ((cnt--) && (status) && ((ii % 16) == 15)) { /*20071217 jason(jeffery) modified*/

			gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
			status =  (gamma_ctrl_1_REG.gamma_fifo_empty == 1) ? 0 : 1;
		}
	}

	gamma_ctrl_1_REG.gamma_ax_rw_sel = 0; /* writing table*/
	gamma_ctrl_2_REG.gamma_m_tab_sel = 1; /* use tab-1*/


	rtd_outl(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
	rtd_outl(GAMMA_GAMMA_CTRL_2_reg, gamma_ctrl_2_REG.regValue);


	/*VIPprintf("gamma end ===================\n");*/
	/*ROS_EXIT_CRITICAL();*/
#elif 0 // on line write /half

/*VIPprintf("gamma start ===================\n");*/
unsigned short ii, cnt = 10000;
gamma_gamma_port_RBUS gamma_port_REG;
gamma_gamma_ctrl_1_RBUS gamma_ctrl_1_REG;
gamma_gamma_ctrl_2_RBUS gamma_ctrl_2_REG;

unsigned char status = 1;
unsigned char status2 = 1; // fifo_full

unsigned int p0, p1, p;
unsigned int index0, index1;
unsigned int delta0, delta1;


while ((cnt--) && (status)&& (status2)) { /*20071217 jason(jeffery) modified*/

	gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
	status =  (gamma_ctrl_1_REG.gamma_fifo_empty == 1) ? 0 : 1;
	status2 =  (gamma_ctrl_1_REG.gamma_fifo_full == 0) ? 0 : 1;
}


gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
gamma_ctrl_2_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_2_reg);

gamma_ctrl_1_REG.gamma_ax_rw_sel = 1; //1= writing 0:read
gamma_ctrl_1_REG.gamma_ax_tab_sel = 0; // 0 = select table1

gamma_ctrl_2_REG.gamma_m_tab_sel = 1;  // 0:disable gamma 1:table1 2: table2
gamma_ctrl_2_REG.gamma_tab_size_sel = 1;  // 0:table size 512 1:table:size 256

gamma_ctrl_1_REG.gamma_ax_ch_sel = Channel;



rtd_outl(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
rtd_outl(GAMMA_GAMMA_CTRL_2_reg, gamma_ctrl_2_REG.regValue);


for (ii = 0; ii < 512; ii+=2) { /* Num of index: Mac2 = 128, Sirius = 512 (jyyang_2013/12/25)*/

	#if 0
	if (ii == 256) {
		gamma_ctrl_1_REG.regValue = IoReg_Read32(GAMMA_GAMMA_CTRL_1_reg);
		gamma_ctrl_1_REG.gamma_ax_tab_sel = 1;/* write table2*/
		IoReg_Write32(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
	} /*[jyyang@ Mac3] only main channel and one 512 table*/
	#endif
	status = 1;
	cnt = 10000;
	/*
	gamma_port_REG.index	= (pArray[ii*3] << 2) + ((pArray[ii*3 + 1] >> 6)&0x03);
	gamma_port_REG.d0		= pArray[ii*3 + 1]&0x1f;
	gamma_port_REG.d1		= pArray[ii*3 + 2]&0x1f;
	*/
	p0 = pArray[ii];
	p1 = pArray[ii+1];
	index0 = p0>>16;
	delta0 = ((p0>>8)+p0)&0xff;
	index1 = p1>>16;
	delta1 = ((p1>>8)+p1)&0xff;
	p = ((index0)<<16) + ((delta0&0xff)<<8 )+ (delta1&0xff);
	gamma_port_REG.regValue = p;
	/*if (ii % 31 == 0)*/
		/*VIPprintf("GAMMA[%d] = 0x%x\n", ii, pArray[ii]);*/
	rtd_outl(GAMMA_GAMMA_PORT_reg, gamma_port_REG.regValue);
	status =1;
	status2 =1;

	while ((cnt--) && (status)&& (status2) && ((ii % 32) == 30)) { /*20071217 jason(jeffery) modified*/

		gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
		status =  (gamma_ctrl_1_REG.gamma_fifo_empty == 1) ? 0 : 1;
		status2 =  (gamma_ctrl_1_REG.gamma_fifo_full == 0) ? 0 : 1;
	}
}

gamma_ctrl_1_REG.gamma_ax_rw_sel = 0; /* writing table*/
gamma_ctrl_2_REG.gamma_m_tab_sel = 1; /* use tab-1*/


rtd_outl(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
rtd_outl(GAMMA_GAMMA_CTRL_2_reg, gamma_ctrl_2_REG.regValue);


/*VIPprintf("gamma end ===================\n");*/
/*ROS_EXIT_CRITICAL();*/

#else
/*VIPprintf("gamma start ===================\n");*/
unsigned short ii, cnt = 10000;
gamma_gamma_port_RBUS gamma_port_REG;
gamma_gamma_ctrl_1_RBUS gamma_ctrl_1_REG;
gamma_gamma_ctrl_2_RBUS gamma_ctrl_2_REG;

unsigned char status = 1;
//unsigned char status2 = 1; // fifo_full

//unsigned int p0, p1, p;
//unsigned int index0, index1;
//unsigned int delta0, delta1;

#if 0
while ((cnt--) && (status)&& (status2)) { /*20071217 jason(jeffery) modified*/

	gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
	status =  (gamma_ctrl_1_REG.gamma_fifo_empty == 1) ? 0 : 1;
	status2 =  (gamma_ctrl_1_REG.gamma_fifo_full == 0) ? 0 : 1;
}
#endif

gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
gamma_ctrl_2_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_2_reg);

gamma_ctrl_1_REG.gamma_ax_rw_sel = 1; //1= writing 0:read
//gamma_ctrl_1_REG.gamma_ax_tab_sel = 0; // 0 = select table1 //jyyang20161215

gamma_ctrl_2_REG.gamma_m_tab_sel = 1;  // 0:disable gamma 1:table1 2: table2
//gamma_ctrl_2_REG.gamma_tab_size_sel = 0;  // 0:table size 512 1:table:size 256//jyyang20161215

gamma_ctrl_1_REG.gamma_ax_ch_sel = Channel;



rtd_outl(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
rtd_outl(GAMMA_GAMMA_CTRL_2_reg, gamma_ctrl_2_REG.regValue);


for (ii = 0; ii < 512; ii++) { /* Num of index: Mac2 = 128, Sirius = 512 (jyyang_2013/12/25)*/

	#if 0
	if (ii == 256) {
		gamma_ctrl_1_REG.regValue = IoReg_Read32(GAMMA_GAMMA_CTRL_1_reg);
		gamma_ctrl_1_REG.gamma_ax_tab_sel = 1;/* write table2*/
		IoReg_Write32(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
	} /*[jyyang@ Mac3] only main channel and one 512 table*/
	#endif
	status = 1;
	cnt = 10000;
	/*
	gamma_port_REG.index 	= (pArray[ii*3] << 2) + ((pArray[ii*3 + 1] >> 6)&0x03);
	gamma_port_REG.d0 		= pArray[ii*3 + 1]&0x1f;
	gamma_port_REG.d1 		= pArray[ii*3 + 2]&0x1f;
	*/
	gamma_port_REG.regValue = pArray[ii];
	/*if (ii % 31 == 0)*/
		/*VIPprintf("GAMMA[%d] = 0x%x\n", ii, pArray[ii]);*/
	rtd_outl(GAMMA_GAMMA_PORT_reg, gamma_port_REG.regValue);

	while ((cnt--) && (status) && ((ii % 16) == 15)) { /*20071217 jason(jeffery) modified*/

		gamma_ctrl_1_REG.regValue = rtd_inl(GAMMA_GAMMA_CTRL_1_reg);
		status =  (gamma_ctrl_1_REG.gamma_fifo_empty == 1) ? 0 : 1;
	}
}

gamma_ctrl_1_REG.gamma_ax_rw_sel = 0; /* writing table*/
gamma_ctrl_2_REG.gamma_m_tab_sel = 1; /* use tab-1*/


rtd_outl(GAMMA_GAMMA_CTRL_1_reg, gamma_ctrl_1_REG.regValue);
rtd_outl(GAMMA_GAMMA_CTRL_2_reg, gamma_ctrl_2_REG.regValue);


/*VIPprintf("gamma end ===================\n");*/
/*ROS_EXIT_CRITICAL();*/






#endif
}
#endif



void fwif_color_set_gamma_encode_isr(unsigned int *final_GAMMA_R, unsigned int *final_GAMMA_G, unsigned int *final_GAMMA_B)
{
	drvif_color_colorwritegamma_isr(final_GAMMA_G, GAMMA_CHANNEL_G_ISR);	/*G*/
	drvif_color_colorwritegamma_isr(final_GAMMA_R, GAMMA_CHANNEL_R_ISR);	/*R*/
	drvif_color_colorwritegamma_isr(final_GAMMA_B, GAMMA_CHANNEL_B_ISR);	/*B*/
}


void scalerVIP_Gamma_Table_Write(void)
{

//unsigned int xx=0;

//scaleup_d_uzu_globle_ctrl_RBUS d_uzu_Globle_Ctrl_reg;

//system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

//unsigned int printf_Flag=0,print_delay=0;
//printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
//print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;


//color_dcc_d_dcc_fwused_2_RBUS  d_dcc_fwused_2_reg;
//color_dcc_d_dcc_fwused_3_RBUS  d_dcc_fwused_3_reg;

//d_dcc_fwused_2_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_2_reg);
//d_dcc_fwused_3_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_3_reg);


//if(d_dcc_fwused_2_reg.regValue==0x81)

//{
//	d_uzu_Globle_Ctrl_reg.regValue = rtd_inl(SCALEUP_D_UZU_GLOBLE_CTRL_reg);
//	d_uzu_Globle_Ctrl_reg.patgen_sel =0;

//	rtd_outl(SCALEUP_D_UZU_GLOBLE_CTRL_reg, d_uzu_Globle_Ctrl_reg.regValue);

//}

//if(d_dcc_fwused_2_reg.regValue==0x83)
//{
//	d_uzu_Globle_Ctrl_reg.regValue = rtd_inl(SCALEUP_D_UZU_GLOBLE_CTRL_reg);
//	d_uzu_Globle_Ctrl_reg.patgen_sel =3;

//	rtd_outl(SCALEUP_D_UZU_GLOBLE_CTRL_reg, d_uzu_Globle_Ctrl_reg.regValue);

//}



//new_meas1_linecnt_real_Reg.regValue=IoReg_Read32(PPOVERLAY_new_meas1_linecnt_real_reg);
//precnt=new_meas1_linecnt_real_Reg.memcdtg_line_cnt_rt;



//new_meas1_linecnt_real_Reg.regValue=IoReg_Read32(PPOVERLAY_new_meas1_linecnt_real_reg);
//postcnt=new_meas1_linecnt_real_Reg.memcdtg_line_cnt_rt;

//postcnt = IoReg_Read32(0xb801b6a8);






#if 1
	if(pGamma_Table)
	{
		unsigned int* pGamma_Table_tmp = pGamma_Table;
		pGamma_Table = NULL;
		//static unsigned char ss=0;
		//ss++;
		//xx = rtd_inl(0xb802ac00);
		//rtd_outl(0xb802ac00,xx&0xFFFE);
		//inv_gamma_inv_gamma_ctrl_2_RBUS inv_gamma_ctrl_2_REG;

		//inv_gamma_ctrl_2_REG.regValue = rtd_inl(INV_GAMMA_INV_GAMMA_CTRL_2_reg);

		//if(ss%2==0)
		//inv_gamma_ctrl_2_REG.inv_gamma_m_tab_sel = 0; /* use tab-1*/
		//else
		///inv_gamma_ctrl_2_REG.inv_gamma_m_tab_sel = 1; /* use tab-1*/

		//rtd_outl(INV_GAMMA_INV_GAMMA_CTRL_2_reg, inv_gamma_ctrl_2_REG.regValue);

		fwif_color_set_gamma_encode_isr(pGamma_Table_tmp, pGamma_Table_tmp+512, pGamma_Table_tmp+1024);
		//rtd_outl(0xb802ac00,xx|0x1);




	}
#else

if(pGamma_Table)
{
	unsigned int* pGamma_Table_tmp = pGamma_Table;

	drvif_color_gamma_control_front(SLR_MAIN_DISPLAY);
	//fwif_color_set_gamma_encode_isr(pGamma_Table_tmp, pGamma_Table_tmp+512, pGamma_Table_tmp+1024);
	static unsigned char temp=0;
	if(temp==0)
	{
		fwif_color_Gamma_Curve_Write(pGamma_Table_tmp, GAMMA_CHANNEL_R);	/*R*/
	 	temp=1;

	}
	else if (temp==1)
	{
		fwif_color_Gamma_Curve_Write(pGamma_Table_tmp+512, GAMMA_CHANNEL_G);	/*G*/
		temp=2;

	}
	else if(temp==2)
	{
		fwif_color_Gamma_Curve_Write(pGamma_Table_tmp+1024, GAMMA_CHANNEL_B);	/*B*/

		temp=0;
		pGamma_Table = NULL;

	}



	drvif_color_gamma_control_back(SLR_MAIN_DISPLAY,1);

}


#endif

}

void wait_for_sRGB_fifo_empty_isr(void)
{
	srgb_srgb_access_ctrl_RBUS  SRGB_access_ctrl_reg;
	signed short fifo_count = 5000;
	unsigned char status = 1;

	do
	{
		SRGB_access_ctrl_reg.regValue=rtd_inl(SRGB_sRGB_Access_CTRL_reg);
		if(SRGB_access_ctrl_reg.srgb_fifo_empty== 1)
			status = 0;
		else
			fifo_count --;
	}

	while((fifo_count > 0)&&(status));
	if(status)
		ROSPrintf("sRGB Control write fifo error\n");
}
#if 0 //VIP_100_4 project
void scalerVIP_100_4_Bright_Plus(void)
{
	//if(Scaler_GetAutoMA(BP_EN) == 0)
		//return;

	if(COEFF_BY_Y_REG==NULL)
		return;

	unsigned int debug_tmp = rtd_inl(COLOR_DCC_DS_INTERP_DATA_70_reg);

	if((((debug_tmp&_BIT0)>>0)==1) && (((debug_tmp&_BIT1)>>1)==1))
		return;

	unsigned char i = 0, j = 0, k = 0;
	unsigned char APL = 0;
//	unsigned char cur_Gain_Value = 100;
	unsigned char G1 = 108;
	unsigned char G2 = 100;
	unsigned char P1 = 40;
	unsigned char P2 = 150;
	unsigned char Max_Bright_bin= 32;
//	unsigned char pre_Gain_Value = Scaler_GetAutoMA(pre_BP_Gain_Value);

	unsigned int coef_tmp[YUV2RGB_COEF_BY_Y_Seg_Num][3][3];
	unsigned char com_flag[YUV2RGB_COEF_BY_Y_Seg_Num][3][3];

	if((((debug_tmp&_BIT0)>>0)==1))
	{
		G1 = (debug_tmp&0xff00)>>8;
	}


	unsigned int Gain_Value = 100;
	unsigned int DC_average = 0;
	unsigned int Total_HistCnt = 0;

	d_yuv2rgb_control_1_RBUS d_yuv2rgb_control_1_reg;
	d_yuv2rgb_control_1_reg.regValue = rtd_inl(YUV2RGB_D_YUV2RGB_CONTROL_1_reg);
	d_yuv2rgb_control_1_reg.yuv2rgb_double_buffer_en=1;
	rtd_outl(YUV2RGB_D_YUV2RGB_CONTROL_1_reg, d_yuv2rgb_control_1_reg.regValue);

#if 1	//lsie 20131126: FIXME
	d_yuv2rgb_tab1_data_0_RBUS d_yuv2rgb_tab1_data_0_REG;
	d_yuv2rgb_tab1_data_1_RBUS d_yuv2rgb_tab1_data_1_REG;
	d_yuv2rgb_tab1_data_2_RBUS d_yuv2rgb_tab1_data_2_REG;
	d_yuv2rgb_tab1_data_3_RBUS d_yuv2rgb_tab1_data_3_REG;

	//////////////////////// Coef by Y registers ////////////////////////
	d_yuv2rgbbyy_tab_data_1_0_RBUS d_yuv2rgbbyy_tab_data_1_0_REG;
	d_yuv2rgbbyy_tab_data_1_1_RBUS d_yuv2rgbbyy_tab_data_1_1_REG;
	d_yuv2rgbbyy_tab_data_1_2_RBUS d_yuv2rgbbyy_tab_data_1_2_REG;
	d_yuv2rgbbyy_tab_data_1_3_RBUS d_yuv2rgbbyy_tab_data_1_3_REG;
	d_yuv2rgbbyy_tab_data_2_0_RBUS d_yuv2rgbbyy_tab_data_2_0_REG;
	d_yuv2rgbbyy_tab_data_2_1_RBUS d_yuv2rgbbyy_tab_data_2_1_REG;
	d_yuv2rgbbyy_tab_data_2_2_RBUS d_yuv2rgbbyy_tab_data_2_2_REG;
	d_yuv2rgbbyy_tab_data_2_3_RBUS d_yuv2rgbbyy_tab_data_2_3_REG;
	d_yuv2rgbbyy_tab_data_3_0_RBUS d_yuv2rgbbyy_tab_data_3_0_REG;
	d_yuv2rgbbyy_tab_data_3_1_RBUS d_yuv2rgbbyy_tab_data_3_1_REG;
	d_yuv2rgbbyy_tab_data_3_2_RBUS d_yuv2rgbbyy_tab_data_3_2_REG;
	d_yuv2rgbbyy_tab_data_3_3_RBUS d_yuv2rgbbyy_tab_data_3_3_REG;
	d_yuv2rgbbyy_tab_data_4_0_RBUS d_yuv2rgbbyy_tab_data_4_0_REG;
	d_yuv2rgbbyy_tab_data_4_1_RBUS d_yuv2rgbbyy_tab_data_4_1_REG;
	d_yuv2rgbbyy_tab_data_4_2_RBUS d_yuv2rgbbyy_tab_data_4_2_REG;
	d_yuv2rgbbyy_tab_data_4_3_RBUS d_yuv2rgbbyy_tab_data_4_3_REG;
	d_yuv2rgbbyy_tab_data_5_0_RBUS d_yuv2rgbbyy_tab_data_5_0_REG;
	d_yuv2rgbbyy_tab_data_5_1_RBUS d_yuv2rgbbyy_tab_data_5_1_REG;
	d_yuv2rgbbyy_tab_data_5_2_RBUS d_yuv2rgbbyy_tab_data_5_2_REG;
	d_yuv2rgbbyy_tab_data_5_3_RBUS d_yuv2rgbbyy_tab_data_5_3_REG;
	d_yuv2rgbbyy_tab_data_6_0_RBUS d_yuv2rgbbyy_tab_data_6_0_REG;
	d_yuv2rgbbyy_tab_data_6_1_RBUS d_yuv2rgbbyy_tab_data_6_1_REG;
	d_yuv2rgbbyy_tab_data_6_2_RBUS d_yuv2rgbbyy_tab_data_6_2_REG;
	d_yuv2rgbbyy_tab_data_6_3_RBUS d_yuv2rgbbyy_tab_data_6_3_REG;
	d_yuv2rgbbyy_tab_data_7_0_RBUS d_yuv2rgbbyy_tab_data_7_0_REG;
	d_yuv2rgbbyy_tab_data_7_1_RBUS d_yuv2rgbbyy_tab_data_7_1_REG;
	d_yuv2rgbbyy_tab_data_7_2_RBUS d_yuv2rgbbyy_tab_data_7_2_REG;
	d_yuv2rgbbyy_tab_data_7_3_RBUS d_yuv2rgbbyy_tab_data_7_3_REG;
	d_yuv2rgbbyy_tab_data_8_0_RBUS d_yuv2rgbbyy_tab_data_8_0_REG;
	d_yuv2rgbbyy_tab_data_8_1_RBUS d_yuv2rgbbyy_tab_data_8_1_REG;
	d_yuv2rgbbyy_tab_data_8_2_RBUS d_yuv2rgbbyy_tab_data_8_2_REG;
	d_yuv2rgbbyy_tab_data_8_3_RBUS d_yuv2rgbbyy_tab_data_8_3_REG;
	d_yuv2rgbbyy_tab_data_9_0_RBUS d_yuv2rgbbyy_tab_data_9_0_REG;
	d_yuv2rgbbyy_tab_data_9_1_RBUS d_yuv2rgbbyy_tab_data_9_1_REG;
	d_yuv2rgbbyy_tab_data_9_2_RBUS d_yuv2rgbbyy_tab_data_9_2_REG;
	d_yuv2rgbbyy_tab_data_9_3_RBUS d_yuv2rgbbyy_tab_data_9_3_REG;
	d_yuv2rgbbyy_tab_data_10_0_RBUS d_yuv2rgbbyy_tab_data_10_0_REG;
	d_yuv2rgbbyy_tab_data_10_1_RBUS d_yuv2rgbbyy_tab_data_10_1_REG;
	d_yuv2rgbbyy_tab_data_10_2_RBUS d_yuv2rgbbyy_tab_data_10_2_REG;
	d_yuv2rgbbyy_tab_data_10_3_RBUS d_yuv2rgbbyy_tab_data_10_3_REG;
	d_yuv2rgbbyy_tab_data_11_0_RBUS d_yuv2rgbbyy_tab_data_11_0_REG;
	d_yuv2rgbbyy_tab_data_11_1_RBUS d_yuv2rgbbyy_tab_data_11_1_REG;
	d_yuv2rgbbyy_tab_data_11_2_RBUS d_yuv2rgbbyy_tab_data_11_2_REG;
	d_yuv2rgbbyy_tab_data_11_3_RBUS d_yuv2rgbbyy_tab_data_11_3_REG;
	d_yuv2rgbbyy_tab_data_12_0_RBUS d_yuv2rgbbyy_tab_data_12_0_REG;
	d_yuv2rgbbyy_tab_data_12_1_RBUS d_yuv2rgbbyy_tab_data_12_1_REG;
	d_yuv2rgbbyy_tab_data_12_2_RBUS d_yuv2rgbbyy_tab_data_12_2_REG;
	d_yuv2rgbbyy_tab_data_12_3_RBUS d_yuv2rgbbyy_tab_data_12_3_REG;
	d_yuv2rgbbyy_tab_data_13_0_RBUS d_yuv2rgbbyy_tab_data_13_0_REG;
	d_yuv2rgbbyy_tab_data_13_1_RBUS d_yuv2rgbbyy_tab_data_13_1_REG;
	d_yuv2rgbbyy_tab_data_13_2_RBUS d_yuv2rgbbyy_tab_data_13_2_REG;
	d_yuv2rgbbyy_tab_data_13_3_RBUS d_yuv2rgbbyy_tab_data_13_3_REG;
	d_yuv2rgbbyy_tab_data_14_0_RBUS d_yuv2rgbbyy_tab_data_14_0_REG;
	d_yuv2rgbbyy_tab_data_14_1_RBUS d_yuv2rgbbyy_tab_data_14_1_REG;
	d_yuv2rgbbyy_tab_data_14_2_RBUS d_yuv2rgbbyy_tab_data_14_2_REG;
	d_yuv2rgbbyy_tab_data_14_3_RBUS d_yuv2rgbbyy_tab_data_14_3_REG;
	d_yuv2rgbbyy_tab_data_15_0_RBUS d_yuv2rgbbyy_tab_data_15_0_REG;
	d_yuv2rgbbyy_tab_data_15_1_RBUS d_yuv2rgbbyy_tab_data_15_1_REG;
	d_yuv2rgbbyy_tab_data_15_2_RBUS d_yuv2rgbbyy_tab_data_15_2_REG;
	d_yuv2rgbbyy_tab_data_15_3_RBUS d_yuv2rgbbyy_tab_data_15_3_REG;
	d_yuv2rgbbyy_tab_data_16_0_RBUS d_yuv2rgbbyy_tab_data_16_0_REG;
	d_yuv2rgbbyy_tab_data_16_1_RBUS d_yuv2rgbbyy_tab_data_16_1_REG;
	d_yuv2rgbbyy_tab_data_16_2_RBUS d_yuv2rgbbyy_tab_data_16_2_REG;
	d_yuv2rgbbyy_tab_data_16_3_RBUS d_yuv2rgbbyy_tab_data_16_3_REG;
#endif
	//////////////////////// Coef by Y registers end////////////////////////
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	for(i=0;i<(Max_Bright_bin);i++)
	{
		DC_average+= reg_HistCnt[i]*( i*8);
		Total_HistCnt+= reg_HistCnt[i];
	}

	if((SmartPic_clue->Hist_Y_Total_sum) == 0 || Max_Bright_bin == 0)
		return;

	APL = ((DC_average/(SmartPic_clue->Hist_Y_Total_sum))<<5)/(Max_Bright_bin);

//	ROSPrintf("scalerVIP_100_4_Bright_Plus	APL = %d\n", APL);
	if(Scaler_GetAutoMA(BP_Debug_EN) == 1)
		APL = Scaler_GetAutoMA(BP_Debug_APL);

	if(APL >= P2)
		Gain_Value = G2;
	else if(APL >= P1)
		Gain_Value = (G1 - G2) * (P2 - APL) / (P2 - P1) + G2;
	else
		Gain_Value = G1;

	//Gain_Value = ((cur_Gain_Value<< 10)  / pre_Gain_Value);
//	if(MA_print_count%300==0)
//		ROSPrintf("cur_Gain_Value=%d, pre_Gain_Value = %d, Gain_Value = %d\n",cur_Gain_Value,pre_Gain_Value,Gain_Value);
#if 1	//Elsie 20131126: FIXME
	d_yuv2rgb_tab1_data_0_REG.regValue      = COEFF_BY_Y_REG[0];
	d_yuv2rgb_tab1_data_1_REG.regValue      = COEFF_BY_Y_REG[1];
	d_yuv2rgb_tab1_data_2_REG.regValue      = COEFF_BY_Y_REG[2];
	d_yuv2rgb_tab1_data_3_REG.regValue      = COEFF_BY_Y_REG[3];
	d_yuv2rgbbyy_tab_data_1_0_REG.regValue  = COEFF_BY_Y_REG[4];
	d_yuv2rgbbyy_tab_data_1_1_REG.regValue  = COEFF_BY_Y_REG[5];
	d_yuv2rgbbyy_tab_data_1_2_REG.regValue  = COEFF_BY_Y_REG[6];
	d_yuv2rgbbyy_tab_data_1_3_REG.regValue  = COEFF_BY_Y_REG[7];
	d_yuv2rgbbyy_tab_data_2_0_REG.regValue  = COEFF_BY_Y_REG[8];
	d_yuv2rgbbyy_tab_data_2_1_REG.regValue  = COEFF_BY_Y_REG[9];
	d_yuv2rgbbyy_tab_data_2_2_REG.regValue  = COEFF_BY_Y_REG[10];
	d_yuv2rgbbyy_tab_data_2_3_REG.regValue  = COEFF_BY_Y_REG[11];
	d_yuv2rgbbyy_tab_data_3_0_REG.regValue  = COEFF_BY_Y_REG[12];
	d_yuv2rgbbyy_tab_data_3_1_REG.regValue  = COEFF_BY_Y_REG[13];
	d_yuv2rgbbyy_tab_data_3_2_REG.regValue  = COEFF_BY_Y_REG[14];
	d_yuv2rgbbyy_tab_data_3_3_REG.regValue  = COEFF_BY_Y_REG[15];
	d_yuv2rgbbyy_tab_data_4_0_REG.regValue  = COEFF_BY_Y_REG[16];
	d_yuv2rgbbyy_tab_data_4_1_REG.regValue  = COEFF_BY_Y_REG[17];
	d_yuv2rgbbyy_tab_data_4_2_REG.regValue  = COEFF_BY_Y_REG[18];
	d_yuv2rgbbyy_tab_data_4_3_REG.regValue  = COEFF_BY_Y_REG[19];
	d_yuv2rgbbyy_tab_data_5_0_REG.regValue  = COEFF_BY_Y_REG[20];
	d_yuv2rgbbyy_tab_data_5_1_REG.regValue  = COEFF_BY_Y_REG[21];
	d_yuv2rgbbyy_tab_data_5_2_REG.regValue  = COEFF_BY_Y_REG[22];
	d_yuv2rgbbyy_tab_data_5_3_REG.regValue  = COEFF_BY_Y_REG[23];
	d_yuv2rgbbyy_tab_data_6_0_REG.regValue  = COEFF_BY_Y_REG[24];
	d_yuv2rgbbyy_tab_data_6_1_REG.regValue  = COEFF_BY_Y_REG[25];
	d_yuv2rgbbyy_tab_data_6_2_REG.regValue  = COEFF_BY_Y_REG[26];
	d_yuv2rgbbyy_tab_data_6_3_REG.regValue  = COEFF_BY_Y_REG[27];
	d_yuv2rgbbyy_tab_data_7_0_REG.regValue  = COEFF_BY_Y_REG[28];
	d_yuv2rgbbyy_tab_data_7_1_REG.regValue  = COEFF_BY_Y_REG[29];
	d_yuv2rgbbyy_tab_data_7_2_REG.regValue  = COEFF_BY_Y_REG[30];
	d_yuv2rgbbyy_tab_data_7_3_REG.regValue  = COEFF_BY_Y_REG[31];
	d_yuv2rgbbyy_tab_data_8_0_REG.regValue  = COEFF_BY_Y_REG[32];
	d_yuv2rgbbyy_tab_data_8_1_REG.regValue  = COEFF_BY_Y_REG[33];
	d_yuv2rgbbyy_tab_data_8_2_REG.regValue  = COEFF_BY_Y_REG[34];
	d_yuv2rgbbyy_tab_data_8_3_REG.regValue  = COEFF_BY_Y_REG[35];
	d_yuv2rgbbyy_tab_data_9_0_REG.regValue  = COEFF_BY_Y_REG[36];
	d_yuv2rgbbyy_tab_data_9_1_REG.regValue  = COEFF_BY_Y_REG[37];
	d_yuv2rgbbyy_tab_data_9_2_REG.regValue  = COEFF_BY_Y_REG[38];
	d_yuv2rgbbyy_tab_data_9_3_REG.regValue  = COEFF_BY_Y_REG[39];
	d_yuv2rgbbyy_tab_data_10_0_REG.regValue = COEFF_BY_Y_REG[40];
	d_yuv2rgbbyy_tab_data_10_1_REG.regValue = COEFF_BY_Y_REG[41];
	d_yuv2rgbbyy_tab_data_10_2_REG.regValue = COEFF_BY_Y_REG[42];
	d_yuv2rgbbyy_tab_data_10_3_REG.regValue = COEFF_BY_Y_REG[43];
	d_yuv2rgbbyy_tab_data_11_0_REG.regValue = COEFF_BY_Y_REG[44];
	d_yuv2rgbbyy_tab_data_11_1_REG.regValue = COEFF_BY_Y_REG[45];
	d_yuv2rgbbyy_tab_data_11_2_REG.regValue = COEFF_BY_Y_REG[46];
	d_yuv2rgbbyy_tab_data_11_3_REG.regValue = COEFF_BY_Y_REG[47];
	d_yuv2rgbbyy_tab_data_12_0_REG.regValue = COEFF_BY_Y_REG[48];
	d_yuv2rgbbyy_tab_data_12_1_REG.regValue = COEFF_BY_Y_REG[49];
	d_yuv2rgbbyy_tab_data_12_2_REG.regValue = COEFF_BY_Y_REG[50];
	d_yuv2rgbbyy_tab_data_12_3_REG.regValue = COEFF_BY_Y_REG[51];
	d_yuv2rgbbyy_tab_data_13_0_REG.regValue = COEFF_BY_Y_REG[52];
	d_yuv2rgbbyy_tab_data_13_1_REG.regValue = COEFF_BY_Y_REG[53];
	d_yuv2rgbbyy_tab_data_13_2_REG.regValue = COEFF_BY_Y_REG[54];
	d_yuv2rgbbyy_tab_data_13_3_REG.regValue = COEFF_BY_Y_REG[55];
	d_yuv2rgbbyy_tab_data_14_0_REG.regValue = COEFF_BY_Y_REG[56];
	d_yuv2rgbbyy_tab_data_14_1_REG.regValue = COEFF_BY_Y_REG[57];
	d_yuv2rgbbyy_tab_data_14_2_REG.regValue = COEFF_BY_Y_REG[58];
	d_yuv2rgbbyy_tab_data_14_3_REG.regValue = COEFF_BY_Y_REG[59];
	d_yuv2rgbbyy_tab_data_15_0_REG.regValue = COEFF_BY_Y_REG[60];
	d_yuv2rgbbyy_tab_data_15_1_REG.regValue = COEFF_BY_Y_REG[61];
	d_yuv2rgbbyy_tab_data_15_2_REG.regValue = COEFF_BY_Y_REG[62];
	d_yuv2rgbbyy_tab_data_15_3_REG.regValue = COEFF_BY_Y_REG[63];
	d_yuv2rgbbyy_tab_data_16_0_REG.regValue = COEFF_BY_Y_REG[64];
	d_yuv2rgbbyy_tab_data_16_1_REG.regValue = COEFF_BY_Y_REG[65];
	d_yuv2rgbbyy_tab_data_16_2_REG.regValue = COEFF_BY_Y_REG[66];
	d_yuv2rgbbyy_tab_data_16_3_REG.regValue = COEFF_BY_Y_REG[67];

	coef_tmp[0][0][0]	 =	d_yuv2rgb_tab1_data_0_REG.k11	  ;
	coef_tmp[0][0][1]	 =	d_yuv2rgb_tab1_data_0_REG.k12	  ;
	coef_tmp[0][0][2]	 =	d_yuv2rgb_tab1_data_1_REG.k13	  ;
	coef_tmp[0][1][1]	 =	d_yuv2rgb_tab1_data_2_REG.k22	  ;
	coef_tmp[0][1][2]	 =	d_yuv2rgb_tab1_data_2_REG.k23	  ;
	coef_tmp[0][2][1]	 =	d_yuv2rgb_tab1_data_3_REG.k32	  ;
	coef_tmp[0][2][2]	 =	d_yuv2rgb_tab1_data_3_REG.k33	  ;

	coef_tmp[1][0][0]	 =	d_yuv2rgbbyy_tab_data_1_0_REG.k11 ;
	coef_tmp[1][0][1]	 =	d_yuv2rgbbyy_tab_data_1_0_REG.k12 ;
	coef_tmp[1][0][2]	 =	d_yuv2rgbbyy_tab_data_1_1_REG.k13 ;
	coef_tmp[1][1][1]	 =	d_yuv2rgbbyy_tab_data_1_2_REG.k22 ;
	coef_tmp[1][1][2]	 =	d_yuv2rgbbyy_tab_data_1_2_REG.k23 ;
	coef_tmp[1][2][1]	 =	d_yuv2rgbbyy_tab_data_1_3_REG.k32 ;
	coef_tmp[1][2][2]	 =	d_yuv2rgbbyy_tab_data_1_3_REG.k33 ;

	coef_tmp[2][0][0]	 =	d_yuv2rgbbyy_tab_data_2_0_REG.k11 ;
	coef_tmp[2][0][1]	 =	d_yuv2rgbbyy_tab_data_2_0_REG.k12 ;
	coef_tmp[2][0][2]	 =	d_yuv2rgbbyy_tab_data_2_1_REG.k13 ;
	coef_tmp[2][1][1]	 =	d_yuv2rgbbyy_tab_data_2_2_REG.k22 ;
	coef_tmp[2][1][2]	 =	d_yuv2rgbbyy_tab_data_2_2_REG.k23 ;
	coef_tmp[2][2][1]	 =	d_yuv2rgbbyy_tab_data_2_3_REG.k32 ;
	coef_tmp[2][2][2]	 =	d_yuv2rgbbyy_tab_data_2_3_REG.k33 ;

	coef_tmp[3][0][0]	 =	d_yuv2rgbbyy_tab_data_3_0_REG.k11 ;
	coef_tmp[3][0][1]	 =	d_yuv2rgbbyy_tab_data_3_0_REG.k12 ;
	coef_tmp[3][0][2]	 =	d_yuv2rgbbyy_tab_data_3_1_REG.k13 ;
	coef_tmp[3][1][1]	 =	d_yuv2rgbbyy_tab_data_3_2_REG.k22 ;
	coef_tmp[3][1][2]	 =	d_yuv2rgbbyy_tab_data_3_2_REG.k23 ;
	coef_tmp[3][2][1]	 =	d_yuv2rgbbyy_tab_data_3_3_REG.k32 ;
	coef_tmp[3][2][2]	 =	d_yuv2rgbbyy_tab_data_3_3_REG.k33 ;

	coef_tmp[4][0][0]	 =	d_yuv2rgbbyy_tab_data_4_0_REG.k11 ;
	coef_tmp[4][0][1]	 =	d_yuv2rgbbyy_tab_data_4_0_REG.k12 ;
	coef_tmp[4][0][2]	 =	d_yuv2rgbbyy_tab_data_4_1_REG.k13 ;
	coef_tmp[4][1][1]	 =	d_yuv2rgbbyy_tab_data_4_2_REG.k22 ;
	coef_tmp[4][1][2]	 =	d_yuv2rgbbyy_tab_data_4_2_REG.k23 ;
	coef_tmp[4][2][1]	 =	d_yuv2rgbbyy_tab_data_4_3_REG.k32 ;
	coef_tmp[4][2][2]	 =	d_yuv2rgbbyy_tab_data_4_3_REG.k33 ;

	coef_tmp[5][0][0]	 =	d_yuv2rgbbyy_tab_data_5_0_REG.k11 ;
	coef_tmp[5][0][1]	 =	d_yuv2rgbbyy_tab_data_5_0_REG.k12 ;
	coef_tmp[5][0][2]	 =	d_yuv2rgbbyy_tab_data_5_1_REG.k13 ;
	coef_tmp[5][1][1]	 =	d_yuv2rgbbyy_tab_data_5_2_REG.k22 ;
	coef_tmp[5][1][2]	 =	d_yuv2rgbbyy_tab_data_5_2_REG.k23 ;
	coef_tmp[5][2][1]	 =	d_yuv2rgbbyy_tab_data_5_3_REG.k32 ;
	coef_tmp[5][2][2]	 =	d_yuv2rgbbyy_tab_data_5_3_REG.k33 ;

	coef_tmp[6][0][0]	 =	d_yuv2rgbbyy_tab_data_6_0_REG.k11 ;
	coef_tmp[6][0][1]	 =	d_yuv2rgbbyy_tab_data_6_0_REG.k12 ;
	coef_tmp[6][0][2]	 =	d_yuv2rgbbyy_tab_data_6_1_REG.k13 ;
	coef_tmp[6][1][1]	 =	d_yuv2rgbbyy_tab_data_6_2_REG.k22 ;
	coef_tmp[6][1][2]	 =	d_yuv2rgbbyy_tab_data_6_2_REG.k23 ;
	coef_tmp[6][2][1]	 =	d_yuv2rgbbyy_tab_data_6_3_REG.k32 ;
	coef_tmp[6][2][2]	 =	d_yuv2rgbbyy_tab_data_6_3_REG.k33 ;

	coef_tmp[7][0][0]	 =	d_yuv2rgbbyy_tab_data_7_0_REG.k11 ;
	coef_tmp[7][0][1]	 =	d_yuv2rgbbyy_tab_data_7_0_REG.k12 ;
	coef_tmp[7][0][2]	 =	d_yuv2rgbbyy_tab_data_7_1_REG.k13 ;
	coef_tmp[7][1][1]	 =	d_yuv2rgbbyy_tab_data_7_2_REG.k22 ;
	coef_tmp[7][1][2]	 =	d_yuv2rgbbyy_tab_data_7_2_REG.k23 ;
	coef_tmp[7][2][1]	 =	d_yuv2rgbbyy_tab_data_7_3_REG.k32 ;
	coef_tmp[7][2][2]	 =	d_yuv2rgbbyy_tab_data_7_3_REG.k33 ;

	coef_tmp[8][0][0]	 =	d_yuv2rgbbyy_tab_data_8_0_REG.k11 ;
	coef_tmp[8][0][1]	 =	d_yuv2rgbbyy_tab_data_8_0_REG.k12 ;
	coef_tmp[8][0][2]	 =	d_yuv2rgbbyy_tab_data_8_1_REG.k13 ;
	coef_tmp[8][1][1]	 =	d_yuv2rgbbyy_tab_data_8_2_REG.k22 ;
	coef_tmp[8][1][2]	 =	d_yuv2rgbbyy_tab_data_8_2_REG.k23 ;
	coef_tmp[8][2][1]	 =	d_yuv2rgbbyy_tab_data_8_3_REG.k32 ;
	coef_tmp[8][2][2]	 =	d_yuv2rgbbyy_tab_data_8_3_REG.k33 ;

	coef_tmp[9][0][0]	 =	d_yuv2rgbbyy_tab_data_9_0_REG.k11 ;
	coef_tmp[9][0][1]	 =	d_yuv2rgbbyy_tab_data_9_0_REG.k12 ;
	coef_tmp[9][0][2]	 =	d_yuv2rgbbyy_tab_data_9_1_REG.k13 ;
	coef_tmp[9][1][1]	 =	d_yuv2rgbbyy_tab_data_9_2_REG.k22 ;
	coef_tmp[9][1][2]	 =	d_yuv2rgbbyy_tab_data_9_2_REG.k23 ;
	coef_tmp[9][2][1]	 =	d_yuv2rgbbyy_tab_data_9_3_REG.k32 ;
	coef_tmp[9][2][2]	 =	d_yuv2rgbbyy_tab_data_9_3_REG.k33 ;

	coef_tmp[10][0][0]	 =	d_yuv2rgbbyy_tab_data_10_0_REG.k11;
	coef_tmp[10][0][1]	 =	d_yuv2rgbbyy_tab_data_10_0_REG.k12;
	coef_tmp[10][0][2]	 =	d_yuv2rgbbyy_tab_data_10_1_REG.k13;
	coef_tmp[10][1][1]	 =	d_yuv2rgbbyy_tab_data_10_2_REG.k22;
	coef_tmp[10][1][2]	 =	d_yuv2rgbbyy_tab_data_10_2_REG.k23;
	coef_tmp[10][2][1]	 =	d_yuv2rgbbyy_tab_data_10_3_REG.k32;
	coef_tmp[10][2][2]	 =	d_yuv2rgbbyy_tab_data_10_3_REG.k33;

	coef_tmp[11][0][0]	 =	d_yuv2rgbbyy_tab_data_11_0_REG.k11;
	coef_tmp[11][0][1]	 =	d_yuv2rgbbyy_tab_data_11_0_REG.k12;
	coef_tmp[11][0][2]	 =	d_yuv2rgbbyy_tab_data_11_1_REG.k13;
	coef_tmp[11][1][1]	 =	d_yuv2rgbbyy_tab_data_11_2_REG.k22;
	coef_tmp[11][1][2]	 =	d_yuv2rgbbyy_tab_data_11_2_REG.k23;
	coef_tmp[11][2][1]	 =	d_yuv2rgbbyy_tab_data_11_3_REG.k32;
	coef_tmp[11][2][2]	 =	d_yuv2rgbbyy_tab_data_11_3_REG.k33;

	coef_tmp[12][0][0]	 =	d_yuv2rgbbyy_tab_data_12_0_REG.k11;
	coef_tmp[12][0][1]	 =	d_yuv2rgbbyy_tab_data_12_0_REG.k12;
	coef_tmp[12][0][2]	 =	d_yuv2rgbbyy_tab_data_12_1_REG.k13;
	coef_tmp[12][1][1]	 =	d_yuv2rgbbyy_tab_data_12_2_REG.k22;
	coef_tmp[12][1][2]	 =	d_yuv2rgbbyy_tab_data_12_2_REG.k23;
	coef_tmp[12][2][1]	 =	d_yuv2rgbbyy_tab_data_12_3_REG.k32;
	coef_tmp[12][2][2]	 =	d_yuv2rgbbyy_tab_data_12_3_REG.k33;

	coef_tmp[13][0][0]	 =	d_yuv2rgbbyy_tab_data_13_0_REG.k11;
	coef_tmp[13][0][1]	 =	d_yuv2rgbbyy_tab_data_13_0_REG.k12;
	coef_tmp[13][0][2]	 =	d_yuv2rgbbyy_tab_data_13_1_REG.k13;
	coef_tmp[13][1][1]	 =	d_yuv2rgbbyy_tab_data_13_2_REG.k22;
	coef_tmp[13][1][2]	 =	d_yuv2rgbbyy_tab_data_13_2_REG.k23;
	coef_tmp[13][2][1]	 =	d_yuv2rgbbyy_tab_data_13_3_REG.k32;
	coef_tmp[13][2][2]	 =	d_yuv2rgbbyy_tab_data_13_3_REG.k33;

	coef_tmp[14][0][0]	 =	d_yuv2rgbbyy_tab_data_14_0_REG.k11;
	coef_tmp[14][0][1]	 =	d_yuv2rgbbyy_tab_data_14_0_REG.k12;
	coef_tmp[14][0][2]	 =	d_yuv2rgbbyy_tab_data_14_1_REG.k13;
	coef_tmp[14][1][1]	 =	d_yuv2rgbbyy_tab_data_14_2_REG.k22;
	coef_tmp[14][1][2]	 =	d_yuv2rgbbyy_tab_data_14_2_REG.k23;
	coef_tmp[14][2][1]	 =	d_yuv2rgbbyy_tab_data_14_3_REG.k32;
	coef_tmp[14][2][2]	 =	d_yuv2rgbbyy_tab_data_14_3_REG.k33;

	coef_tmp[15][0][0]	 =	d_yuv2rgbbyy_tab_data_15_0_REG.k11;
	coef_tmp[15][0][1]	 =	d_yuv2rgbbyy_tab_data_15_0_REG.k12;
	coef_tmp[15][0][2]	 =	d_yuv2rgbbyy_tab_data_15_1_REG.k13;
	coef_tmp[15][1][1]	 =	d_yuv2rgbbyy_tab_data_15_2_REG.k22;
	coef_tmp[15][1][2]	 =	d_yuv2rgbbyy_tab_data_15_2_REG.k23;
	coef_tmp[15][2][1]	 =	d_yuv2rgbbyy_tab_data_15_3_REG.k32;
	coef_tmp[15][2][2]	 =	d_yuv2rgbbyy_tab_data_15_3_REG.k33;

	coef_tmp[16][0][0]	 =	d_yuv2rgbbyy_tab_data_16_0_REG.k11;
	coef_tmp[16][0][1]	 =	d_yuv2rgbbyy_tab_data_16_0_REG.k12;
	coef_tmp[16][0][2]	 =	d_yuv2rgbbyy_tab_data_16_1_REG.k13;
	coef_tmp[16][1][1]	 =	d_yuv2rgbbyy_tab_data_16_2_REG.k22;
	coef_tmp[16][1][2]	 =	d_yuv2rgbbyy_tab_data_16_2_REG.k23;
	coef_tmp[16][2][1]	 =	d_yuv2rgbbyy_tab_data_16_3_REG.k32;
	coef_tmp[16][2][2]	 =	d_yuv2rgbbyy_tab_data_16_3_REG.k33;

	if(MA_print_count%150==0)
		ROSPrintf("1.k22=%d,k23=%d,%d\n",coef_tmp[0][1][1], coef_tmp[0][1][2], (((~coef_tmp[0][1][1]) & 0x7FF) + 1));

	for(i=0;i<YUV2RGB_COEF_BY_Y_Seg_Num;i++)
	{
		for(j=0;j<3;j++)
		{
			for(k=0;k<3;k++)
			{
				// if coef_tmp > 0x400(1024, 11bit), negtive coef, need to do 2's complement
				com_flag[i][j][k]=0;
				if(coef_tmp[i][j][k]>=0x400)
				{
					coef_tmp[i][j][k] = ((~coef_tmp[i][j][k]) & 0x7FF) + 1;
					com_flag[i][j][k] = 1;
				}
			}
		}
	}

	if(MA_print_count%150==0)
		ROSPrintf("2.k22=%d,k23=%d,flag=%d\n",coef_tmp[0][1][1], coef_tmp[0][1][2],com_flag[0][1][1]);


	for(i=0;i<YUV2RGB_COEF_BY_Y_Seg_Num;i++)
	{
		coef_tmp[i][0][0] = coef_tmp[i][0][0]* Gain_Value / 100;
		coef_tmp[i][0][1] = coef_tmp[i][0][1]* Gain_Value / 100;
		coef_tmp[i][0][2] = coef_tmp[i][0][2]* Gain_Value / 100;
		coef_tmp[i][1][1] = coef_tmp[i][1][1]* Gain_Value / 100;
		coef_tmp[i][1][2] = coef_tmp[i][1][2]* Gain_Value / 100;
		coef_tmp[i][2][1] = coef_tmp[i][2][1]* Gain_Value / 100;
		coef_tmp[i][2][2] = coef_tmp[i][2][2]* Gain_Value / 100;
	}

	if(MA_print_count%150==0)
		ROSPrintf("3.k22=%d,k23=%d,gain=%d\n",coef_tmp[0][1][1], coef_tmp[0][1][2],Gain_Value);


	//return to coef table form
	for(i=0;i<YUV2RGB_COEF_BY_Y_Seg_Num;i++)
	{
		for(j=0;j<3;j++)
		{
			for(k=0;k<3;k++)
			{
				if(com_flag[i][j][k]==1)
				{
					coef_tmp[i][j][k] = ~(coef_tmp[i][j][k] - 1);
				}
			}
		}
	}

	if(MA_print_count%150==0)
		ROSPrintf("4.k22=%d,k23=%d\n",coef_tmp[0][1][1], coef_tmp[0][1][2]);


	d_yuv2rgb_tab1_data_0_REG.k11 =		coef_tmp[0][0][0];
	d_yuv2rgb_tab1_data_0_REG.k12 =		coef_tmp[0][0][1];
	d_yuv2rgb_tab1_data_1_REG.k13 =		coef_tmp[0][0][2];
	d_yuv2rgb_tab1_data_2_REG.k22 =		coef_tmp[0][1][1];
	d_yuv2rgb_tab1_data_2_REG.k23 =		coef_tmp[0][1][2];
	d_yuv2rgb_tab1_data_3_REG.k32 =		coef_tmp[0][2][1];
	d_yuv2rgb_tab1_data_3_REG.k33 =		coef_tmp[0][2][2];

	d_yuv2rgbbyy_tab_data_1_0_REG.k11 =  coef_tmp[1][0][0];
	d_yuv2rgbbyy_tab_data_1_0_REG.k12 =  coef_tmp[1][0][1];
	d_yuv2rgbbyy_tab_data_1_1_REG.k13 =  coef_tmp[1][0][2];
	d_yuv2rgbbyy_tab_data_1_2_REG.k22 =  coef_tmp[1][1][1];
	d_yuv2rgbbyy_tab_data_1_2_REG.k23 =  coef_tmp[1][1][2];
	d_yuv2rgbbyy_tab_data_1_3_REG.k32 =  coef_tmp[1][2][1];
	d_yuv2rgbbyy_tab_data_1_3_REG.k33 =  coef_tmp[1][2][2];

	d_yuv2rgbbyy_tab_data_2_0_REG.k11 =  coef_tmp[2][0][0];
	d_yuv2rgbbyy_tab_data_2_0_REG.k12 =  coef_tmp[2][0][1];
	d_yuv2rgbbyy_tab_data_2_1_REG.k13 =  coef_tmp[2][0][2];
	d_yuv2rgbbyy_tab_data_2_2_REG.k22 =  coef_tmp[2][1][1];
	d_yuv2rgbbyy_tab_data_2_2_REG.k23 =  coef_tmp[2][1][2];
	d_yuv2rgbbyy_tab_data_2_3_REG.k32 =  coef_tmp[2][2][1];
	d_yuv2rgbbyy_tab_data_2_3_REG.k33 =  coef_tmp[2][2][2];

	d_yuv2rgbbyy_tab_data_3_0_REG.k11 =  coef_tmp[3][0][0];
	d_yuv2rgbbyy_tab_data_3_0_REG.k12 =  coef_tmp[3][0][1];
	d_yuv2rgbbyy_tab_data_3_1_REG.k13 =  coef_tmp[3][0][2];
	d_yuv2rgbbyy_tab_data_3_2_REG.k22 =  coef_tmp[3][1][1];
	d_yuv2rgbbyy_tab_data_3_2_REG.k23 =  coef_tmp[3][1][2];
	d_yuv2rgbbyy_tab_data_3_3_REG.k32 =  coef_tmp[3][2][1];
	d_yuv2rgbbyy_tab_data_3_3_REG.k33 =  coef_tmp[3][2][2];

	d_yuv2rgbbyy_tab_data_4_0_REG.k11 =  coef_tmp[4][0][0];
	d_yuv2rgbbyy_tab_data_4_0_REG.k12 =  coef_tmp[4][0][1];
	d_yuv2rgbbyy_tab_data_4_1_REG.k13 =  coef_tmp[4][0][2];
	d_yuv2rgbbyy_tab_data_4_2_REG.k22 =  coef_tmp[4][1][1];
	d_yuv2rgbbyy_tab_data_4_2_REG.k23 =  coef_tmp[4][1][2];
	d_yuv2rgbbyy_tab_data_4_3_REG.k32 =  coef_tmp[4][2][1];
	d_yuv2rgbbyy_tab_data_4_3_REG.k33 =  coef_tmp[4][2][2];

	d_yuv2rgbbyy_tab_data_5_0_REG.k11 =  coef_tmp[5][0][0];
	d_yuv2rgbbyy_tab_data_5_0_REG.k12 =  coef_tmp[5][0][1];
	d_yuv2rgbbyy_tab_data_5_1_REG.k13 =  coef_tmp[5][0][2];
	d_yuv2rgbbyy_tab_data_5_2_REG.k22 =  coef_tmp[5][1][1];
	d_yuv2rgbbyy_tab_data_5_2_REG.k23 =  coef_tmp[5][1][2];
	d_yuv2rgbbyy_tab_data_5_3_REG.k32 =  coef_tmp[5][2][1];
	d_yuv2rgbbyy_tab_data_5_3_REG.k33 =  coef_tmp[5][2][2];

	d_yuv2rgbbyy_tab_data_6_0_REG.k11 =  coef_tmp[6][0][0];
	d_yuv2rgbbyy_tab_data_6_0_REG.k12 =  coef_tmp[6][0][1];
	d_yuv2rgbbyy_tab_data_6_1_REG.k13 =  coef_tmp[6][0][2];
	d_yuv2rgbbyy_tab_data_6_2_REG.k22 =  coef_tmp[6][1][1];
	d_yuv2rgbbyy_tab_data_6_2_REG.k23 =  coef_tmp[6][1][2];
	d_yuv2rgbbyy_tab_data_6_3_REG.k32 =  coef_tmp[6][2][1];
	d_yuv2rgbbyy_tab_data_6_3_REG.k33 =  coef_tmp[6][2][2];

	d_yuv2rgbbyy_tab_data_7_0_REG.k11 =  coef_tmp[7][0][0];
	d_yuv2rgbbyy_tab_data_7_0_REG.k12 =  coef_tmp[7][0][1];
	d_yuv2rgbbyy_tab_data_7_1_REG.k13 =  coef_tmp[7][0][2];
	d_yuv2rgbbyy_tab_data_7_2_REG.k22 =  coef_tmp[7][1][1];
	d_yuv2rgbbyy_tab_data_7_2_REG.k23 =  coef_tmp[7][1][2];
	d_yuv2rgbbyy_tab_data_7_3_REG.k32 =  coef_tmp[7][2][1];
	d_yuv2rgbbyy_tab_data_7_3_REG.k33 =  coef_tmp[7][2][2];

	d_yuv2rgbbyy_tab_data_8_0_REG.k11 =  coef_tmp[8][0][0];
	d_yuv2rgbbyy_tab_data_8_0_REG.k12 =  coef_tmp[8][0][1];
	d_yuv2rgbbyy_tab_data_8_1_REG.k13 =  coef_tmp[8][0][2];
	d_yuv2rgbbyy_tab_data_8_2_REG.k22 =  coef_tmp[8][1][1];
	d_yuv2rgbbyy_tab_data_8_2_REG.k23 =  coef_tmp[8][1][2];
	d_yuv2rgbbyy_tab_data_8_3_REG.k32 =  coef_tmp[8][2][1];
	d_yuv2rgbbyy_tab_data_8_3_REG.k33 =  coef_tmp[8][2][2];

	d_yuv2rgbbyy_tab_data_9_0_REG.k11 =  coef_tmp[9][0][0];
	d_yuv2rgbbyy_tab_data_9_0_REG.k12 =  coef_tmp[9][0][1];
	d_yuv2rgbbyy_tab_data_9_1_REG.k13 =  coef_tmp[9][0][2];
	d_yuv2rgbbyy_tab_data_9_2_REG.k22 =  coef_tmp[9][1][1];
	d_yuv2rgbbyy_tab_data_9_2_REG.k23 =  coef_tmp[9][1][2];
	d_yuv2rgbbyy_tab_data_9_3_REG.k32 =  coef_tmp[9][2][1];
	d_yuv2rgbbyy_tab_data_9_3_REG.k33 =  coef_tmp[9][2][2];

	d_yuv2rgbbyy_tab_data_10_0_REG.k11 = coef_tmp[10][0][0];
	d_yuv2rgbbyy_tab_data_10_0_REG.k12 = coef_tmp[10][0][1];
	d_yuv2rgbbyy_tab_data_10_1_REG.k13 = coef_tmp[10][0][2];
	d_yuv2rgbbyy_tab_data_10_2_REG.k22 = coef_tmp[10][1][1];
	d_yuv2rgbbyy_tab_data_10_2_REG.k23 = coef_tmp[10][1][2];
	d_yuv2rgbbyy_tab_data_10_3_REG.k32 = coef_tmp[10][2][1];
	d_yuv2rgbbyy_tab_data_10_3_REG.k33 = coef_tmp[10][2][2];

	d_yuv2rgbbyy_tab_data_11_0_REG.k11 = coef_tmp[11][0][0];
	d_yuv2rgbbyy_tab_data_11_0_REG.k12 = coef_tmp[11][0][1];
	d_yuv2rgbbyy_tab_data_11_1_REG.k13 = coef_tmp[11][0][2];
	d_yuv2rgbbyy_tab_data_11_2_REG.k22 = coef_tmp[11][1][1];
	d_yuv2rgbbyy_tab_data_11_2_REG.k23 = coef_tmp[11][1][2];
	d_yuv2rgbbyy_tab_data_11_3_REG.k32 = coef_tmp[11][2][1];
	d_yuv2rgbbyy_tab_data_11_3_REG.k33 = coef_tmp[11][2][2];

	d_yuv2rgbbyy_tab_data_12_0_REG.k11 = coef_tmp[12][0][0];
	d_yuv2rgbbyy_tab_data_12_0_REG.k12 = coef_tmp[12][0][1];
	d_yuv2rgbbyy_tab_data_12_1_REG.k13 = coef_tmp[12][0][2];
	d_yuv2rgbbyy_tab_data_12_2_REG.k22 = coef_tmp[12][1][1];
	d_yuv2rgbbyy_tab_data_12_2_REG.k23 = coef_tmp[12][1][2];
	d_yuv2rgbbyy_tab_data_12_3_REG.k32 = coef_tmp[12][2][1];
	d_yuv2rgbbyy_tab_data_12_3_REG.k33 = coef_tmp[12][2][2];

	d_yuv2rgbbyy_tab_data_13_0_REG.k11 = coef_tmp[13][0][0];
	d_yuv2rgbbyy_tab_data_13_0_REG.k12 = coef_tmp[13][0][1];
	d_yuv2rgbbyy_tab_data_13_1_REG.k13 = coef_tmp[13][0][2];
	d_yuv2rgbbyy_tab_data_13_2_REG.k22 = coef_tmp[13][1][1];
	d_yuv2rgbbyy_tab_data_13_2_REG.k23 = coef_tmp[13][1][2];
	d_yuv2rgbbyy_tab_data_13_3_REG.k32 = coef_tmp[13][2][1];
	d_yuv2rgbbyy_tab_data_13_3_REG.k33 = coef_tmp[13][2][2];

	d_yuv2rgbbyy_tab_data_14_0_REG.k11 = coef_tmp[14][0][0];
	d_yuv2rgbbyy_tab_data_14_0_REG.k12 = coef_tmp[14][0][1];
	d_yuv2rgbbyy_tab_data_14_1_REG.k13 = coef_tmp[14][0][2];
	d_yuv2rgbbyy_tab_data_14_2_REG.k22 = coef_tmp[14][1][1];
	d_yuv2rgbbyy_tab_data_14_2_REG.k23 = coef_tmp[14][1][2];
	d_yuv2rgbbyy_tab_data_14_3_REG.k32 = coef_tmp[14][2][1];
	d_yuv2rgbbyy_tab_data_14_3_REG.k33 = coef_tmp[14][2][2];

	d_yuv2rgbbyy_tab_data_15_0_REG.k11 = coef_tmp[15][0][0];
	d_yuv2rgbbyy_tab_data_15_0_REG.k12 = coef_tmp[15][0][1];
	d_yuv2rgbbyy_tab_data_15_1_REG.k13 = coef_tmp[15][0][2];
	d_yuv2rgbbyy_tab_data_15_2_REG.k22 = coef_tmp[15][1][1];
	d_yuv2rgbbyy_tab_data_15_2_REG.k23 = coef_tmp[15][1][2];
	d_yuv2rgbbyy_tab_data_15_3_REG.k32 = coef_tmp[15][2][1];
	d_yuv2rgbbyy_tab_data_15_3_REG.k33 = coef_tmp[15][2][2];

	d_yuv2rgbbyy_tab_data_16_0_REG.k11 = coef_tmp[16][0][0];
	d_yuv2rgbbyy_tab_data_16_0_REG.k12 = coef_tmp[16][0][1];
	d_yuv2rgbbyy_tab_data_16_1_REG.k13 = coef_tmp[16][0][2];
	d_yuv2rgbbyy_tab_data_16_2_REG.k22 = coef_tmp[16][1][1];
	d_yuv2rgbbyy_tab_data_16_2_REG.k23 = coef_tmp[16][1][2];
	d_yuv2rgbbyy_tab_data_16_3_REG.k32 = coef_tmp[16][2][1];
	d_yuv2rgbbyy_tab_data_16_3_REG.k33 = coef_tmp[16][2][2];

	rtd_outl(YUV2RGB_D_YUV2RGB_TAB1_DATA_0_reg, d_yuv2rgb_tab1_data_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGB_TAB1_DATA_1_reg, d_yuv2rgb_tab1_data_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGB_TAB1_DATA_2_reg, d_yuv2rgb_tab1_data_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGB_TAB1_DATA_3_reg, d_yuv2rgb_tab1_data_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_1_0_reg, d_yuv2rgbbyy_tab_data_1_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_1_1_reg, d_yuv2rgbbyy_tab_data_1_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_1_2_reg, d_yuv2rgbbyy_tab_data_1_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_1_3_reg, d_yuv2rgbbyy_tab_data_1_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_2_0_reg, d_yuv2rgbbyy_tab_data_2_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_2_1_reg, d_yuv2rgbbyy_tab_data_2_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_2_2_reg, d_yuv2rgbbyy_tab_data_2_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_2_3_reg, d_yuv2rgbbyy_tab_data_2_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_3_0_reg, d_yuv2rgbbyy_tab_data_3_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_3_1_reg, d_yuv2rgbbyy_tab_data_3_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_3_2_reg, d_yuv2rgbbyy_tab_data_3_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_3_3_reg, d_yuv2rgbbyy_tab_data_3_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_4_0_reg, d_yuv2rgbbyy_tab_data_4_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_4_1_reg, d_yuv2rgbbyy_tab_data_4_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_4_2_reg, d_yuv2rgbbyy_tab_data_4_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_4_3_reg, d_yuv2rgbbyy_tab_data_4_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_5_0_reg, d_yuv2rgbbyy_tab_data_5_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_5_1_reg, d_yuv2rgbbyy_tab_data_5_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_5_2_reg, d_yuv2rgbbyy_tab_data_5_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_5_3_reg, d_yuv2rgbbyy_tab_data_5_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_6_0_reg, d_yuv2rgbbyy_tab_data_6_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_6_1_reg, d_yuv2rgbbyy_tab_data_6_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_6_2_reg, d_yuv2rgbbyy_tab_data_6_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_6_3_reg, d_yuv2rgbbyy_tab_data_6_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_7_0_reg, d_yuv2rgbbyy_tab_data_7_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_7_1_reg, d_yuv2rgbbyy_tab_data_7_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_7_2_reg, d_yuv2rgbbyy_tab_data_7_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_7_3_reg, d_yuv2rgbbyy_tab_data_7_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_8_0_reg, d_yuv2rgbbyy_tab_data_8_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_8_1_reg, d_yuv2rgbbyy_tab_data_8_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_8_2_reg, d_yuv2rgbbyy_tab_data_8_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_8_3_reg, d_yuv2rgbbyy_tab_data_8_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_9_0_reg, d_yuv2rgbbyy_tab_data_9_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_9_1_reg, d_yuv2rgbbyy_tab_data_9_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_9_2_reg, d_yuv2rgbbyy_tab_data_9_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_9_3_reg, d_yuv2rgbbyy_tab_data_9_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_10_0_reg, d_yuv2rgbbyy_tab_data_10_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_10_1_reg, d_yuv2rgbbyy_tab_data_10_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_10_2_reg, d_yuv2rgbbyy_tab_data_10_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_10_3_reg, d_yuv2rgbbyy_tab_data_10_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_11_0_reg, d_yuv2rgbbyy_tab_data_11_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_11_1_reg, d_yuv2rgbbyy_tab_data_11_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_11_2_reg, d_yuv2rgbbyy_tab_data_11_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_11_3_reg, d_yuv2rgbbyy_tab_data_11_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_12_0_reg, d_yuv2rgbbyy_tab_data_12_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_12_1_reg, d_yuv2rgbbyy_tab_data_12_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_12_2_reg, d_yuv2rgbbyy_tab_data_12_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_12_3_reg, d_yuv2rgbbyy_tab_data_12_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_13_0_reg, d_yuv2rgbbyy_tab_data_13_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_13_1_reg, d_yuv2rgbbyy_tab_data_13_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_13_2_reg, d_yuv2rgbbyy_tab_data_13_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_13_3_reg, d_yuv2rgbbyy_tab_data_13_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_14_0_reg, d_yuv2rgbbyy_tab_data_14_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_14_1_reg, d_yuv2rgbbyy_tab_data_14_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_14_2_reg, d_yuv2rgbbyy_tab_data_14_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_14_3_reg, d_yuv2rgbbyy_tab_data_14_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_15_0_reg, d_yuv2rgbbyy_tab_data_15_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_15_1_reg, d_yuv2rgbbyy_tab_data_15_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_15_2_reg, d_yuv2rgbbyy_tab_data_15_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_15_3_reg, d_yuv2rgbbyy_tab_data_15_3_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_16_0_reg, d_yuv2rgbbyy_tab_data_16_0_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_16_1_reg, d_yuv2rgbbyy_tab_data_16_1_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_16_2_reg, d_yuv2rgbbyy_tab_data_16_2_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGBBYY_TAB_DATA_16_3_reg, d_yuv2rgbbyy_tab_data_16_3_REG.regValue);

#endif
	d_yuv2rgb_control_1_reg.yuv2rgb_double_buffer_status = 1;  // 20100811, double buffer en , csfanchiang
	rtd_outl(YUV2RGB_D_YUV2RGB_CONTROL_1_reg, d_yuv2rgb_control_1_reg.regValue);

	//pre_Gain_Value = cur_Gain_Value;
}
#endif


#if 0
unsigned int Noise_Statistics( unsigned int width, unsigned int height)
{
#if 0
        static unsigned char fcounter = 0;
        unsigned int MAD_Y_th1, MAD_Y_th2;
        unsigned int MAD_C_th1, MAD_C_th2;
        unsigned int MAD_Y_Count, MAD_U_Count, MAD_V_Count;
        static unsigned int MAD_Y_tmp_sum = 0;
        static unsigned int MAD_U_tmp_sum = 0;
        static unsigned int MAD_V_tmp_sum= 0;
        static unsigned int MAD_Y_min = 0xFFFFFFFF;
        static unsigned int MAD_Y_max = 0;
        static unsigned int MAD_Y_2ndmax = 0;
        static unsigned int MAD_U_min = 0xFFFFFFFF;
        static unsigned int MAD_U_max = 0;
        static unsigned int MAD_U_2ndmax = 0;
        static unsigned int MAD_V_min = 0xFFFFFFFF;
        static unsigned int MAD_V_max = 0;
        static unsigned int MAD_V_2ndmax = 0;
        unsigned int et_y_count;
        //unsigned int et_y_sum, et_u_sum, et_v_sum;
        static unsigned int et_y_count_tmp_sum = 0;
        unsigned int MAD_Y_avg, MAD_U_avg, MAD_V_avg, et_y_count_avg;
		static unsigned int ret_value = 0;
//     static int RTNR_offset;

        di_im_di_rtnr_mad_y_th_RBUS im_di_rtnr_mad_y_th_reg;
        di_im_di_rtnr_mad_c_th_RBUS im_di_rtnr_mad_c_th_reg;
        di_im_di_rtnr_mad_y_counter_RBUS im_di_rtnr_mad_y_counter_reg;
        di_im_di_rtnr_mad_u_counter_RBUS im_di_rtnr_mad_u_counter_reg;
        di_im_di_rtnr_mad_v_counter_RBUS im_di_rtnr_mad_v_counter_reg;
        di_im_di_rtnr_et_count_y_RBUS im_di_et_count_y_reg;
        //di_im_di_rtnr_et_sum_y_RBUS im_di_et_sum_y_reg;
        //di_im_di_rtnr_et_sum_u_RBUS im_di_et_sum_u_reg;
        //di_im_di_rtnr_et_sum_v_RBUS im_di_et_sum_v_reg;

        MAD_Y_th1 = 0x020;
        MAD_Y_th2 = 0x7FF;
        //MAD_Y_th1 = 0x0;
        //MAD_Y_th2 = 0xA;
        MAD_C_th1 = 0x010;
        MAD_C_th2 = 0x7FF;
        /*if( fcounter < 8 ) {
                MAD_Y_th1 = 0x100 * fcounter;
                MAD_Y_th2 = 0x100 * (fcounter+1) -1;
        }*/

        im_di_rtnr_mad_y_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_TH_reg);
        im_di_rtnr_mad_c_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_C_TH_reg);
        //MAD_Y_th1 = im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1;
        //MAD_Y_th2 = im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2;
        //MAD_C_th1 = im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1;
        //MAD_C_th2 = im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th2;
        im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = MAD_Y_th1;
        im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = MAD_Y_th2;
        im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1 = MAD_C_th1;
        im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th2 = MAD_C_th2;
        rtd_outl(DI_IM_DI_RTNR_MAD_Y_TH_reg, im_di_rtnr_mad_y_th_reg.regValue);
        rtd_outl(DI_IM_DI_RTNR_MAD_C_TH_reg, im_di_rtnr_mad_c_th_reg.regValue);

        im_di_rtnr_mad_y_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);
        im_di_rtnr_mad_u_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_U_COUNTER_reg);
        im_di_rtnr_mad_v_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_V_COUNTER_reg);
        MAD_Y_Count = im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery;
        MAD_U_Count = im_di_rtnr_mad_u_counter_reg.cp_temporal_mad_counteru;
        MAD_V_Count = im_di_rtnr_mad_v_counter_reg.cp_temporal_mad_counterv;

        im_di_et_count_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_COUNT_Y_reg);
        //im_di_et_sum_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_Y_reg);
        //im_di_et_sum_u_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_U_reg);
        //im_di_et_sum_v_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_V_reg);
        et_y_count = im_di_et_count_y_reg.cp_temporal_same_et_cnt_y;
        //et_y_sum = im_di_et_sum_y_reg.cp_temporal_same_et_sad_sum_y;
        //et_u_sum = im_di_et_sum_u_reg.cp_temporal_same_et_sad_sum_u;
        //et_v_sum = im_di_et_sum_v_reg.cp_temporal_same_et_sad_sum_v;

        MAD_Y_tmp_sum += MAD_Y_Count;
        MAD_U_tmp_sum += MAD_U_Count;
        MAD_V_tmp_sum += MAD_V_Count;
        et_y_count_tmp_sum += et_y_count;
        if(et_y_count == 0 ) et_y_count += 1;

        if( MAD_Y_Count < MAD_Y_min ) MAD_Y_min = MAD_Y_Count;
        if( MAD_Y_Count > MAD_Y_2ndmax ) {
                if( MAD_Y_Count > MAD_Y_max ) {
                        MAD_Y_2ndmax = MAD_Y_max; // drop max to avoid scene change
                        MAD_Y_max= MAD_Y_Count;
                }
                else MAD_Y_2ndmax = MAD_Y_Count;
        }
        if( MAD_U_Count < MAD_U_min ) MAD_U_min = MAD_U_Count;
        if( MAD_U_Count > MAD_U_2ndmax ) {
                if( MAD_U_Count > MAD_U_max ) {
                        MAD_U_2ndmax = MAD_U_max; // drop max to avoid scene change
                        MAD_U_max= MAD_U_Count;
                }
                else MAD_U_2ndmax = MAD_U_Count;
        }
        if( MAD_V_Count < MAD_V_min ) MAD_V_min = MAD_V_Count;
        if( MAD_V_Count > MAD_V_2ndmax ) {
                if( MAD_V_Count > MAD_V_max ) {
                        MAD_V_2ndmax = MAD_V_max; // drop max to avoid scene change
                        MAD_V_max= MAD_V_Count;
                }
                else MAD_V_2ndmax = MAD_V_Count;
        }

        /*if( fcounter <= 8 ) {
                ROSPrintf("ooo--- Noise Statistics: ---ooo\n");
                ROSPrintf("ooo--- Count of Y MAD between %d and %d is : %d ---ooo\n", MAD_Y_th1, MAD_Y_th2, MAD_Y_Count);
                ROSPrintf("ooo--- Avg count of U&V MAD between %d and %d is : %d&%d ---ooo\n", MAD_C_th1, MAD_C_th2, MAD_U_Count, MAD_V_Count);
                ROSPrintf("ooo--- Avg count of same edge type: %d ---ooo\n", et_y_count);
                ROSPrintf("ooo--- Avg same edge type sum/count for Y = %d, U = %d, V = %d ---ooo\n", et_y_sum/et_y_count, et_u_sum/et_y_count, et_v_sum/et_y_count);
        }*/
    fcounter++;
    if(fcounter == 5) {
            MAD_Y_avg = MAD_Y_tmp_sum/5;
            MAD_U_avg = MAD_U_tmp_sum/5;
            MAD_V_avg = MAD_V_tmp_sum/5;
            et_y_count_avg = et_y_count_tmp_sum/5;
            /*
            RTNR_offset = 0;
            if( MAD_Y_avg < 1000 )
                    RTNR_offset -= 2;
            else if( MAD_Y_avg < 5000 )
                    RTNR_offset -= 1;
            if( MAD_Y_avg > 500000 )
                    RTNR_offset += 3;
            else if( MAD_Y_avg > 100000 )
                    RTNR_offset += 2;
            else if( MAD_Y_avg > 30000 )
                    RTNR_offset += 1;

            //if( MAD_U_avg > 300000 ) // judged as motion
            //     RTNR_offset -= 2;
            //else if( MAD_U_avg > 150000 )
            //     RTNR_offset -= 1;
            //else if( MAD_U_avg > 10000 && MAD_U_avg < 80000 ) // judged as noise
            if( MAD_U_avg > 10000 ) // judged as noise
                    RTNR_offset += 1;

            //if( MAD_V_avg > 300000 ) // judged as motion
            //     RTNR_offset -= 2;
            //else if( MAD_V_avg > 150000 )
            //     RTNR_offset -= 1;
            //else if( MAD_V_avg > 10000 && MAD_V_avg < 80000 ) // judged as noise
            if( MAD_V_avg > 10000 ) // judged as noise
                    RTNR_offset += 1;

            if( et_y_count_avg < 2000 )
                    RTNR_offset += 4;
            else if( et_y_count_avg < 3000 )
                    RTNR_offset += 3;
            else if( et_y_count_avg < 5000 )
                    RTNR_offset += 2;
            else if( et_y_count_avg < 10000 )
                    RTNR_offset += 1;
            if( et_y_count_avg > 800000 )
                    RTNR_offset -= 3;
            else if( et_y_count_avg > 500000 )
                    RTNR_offset -= 2;
            else if( et_y_count_avg > 300000 )
                    RTNR_offset -= 1;

            RTNR_offset /= 2;
            */
            ///*
            //ROSPrintf("ooo--- Noise Statistics: ---ooo\n");
            //ROSPrintf("ooo--- Range of Y MAD between %d and %d is : %d~%d, avg = %d ---ooo\n", MAD_Y_th1, MAD_Y_th2, MAD_Y_min, MAD_Y_2ndmax, MAD_Y_avg);
            //ROSPrintf("ooo--- Range of U&V MAD between %d and %d is : %d~%d & %d~%d ---ooo\n", MAD_C_th1, MAD_C_th2, MAD_U_min, MAD_U_2ndmax, MAD_V_min, MAD_V_2ndmax);
            //ROSPrintf("ooo--- Avg count of same edge type: %d ---ooo\n", et_y_count_avg);
            //ROSPrintf("ooo--- Avg same edge type sum/count for Y = %d, U = %d, V = %d ---ooo\n", et_y_ratio_tmp_sum/50, et_u_ratio_tmp_sum/50, et_v_ratio_tmp_sum/50);
            //ROSPrintf("ooo--- RTNR offset = %d, RTNR level = %d, SPNR level = %d ---ooo\n", RTNR_offset, RTNR_LEVEL_SDHD, SPNR_LEVEL_SDHD);
            //ROSPrintf("ooo--- RTNR offset = %d ---ooo\n", RTNR_offset);
            //*/
        #if 0
           	static unsigned int counter=0;
			if(counter%5==0)
				ROSPrintf("=%d,\n", MAD_Y_avg);
		#endif
            fcounter = 0;
            MAD_Y_tmp_sum = MAD_U_tmp_sum = MAD_V_tmp_sum = 0;
            et_y_count_tmp_sum =0;
            MAD_Y_min = MAD_U_min = MAD_V_min = 0xFFFFFFFF;
            MAD_Y_max = MAD_U_max = MAD_V_max = 0;
            MAD_Y_2ndmax = MAD_U_2ndmax = MAD_V_2ndmax = 0;
			ret_value = MAD_Y_avg;
    }
	return ret_value;
#else
	static unsigned int ret_value = 0;
	static unsigned char fcounter = 0;

	// MAD counter threshold setting
	unsigned int MAD_Y_Count;
	static unsigned int MAD_Y_tmp_sum = 0;
	unsigned int MAD_Y_avg;
	di_im_di_rtnr_mad_y_th_RBUS im_di_rtnr_mad_y_th_reg;
	di_im_di_rtnr_mad_y_counter_RBUS im_di_rtnr_mad_y_counter_reg;
	im_di_rtnr_mad_y_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_TH_reg);
	im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = 0x020;
	im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = 0x7FF;
#ifndef LG_Demo_flag
	rtd_outl(DI_IM_DI_RTNR_MAD_Y_TH_reg, im_di_rtnr_mad_y_th_reg.regValue);
#endif

	//same edge conter setting
	unsigned int et_y_count;
	unsigned int et_y_sum, et_y_ave;
	di_im_di_rtnr_et_count_y_RBUS im_di_et_count_y_reg;
	di_im_di_rtnr_et_sum_y_RBUS im_di_et_sum_y_reg;
	di_im_di_rtnr_hmcnr_RBUS di_im_di_rtnr_hmcnr_RBUS_reg;
	di_im_di_rtnr_hmcnr_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_reg);
	di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_mad_window = 2;
	di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_search_range = 0;
	rtd_outl(DI_IM_DI_RTNR_HMCNR_reg, di_im_di_rtnr_hmcnr_RBUS_reg.regValue);

	//MAD counter calculate
	im_di_rtnr_mad_y_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);
	MAD_Y_Count = im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery;
	MAD_Y_tmp_sum += MAD_Y_Count;
	fcounter++;
	if(fcounter == 5)
	{
		MAD_Y_avg = MAD_Y_tmp_sum/5;
		fcounter = 0;
		MAD_Y_tmp_sum = 0;
		ret_value = MAD_Y_avg;
	}

	//same edge calculate
	im_di_et_count_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_COUNT_Y_reg);
	im_di_et_sum_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_Y_reg);
	et_y_count = im_di_et_count_y_reg.cp_temporal_same_et_cnt_y;
	et_y_sum = im_di_et_sum_y_reg.cp_temporal_same_et_sad_sum_y;
	if(et_y_count==0)
		et_y_count=1;
	et_y_ave = (et_y_sum/et_y_count);

#if 0
	if(MA_print_count%50==0)
		ROSPrintf("n=%d,e=%d,\n",ret_value, et_y_ave);
#endif
	//reuturn
	return ret_value;

#endif
}
#endif

//Elsie 20131212, original by jimmy.lin
unsigned char scalerVIP_Fade_Detection (void)
{
	//static unsigned int ProfSum_pre_field = 0;
	static unsigned int ProfSum_pre_frame = 0;
	static unsigned char isEvenField=0;
	static char fadeDirection = 0;
	static short fadeCount = 0;
	static short stillCount = 0;

	unsigned char isProgressive = 0;
	unsigned int ProfSum_curr_frame = 0;
	int frameDiff = 0;
	unsigned char isValidFrame=0;
	unsigned short diff_still_th = 0;
	unsigned short diff_Th1 = 0, diff_Th2 = 0;
	unsigned short still_Th = 10;

	unsigned short IWid;
	unsigned short ILen;
	unsigned char profsum_shift = 0;

	vgip_vgip_chn1_act_hsta_width_RBUS vgip_chn1_act_hsta_width_reg;
	vgip_vgip_chn1_act_vsta_length_RBUS vgip_chn1_act_vsta_length_reg;

	vgip_chn1_act_hsta_width_reg.regValue  = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg);
	vgip_chn1_act_vsta_length_reg.regValue = scaler_rtd_inl(VGIP_VGIP_CHN1_ACT_VSTA_Length_reg);

	isProgressive = ( SmartPic_clue->SCALER_DISP_INFO.disp_status & _BIT8 ) == 0;
/*
        if( MA_print_count% 180==0 )
	{
		ROSPrintf("[ScalerVIP] isProgressive = %d\n", isProgressive);
	}
*/
	//IWid = scaler_disp_info[_CHANNEL1].DispWid;
	//ILen = scaler_disp_info[_CHANNEL1].DispLen;
	IWid = vgip_chn1_act_hsta_width_reg.ch1_ih_act_wid;
	ILen = vgip_chn1_act_vsta_length_reg.ch1_iv_act_len;

	profile_ich1_hist_profile_ctrl_RBUS ich1_hist_profile_ctrl_reg;
	ich1_hist_profile_ctrl_reg.regValue = rtd_inl(PROFILE_ICH1_Hist_Profile_CTRL_reg);

	switch( ich1_hist_profile_ctrl_reg.ch1_pf_hnsr )
	{
		case 1:
			profsum_shift = 8;
			break;
		case 2:
			profsum_shift = 9;
			break;
		case 3:
			profsum_shift = 10;
			break;
		default: // shouldn't come here normally
			profsum_shift = 0;
			break;
	}

	// Progressive: current frame vs. previous frame
	if( isProgressive )
	{
		ProfSum_curr_frame = ProfSum;
		frameDiff = ProfSum_curr_frame - ProfSum_pre_frame;
		isValidFrame = 1;
	}

	// Interlaced: current even field vs. previous even field
	else if(isEvenField == 1 )
	{
		ProfSum_curr_frame = ProfSum;
		frameDiff = ProfSum_curr_frame - ProfSum_pre_frame;
		isValidFrame = 1;
		ILen *= 2;
	}
	else
	{
		isValidFrame = 0;
	}

	diff_still_th =  ( ( IWid * ILen ) >> profsum_shift ) >> 4; // avg. Y change 1/16
	diff_Th1 = ( ( IWid * ILen ) >> profsum_shift ) >> 2; // avg. Y change 1/4
	//diff_Th1 = 0;
	diff_Th2 = ( ( IWid * ILen ) >> profsum_shift ) << 3; // avg. Y change 8

	if( isValidFrame ) {
		if( abs(frameDiff) > diff_still_th ) {
			if( frameDiff * fadeDirection < 0 ) { // direction changed
				fadeCount = 0;
				fadeDirection = (frameDiff > 0) ? 1 : -1;
			}
			else if ( abs(frameDiff) >= diff_Th1 && abs(frameDiff) <= diff_Th2 ) {
				fadeCount++;
				fadeDirection = (frameDiff > 0) ? 1 : -1;
			}
			stillCount = 0;
		}
		else { // change 0~very small, judged as still
			stillCount++;
			if( stillCount >= still_Th ) { // still for more than set number of frames
				fadeCount = 0;
				fadeDirection = 0;
				stillCount = 0;
			}
		}

		ProfSum_pre_frame = ProfSum_curr_frame;
	}

	isEvenField = (isEvenField==0) ? 1 : 0;
#if 0
	if( MA_print_count% 180==0 )
	{
		ROSPrintf("[ScalerVIP] ProfSum = %d, ProfSum_pre = %d\n", ProfSum, ProfSum_pre_frame);
		ROSPrintf("[ScalerVIP] Frame diff: %d, Fade direction: %d, stillCount: %d\n", frameDiff, fadeDirection, stillCount);
	}
#endif
	if( fadeCount >= 4 ) return true;
	else return false;

}

// 20130823 jimmy.lin for noise statistics
MOTION_NOISE_TYPE scalerVIP_noise_estimation_MAD_et( unsigned int width, unsigned int height )
{
	static unsigned char fcounter = 0;
	unsigned int MAD_Y_th1, MAD_Y_th2;
	unsigned int MAD_C_th1, MAD_C_th2;
	unsigned int MAD_Y_Count, MAD_U_Count, MAD_V_Count;
	static unsigned int MAD_Y_tmp_sum = 0;
	static unsigned int MAD_U_tmp_sum = 0;
	static unsigned int MAD_V_tmp_sum= 0;
	static unsigned int MAD_Y_min = 0xFFFFFFFF;
	static unsigned int MAD_Y_max = 0;
	static unsigned int MAD_Y_2ndmax = 0;
	static unsigned int MAD_U_min = 0xFFFFFFFF;
	static unsigned int MAD_U_max = 0;
	static unsigned int MAD_U_2ndmax = 0;
	static unsigned int MAD_V_min = 0xFFFFFFFF;
	static unsigned int MAD_V_max = 0;
	static unsigned int MAD_V_2ndmax = 0;
	unsigned int et_y_count;
	//unsigned int et_y_sum, et_u_sum, et_v_sum;
	static unsigned int et_y_count_tmp_sum = 0;
	unsigned int MAD_Y_avg, MAD_U_avg, MAD_V_avg, et_y_count_avg;
	static MOTION_NOISE_TYPE isMotion = 0; // 0: still, 1: motion, 2: noise

	di_im_di_rtnr_mad_y_th_RBUS im_di_rtnr_mad_y_th_reg;
	di_im_di_rtnr_mad_c_th_RBUS im_di_rtnr_mad_c_th_reg;
	di_im_di_rtnr_mad_y_counter_RBUS im_di_rtnr_mad_y_counter_reg;
	di_im_di_rtnr_mad_u_counter_RBUS im_di_rtnr_mad_u_counter_reg;
	di_im_di_rtnr_mad_v_counter_RBUS im_di_rtnr_mad_v_counter_reg;
	di_im_di_rtnr_et_count_y_RBUS im_di_et_count_y_reg;
	di_im_di_rtnr_level_bound_RBUS im_di_rtnr_level_bound_reg;
	//di_im_di_rtnr_et_sum_y_RBUS im_di_et_sum_y_reg;
	//di_im_di_rtnr_et_sum_u_RBUS im_di_et_sum_u_reg;
	//di_im_di_rtnr_et_sum_v_RBUS im_di_et_sum_v_reg;

	MAD_Y_th1 = 0x017; //23
	MAD_Y_th2 = 0x7FF;
	//MAD_Y_th1 = 0x0;
	//MAD_Y_th2 = 0xA;
	MAD_C_th1 = 0x010;
	MAD_C_th2 = 0x7FF;
	/*if( fcounter < 8 ) {
		MAD_Y_th1 = 0x100 * fcounter;
		MAD_Y_th2 = 0x100 * (fcounter+1) -1;
	}*/

	im_di_rtnr_mad_y_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_TH_reg);
	im_di_rtnr_mad_c_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_C_TH_reg);
	im_di_rtnr_level_bound_reg.regValue = rtd_inl(DI_IM_DI_RTNR_LEVEL_BOUND_reg);
	//MAD_Y_th1 = im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1;
	//MAD_Y_th2 = im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2;
	//MAD_C_th1 = im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1;
	//MAD_C_th2 = im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th2;
	im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = MAD_Y_th1;
	im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = MAD_Y_th2;
	im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th1 = MAD_C_th1;
	im_di_rtnr_mad_c_th_reg.cp_temporal_mad_c_th2 = MAD_C_th2;
	im_di_rtnr_level_bound_reg.cp_temporal_nl_low_bnd_y = 0;
	im_di_rtnr_level_bound_reg.cp_temporal_nl_up_bnd_y = 0xFF;
	rtd_outl(DI_IM_DI_RTNR_MAD_Y_TH_reg, im_di_rtnr_mad_y_th_reg.regValue);
	rtd_outl(DI_IM_DI_RTNR_MAD_C_TH_reg, im_di_rtnr_mad_c_th_reg.regValue);
	rtd_outl(DI_IM_DI_RTNR_LEVEL_BOUND_reg, im_di_rtnr_level_bound_reg.regValue);

	im_di_rtnr_mad_y_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);
	im_di_rtnr_mad_u_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_U_COUNTER_reg);
	im_di_rtnr_mad_v_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_V_COUNTER_reg);
	MAD_Y_Count = im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery;
	MAD_U_Count = im_di_rtnr_mad_u_counter_reg.cp_temporal_mad_counteru;
	MAD_V_Count = im_di_rtnr_mad_v_counter_reg.cp_temporal_mad_counterv;

	im_di_et_count_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_COUNT_Y_reg);
	//im_di_et_sum_y_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_Y_reg);
	//im_di_et_sum_u_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_U_reg);
	//im_di_et_sum_v_reg.regValue = rtd_inl(DI_IM_DI_RTNR_ET_SUM_V_reg);
	et_y_count = im_di_et_count_y_reg.cp_temporal_same_et_cnt_y;
	//et_y_sum = im_di_et_sum_y_reg.cp_temporal_same_et_sad_sum_y;
	//et_u_sum = im_di_et_sum_u_reg.cp_temporal_same_et_sad_sum_u;
	//et_v_sum = im_di_et_sum_v_reg.cp_temporal_same_et_sad_sum_v;

	MAD_Y_tmp_sum += MAD_Y_Count;
	MAD_U_tmp_sum += MAD_U_Count;
	MAD_V_tmp_sum += MAD_V_Count;
	et_y_count_tmp_sum += et_y_count;
	if(et_y_count == 0 ) et_y_count += 1;

	if( MAD_Y_Count < MAD_Y_min ) MAD_Y_min = MAD_Y_Count;
	if( MAD_Y_Count > MAD_Y_2ndmax ) {
		if( MAD_Y_Count > MAD_Y_max ) {
			MAD_Y_2ndmax = MAD_Y_max; // drop max to avoid scene change
			MAD_Y_max= MAD_Y_Count;
		}
		else MAD_Y_2ndmax = MAD_Y_Count;
	}
	if( MAD_U_Count < MAD_U_min ) MAD_U_min = MAD_U_Count;
	if( MAD_U_Count > MAD_U_2ndmax ) {
		if( MAD_U_Count > MAD_U_max ) {
			MAD_U_2ndmax = MAD_U_max; // drop max to avoid scene change
			MAD_U_max= MAD_U_Count;
		}
		else MAD_U_2ndmax = MAD_U_Count;
	}
	if( MAD_V_Count < MAD_V_min ) MAD_V_min = MAD_V_Count;
	if( MAD_V_Count > MAD_V_2ndmax ) {
		if( MAD_V_Count > MAD_V_max ) {
			MAD_V_2ndmax = MAD_V_max; // drop max to avoid scene change
			MAD_V_max= MAD_V_Count;
		}
		else MAD_V_2ndmax = MAD_V_Count;
	}

	fcounter++;
	if(fcounter % 5 == 0) {
		MAD_Y_avg = MAD_Y_tmp_sum/5;
		MAD_U_avg = MAD_U_tmp_sum/5;
		MAD_V_avg = MAD_V_tmp_sum/5;
		et_y_count_avg = et_y_count_tmp_sum/5;

		isMotion = MOTION_NOISE_TYPE_STILL;
		if( MAD_Y_avg > ((width*height) >> 6) ) // total area/64
		{
			isMotion = MOTION_NOISE_TYPE_MOTION; // judge as motion
			if( MAD_Y_avg > ((width*height) >> 4) ) // total area / 16
				isMotion = MOTION_NOISE_TYPE_LARGE_MOTION;
			else if( et_y_count_avg < ((width*height) >> 4) ) // total area/16
				isMotion = MOTION_NOISE_TYPE_NOISE; // judge as noise
		}
#if 1
		if( (fcounter%debug_print_delay_time == 0) &&(Start_Print.Rtnr_1==TRUE) )
		{

			ROSPrintf("ooo--- Noise Statistics: ---ooo\n");
			ROSPrintf("ooo--- Range of Y MAD between %d and %d is : %d~%d, avg = %d ---ooo \n", MAD_Y_th1, MAD_Y_th2, MAD_Y_min, MAD_Y_2ndmax, MAD_Y_avg);
			ROSPrintf("ooo--- Range of U&V MAD between %d and %d is : %d~%d & %d~%d ---ooo \n", MAD_C_th1, MAD_C_th2, MAD_U_min, MAD_U_2ndmax, MAD_V_min, MAD_V_2ndmax);
			ROSPrintf("ooo--- Avg count of same edge type: %d ---ooo\n", et_y_count_avg);

			switch( isMotion )
			{
				case MOTION_NOISE_TYPE_STILL:
					ROSPrintf("ooo--- MOTION_NOISE_TYPE_STILL ---ooo\n");
					break;
				case MOTION_NOISE_TYPE_MOTION:
					ROSPrintf("ooo--- MOTION_NOISE_TYPE_MOTION ---ooo\n");
					break;
				case MOTION_NOISE_TYPE_LARGE_MOTION:
					ROSPrintf("ooo--- MOTION_NOISE_TYPE_LARGE_MOTION ---ooo\n");
					break;
				case MOTION_NOISE_TYPE_NOISE:
					ROSPrintf("ooo--- MOTION_NOISE_TYPE_NOISE ---ooo\n");
					break;
			}
			fcounter = 0;
		}
#endif
		MAD_Y_tmp_sum = MAD_U_tmp_sum = MAD_V_tmp_sum = 0;
		et_y_count_tmp_sum =0;
		MAD_Y_min = MAD_U_min = MAD_V_min = 0xFFFFFFFF;
		MAD_Y_max = MAD_U_max = MAD_V_max = 0;
		MAD_Y_2ndmax = MAD_U_2ndmax = MAD_V_2ndmax = 0;
	}

	return isMotion;

}


void scalerVIP_RTNR_correctionbit_period(void)
{
	static unsigned short framecnt = 0;
	static unsigned short pseudo_ran = 0;
	unsigned int pseudo_ran_var = 566927;
	unsigned char nRan_Range=5;
	unsigned char correctionbit_period = 0;

	if((SmartPic_clue->MAD_motion_status) == MOTION_NOISE_TYPE_MOTION) // motion
		correctionbit_period = 1;
	else if((SmartPic_clue->MAD_motion_status) == MOTION_NOISE_TYPE_NOISE) // noise or very large motion
		correctionbit_period = 1;
	else	// still
	{
		//correctionbit_period = pseudo_ran;
		correctionbit_period = 1;
	}

	if( (correctionbit_period != 0) && (framecnt % correctionbit_period == 0) ) {
		IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3);
		if( pseudo_ran_var != 0 )
			pseudo_ran = (pseudo_ran*3612+5701) % pseudo_ran_var;
		else
			pseudo_ran = 0;

		pseudo_ran = pseudo_ran % nRan_Range;
		framecnt = 0;
	}

	/*
	if( MA_print_count% 180==0 ) {
		ROSPrintf("[AutoRTNR] MAD_motion_status = %d, di_motion_status = %d, correctionbit_period = %d\n", (SmartPic_clue->MAD_motion_status), (SmartPic_clue->di_motion_status), correctionbit_period );
	}
	*/
	framecnt++;
}


// 20131209 jimmy.lin
MOTION_NOISE_TYPE scalerVIP_Profile_Block_Motion(_clues* SmartPic_clue)
{
	unsigned char ii,jj;
	unsigned char Profile_Block_Num = 16;//set profile h&V block number
	unsigned short *H_Block = &(SmartPic_clue->Profile_Cal_INFO.H_Block_Y[0]);
	unsigned short *V_Block = &(SmartPic_clue->Profile_Cal_INFO.V_Block_Y[0]);

	static unsigned char isEvenField = 0;

	static unsigned short pre_H_Block[16] = {0};
	static unsigned short pre_V_Block[16] = {0};
	static int diff_H[10][16] = {{0},{0},{0},{0},{0},{0},{0},{0},{0},{0}};
	static int diff_V[10][16] = {{0},{0},{0},{0},{0},{0},{0},{0},{0},{0}};

	unsigned int sum_of_difference[10];
	for( jj=0; jj<10; jj++ ) {
		sum_of_difference[jj] = 0;
	}
	//unsigned short motion_trend = 0;
	unsigned short motion_th = 1;
	unsigned char maxDirCnt = 0;
	unsigned char sameDirCnt = 0;
	unsigned char diffDirCnt = 0;
	char currDir;
	char sign; // 1: +, -1: -, 0: zero or under threshold
	unsigned short maxDiff, totalDiff;

	MOTION_NOISE_TYPE H_Block_Motion[16];
	MOTION_NOISE_TYPE V_Block_Motion[16];

	static MOTION_NOISE_TYPE isMotion = 0;

	for( ii=0; ii<Profile_Block_Num; ii++ )
	{
		H_Block_Motion[ii] = MOTION_NOISE_TYPE_STILL;
		V_Block_Motion[ii] = MOTION_NOISE_TYPE_STILL;
	}

	if( isEvenField != 0 ) {

		block_motion_count_H = 0;
		block_motion_count_V = 0;
		block_noise_count_H = 0;
		block_noise_count_V = 0;

		//motion detection
		for (ii=0;ii<Profile_Block_Num;ii++)
		{
			for(jj=9; jj>0; jj--) {
				diff_H[jj][ii] = diff_H[jj-1][ii];
				diff_V[jj][ii] = diff_V[jj-1][ii];
				sum_of_difference[jj] += abs(diff_H[jj][ii]) + abs(diff_V[jj][ii]);
			}
			diff_H[0][ii] = H_Block[ii] - pre_H_Block[ii];
			diff_V[0][ii] = V_Block[ii] - pre_V_Block[ii];
			sum_of_difference[0] += abs(diff_H[0][ii]) + abs(diff_V[0][ii]);

		}

		//save profile to buffer:pre_H_Block, pre_V_Block
		for (ii=0;ii<Profile_Block_Num;ii++)
		{
			pre_H_Block[ii] = H_Block[ii];
			pre_V_Block[ii] = V_Block[ii];
		}

		for( ii=0; ii<Profile_Block_Num; ii++ ) {

			// H_Block motion determination
			maxDirCnt = 0;
			sameDirCnt = 0;
			diffDirCnt = 0;
			maxDiff = 0;
			totalDiff = 0;
			if( abs(diff_H[0][ii]) < motion_th )
				currDir = 0;
			else
				currDir = (diff_H[0][ii]>=0 ? 1 : -1);

			for( jj=1; jj<5; jj++ ) {
				if( abs(diff_H[jj][ii]) < motion_th )
					sign = 0;
				else
					sign = (diff_H[jj][ii]>=0 ? 1 : -1);

				if( sign == currDir && currDir!= 0 ) {
					sameDirCnt++;
					if( sameDirCnt > maxDirCnt )
						maxDirCnt = sameDirCnt;
					totalDiff += abs(diff_H[jj][ii]);
					if( totalDiff > maxDiff )
						maxDiff = totalDiff;
				}
				else if( sign != 0 && currDir != 0 ) { // different direction
					sameDirCnt = 0;
					diffDirCnt++;
					currDir = sign;
					totalDiff = 0;
				}
				else {
					totalDiff = abs(totalDiff + diff_H[jj][ii]);
					if( totalDiff > maxDiff )
						maxDiff = totalDiff;
				}
			}
			if( diffDirCnt >= 2  ) {
				H_Block_Motion[ii] = MOTION_NOISE_TYPE_NOISE;
				block_noise_count_H++;
			}
			else if( maxDirCnt >= 3 || (maxDirCnt>1 && maxDiff >= motion_th*maxDirCnt ) ) {
				H_Block_Motion[ii] = MOTION_NOISE_TYPE_MOTION;
				block_motion_count_H++;
			}
			else {
				H_Block_Motion[ii] = MOTION_NOISE_TYPE_STILL;
			}

			// V_Block motion determination
			maxDirCnt = 0;
			sameDirCnt = 0;
			diffDirCnt = 0;
			maxDiff = 0;
			totalDiff = 0;
			if( abs(diff_V[0][ii]) < motion_th )
				currDir = 0;
			else
				currDir = (diff_V[0][ii]>=0 ? 1 : -1);

			for( jj=1; jj<5; jj++ ) {
				if( abs(diff_V[jj][ii]) < motion_th )
					sign = 0;
				else
					sign = (diff_V[jj][ii]>=0 ? 1 : -1);

				if( sign == currDir && currDir!= 0 ) {
					sameDirCnt++;
					if( sameDirCnt > maxDirCnt )
						maxDirCnt = sameDirCnt;
					totalDiff += abs(diff_V[jj][ii]);
					if( totalDiff > maxDiff )
						maxDiff = totalDiff;
				}
				else if( sign != 0 && currDir != 0 ) { // different direction
					sameDirCnt = 0;
					diffDirCnt++;
					currDir = sign;
					totalDiff = 0;
				}
				else {
					totalDiff = abs(totalDiff + diff_V[jj][ii]);
					if( totalDiff > maxDiff )
						maxDiff = totalDiff;
				}
			}
			if( diffDirCnt > 2  ) {
				V_Block_Motion[ii] = MOTION_NOISE_TYPE_NOISE;
				block_noise_count_V++;
			}
			else if( maxDirCnt >= 3 || (maxDirCnt>1 && maxDiff >= motion_th*maxDirCnt ) ) {
				V_Block_Motion[ii] = MOTION_NOISE_TYPE_MOTION;
				block_motion_count_V++;
			}
			else {
				V_Block_Motion[ii] = MOTION_NOISE_TYPE_STILL;
			}

		}

	}

	isEvenField = (isEvenField+1) % 2;
	//flag_motion_type_pre = flag_motion_type;
	if( (block_motion_count_H >= 8) || (block_motion_count_V >= 8) )
		isMotion = MOTION_NOISE_TYPE_MOTION;
	else {
		isMotion = MOTION_NOISE_TYPE_STILL;
	}
#if 0
	if( MA_print_count% 180==0 ) {
		///*
		for( ii=0; ii<Profile_Block_Num; ii++ ) {
			ROSPrintf("diff_H of block %d: ", ii );
			for( jj=0; jj<5; jj++ ) {
				ROSPrintf("%d ", diff_H[jj][ii] );
			}
			ROSPrintf("\n");
		}


		for( ii=0; ii<Profile_Block_Num; ii++ ) {
			ROSPrintf("diff_V of block %d: ", ii );
			for( jj=0; jj<5; jj++ ) {
				ROSPrintf("%d ", diff_V[jj][ii] );
			}
			ROSPrintf("\n");
		}

		ROSPrintf("H motion level: ");
		for( ii=0; ii<Profile_Block_Num; ii++ ) {
			ROSPrintf("%d ", H_Block_Motion[ii]);
		}
		ROSPrintf("\n");
		ROSPrintf("V motion level: ");
		for( ii=0; ii<Profile_Block_Num; ii++ ) {
			ROSPrintf("%d ", V_Block_Motion[ii]);
		}
		ROSPrintf("\n");
		//*/
		//ROSPrintf("block_motion_count_H = %d, block_motion_count_V = %d\n", block_motion_count_H, block_motion_count_V );
	}
#endif
	return isMotion;
}

unsigned char scalerVIP_RTNR_level_compute(MOTION_NOISE_TYPE MADMotion, MOTION_NOISE_TYPE blockMotion, unsigned short *PQA_Input_Level, unsigned short *PQA_Input_rate)
{
	static char RTNR_level_SdHd = 1;
	static char SPNR_level_SdHd;
	static unsigned char counter_file = 0;
	unsigned char motion_blk_cnt;
	char target_level=0,target_level_T=0,target_level_S=0;
	static unsigned short motion_total = 0; // for avg..
	static unsigned char motion_cnt= 0;
	char content_spatial_noise_offset = 0;

	// content spatial noise meter offset
	if( scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE) )
	{
		unsigned char spatial_noise_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL);

		if( (spatial_noise_level >= 1) && (spatial_noise_level <= 2) )
		{
			content_spatial_noise_offset = 1;
		}
		else if( (spatial_noise_level >= 3) && (spatial_noise_level <= 4))
		{
			content_spatial_noise_offset = 2;
		}
		else
		{
			content_spatial_noise_offset = 0;
		}
	}


	// motion_level: 0 <- still      motion -> 9
	// target_level = 9-motion_level
	if( MADMotion == MOTION_NOISE_TYPE_LARGE_MOTION )
	{
		motion_total += 9;
		motion_cnt++;
	}
	else
	{
		motion_blk_cnt = (block_motion_count_H>=block_motion_count_V) ? block_motion_count_H : block_motion_count_V;
		if( motion_blk_cnt >= 12 )
		{
			motion_total += 9;
			motion_cnt++;
		}
		else if( scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN) > 0 )  // V-PAN condition
		{
			motion_total += 9;
			motion_cnt++;
		}
		else if( motion_blk_cnt >= 7 ) // half motion <- 5~9 -> total motion
		{
			//motion_total += (12 - motion_blk_cnt);
			motion_total += motion_blk_cnt - 2;
			motion_cnt++;
		}
		else if( MADMotion == MOTION_NOISE_TYPE_MOTION )
		{
			motion_total += 7;
			motion_cnt++;
		}
	}

	counter_file++;

	if( counter_file % 21 == 0 )
	{
		if( motion_cnt > 10 )
		{
			//target_level = motion_total / motion_cnt - 1;
			target_level = 9 - (motion_total / motion_cnt);
		}
		else
		{
			//target_level = 9;
			target_level = 9 - (motion_total / 21);
		}

		// content special noise offset
		//target_level += content_spatial_noise_offset;
		//if( target_level > 9 )
			//target_level = 9;

		target_level_T=target_level;
		target_level_S=target_level;

		// special pattern identify
		if( (DynamicOptimizeSystem[35] == 1) || (DynamicOptimizeSystem[47] == 1) ||  (DynamicOptimizeSystem[133] == 1) || (DynamicOptimizeSystem[134] == 1) || (DynamicOptimizeSystem[135] == 1) )
		{
			target_level_T = 0;
		}


		if( RTNR_level_SdHd > target_level_T )
		{
			RTNR_level_SdHd--;
			// switch on correction1
			IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3);
		}
		else if( RTNR_level_SdHd < target_level_T )
		{
			RTNR_level_SdHd++;
			// switch on correction1
			IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3);
		}

		counter_file = 0;
		motion_total = 0;
		motion_cnt = 0;

		//ROSPrintf( "Current RTNR level = %d, target level = %d\n", RTNR_level_SdHd, target_level );
		//ROSPrintf( "Block motion H = %d, block motion V = %d\n", block_motion_count_H, block_motion_count_V );
		    SPNR_level_SdHd = RTNR_level_SdHd;

			// content special noise offset
		    if(target_level>5) // enhance TNR
		        target_level_T+=content_spatial_noise_offset;
		    else // enhance SNR
		      	target_level_S -= content_spatial_noise_offset;


		    if( RTNR_level_SdHd > target_level_T )
		        RTNR_level_SdHd--;
		    else if( RTNR_level_SdHd < target_level_T )
		        RTNR_level_SdHd++;

		    if( SPNR_level_SdHd > target_level_S )
		        SPNR_level_SdHd--;
		    else if( SPNR_level_SdHd < target_level_S )
		        SPNR_level_SdHd++;

		    if (RTNR_level_SdHd>9)
		        RTNR_level_SdHd=9;
		    if(RTNR_level_SdHd<0)
		        RTNR_level_SdHd=0;

		    if (SPNR_level_SdHd>9)
		        SPNR_level_SdHd=9;
		    if(SPNR_level_SdHd<0)
		        SPNR_level_SdHd=0;

	}



	if( SmartPic_clue->SceneChange_NR )
	{
		if(Start_Print.Rtnr_1==TRUE)
		{
			ROSPrintf("*************** [RTNR] Scene Change!!!!! ***************\n" );
		}
		RTNR_level_SdHd = 0;
	}

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Snr==TRUE))
	{
		ROSPrintf( "** target level = %d, target level T = %d, target level S = %d\n", target_level, target_level_T, target_level_S );
		ROSPrintf( "** RTNR level = %d, SPNR level = %d\n",  RTNR_level_SdHd, SPNR_level_SdHd );
		ROSPrintf( "** content_spatial_noise_offset = %d\n", content_spatial_noise_offset );
	}

	PQA_Input_Level[I_MOTION_RTNR] = RTNR_level_SdHd;
	PQA_Input_rate[I_MOTION_RTNR] =0;
	PQA_Input_Level[I_MOTION_SPNR] = SPNR_level_SdHd;
	PQA_Input_rate[I_MOTION_SPNR] =0;
	return RTNR_level_SdHd;
}

//#ifdef ISR_READ_SRC_DET_FUNCTIOM_ENABLE
char scalerVIP_ReadSrcDet(unsigned char step_thl, unsigned char step_max, unsigned char step_min)
{
	profile_srcdet_control_RBUS srcdet_control_reg;
	profile_srcdet_tsh_step_thl_RBUS srcdet_tsh_step_thl_reg;
	profile_srcdet_tsh_step_max_RBUS srcdet_tsh_step_max_reg;
	profile_srcdet_tsh_step_min_RBUS srcdet_tsh_step_min_reg;
	UINT32 sum=0;


	unsigned int average;
	unsigned char i=0;
	srcdet_control_reg.regValue = rtd_inl(PROFILE_SRCDET_CONTROL_reg);
	srcdet_tsh_step_thl_reg.regValue = rtd_inl(PROFILE_SRCDET_TSH_STEP_THL_reg);
	srcdet_tsh_step_max_reg.regValue = rtd_inl(PROFILE_SRCDET_TSH_STEP_MAX_reg);
	srcdet_tsh_step_min_reg.regValue = rtd_inl(PROFILE_SRCDET_TSH_STEP_MIN_reg);

	srcdet_tsh_step_thl_reg.srcdet_tsh_step_thl = step_thl;
	srcdet_tsh_step_max_reg.srcdet_tsh_step_max = step_max;
	srcdet_tsh_step_min_reg.srcdet_tsh_step_min = step_min;


	rtd_outl(PROFILE_SRCDET_CONTROL_reg, srcdet_control_reg.regValue);
	if(ini_ReadSrcDet==0)
	{

		srcdet_tsh_step_thl_reg.srcdet_tsh_step_thl = 31;
		srcdet_tsh_step_max_reg.srcdet_tsh_step_max = step_max;
		srcdet_tsh_step_min_reg.srcdet_tsh_step_min = step_min;
	rtd_outl(PROFILE_SRCDET_TSH_STEP_THL_reg, srcdet_tsh_step_thl_reg.regValue);
	rtd_outl(PROFILE_SRCDET_TSH_STEP_MAX_reg, srcdet_tsh_step_max_reg.regValue);
	rtd_outl(PROFILE_SRCDET_TSH_STEP_MIN_reg, srcdet_tsh_step_min_reg.regValue);
		ini_ReadSrcDet=1;
	}
	if ( srcdet_control_reg.srcdet_start == 0 ) //wait for finish flag
	{
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT//can't use scaler_rtd_t_inl in kernel
		Step_Hist[0] = scaler_rtd_t_inl(profile_srcdet_tsh_hist01_RBUS, PROFILE_SRCDET_TSH_HIST01_reg).srcdet_tsh_hist01;
		Step_Hist[1] = scaler_rtd_t_inl(profile_srcdet_tsh_hist02_RBUS, PROFILE_SRCDET_TSH_HIST02_reg).srcdet_tsh_hist02;
		Step_Hist[2] = scaler_rtd_t_inl(profile_srcdet_tsh_hist03_RBUS, PROFILE_SRCDET_TSH_HIST03_reg).srcdet_tsh_hist03;
		Step_Hist[3] = scaler_rtd_t_inl(profile_srcdet_tsh_hist04_RBUS, PROFILE_SRCDET_TSH_HIST04_reg).srcdet_tsh_hist04;
		Step_Hist[4] = scaler_rtd_t_inl(profile_srcdet_tsh_hist05_RBUS, PROFILE_SRCDET_TSH_HIST05_reg).srcdet_tsh_hist05;
		Step_Hist[5] = scaler_rtd_t_inl(profile_srcdet_tsh_hist06_RBUS, PROFILE_SRCDET_TSH_HIST06_reg).srcdet_tsh_hist06;
		Step_Hist[6] = scaler_rtd_t_inl(profile_srcdet_tsh_hist07_RBUS, PROFILE_SRCDET_TSH_HIST07_reg).srcdet_tsh_hist07;
		Step_Hist[7] = scaler_rtd_t_inl(profile_srcdet_tsh_hist08_RBUS, PROFILE_SRCDET_TSH_HIST08_reg).srcdet_tsh_hist08;
		Step_Hist[8] = scaler_rtd_t_inl(profile_srcdet_tsh_hist09_RBUS, PROFILE_SRCDET_TSH_HIST09_reg).srcdet_tsh_hist09;
		Step_Hist[9] = scaler_rtd_t_inl(profile_srcdet_tsh_hist10_RBUS, PROFILE_SRCDET_TSH_HIST10_reg).srcdet_tsh_hist10;
		Step_Hist[10] = scaler_rtd_t_inl(profile_srcdet_tsh_hist11_RBUS, PROFILE_SRCDET_TSH_HIST11_reg).srcdet_tsh_hist11;
		Step_Hist[11] = scaler_rtd_t_inl(profile_srcdet_tsh_hist12_RBUS, PROFILE_SRCDET_TSH_HIST12_reg).srcdet_tsh_hist12;
		Step_Hist[12] = scaler_rtd_t_inl(profile_srcdet_tsh_hist13_RBUS, PROFILE_SRCDET_TSH_HIST13_reg).srcdet_tsh_hist13;
		Step_Hist[13] = scaler_rtd_t_inl(profile_srcdet_tsh_hist14_RBUS, PROFILE_SRCDET_TSH_HIST14_reg).srcdet_tsh_hist14;
		Step_Hist[14] = scaler_rtd_t_inl(profile_srcdet_tsh_hist15_RBUS, PROFILE_SRCDET_TSH_HIST15_reg).srcdet_tsh_hist15;
		Step_Hist[15] = scaler_rtd_t_inl(profile_srcdet_tsh_hist16_RBUS, PROFILE_SRCDET_TSH_HIST16_reg).srcdet_tsh_hist16;
		Step_Hist[16] = scaler_rtd_t_inl(profile_srcdet_tsh_hist17_RBUS, PROFILE_SRCDET_TSH_HIST17_reg).srcdet_tsh_hist17;
		Step_Hist[17] = scaler_rtd_t_inl(profile_srcdet_tsh_hist18_RBUS, PROFILE_SRCDET_TSH_HIST18_reg).srcdet_tsh_hist18;
		Step_Hist[18] = scaler_rtd_t_inl(profile_srcdet_tsh_hist19_RBUS, PROFILE_SRCDET_TSH_HIST19_reg).srcdet_tsh_hist19;
		Step_Hist[19] = scaler_rtd_t_inl(profile_srcdet_tsh_hist20_RBUS, PROFILE_SRCDET_TSH_HIST20_reg).srcdet_tsh_hist20;

		PMH_Hist[0] = scaler_rtd_t_inl(profile_srcdet_pmh_hist0_RBUS, PROFILE_SRCDET_PMH_HIST0_reg).srcdet_pmh_hist0;
		PMH_Hist[1] = scaler_rtd_t_inl(profile_srcdet_pmh_hist1_RBUS, PROFILE_SRCDET_PMH_HIST1_reg).srcdet_pmh_hist1;
		PMH_Hist[2] = scaler_rtd_t_inl(profile_srcdet_pmh_hist2_RBUS, PROFILE_SRCDET_PMH_HIST2_reg).srcdet_pmh_hist2;
		PMH_Hist[3] = scaler_rtd_t_inl(profile_srcdet_pmh_hist3_RBUS, PROFILE_SRCDET_PMH_HIST3_reg).srcdet_pmh_hist3;
		PMH_Hist[4] = scaler_rtd_t_inl(profile_srcdet_pmh_hist4_RBUS, PROFILE_SRCDET_PMH_HIST4_reg).srcdet_pmh_hist4;
		PMH_Hist[5] = scaler_rtd_t_inl(profile_srcdet_pmh_hist5_RBUS, PROFILE_SRCDET_PMH_HIST5_reg).srcdet_pmh_hist5;
#else
		profile_srcdet_tsh_hist01_RBUS tsh_hist01;
		profile_srcdet_tsh_hist02_RBUS tsh_hist02;
		profile_srcdet_tsh_hist03_RBUS tsh_hist03;
		profile_srcdet_tsh_hist04_RBUS tsh_hist04;
		profile_srcdet_tsh_hist05_RBUS tsh_hist05;
		profile_srcdet_tsh_hist06_RBUS tsh_hist06;
		profile_srcdet_tsh_hist07_RBUS tsh_hist07;
		profile_srcdet_tsh_hist08_RBUS tsh_hist08;
		profile_srcdet_tsh_hist09_RBUS tsh_hist09;
		profile_srcdet_tsh_hist10_RBUS tsh_hist10;
		profile_srcdet_tsh_hist11_RBUS tsh_hist11;
		profile_srcdet_tsh_hist12_RBUS tsh_hist12;
		profile_srcdet_tsh_hist13_RBUS tsh_hist13;
		profile_srcdet_tsh_hist14_RBUS tsh_hist14;
		profile_srcdet_tsh_hist15_RBUS tsh_hist15;
		profile_srcdet_tsh_hist16_RBUS tsh_hist16;
		profile_srcdet_tsh_hist17_RBUS tsh_hist17;
		profile_srcdet_tsh_hist18_RBUS tsh_hist18;
		profile_srcdet_tsh_hist19_RBUS tsh_hist19;
		profile_srcdet_tsh_hist20_RBUS tsh_hist20;

		profile_srcdet_pmh_hist0_RBUS pmh_hist0;
		profile_srcdet_pmh_hist1_RBUS pmh_hist1;
		profile_srcdet_pmh_hist2_RBUS pmh_hist2;
		profile_srcdet_pmh_hist3_RBUS pmh_hist3;
		profile_srcdet_pmh_hist4_RBUS pmh_hist4;
		profile_srcdet_pmh_hist5_RBUS pmh_hist5;

		tsh_hist01.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST01_reg);
		tsh_hist02.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST02_reg);
		tsh_hist03.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST03_reg);
		tsh_hist04.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST04_reg);
		tsh_hist05.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST05_reg);
		tsh_hist06.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST06_reg);
		tsh_hist07.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST07_reg);
		tsh_hist08.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST08_reg);
		tsh_hist09.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST09_reg);
		tsh_hist10.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST10_reg);
		tsh_hist11.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST11_reg);
		tsh_hist12.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST12_reg);
		tsh_hist13.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST13_reg);
		tsh_hist14.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST14_reg);
		tsh_hist15.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST15_reg);
		tsh_hist16.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST16_reg);
		tsh_hist17.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST17_reg);
		tsh_hist18.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST18_reg);
		tsh_hist19.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST19_reg);
		tsh_hist20.regValue = rtd_inl(PROFILE_SRCDET_TSH_HIST20_reg);

		pmh_hist0.regValue = rtd_inl(PROFILE_SRCDET_PMH_HIST0_reg);
		pmh_hist1.regValue = rtd_inl(PROFILE_SRCDET_PMH_HIST1_reg);
		pmh_hist2.regValue = rtd_inl(PROFILE_SRCDET_PMH_HIST2_reg);
		pmh_hist3.regValue = rtd_inl(PROFILE_SRCDET_PMH_HIST3_reg);
		pmh_hist4.regValue = rtd_inl(PROFILE_SRCDET_PMH_HIST4_reg);
		pmh_hist5.regValue = rtd_inl(PROFILE_SRCDET_PMH_HIST5_reg);

		Step_Hist[0] = tsh_hist01.srcdet_tsh_hist01;
		Step_Hist[1] = tsh_hist02.srcdet_tsh_hist02;
		Step_Hist[2] = tsh_hist03.srcdet_tsh_hist03;
		Step_Hist[3] = tsh_hist04.srcdet_tsh_hist04;
		Step_Hist[4] = tsh_hist05.srcdet_tsh_hist05;
		Step_Hist[5] = tsh_hist06.srcdet_tsh_hist06;
		Step_Hist[6] = tsh_hist07.srcdet_tsh_hist07;
		Step_Hist[7] = tsh_hist08.srcdet_tsh_hist08;
		Step_Hist[8] = tsh_hist09.srcdet_tsh_hist09;
		Step_Hist[9] = tsh_hist10.srcdet_tsh_hist10;
		Step_Hist[10] = tsh_hist11.srcdet_tsh_hist11;
		Step_Hist[11] = tsh_hist12.srcdet_tsh_hist12;
		Step_Hist[12] = tsh_hist13.srcdet_tsh_hist13;
		Step_Hist[13] = tsh_hist14.srcdet_tsh_hist14;
		Step_Hist[14] = tsh_hist15.srcdet_tsh_hist15;
		Step_Hist[15] = tsh_hist16.srcdet_tsh_hist16;
		Step_Hist[16] = tsh_hist17.srcdet_tsh_hist17;
		Step_Hist[17] = tsh_hist18.srcdet_tsh_hist18;
		Step_Hist[18] = tsh_hist19.srcdet_tsh_hist19;
		Step_Hist[19] = tsh_hist20.srcdet_tsh_hist20;

		PMH_Hist[0] = pmh_hist0.srcdet_pmh_hist0;
		PMH_Hist[1] = pmh_hist1.srcdet_pmh_hist1;
		PMH_Hist[2] = pmh_hist2.srcdet_pmh_hist2;
		PMH_Hist[3] = pmh_hist3.srcdet_pmh_hist3;
		PMH_Hist[4] = pmh_hist4.srcdet_pmh_hist4;
		PMH_Hist[5] = pmh_hist5.srcdet_pmh_hist5;
#endif

		//enable profile
		srcdet_control_reg.srcdet_pmh_depend_tsh = 0; // always do PMH
		srcdet_control_reg.srcdet_start = 1;
		rtd_outl(PROFILE_SRCDET_CONTROL_reg, srcdet_control_reg.regValue);

		step_count = Step_Hist[0]+Step_Hist[1]+Step_Hist[2];

		for( i=0; i<20; i++ )
		{
			sum += Step_Hist[i];
		}
		if( sum>0 )
		{
			average = step_count*1000/sum;
		}
		else
		{
			average = 0;
		}

		return SUCCESS;
	}
	else
	{
		//scalerDrvPrint( "[ScalerVIP] ==========Profile NOT ready==========\n" );
		return FAILED;
	}
}

unsigned char scalerVIP_Input_Source_Detection(unsigned int HD_SD_Thl)
{
	unsigned char i;
	unsigned char isScaled = FALSE;
	unsigned int sum=0;
	unsigned int weight_sum=0; // scale to 100x for average precision
	unsigned int squaresum = 0; // scale to 10000x for variance precision
	unsigned int max=0; // TSH max value
	unsigned char maxIdx=0; // TSH peak index
	unsigned int average;
	unsigned int variance;

	for( i=0; i<20; i++ )
	{
		if( Step_Hist[i]>max )
		{
			max = Step_Hist[i];
			maxIdx = i;
		}
		sum += Step_Hist[i];
		weight_sum += Step_Hist[i]*(i+1);
		squaresum += Step_Hist[i]*(i+1)*(i+1);
	}

	if( sum>0 )
	{
		average = weight_sum*100/sum;
		variance = squaresum*100/sum - average*average/100;
	}
	else
	{
		average = 0;
		variance = 0;
	}

	//if( MA_print_count % 180 == 0 )
	//	ROSPrintf( "[InputSourceDetection] TSH Average 100x = %d, variance 100x = %d\n", average, variance );

	if( average >= HD_SD_Thl )
		isScaled = TRUE;
	else
		isScaled = FALSE;

	return isScaled;
}
//#endif

void scalerVIP_compute_level_I_BITRate(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _RPC_clues* RPC_SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode3 for HD SNR
{

	int decode_bit_rate = Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.decode_bit_rate);
	int inputplugin_bit_rate = Scaler_ChangeUINT32Endian(RPC_SmartPic_clue->VCPU_setting_info.inputplugin_bit_rate);
	unsigned char printf_Flag=0, print_delay=200;
	int level_Idx=0;
	unsigned char Lv=0;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_BitRate_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_BitRate_th][0]);
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];

	if( (decode_bit_rate==0) && (inputplugin_bit_rate==0) ){
		return;
	}

	//NOTICE it is only for interlace mode

	//unsigned int noise_relaible = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE);
	//unsigned int motion = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);
	int bit_rate_level = inputplugin_bit_rate;

	level_Idx = bit_rate_level;

	if(level_Idx < pPQA_BitRate_TBL[0])
		Lv = 0;
	else if(level_Idx < pPQA_BitRate_TBL[1])
		Lv = 1;
	else if(level_Idx < pPQA_BitRate_TBL[2])
		Lv = 2;
	else if(level_Idx < pPQA_BitRate_TBL[3])
		Lv = 3;
	else if(level_Idx < pPQA_BitRate_TBL[4])
		Lv = 4;
	else if(level_Idx < pPQA_BitRate_TBL[5])
		Lv = 5;
	else if(level_Idx < pPQA_BitRate_TBL[6])
		Lv = 6;
	else if(level_Idx < pPQA_BitRate_TBL[7])
		Lv = 7;
	else if(level_Idx < pPQA_BitRate_TBL[8])
		Lv = 8;
	else
		Lv = 9;


	//SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = level_Idx;

	PQA_Input_Level[I_BitRate_Crtl] = Lv;
	PQA_Input_rate[I_BitRate_Crtl] = 0;

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.TV002_Flag;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.
	if(((printf_Flag&_BIT3)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk(KERN_EMERG "[BitRate] De_BitRate=%d, input_bit_rate=%d,sLv=%d\n", decode_bit_rate, inputplugin_bit_rate, PQA_Input_Level[I_BitRate_Crtl]);
		}
	}

}

unsigned char scalerVIP_DCC_Black_White_Detect(void)
{
	unsigned char i;
	unsigned int hist_max=0, hist_max2=0;
	unsigned char hist_max_idx=0, hist_max2_idx=0;
	unsigned int peak1_sum, peak2_sum;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	for(i=0; i<32; i++ )
	{
		if( reg_HistCnt[i] > hist_max )
		{
			hist_max2 = hist_max;
			hist_max2_idx = hist_max_idx;
			hist_max = reg_HistCnt[i];
			hist_max_idx = i;
		}
		else if( reg_HistCnt[i] > hist_max2 )
		{
			hist_max2 = reg_HistCnt[i];
			hist_max2_idx = i;
		}
	}

	hist_max_idx = (hist_max_idx == 0) ? 1 : ((hist_max_idx==31) ? 30 : hist_max_idx);
	hist_max2_idx = (hist_max2_idx == 0) ? 1 : ((hist_max2_idx==31) ? 30 : hist_max2_idx);

	if( (hist_max_idx <= 2 )|| (hist_max_idx >= 28) )
	{
		peak1_sum = reg_HistCnt[ hist_max_idx-1 ] + reg_HistCnt[ hist_max_idx ]+ reg_HistCnt[ hist_max_idx+1 ];
		peak2_sum = reg_HistCnt[ hist_max2_idx-1 ] + reg_HistCnt[ hist_max2_idx ]+ reg_HistCnt[ hist_max2_idx+1 ];
		if( peak1_sum > (SmartPic_clue->Hist_Y_Total_sum)*3/4)
			return TRUE; // peak white or black

		else if( (abs(hist_max_idx-hist_max2_idx) >= 26) && (peak1_sum+peak2_sum > (SmartPic_clue->Hist_Y_Total_sum)*3/4) && ((SmartPic_clue->saturationflag)==0))
			return TRUE; // 2 peaks one white and black

		else
			return FALSE;
	}
	else
		return FALSE;
}

//=====================================================================================================================
//vvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvv
unsigned int scalerVIP_Cal_Idx_Ave_I_006(unsigned int lv_index, unsigned char isAll_Flag)
{
	#define windowSize_I_006 32
	#define windowSizeBit_I_006 5

	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_006]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize_I_006;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize_I_006;i++)
			sum = sum + levelIdx_arr[i];
		ret = sum>>windowSizeBit_I_006;

		idx++;
		if(idx==windowSize_I_006)
			idx=0;
	}
	return ret;
}

unsigned int scalerVIP_Cal_Idx_Ave_I_006_mv(unsigned int lv_index, unsigned char isAll_Flag)
{
	#define windowSize_I_006 32
	#define windowSizeBit_I_006 5

	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_006]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize_I_006;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize_I_006;i++)
			sum = sum + levelIdx_arr[i];
		ret = sum>>windowSizeBit_I_006;

		idx++;
		if(idx==windowSize_I_006)
			idx=0;
	}
	return ret;
}

unsigned int scalerVIP_Cal_Idx_Ave_I_006_noise(unsigned int lv_index, unsigned char isAll_Flag)
{
	#define windowSize_I_006 32
	#define windowSizeBit_I_006 5

	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_006]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize_I_006;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize_I_006;i++)
			sum = sum + levelIdx_arr[i];
		ret = sum>>windowSizeBit_I_006;

		idx++;
		if(idx==windowSize_I_006)
			idx=0;
	}
	return ret;
}
unsigned int scalerVIP_Cal_Idx_Ave_I_006_mcnr(unsigned int lv_index, unsigned char isAll_Flag)
{

	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_006]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	SLR_VIP_TABLE* Share_Memory_VIP_TABLE_Struct = NULL;
	_clues* SmartPic_clue=NULL;
	_system_setting_info* system_info_structure_table = NULL;

	Share_Memory_VIP_TABLE_Struct = scaler_GetShare_Memory_VIP_TABLE_Struct();
	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();
	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();


	if((Share_Memory_VIP_TABLE_Struct == NULL)||(SmartPic_clue == NULL)||(system_info_structure_table == NULL)) {
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR, Share_Memory_VIP_TABLE_Struct=%x, SmartPic_clue = %x, system_info_structure_table=%x\n",Share_Memory_VIP_TABLE_Struct,SmartPic_clue,system_info_structure_table);
		return 0;
	}

	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;

	unsigned int windowSize = Share_Memory_VIP_TABLE_Struct->PQA_Input_Table[PQA_table_select][I_VD_noise_status][0];

	if(windowSize>windowSize_I_006)
		windowSize=windowSize_I_006;
	if(windowSize==0)
		windowSize=32;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize;i++)
			sum = sum + levelIdx_arr[i];
		//ret = sum>>windowSizeBit_I_006;
		ret = sum/windowSize;
		idx++;
		if(idx>=windowSize)
			idx=0;
	}
	return ret;
}


#define windowSize_I_mcnr 8
#define windowSizeBit_I_mcnr 3
unsigned int scalerVIP_compute_I_hmcnrlevel_Index_Ave(unsigned int lv_index, unsigned char isAll_Flag)
{
	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_mcnr]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize_I_mcnr;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize_I_mcnr;i++)
			sum = sum + levelIdx_arr[i];
		ret = sum>>windowSizeBit_I_mcnr;

		idx++;
		if(idx==windowSize_I_mcnr)
			idx=0;
	}
	return ret;
}

unsigned int scalerVIP_Cal_Idx_Ave_I_006_chroma(unsigned int lv_index, unsigned char isAll_Flag)
{

	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_006]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	SLR_VIP_TABLE* Share_Memory_VIP_TABLE_Struct = NULL;
	_clues* SmartPic_clue=NULL;
	_system_setting_info* system_info_structure_table = NULL;

	Share_Memory_VIP_TABLE_Struct = scaler_GetShare_Memory_VIP_TABLE_Struct();
	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();
	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

	if((Share_Memory_VIP_TABLE_Struct == NULL)||(system_info_structure_table == NULL) || (SmartPic_clue == NULL) ) {
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR,Share_Memory_VIP_TABLE_Struct = %x, system_info_structure_table = %x, SmartPic_clue = %x\n",Share_Memory_VIP_TABLE_Struct,system_info_structure_table,SmartPic_clue);
		return 0;
	}

	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;

	unsigned int windowSize = Share_Memory_VIP_TABLE_Struct->PQA_Input_Table[PQA_table_select][I_VD_noise_status][0];

	if(windowSize>windowSize_I_006)
		windowSize=windowSize_I_006;
	if(windowSize==0)
		windowSize=32;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize;i++)
			sum = sum + levelIdx_arr[i];
		//ret = sum>>windowSizeBit_I_006;
		ret = sum/windowSize;
		idx++;
		if(idx>=windowSize)
			idx=0;
	}
	return ret;
}
#define windowSize_I_mcnr 8
#define windowSizeBit_I_mcnr 3
unsigned int scalerVIP_compute_I_chromanrlevel_Index_Ave(unsigned int lv_index, unsigned char isAll_Flag)
{
	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_mcnr]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize_I_mcnr;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize_I_mcnr;i++)
			sum = sum + levelIdx_arr[i];
		ret = sum>>windowSizeBit_I_mcnr;

		idx++;
		if(idx==windowSize_I_mcnr)
			idx=0;
	}
	return ret;
}
#define windowSize_I_teeth 8
#define windowSizeBit_I_teeth 3
unsigned int scalerVIP_compute_I_teeth_Index_Ave(unsigned int lv_index, unsigned char isAll_Flag)
{
	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_teeth]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize_I_teeth;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize_I_teeth;i++)
			sum = sum + levelIdx_arr[i];
		ret = sum>>windowSizeBit_I_teeth;

		idx++;
		if(idx==windowSize_I_teeth)
			idx=0;
	}
	return ret;
}

#define windowSize_I_Gmv 16
#define windowSizeBit_I_Gmv 4
unsigned int scalerVIP_compute_I_Gmv_Index_Ave(unsigned int lv_index, unsigned char isAll_Flag)
{
	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize_I_Gmv]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize_I_Gmv;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize_I_Gmv;i++)
		{
			sum = sum + levelIdx_arr[i];
		}
		ret = sum>>windowSizeBit_I_Gmv;

		idx++;
		if(idx==windowSize_I_Gmv)
			idx=0;
	}
	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
	{
		ROSPrintf("\n sum  %d , lv_index %d\n", sum, lv_index);
	}
	return ret;
}


int scalerVIP_compute_Still_Idx_FMV_HMC_I_006(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table)
{
	//new still meter
	unsigned int printf_Flag=0, print_delay=200;
	unsigned char i;
	unsigned int *FMV_hist_ratio, *HMC_bin_hist_ratio;
	//unsigned char FMV_weight[FMV_Hist_Bin_Num] = {};
	//unsigned char HMC_bin_hist_ratio[HMC_Hist_Bin_Num] = {};
	unsigned int still_idx, still_idx_FMV, still_idx_HMC_Bin, FMV_w_total, HMC_w_total;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_FMV_w_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_FMV_Hist_Weighting][0]);	// for FMV weighting
	unsigned int *pPQA_HMC_MV_w_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_HMC_MV_Hist_Weighting][0]);
	unsigned char GMV;
	int ret_still_idx;

	FMV_hist_ratio = SmartPic_clue->FMV_hist_Ratio;
	HMC_bin_hist_ratio = SmartPic_clue->HMC_bin_hist_Ratio;
	GMV = SmartPic_clue->GMV;

	still_idx_FMV = 0;
	FMV_w_total =0;
	for(i=0;i<PQA_I_LEVEL_MAX;i++)
	{
		// 10 is center
		still_idx_FMV = still_idx_FMV + (FMV_hist_ratio[10+i]*pPQA_FMV_w_TBL[i]);
		if(i!=0)
			still_idx_FMV = still_idx_FMV + (FMV_hist_ratio[10-i]*pPQA_FMV_w_TBL[i]);
		FMV_w_total = FMV_w_total + pPQA_FMV_w_TBL[i];
		//ROSPrintf("%d,%d,%d,%d,%d\n",still_idx_FMV,FMV_hist_ratio[10+i],FMV_hist_ratio[10-i],pPQA_VD_status_TBL[i],FMV_w_total);
	}
	//if(FMV_w_total != 0)
		//still_idx_FMV = still_idx_FMV / FMV_w_total;

	still_idx_HMC_Bin = 0;
	HMC_w_total = 0;
	for(i=0;i<PQA_I_LEVEL_MAX;i++)
	{
		// 16 is center
		still_idx_HMC_Bin = still_idx_HMC_Bin + (HMC_bin_hist_ratio[16+i]*pPQA_HMC_MV_w_TBL[i]);
		if(i!=0)
			still_idx_HMC_Bin = still_idx_HMC_Bin + (HMC_bin_hist_ratio[16-i]*pPQA_HMC_MV_w_TBL[i]);
		HMC_w_total = HMC_w_total + pPQA_HMC_MV_w_TBL[i];
	}
	//if(HMC_w_total != 0)
		//still_idx_HMC_Bin = still_idx_HMC_Bin / HMC_w_total;

	still_idx = (still_idx_FMV+still_idx_HMC_Bin)>>1;

	//for debug.
	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	if((printf_Flag==4) && (MA_print_count%print_delay==0))
		ROSPrintf("FMV=%d,HMC=%d,still=%d,GMV=%d\n", still_idx_FMV, still_idx_HMC_Bin, still_idx,GMV);
	if((printf_Flag==8) && (MA_print_count%print_delay==0))
	{
		ROSPrintf("FMV_hist=");
		for(i=0;i<FMV_Hist_Bin_Num;i++)
			ROSPrintf("%d,",FMV_hist_ratio[i]);
		ROSPrintf("\n");

		ROSPrintf("HMC_hist=");
		for(i=0;i<HMC_Hist_Bin_Num;i++)
			ROSPrintf("%d,",HMC_bin_hist_ratio[i]);
		ROSPrintf("\n");

	}

	if(GMV==2 || GMV==4)
		ret_still_idx=-1;
	else if(GMV==1 || GMV==5)
		ret_still_idx=-2;
	else if(GMV==0 || GMV==6)
		ret_still_idx=-3;
	else
		ret_still_idx = still_idx_FMV;

	return ret_still_idx;
}

//=====================================================================================================================
//TV_005_style
//vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv

void scalerVIP_compute_level_I_005_RFCVBS_DNR(unsigned char DNR_TABLE_SECET, unsigned int* g_PQA_Input_Table, unsigned short *PQA_Input_Level, unsigned short *PQA_Input_rate)
{
#if 0
	unsigned int current_Signal_Status = 0;
//==================================================================
//==================compute VD_noise_level of ==============================
//=======================TV_CVBS ====================================
//==================================================================
	if(DEBUG_AUTO_NR == 0)
		//current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
		current_Signal_Status = (SmartPic_clue->VD_Signal_Status_value_avg);  //yuan1024 for rtnr n files avg

	else	//	debug enable;
		current_Signal_Status = DEBUG_VD_NOISE;

	unsigned char PQA_table_select = scaler_GetShare_Memory_system_setting_info_Struct()->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_table_select;
	unsigned int *pPQA_VD_noise_status = &(scaler_GetShare_Memory_VIP_TABLE_Struct()->PQA_Input_Table[PQA_table_select][I_VD_noise_status][0]);
//	unsigned int *pPQA_VD_noise_status_offset = &(scaler_GetShare_Memory_VIP_TABLE_Struct()->PQA_Input_Table[PQA_table_select][I_VD_noise_status_offset][0]);

	if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L00])
		PQA_Input_Level[I_005_RFCVBS] = 0;
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L01])
		PQA_Input_Level[I_005_RFCVBS] = 1;
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L02])
		PQA_Input_Level[I_005_RFCVBS] = 2;
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L03])
		PQA_Input_Level[I_005_RFCVBS] = 3;
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L04])
		PQA_Input_Level[I_005_RFCVBS] = 4;
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L05])
		PQA_Input_Level[I_005_RFCVBS] = 5;
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L06])
		PQA_Input_Level[I_005_RFCVBS] = 6;
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L07])
		PQA_Input_Level[I_005_RFCVBS] = 7;
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L08])
		PQA_Input_Level[I_005_RFCVBS] = 8;
	else
		PQA_Input_Level[I_005_RFCVBS] = 9;

	if(PQA_Input_Level[I_005_RFCVBS] >= 1) {
		if(pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]] > pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]-1])
			PQA_Input_rate[I_005_RFCVBS] = 255*(current_Signal_Status-pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]-1])/(pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]] - pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]-1]);
		else
			PQA_Input_rate[I_005_RFCVBS] = 0;
	}
	else
		PQA_Input_rate[I_005_RFCVBS] = 0;
#else

	unsigned int current_Signal_Status = 0;
//==================================================================
//==================compute VD_noise_level of ==============================
//=======================TV_CVBS ====================================
//==================================================================
	if(DEBUG_AUTO_NR == 0)
		//current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
		current_Signal_Status = (SmartPic_clue->VD_Signal_Status_value_avg);  //yuan1024 for rtnr n files avg

	else	//	debug enable;
		current_Signal_Status = DEBUG_VD_NOISE;




	unsigned char PQA_table_select = scaler_GetShare_Memory_system_setting_info_Struct()->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_table_select;
	unsigned int *pPQA_VD_noise_status = &(scaler_GetShare_Memory_VIP_TABLE_Struct()->PQA_Input_Table[PQA_table_select][I_VD_noise_status][0]);
//	unsigned int *pPQA_VD_noise_status_offset = &(scaler_GetShare_Memory_VIP_TABLE_Struct()->PQA_Input_Table[PQA_table_select][I_VD_noise_status_offset][0]);

	int level_Idx=0, printf_Flag=0, print_delay=200,mv_index=0;
	unsigned char Lv=0,mv_lv=0,ori_lv=0;;
	//unsigned char meanHistY = SmartPic_clue->Hist_Y_Mean_Value;
	//unsigned int tmp,tmp2;

	unsigned int *pPQA_HMC_MV_w_TBL = &(scaler_GetShare_Memory_VIP_TABLE_Struct()->PQA_Input_Table[PQA_table_select][I_HMC_MV_Hist_Weighting][0]);
	mv_index =scalerVIP_compute_I_hmcnrlevel_Index_Ave(SmartPic_clue->HMC_bin_hist_Ratio[16], 0);


	if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L00])
	{
		Lv = 0;
	}
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L01])
	{
		Lv = 1;
	}
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L02])
	{
		Lv = 2;
	}
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L03])
	{
		Lv = 3;

	}
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L04])
	{
		Lv = 4;
	}
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L05])
	{
		Lv = 5;
	}
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L06])
	{
		Lv = 6;
	}
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L07])
	{
		Lv = 7;
	}
	else if(current_Signal_Status < pPQA_VD_noise_status[PQA_I_L08])
	{
		Lv = 8;
	}
	else
	{
		Lv = 9;
	}

	ori_lv = Lv;

	if(mv_index <pPQA_HMC_MV_w_TBL[0])
	{
		Lv = (Lv>9)?(Lv-9):0;
		mv_lv=9;
	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[1])
	{
		Lv = (Lv>8)?(Lv-8):0;
		mv_lv=8;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[2])
	{
		Lv = (Lv>7)?(Lv-7):0;
		mv_lv=7;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[3])
	{
		Lv = (Lv>6)?(Lv-6):0;
		mv_lv=6;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[4])
	{
		Lv = (Lv>5)?(Lv-5):0;
		mv_lv=5;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[5])
	{
		Lv = (Lv>4)?(Lv-4):0;
		mv_lv=4;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[6])
	{
		Lv = (Lv>3)?(Lv-3):0;
		mv_lv=3;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[7])
	{
		Lv = (Lv>2)?(Lv-2):0;
		mv_lv=2;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[8])
	{
		Lv = (Lv>1)?(Lv-1):0;
		mv_lv=1;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[9])
	{
		mv_lv=0;

	}
	else
	{
		mv_lv=0;
	}


	if(ori_lv<=3)
		Lv=ori_lv;


	if(Lv<=0)
	{
		Lv=0;

	}
	/*	 for OSD setting ,shift level Start	*/
	if(system_info_structure_table->OSD_Info.OSD_NR_Mode==1) //osd level =low
	{
		Lv = (Lv>1)?(Lv-1):0;
	}
	else if (system_info_structure_table->OSD_Info.OSD_NR_Mode==3) // osd level =high
	{
		Lv = (Lv>=9)?9:(Lv+1);
	}
	/*	 for OSD setting ,shift level END	*/


	PQA_Input_Level[I_005_RFCVBS] =Lv;

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;

	if((printf_Flag&_BIT10)!=0 && print_delay && (MA_print_count%print_delay==0))
	{
		//ROSPrintf("Y1=%d ,Y2=%d ,Y3=%d , mv_index=%d ,Lv= %d ,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_Y2_avg,RTNR_MAD_count_Y3_avg,mv_index,Lv,center,mv_lv);
		ROSPrintf("Y2=%d , mv_index=%d ,level_Idx= %d ,Lv=%d,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y2_avg,mv_index,level_Idx,Lv,center,mv_lv);

	}

#if 0
	if(PQA_Input_Level[I_005_RFCVBS] >= 1) {
		if(pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]] > pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]-1])
			PQA_Input_rate[I_005_RFCVBS] = 255*(current_Signal_Status-pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]-1])/(pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]] - pPQA_VD_noise_status[PQA_Input_Level[I_005_RFCVBS]-1]);
		else
			PQA_Input_rate[I_005_RFCVBS] = 0;
	}
	else
#endif
		PQA_Input_rate[I_005_RFCVBS] = 0;




#endif
}

void scalerVIP_compute_level_I_005_SDHD_DNR(unsigned char DNR_TABLE_SECET, unsigned int* g_PQA_Input_Table, unsigned short *PQA_Input_Level, unsigned short *PQA_Input_rate)
{
	//=====================================================
	//static unsigned int counter_file = 0;
	static unsigned int RTNR_MAD_count_Y_avg_sum = 0;

	unsigned char PQA_Input_RTNR_MAD;
	unsigned char PQA_Input_DCC_Histogram_mean;

	unsigned int DCC_Histogram_Mean_value = 0;
	DCC_Histogram_Mean_value = SmartPic_clue->Hist_Y_Mean_Value;

	PQA_Input_RTNR_MAD = DNR_TABLE_SECET*PQA_I_ITEM_MAX*PQA_I_LEVEL_MAX + I_RTNR_MAD * PQA_I_LEVEL_MAX;
	PQA_Input_DCC_Histogram_mean = DNR_TABLE_SECET*PQA_I_ITEM_MAX*PQA_I_LEVEL_MAX + I_DCC_Histogram_mean * PQA_I_LEVEL_MAX;

	RTNR_MAD_count_Y_avg_sum += RTNR_MAD_count_Y2_avg;
	if(((MA_print_count % DNR_Auto_Count_Num) == 0)&&(MA_print_count != 0 ))
	{

		RTNR_MAD_count_Y_sum_avg = RTNR_MAD_count_Y_avg_sum/DNR_Auto_Count_Num;
		RTNR_MAD_count_Y_avg_sum = 0;

		if(DEBUG_AUTO_NR == 1)
		{	//	debug enable;
			RTNR_MAD_count_Y_sum_avg = DEBUG_RTNR_MAD;
			DCC_Histogram_Mean_value = DEBUG_HISTOGRAM_MEAN;
		}

		if((RTNR_MAD_count_Y_sum_avg >= *(g_PQA_Input_Table + PQA_Input_RTNR_MAD + 0)) && (RTNR_MAD_count_Y_sum_avg <= *(g_PQA_Input_Table + PQA_Input_RTNR_MAD + 1)))
		{
			if(DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 0))
				PQA_Input_Level[I_005_SDHD] = 1;
			else if((DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 0)) && (DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 1)))
				PQA_Input_Level[I_005_SDHD] = 2;
			else if((DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 1)) && (DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 2)))
				PQA_Input_Level[I_005_SDHD] = 3;
			else if(DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 2))
				PQA_Input_Level[I_005_SDHD] = 4;
		}
		else if((RTNR_MAD_count_Y_sum_avg > *(g_PQA_Input_Table + PQA_Input_RTNR_MAD + 1)) && (RTNR_MAD_count_Y_sum_avg <= *(g_PQA_Input_Table + PQA_Input_RTNR_MAD + 2)))
		{
			if(DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 0))
				PQA_Input_Level[I_005_SDHD] = 2;
			else if((DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 0)) && (DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 1)))
				PQA_Input_Level[I_005_SDHD] = 3;
			else if((DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 1)) && (DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 2)))
				PQA_Input_Level[I_005_SDHD] = 4;
			else if(DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 2))
				PQA_Input_Level[I_005_SDHD] = 5;
		}
		else if(RTNR_MAD_count_Y_sum_avg > *(g_PQA_Input_Table + PQA_Input_RTNR_MAD + 2))
		{
			if(DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 0))
				PQA_Input_Level[I_005_SDHD] = 4;
			else if((DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 0)) && (DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 1)))
				PQA_Input_Level[I_005_SDHD] = 5;
			else if((DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 1)) && (DCC_Histogram_Mean_value <= *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 2)))
				PQA_Input_Level[I_005_SDHD] = 6;
			else if(DCC_Histogram_Mean_value > *(g_PQA_Input_Table + PQA_Input_DCC_Histogram_mean + 2))
				PQA_Input_Level[I_005_SDHD] = 7;
		}
		else
		{
			PQA_Input_Level[I_005_SDHD] = 7;
		}

	}
	PQA_Input_rate[I_005_SDHD] = 0;
/*
	if( MA_print_count % 60 == 0 )
	{
		ROSPrintf( "count_Y_avg_ratio = %d\n", SmartPic_clue->RTNR_MAD_count_Y_avg_ratio );
		ROSPrintf( "count_Y_avg_sum = %d, DNR_Auto_Count_Num = %d\n", RTNR_MAD_count_Y_avg_sum, DNR_Auto_Count_Num );
		ROSPrintf( "count_Y_sum_avg = %d, PQA_Input_Level = %d\n", RTNR_MAD_count_Y_sum_avg, PQA_Input_Level[I_005_SDHD] );
	}
*/
	//=====================================================

}
//^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//TV_005_style
//=====================================================================================================================


void scalerVIP_compute_level_I_006_RTNR_Mode0(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode1 for RF CVBS RTNR
{
	unsigned int level_Idx=0, printf_Flag=0, print_delay=200;
	unsigned char Lv=0;

	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_InputMAD_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_RTNR_MAD][0]);
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];

	// get spatial content noise meter status
	unsigned int noise_status = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL);
	unsigned int noise_relaible = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE);
	//get mean histgram Y
	unsigned char meanHistY = SmartPic_clue->Hist_Y_Mean_Value;

	unsigned int motion_h_t = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_T_reg);
	unsigned int motion_h_m = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_M_reg);
	unsigned int motion_h_b = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_B_reg);
	unsigned int motion_v_l = rtd_inl(DI_IM_DI_SI_FILM_MOTION_V_L_reg);
	unsigned int motion_v_m = rtd_inl(DI_IM_DI_SI_FILM_MOTION_V_M_reg);
	unsigned int motion_v_r = rtd_inl(DI_IM_DI_SI_FILM_MOTION_V_R_reg);
	unsigned int motion = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);
	motion += pPQA_InputMAD_TBL[0]+1;

	// for id pattern
	if(DynamicOptimizeSystem[35]==1)	// lg radio,
		motion = pPQA_InputMAD_TBL[8];

	if(motion>pPQA_InputMAD_TBL[9])
		motion = pPQA_InputMAD_TBL[9];
	level_Idx = scalerVIP_Cal_Idx_Ave_I_006(motion, 0);

	if(level_Idx <= pPQA_InputMAD_TBL[0])
		Lv = 9;
	else if(level_Idx <= pPQA_InputMAD_TBL[1])
		Lv = 8;
	else if(level_Idx <= pPQA_InputMAD_TBL[2])
		Lv = 7;
	else if(level_Idx <= pPQA_InputMAD_TBL[3])
		Lv = 6;
	else if(level_Idx <= pPQA_InputMAD_TBL[4])
		Lv = 5;
	else if(level_Idx <= pPQA_InputMAD_TBL[5])
		Lv = 4;
	else if(level_Idx <= pPQA_InputMAD_TBL[6])
		Lv = 3;
	else if(level_Idx <= pPQA_InputMAD_TBL[7])
		Lv = 2;
	else if(level_Idx <= pPQA_InputMAD_TBL[8])
		Lv = 1;
	else
		Lv=0;
	/*	 for OSD setting ,shift level Start Rord 2015/11/07	*/
	if(system_info_structure_table->OSD_Info.OSD_NR_Mode==1) //osd level =low
	{
		Lv = (Lv>1)?(Lv-1):0;
	}
	else if (system_info_structure_table->OSD_Info.OSD_NR_Mode==3) // osd level =high
	{
		Lv = (Lv>=9)?9:(Lv+1);
	}
	/*	 for OSD setting ,shift level END	*/

	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = level_Idx;
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_1] = motion;

	PQA_Input_Level[I_006_RTNR_Mode0] = Lv;
	PQA_Input_rate[I_006_RTNR_Mode0] = 0;
	scalerVIP_Set_Noise_Level(Lv);

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.
	if(((printf_Flag&_BIT0)!=0) && (MA_print_count%print_delay==0))
		ROSPrintf("rm0~%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,\n",
		SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0], SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_1],
		SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_2], SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[I_006_RTNR_Mode2],
		noise_status, noise_relaible, meanHistY,motion_h_t,motion_h_m,motion_h_b,motion_v_l,motion_v_m,motion_v_r,motion);

}


void scalerVIP_compute_level_I_006_RTNR_Mode1(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode2 for SD RTNR
{
// it is for chroma NR information //2015/11/10 rord

	int level_Idx=0, printf_Flag=0, print_delay=200,mv_index=0;
	char Lv=0,mv_lv=0,ori_lv=0;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_InputMAD_Chroma_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_FMV_Hist_Weighting][0]); //for mad chroma
	unsigned char meanHistY = SmartPic_clue->Hist_Y_Mean_Value;
	unsigned short Lv_intp=0;//, sr_d;
	unsigned int tmp,tmp2;
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned int *pPQA_HMC_MV_C_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_FMV_Hist_stillIdx_th][0]);//for hmv
	static unsigned char mcnr_pan_nr_level = 255;
	unsigned int uv_max_value1=0,uv_max_value2=0,uv_max_value3=0;

	uv_max_value1 = max(RTNR_MAD_count_U_avg,RTNR_MAD_count_V_avg);
	uv_max_value2 = max(RTNR_MAD_count_U2_avg,RTNR_MAD_count_V2_avg);
	uv_max_value3 = max(RTNR_MAD_count_U3_avg,RTNR_MAD_count_V3_avg);



	level_Idx = scalerVIP_Cal_Idx_Ave_I_006_chroma(uv_max_value2, 0);
	//mv_index =scalerVIP_compute_I_chromanrlevel_Index_Ave(SmartPic_clue->HMC_bin_hist_Ratio[16], 0);
	mv_index =scalerVIP_compute_I_chromanrlevel_Index_Ave(scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio(), 0);

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.someothers==TRUE))
	{
		ROSPrintf("mv_index=%d \n ",mv_index);
	}
	//mv_index =scalerVIP_Cal_Idx_Ave_I_006_mv(center, 0);


	unsigned char cur_source=0,sd_input=0;
	cur_source=(RPC_system_info_structure_table->VIP_source);

	if((cur_source >= VIP_QUALITY_CVBS_NTSC && cur_source <=VIP_QUALITY_YPbPr_576P)||
		(cur_source >= VIP_QUALITY_HDMI_480I && cur_source <=VIP_QUALITY_HDMI_576P)||
		(cur_source >= VIP_QUALITY_DTV_480I && cur_source <=VIP_QUALITY_DTV_576P)||
		(cur_source >= VIP_QUALITY_PVR_480I && cur_source <=VIP_QUALITY_PVR_576P)||
		(cur_source >= VIP_QUALITY_CVBS_SECAN && cur_source <=VIP_QUALITY_TV_NTSC443))
	{
		sd_input = 1;
	}
	else
	{
		sd_input = 0;
	}



	if(level_Idx < pPQA_InputMAD_Chroma_TBL[0])
		Lv = 0;
	else if(level_Idx < pPQA_InputMAD_Chroma_TBL[1])
		Lv = 1;
	else if(level_Idx < pPQA_InputMAD_Chroma_TBL[2])
		Lv = 2;
	else if(level_Idx < pPQA_InputMAD_Chroma_TBL[3])
		Lv = 3;
	else if(level_Idx < pPQA_InputMAD_Chroma_TBL[4])
		Lv = 4;
	else if(level_Idx < pPQA_InputMAD_Chroma_TBL[5])
		Lv = 5;
	else if(level_Idx < pPQA_InputMAD_Chroma_TBL[6])
		Lv = 6;
	else if(level_Idx < pPQA_InputMAD_Chroma_TBL[7])
		Lv = 7;
	else if(level_Idx < pPQA_InputMAD_Chroma_TBL[8])
		Lv = 8;
	else
		Lv = 9;

	ori_lv = Lv;


	if(mv_index <pPQA_HMC_MV_C_TBL[0])
	{
		Lv = (Lv>9)?(Lv-9):0;
		mv_lv=9;
	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[1])
	{
		Lv = (Lv>8)?(Lv-8):0;
		mv_lv=8;

	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[2])
	{
		Lv = (Lv>7)?(Lv-7):0;
		mv_lv=7;

	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[3])
	{
		Lv = (Lv>6)?(Lv-6):0;
		mv_lv=6;

	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[4])
	{
		Lv = (Lv>5)?(Lv-5):0;
		mv_lv=5;

	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[5])
	{
		Lv = (Lv>4)?(Lv-4):0;
		mv_lv=4;

	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[6])
	{
		Lv = (Lv>3)?(Lv-3):0;
		mv_lv=3;

	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[7])
	{
		Lv = (Lv>2)?(Lv-2):0;
		mv_lv=2;

	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[8])
	{
		Lv = (Lv>1)?(Lv-1):0;
		mv_lv=1;

	}
	else if(mv_index <pPQA_HMC_MV_C_TBL[9])
	{
		mv_lv=0;

	}
	else
	{
		mv_lv=0;
	}


	if(ori_lv<=3)
		Lv=ori_lv;


	if(Lv<=0)
	{
		Lv=0;

	}


/////////////////// mcnr pan , use the same nr level start////////////////////////////////////////

	if(sd_input ==1)
	{
		if((scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==1)&&mcnr_pan_nr_level==255)
		{
			mcnr_pan_nr_level = 4;
		}
		else if(scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==0)
		{
			mcnr_pan_nr_level = 255;
		}

		if(mcnr_pan_nr_level !=255)
		{
			Lv = mcnr_pan_nr_level;
		}
	}
	else
	{
		if((scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==1)&&mcnr_pan_nr_level==255)
		{
			mcnr_pan_nr_level = 6;
		}
		else if(scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==0)
		{
			mcnr_pan_nr_level = 255;
		}

		if(mcnr_pan_nr_level !=255)
		{
			Lv = mcnr_pan_nr_level;
		}

	}


/////////////////// mcnr pan , use the same nr level  end ////////////////////////////////////////
	/*	 for OSD setting ,shift level Start	*/
	if(system_info_structure_table->OSD_Info.OSD_NR_Mode==1) //osd level =low
	{
		Lv--;
		if(Lv<=0)
			Lv=0;
	}
	else if (system_info_structure_table->OSD_Info.OSD_NR_Mode==3) // osd level =high
	{
		Lv++;
		if(Lv>9)
			Lv=9;
	}
	/*	 for OSD setting ,shift level END	*/


	//if(DynamicOptimizeSystem[35]==1)	// lg radio,
	//	Lv = 2;

	if(DynamicOptimizeSystem[7]==1)	// lg radio,
		Lv = 4;

	if(Lv==9)
		Lv_intp =0;
	else
	{
		if(level_Idx>pPQA_InputMAD_Chroma_TBL[PQA_I_L09])
			level_Idx = pPQA_InputMAD_Chroma_TBL[PQA_I_L09];
		tmp = ((pPQA_InputMAD_Chroma_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_Chroma_TBL[PQA_I_L09-Lv-1])==0)?1:(pPQA_InputMAD_Chroma_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_Chroma_TBL[PQA_I_L09-Lv-1]);
		Lv_intp = ((pPQA_InputMAD_Chroma_TBL[PQA_I_L09-Lv]-level_Idx)<<8) / tmp;
	}

	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = level_Idx;
	//SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_1] = motion;

	//ROSPrintf("\n U1=%d ,U2=%d ,LV =%d ,mv %d , level_Idx =%d\n ",uv_max_value1,uv_max_value2,Lv,mv_lv,level_Idx);
	//ROSPrintf("\n mv_idx=%d ,U2=%d ,LV =%d ,mv %d , level_Idx =%d\n ",mv_index,uv_max_value2,Lv,mv_lv,level_Idx);
//	ROSPrintf("\n mv_idx=%d ,U2=%d ,LV =%d ,mv %d , level_Idx =%d\n ",mv_index,uv_max_value2,Lv,mv_lv,level_Idx);

	PQA_Input_Level[I_006_RTNR_Mode1] = Lv;
	PQA_Input_rate[I_006_RTNR_Mode1] = 0;

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.

	if((printf_Flag&_BIT9)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("LV=%d ,motion=%d ,y=%d, Lv_intp=%d \n ",Lv,level_Idx,meanHistY,Lv_intp);

	}

	tmp2=1000-RTNR_MAD_count_Y_avg-RTNR_MAD_count_Y2_avg-RTNR_MAD_count_Y3_avg;

	//ROSPrintf(" mv=%d ,Idx= %d ,Lv=%d\n",mv_index,level_Idx,Lv);

	if((printf_Flag&_BIT10)!=0 && (MA_print_count%print_delay==0))
	{
		//ROSPrintf("Y1=%d ,Y2=%d ,Y3=%d , mv_index=%d ,Lv= %d ,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_Y2_avg,RTNR_MAD_count_Y3_avg,mv_index,Lv,center,mv_lv);
		ROSPrintf("Y2=%d , mv_index=%d ,level_Idx= %d ,Lv=%d,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y2_avg,mv_index,level_Idx,Lv,center,mv_lv);

	}

	if((printf_Flag&_BIT11)!=0 && (MA_print_count%print_delay==0))
	{
		//ROSPrintf("\n R5=%d ,R4=%d, R3=%d, R2=%d, R1=%d C=%d,L1=%d ,L2=%d ,L3=%d ,L4=%d ,L5=%d \n",hmcnr_sttistic[0],hmcnr_sttistic[1],hmcnr_sttistic[2],
		//hmcnr_sttistic[3],hmcnr_sttistic[4],hmcnr_sttistic[5],hmcnr_sttistic[6],hmcnr_sttistic[7],hmcnr_sttistic[8],hmcnr_sttistic[9],hmcnr_sttistic[10]);


		ROSPrintf("hmc_C=%d ,r1=%d,L2 =%d \n",SmartPic_clue->HMC_bin_hist_Ratio[16],SmartPic_clue->HMC_bin_hist_Ratio[15],SmartPic_clue->HMC_bin_hist_Ratio[17]);

	}

	if((printf_Flag&_BIT12)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("C=%d , L1=%d ,R1= %d ,others \n",center,L1,R1,others);

	}


}



void scalerVIP_compute_level_I_006_RTNR_Mode2(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode3 for HD RTNR
{
#if 0
	unsigned int level_Idx=0, printf_Flag=0, print_delay=200;
	unsigned char Lv=0;
	static unsigned char Pre_Lv=0, Pre_rate=0;
	unsigned char i;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_InputMAD_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_RTNR_MAD][0]);
	unsigned int *pPQA_Input_HistMeanY_Dark_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_DCC_Histogram_mean_dark][0]);
	unsigned int *pPQA_Input_HistMeanY_Dark_Gain_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_DCC_Histogram_mean_dark_gain][0]);
	unsigned int tmp;

	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned int motioni[10]={0};

	unsigned short Lv_intp=0;//, sr_d;
	Lv_intp=0;
	int still_idx;
	still_idx=0;

	// get spatial content noise meter status
	unsigned int noise_status = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL);
	unsigned int noise_relaible = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE);
	//get mean histgram Y
	unsigned char meanHistY = SmartPic_clue->Hist_Y_Mean_Value;

	//unsigned int motion_h_t = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_T_reg);
	//unsigned int motion_h_m = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_M_reg);
	//unsigned int motion_h_b = rtd_inl(DI_IM_DI_SI_FILM_MOTION_H_B_reg);
	//unsigned int motion_v_l = rtd_inl(DI_IM_DI_SI_FILM_MOTION_V_L_reg);
	//unsigned int motion_v_m = rtd_inl(DI_IM_DI_SI_FILM_MOTION_V_M_reg);
	//unsigned int motion_v_r = rtd_inl(DI_IM_DI_SI_FILM_MOTION_V_R_reg);
	unsigned int motion = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);

	still_idx = scalerVIP_compute_Still_Idx_FMV_HMC_I_006(vipTable_shareMem, SmartPic_clue, system_info_structure_table);

	motioni[0] = motion;

	// reduce rtnr for dark sence,
	if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L00])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L00];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L00];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L01])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L01];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L01];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L02])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L02];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L02];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L03])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L03];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L03];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L04])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L04];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L04];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L05])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L05];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L05];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L06])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L06];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L06];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L07])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L07];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L07];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L08])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L08];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L08];
	else if(meanHistY<pPQA_Input_HistMeanY_Dark_TBL[PQA_I_L09])
		motion += pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L09];
		//dark_meanY_Gain = pPQA_Input_HistMeanY_Dark_Gain_TBL[PQA_I_L09];
	else
		motion += 0;
	//dark_meanY_Gain = 1024;
	//motion = (motion*dark_meanY_Gain)>>10;
	motioni[1] = motion;

	//	for change smoothly
	if(motion>pPQA_InputMAD_TBL[PQA_I_L09])
		motion = pPQA_InputMAD_TBL[PQA_I_L09];

	// for moving bamboo women, and moving building
	if( (DynamicOptimizeSystem[198]==1) || (DynamicOptimizeSystem[199]==1) )
		motion = pPQA_InputMAD_TBL[PQA_I_L01];

	// for analog noise, little boy........., using old mode

	if( (DynamicOptimizeSystem[182]==1) || (DynamicOptimizeSystem[183]==1) || (DynamicOptimizeSystem[184]==1) || (DynamicOptimizeSystem[185]==1) || (DynamicOptimizeSystem[186]==1) || (scalerVIP_DI_MiddleWare_GetStatus(STATUS_HMCNR)==1) )
		rtd_clearbits(DI_IM_DI_RTNR_NEW_CONTROL_reg, _BIT0);
	else
		rtd_setbits(DI_IM_DI_RTNR_NEW_CONTROL_reg, _BIT0);

	level_Idx = scalerVIP_Cal_Idx_Ave_I_006(motion, 0);

	if(level_Idx <= pPQA_InputMAD_TBL[0])
		Lv = 9;
	else if(level_Idx <= pPQA_InputMAD_TBL[1])
		Lv = 8;
	else if(level_Idx <= pPQA_InputMAD_TBL[2])
		Lv = 7;
	else if(level_Idx <= pPQA_InputMAD_TBL[3])
		Lv = 6;
	else if(level_Idx <= pPQA_InputMAD_TBL[4])
		Lv = 5;
	else if(level_Idx <= pPQA_InputMAD_TBL[5])
		Lv = 4;
	else if(level_Idx <= pPQA_InputMAD_TBL[6])
		Lv = 3;
	else if(level_Idx <= pPQA_InputMAD_TBL[7])
		Lv = 2;
	else if(level_Idx <= pPQA_InputMAD_TBL[8])
		Lv = 1;
	else
		Lv=0;

	if(Lv==9)
		Lv_intp =0;
	else
	{
		if(level_Idx>pPQA_InputMAD_TBL[PQA_I_L09])
			level_Idx = pPQA_InputMAD_TBL[PQA_I_L09];
		tmp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1])==0)?1:(pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1]);
		Lv_intp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-level_Idx)<<8) / tmp;
	}

	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = level_Idx;
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_1] = motion;

	if(Pre_Lv<Lv)
	{
		if(Pre_rate>=235)
		{
			Pre_rate = 0;
			Pre_Lv=Pre_Lv+1;
		}
		else
			Pre_rate=Pre_rate+20;
	}
	else if(Pre_Lv>Lv)
	{
		if(Pre_rate<=20)
		{
			Pre_rate = 255;
			Pre_Lv=Pre_Lv-1;
		}
		else
			Pre_rate=Pre_rate-20;
	}


	PQA_Input_Level[I_006_RTNR_Mode2] = Pre_Lv;
	PQA_Input_rate[I_006_RTNR_Mode2] = Pre_rate;

//	PQA_Input_Level[I_006_RTNR_Mode2] = Lv;
//	PQA_Input_rate[I_006_RTNR_Mode2] = 0;

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.
	if((printf_Flag==1) && (MA_print_count%print_delay==0))
	{
		ROSPrintf("rm2~lv=%d,st=%d,LvI=%d,mo=%d,y=%d,int=%d,nmL=%d,nmR=%d\n",
			Lv, still_idx, level_Idx, motion, meanHistY, Lv_intp,noise_status,noise_status,noise_relaible);
		ROSPrintf("mo_i=");
		for(i=0;i<10;i++)
			ROSPrintf("%d,",motioni[i]);
		ROSPrintf("\n");
		/*
		ROSPrintf("rm2~%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,\n",
		SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0], SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_1],
		SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_2], SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[I_006_RTNR_Mode2],
		noise_status, noise_relaible, meanHistY,motion_h_t,motion_h_m,motion_h_b,motion_v_l,motion_v_m,motion_v_r,motion);
		*/
		//ROSPrintf("rm0~hpt=%d,mv=%d,\n",s_hpan_pass_total, s_MV);
	}
#else

	int level_Idx=0, printf_Flag=0, print_delay=200,mv_index=0;
	unsigned char Lv=0,mv_lv=0;
	unsigned char i;
	unsigned int HMC_count=0;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_InputMAD_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_RTNR_MAD][0]);
	unsigned char meanHistY = SmartPic_clue->Hist_Y_Mean_Value;
	unsigned short Lv_intp=0;//, sr_d;
	unsigned int tmp,tmp2;
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned int *pPQA_HMC_MV_w_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_HMC_MV_Hist_Weighting][0]);

	level_Idx = scalerVIP_Cal_Idx_Ave_I_006_noise(RTNR_MAD_count_Y2_avg, 0);

	for(i=0;i<((HMC_Hist_Bin_Num-1)>>1);i++)
	{
		HMC_count+=(SmartPic_clue->HMC_bin_hist_Ratio[32-i]*(16-i));
		HMC_count+=(SmartPic_clue->HMC_bin_hist_Ratio[i]*(16-i));
	}
	mv_index =scalerVIP_Cal_Idx_Ave_I_006_mv(HMC_count, 0);
	//mv_index =scalerVIP_Cal_Idx_Ave_I_006_mv(SmartPic_clue->HMC_bin_hist_Ratio[16], 0);

	//ROSPrintf("first_level_Idx=%d ,F_mv_index =%d\n ",level_Idx,mv_index);

	if(level_Idx < pPQA_InputMAD_TBL[0])
		Lv = 0;
	else if(level_Idx < pPQA_InputMAD_TBL[1])
		Lv = 1;
	else if(level_Idx < pPQA_InputMAD_TBL[2])
		Lv = 2;
	else if(level_Idx < pPQA_InputMAD_TBL[3])
		Lv = 3;
	else if(level_Idx < pPQA_InputMAD_TBL[4])
		Lv = 4;
	else if(level_Idx < pPQA_InputMAD_TBL[5])
		Lv = 5;
	else if(level_Idx < pPQA_InputMAD_TBL[6])
		Lv = 6;
	else if(level_Idx < pPQA_InputMAD_TBL[7])
		Lv = 7;
	else if(level_Idx < pPQA_InputMAD_TBL[8])
		Lv = 8;
	else
		Lv = 9;

	if(mv_index >pPQA_HMC_MV_w_TBL[0])
	{
		level_Idx -=700;
		mv_lv=9;
	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[1])
	{
		level_Idx -=600;
		mv_lv=9;

	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[2])
	{
		level_Idx -=500;
		mv_lv=8;

	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[3])
	{
		level_Idx -=400;
		mv_lv=7;

	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[4])
	{
		level_Idx -=300;
		mv_lv=6;

	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[5])
	{
		level_Idx -=250;
		mv_lv=5;

	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[6])
	{
		level_Idx -=200;
		mv_lv=4;

	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[7])
	{
		level_Idx -=150;
		mv_lv=3;

	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[8])
	{
		level_Idx -=100;
		mv_lv=2;

	}
	else if(mv_index >pPQA_HMC_MV_w_TBL[9])
	{
		level_Idx -=50;
		mv_lv=1;

	}
	else
	{
		mv_lv=0;
	}

	if(level_Idx<=0)
	{
		level_Idx=0;

	}

	//ROSPrintf("mv_index=%d ,pPQA_HMC_MV_w_TBL[0]=%d ,y=%d, Lv_intp=%d \n ",mv_index,pPQA_HMC_MV_w_TBL[0],mv_lv,Lv_intp);

	if(level_Idx < pPQA_InputMAD_TBL[0])
		Lv = 0;
	else if(level_Idx < pPQA_InputMAD_TBL[1])
		Lv = 1;
	else if(level_Idx < pPQA_InputMAD_TBL[2])
		Lv = 2;
	else if(level_Idx < pPQA_InputMAD_TBL[3])
		Lv = 3;
	else if(level_Idx < pPQA_InputMAD_TBL[4])
		Lv = 4;
	else if(level_Idx < pPQA_InputMAD_TBL[5])
		Lv = 5;
	else if(level_Idx < pPQA_InputMAD_TBL[6])
		Lv = 6;
	else if(level_Idx < pPQA_InputMAD_TBL[7])
		Lv = 7;
	else if(level_Idx < pPQA_InputMAD_TBL[8])
		Lv = 8;
	else
		Lv = 9;

	/*	 for OSD setting ,shift level Start Rord 2015/11/07	*/
	if(system_info_structure_table->OSD_Info.OSD_NR_Mode==1) //osd level =low
	{
		Lv = (Lv>1)?(Lv-1):0;
	}
	else if (system_info_structure_table->OSD_Info.OSD_NR_Mode==3) // osd level =high
	{
		Lv = (Lv>=9)?9:(Lv+1);
	}
	/*	 for OSD setting ,shift level END	*/


	if(Lv==9)
		Lv_intp =0;
	else
	{
		if(level_Idx>pPQA_InputMAD_TBL[PQA_I_L09])
			level_Idx = pPQA_InputMAD_TBL[PQA_I_L09];
		tmp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1])==0)?1:(pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1]);
		Lv_intp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-level_Idx)<<8) / tmp;
	}

	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = level_Idx;

	PQA_Input_Level[I_006_RTNR_Mode2] = Lv;
	PQA_Input_rate[I_006_RTNR_Mode2] = 0;
	scalerVIP_Set_Noise_Level(Lv);

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.

	if((printf_Flag&_BIT9)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("LV=%d ,motion=%d ,y=%d, Lv_intp=%d \n ",Lv,level_Idx,meanHistY,Lv_intp);

	}

	tmp2=1000-RTNR_MAD_count_Y_avg-RTNR_MAD_count_Y2_avg-RTNR_MAD_count_Y3_avg;
	if((printf_Flag&_BIT10)!=0 && (MA_print_count%print_delay==0))
	{
		//ROSPrintf("Y1=%d ,Y2=%d ,Y3=%d , mv_index=%d ,Lv= %d ,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_Y2_avg,RTNR_MAD_count_Y3_avg,mv_index,Lv,center,mv_lv);
		ROSPrintf("Y2=%d , mv_index=%d ,level_Idx= %d ,Lv=%d,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y2_avg,mv_index,level_Idx,Lv,center,mv_lv);

	}

	if((printf_Flag&_BIT11)!=0 && (MA_print_count%print_delay==0))
	{
		//ROSPrintf("\n R5=%d ,R4=%d, R3=%d, R2=%d, R1=%d C=%d,L1=%d ,L2=%d ,L3=%d ,L4=%d ,L5=%d \n",hmcnr_sttistic[0],hmcnr_sttistic[1],hmcnr_sttistic[2],
		//hmcnr_sttistic[3],hmcnr_sttistic[4],hmcnr_sttistic[5],hmcnr_sttistic[6],hmcnr_sttistic[7],hmcnr_sttistic[8],hmcnr_sttistic[9],hmcnr_sttistic[10]);

		ROSPrintf("Y1=%d ,Y2=%d ,Y3=%d , mv_index=%d ,Lv= %d ,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_Y2_avg,RTNR_MAD_count_Y3_avg,mv_index,Lv,center,mv_lv);

		//ROSPrintf("hmc_C=%d ,r1=%d,L2 =%d \n",SmartPic_clue->HMC_bin_hist_Ratio[16],SmartPic_clue->HMC_bin_hist_Ratio[15],SmartPic_clue->HMC_bin_hist_Ratio[17]);

	}

	if((printf_Flag&_BIT12)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("C=%d , L1=%d ,R1= %d ,others \n",center,L1,R1,others);

	}

#endif


}
void scalerVIP_compute_level_I_006_RTNR_Mode4(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode3 for HD RTNR
{

	int level_Idx=0, printf_Flag=0, print_delay=200,mv_index=0;
	short Lv=0,mv_lv=0;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_InputMAD_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_RTNR_MAD][0]);
	unsigned char meanHistY = SmartPic_clue->Hist_Y_Mean_Value;
	unsigned short Lv_intp=0;//, sr_d;
	unsigned int tmp,tmp2;
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned int *pPQA_HMC_MV_w_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_HMC_MV_Hist_Weighting][0]);

	level_Idx = scalerVIP_Cal_Idx_Ave_I_006_noise(RTNR_MAD_count_Y2_avg, 0);
	mv_index =scalerVIP_Cal_Idx_Ave_I_006_mv(center, 0);
	//mv_index =scalerVIP_compute_I_chromanrlevel_Index_Ave(scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio(), 0);

		//ROSPrintf("mv_index=%d ,level_Idx=%d ,y=%d, Lv_intp=%d \n ",mv_index,level_Idx,mv_lv,Lv_intp);
		//ROSPrintf("Y1=%d ,Y2=%d ,Y3=%d , mv_index=%d ,Lv= %d ,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_Y2_avg,RTNR_MAD_count_Y3_avg,mv_index,Lv,center,mv_lv);

	if(level_Idx < pPQA_InputMAD_TBL[0])
		Lv = 0;
	else if(level_Idx < pPQA_InputMAD_TBL[1])
		Lv = 1;
	else if(level_Idx < pPQA_InputMAD_TBL[2])
		Lv = 2;
	else if(level_Idx < pPQA_InputMAD_TBL[3])
		Lv = 3;
	else if(level_Idx < pPQA_InputMAD_TBL[4])
		Lv = 4;
	else if(level_Idx < pPQA_InputMAD_TBL[5])
		Lv = 5;
	else if(level_Idx < pPQA_InputMAD_TBL[6])
		Lv = 6;
	else if(level_Idx < pPQA_InputMAD_TBL[7])
		Lv = 7;
	else if(level_Idx < pPQA_InputMAD_TBL[8])
		Lv = 8;
	else
		Lv = 9;



	if(mv_index <pPQA_HMC_MV_w_TBL[0])
	{
		Lv = (Lv>=9)?(Lv-9):0;
		mv_lv=9;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[1])
	{
		Lv = (Lv>8)?(Lv-8):0;
		mv_lv=8;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[2])
	{
		Lv = (Lv>7)?(Lv-7):0;
		mv_lv=7;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[3])
	{
		Lv = (Lv>6)?(Lv-6):0;
		mv_lv=6;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[4])
	{
		Lv = (Lv>5)?(Lv-5):0;
		mv_lv=5;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[5])
	{
		Lv = (Lv>4)?(Lv-4):0;
		mv_lv=4;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[6])
	{
		Lv = (Lv>3)?(Lv-3):0;
		mv_lv=3;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[7])
	{
		Lv = (Lv>2)?(Lv-2):0;
		mv_lv=2;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[8])
	{
		Lv = (Lv>1)?(Lv-1):0;
		mv_lv=1;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[9])
	{
		mv_lv=0;
	}
	else
	{
		mv_lv=0;
	}


	if(Lv<=0)
	{
		Lv=0;
	}

	/*	 for OSD setting ,shift level Start Rord 2015/11/07	*/
	if(system_info_structure_table->OSD_Info.OSD_NR_Mode==1) //osd level =low
	{
		Lv = (Lv>1)?(Lv-1):0;
	}
	else if (system_info_structure_table->OSD_Info.OSD_NR_Mode==3) // osd level =high
	{
		Lv = (Lv>=9)?9:(Lv+1);
	}
	/*	 for OSD setting ,shift level END	*/


	if(Lv==9)
		Lv_intp =0;
	else
	{
		if(level_Idx>pPQA_InputMAD_TBL[PQA_I_L09])
			level_Idx = pPQA_InputMAD_TBL[PQA_I_L09];
		tmp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1])==0)?1:(pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1]);
		Lv_intp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-level_Idx)<<8) / tmp;
	}

	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = level_Idx;

	PQA_Input_Level[I_006_RTNR_Mode4] = Lv;
	PQA_Input_rate[I_006_RTNR_Mode4] = 0;
	scalerVIP_Set_Noise_Level(Lv);

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.


	//ROSPrintf("Lv=%d ,mv_lv=%d, mv_index=%d  \n ",Lv,mv_lv,mv_index);

	if((printf_Flag&_BIT9)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("LV=%d ,motion=%d ,y=%d, Lv_intp=%d \n ",Lv,level_Idx,meanHistY,Lv_intp);

	}

	tmp2=1000-RTNR_MAD_count_Y_avg-RTNR_MAD_count_Y2_avg-RTNR_MAD_count_Y3_avg;
	if((printf_Flag&_BIT10)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("Y1=%d ,Y2=%d ,Y3=%d , mv_index=%d ,Lv= %d ,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_Y2_avg,RTNR_MAD_count_Y3_avg,mv_index,Lv,center,mv_lv);
	}

	if((printf_Flag&_BIT11)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("C=%d , L1=%d ,R1= %d ,others \n",center,L1,R1,others);

	}
}

void scalerVIP_compute_level_I_006_RTNR_Mode2_HMCNR(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode2 for SD RTNR
{
	int level_Idx=0, printf_Flag=0, print_delay=200,mv_index=0;
	unsigned char Lv=0,mad_lv=0,mv_lv=0,apl_lv=0;//,ori_lv=0;
	//unsigned char i;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_InputMAD_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_RTNR_MAD][0]);
	unsigned char meanHistY = SmartPic_clue->Hist_Y_Mean_Value;
	unsigned short Lv_intp=0;//, sr_d;
	unsigned int tmp,tmp2;
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned int *pPQA_HMC_MV_w_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_HMC_MV_Hist_Weighting][0]);
	static unsigned char mcnr_pan_nr_level = 255;

	unsigned int *pPQA_Input_HistMeanY_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_DCC_Histogram_mean][0]);


	level_Idx = scalerVIP_Cal_Idx_Ave_I_006_mcnr(RTNR_MAD_count_Y2_avg, 0);
	//mv_index =scalerVIP_compute_I_hmcnrlevel_Index_Ave(SmartPic_clue->HMC_bin_hist_Ratio[16], 0);
	mv_index = scalerVIP_compute_I_hmcnrlevel_Index_Ave(scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio(),0);


	unsigned char cur_source=0,sd_input=0;
	cur_source=(RPC_system_info_structure_table->VIP_source);

	if((cur_source >= VIP_QUALITY_CVBS_NTSC && cur_source <=VIP_QUALITY_YPbPr_576P)||
		(cur_source >= VIP_QUALITY_HDMI_480I && cur_source <=VIP_QUALITY_HDMI_576P)||
		(cur_source >= VIP_QUALITY_DTV_480I && cur_source <=VIP_QUALITY_DTV_576P)||
		(cur_source >= VIP_QUALITY_PVR_480I && cur_source <=VIP_QUALITY_PVR_576P)||
		(cur_source >= VIP_QUALITY_CVBS_SECAN && cur_source <=VIP_QUALITY_TV_NTSC443))
	{
		sd_input = 1;
	}
	else
	{
		sd_input = 0;
	}



	if(level_Idx < pPQA_InputMAD_TBL[0])
	{
		Lv = 0;
		mad_lv =0;
	}
	else if(level_Idx < pPQA_InputMAD_TBL[1])
	{
		Lv = 1;
		mad_lv =1;
	}
	else if(level_Idx < pPQA_InputMAD_TBL[2])
	{
		Lv = 2;
		mad_lv =2;
	}
	else if(level_Idx < pPQA_InputMAD_TBL[3])
	{
		Lv = 3;
		mad_lv =3;
	}
	else if(level_Idx < pPQA_InputMAD_TBL[4])
	{
		Lv = 4;
		mad_lv =4;
	}
	else if(level_Idx < pPQA_InputMAD_TBL[5])
	{
		Lv = 5;
		mad_lv =5;
	}
	else if(level_Idx < pPQA_InputMAD_TBL[6])
	{
		Lv = 6;
		mad_lv =6;
	}
	else if(level_Idx < pPQA_InputMAD_TBL[7])
	{
		Lv = 7;
		mad_lv =7;
	}
	else if(level_Idx < pPQA_InputMAD_TBL[8])
	{
		Lv = 8;
		mad_lv =8;
	}
	else
	{
		Lv = 9;
		mad_lv =9;

	}
	//ori_lv = Lv;


	if(mv_index <pPQA_HMC_MV_w_TBL[0])
	{
		Lv = (Lv>9)?(Lv-9):0;
		mv_lv=9;
	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[1])
	{
		Lv = (Lv>8)?(Lv-8):0;
		mv_lv=8;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[2])
	{
		Lv = (Lv>7)?(Lv-7):0;
		mv_lv=7;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[3])
	{
		Lv = (Lv>6)?(Lv-6):0;
		mv_lv=6;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[4])
	{
		Lv = (Lv>5)?(Lv-5):0;
		mv_lv=5;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[5])
	{
		Lv = (Lv>4)?(Lv-4):0;
		mv_lv=4;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[6])
	{
		Lv = (Lv>3)?(Lv-3):0;
		mv_lv=3;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[7])
	{
		Lv = (Lv>2)?(Lv-2):0;
		mv_lv=2;

	}
	else if(mv_index <pPQA_HMC_MV_w_TBL[8])
	{
		Lv = (Lv>1)?(Lv-1):0;
		mv_lv=1;

	}
	else
	{
		mv_lv=0;
	}


	if(meanHistY<pPQA_Input_HistMeanY_TBL[0])
	{
		Lv = (Lv>9)?(Lv-9):0;
		apl_lv=9;
	}
	else if(meanHistY<pPQA_Input_HistMeanY_TBL[1])
	{
		Lv = (Lv>8)?(Lv-8):0;
		apl_lv=8;

	}
	else if(meanHistY<pPQA_Input_HistMeanY_TBL[2])
	{
		Lv = (Lv>7)?(Lv-7):0;
		apl_lv=7;
	}
	else if(meanHistY<pPQA_Input_HistMeanY_TBL[3])
	{
		Lv = (Lv>6)?(Lv-6):0;
		apl_lv=6;
	}
	else if(meanHistY<pPQA_Input_HistMeanY_TBL[4])
	{
		Lv = (Lv>5)?(Lv-5):0;
		apl_lv=5;
	}
	else if(meanHistY<pPQA_Input_HistMeanY_TBL[5])
	{
		Lv = (Lv>4)?(Lv-4):0;
		apl_lv=4;
	}
	else if(meanHistY<pPQA_Input_HistMeanY_TBL[6])
	{
		Lv = (Lv>3)?(Lv-3):0;
		apl_lv=3;
	}
	else if(meanHistY<pPQA_Input_HistMeanY_TBL[7])
	{
		Lv = (Lv>2)?(Lv-2):0;
		apl_lv=2;
	}
	else if(meanHistY<pPQA_Input_HistMeanY_TBL[8])
	{
		Lv = (Lv>1)?(Lv-1):0;
		apl_lv=1;
	}
	else
	{
		apl_lv=0;

	}


	//if(ori_lv<=3)
	//	Lv=ori_lv;


	if(Lv<=0)
	{
		Lv=0;

	}


	//rord start  2016/12/01
	unsigned char diff_Th1=1,diff_Th2=2,score_th=10;
	static char pre_meanHistY=0,prepre_meanHistY=0;
	static char diff_score=0;
	char pn_flag=0;
	static char pn_flag_pre=0;
	char Level=0;
	Level = Lv;
	if(meanHistY>pre_meanHistY)
			pn_flag=1;
		else if(meanHistY<pre_meanHistY)
			pn_flag=-1;
		else
			pn_flag=0;


	if(RTNR_MAD_count_Y_avg<20)
	{
		if(pn_flag*pn_flag_pre==-1)
		{
			diff_score--;
			if(diff_score<0)
				diff_score=0;
		}
		else if (ABS(pre_meanHistY,meanHistY)>=diff_Th2 || (ABS(pre_meanHistY,meanHistY)>=diff_Th1&&diff_score >5))
		{
			diff_score += 2;
			if(diff_score > 25)
				diff_score=25;
		}
		else if (ABS(pre_meanHistY,meanHistY)>=diff_Th1 || ABS(prepre_meanHistY,meanHistY)>=diff_Th1)
		{
			diff_score ++;
			if(diff_score > 25)
				diff_score=25;
		}
		else if (ABS(prepre_meanHistY,meanHistY)==0)
		{
			diff_score --;
			if(diff_score<0)
				diff_score=0;
		}


		//printk("score1 =%d \n",diff_score);

		if(diff_score>score_th)
		{

			Level= Level-(diff_score-score_th);
			if(Level<0)
				Level=0;


			//printk("score3 =%d , lv=%d \n",diff_score,Lv);

		}
		Lv =Level;

		//if(rtd_inl(0xb802e4f4)==0x17)
			//printk("\n score3 =%d,meanHistY=%d,Lv=%d \n ",diff_score,meanHistY,Lv );
		//	printk("MAD_1=%d =%d,score=%d,Lv =%d ,meanHistY=%d\n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_Y2_avg,diff_score,Lv,meanHistY);

	}
	else
	{
		diff_score--;
		if(diff_score<0)
			diff_score=0;

	}

	//rord End  2016/12/01

/////////////////// mcnr pan , use the same nr level start////////////////////////////////////////

	if(sd_input ==1)
	{
		if(DynamicOptimizeSystem[7]==1||DynamicOptimizeSystem[75]==1)
		{
		if((scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==1)&&mcnr_pan_nr_level==255)
		{
			mcnr_pan_nr_level = 4;
		}
		else if(scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==0)
		{
			mcnr_pan_nr_level = 255;
		}

		if(mcnr_pan_nr_level !=255)
		{
			Lv = mcnr_pan_nr_level;
		}
	}
	}
	else
	{
		if((scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==1)&&mcnr_pan_nr_level==255)
		{
			//mcnr_pan_nr_level = 6;
		}
		else if(scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==0)
		{
		//	mcnr_pan_nr_level = 255;
		}

		if(mcnr_pan_nr_level !=255)
		{
		//	Lv = mcnr_pan_nr_level;
		}



	}


/////////////////// mcnr pan , use the same nr level  end ////////////////////////////////////////
	/*	 for OSD setting ,shift level Start	*/
	if(system_info_structure_table->OSD_Info.OSD_NR_Mode==1) //osd level =low
	{
		Lv = (Lv>1)?(Lv-1):0;
	}
	else if (system_info_structure_table->OSD_Info.OSD_NR_Mode==3) // osd level =high
	{
		Lv = (Lv>=9)?9:(Lv+1);
	}
	/*	 for OSD setting ,shift level END	*/


	if(DynamicOptimizeSystem[35]==1)	// lg radio,
		Lv = 0;

	if(DynamicOptimizeSystem[7]==1)	// lg radio,
		Lv = 4;

	if(Lv==9)
		Lv_intp =0;
	else
	{
		if(level_Idx>pPQA_InputMAD_TBL[PQA_I_L09])
			level_Idx = pPQA_InputMAD_TBL[PQA_I_L09];
		tmp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1])==0)?1:(pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1]);
		Lv_intp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-level_Idx)<<8) / tmp;
	}


	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = level_Idx;
	//SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_1] = motion;

	PQA_Input_Level[I_006_RTNR_Mode2_HMCNR] = Lv;
	PQA_Input_rate[I_006_RTNR_Mode2_HMCNR] = 0;
	scalerVIP_Set_Noise_Level(Lv);

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.

	/*if(rtd_inl(0xb802e4f4)==12)
		printk("\n level_Idx =%d,mv_index=%d,meanHistY=%d ,Cur_Lv=%d \n ",level_Idx,mv_index,meanHistY,Lv );
	if(rtd_inl(0xb802e4f4)==13)
		printk("\n LV=%d,mad=%d,MV=%d ,y=%d,\n ",Lv,mad_lv,mv_lv,apl_lv);

	*/
	if((printf_Flag&_BIT8)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("\n level_Idx =%d,mv_index=%d,meanHistY=%d ,Cur_Lv=%d \n ",level_Idx,mv_index,meanHistY,Lv );

	}

	if((printf_Flag&_BIT9)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("\n LV=%d,mad=%d,MV=%d ,y=%d,\n ",Lv,mad_lv,mv_lv,apl_lv);
	}

	tmp2=1000-RTNR_MAD_count_Y_avg-RTNR_MAD_count_Y2_avg-RTNR_MAD_count_Y3_avg;

	//ROSPrintf(" mv=%d ,Idx= %d ,Lv=%d\n",mv_index,level_Idx,Lv);

	if((printf_Flag&_BIT10)!=0 && (MA_print_count%print_delay==0))
	{
		//ROSPrintf("Y1=%d ,Y2=%d ,Y3=%d , mv_index=%d ,Lv= %d ,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y_avg,RTNR_MAD_count_Y2_avg,RTNR_MAD_count_Y3_avg,mv_index,Lv,center,mv_lv);
		ROSPrintf("Y2=%d , mv_index=%d ,level_Idx= %d ,Lv=%d,C=%d ,mv_lv=%d \n",RTNR_MAD_count_Y2_avg,mv_index,level_Idx,Lv,center,mv_lv);

	}

	if((printf_Flag&_BIT11)!=0 && (MA_print_count%print_delay==0))
	{
		//ROSPrintf("\n R5=%d ,R4=%d, R3=%d, R2=%d, R1=%d C=%d,L1=%d ,L2=%d ,L3=%d ,L4=%d ,L5=%d \n",hmcnr_sttistic[0],hmcnr_sttistic[1],hmcnr_sttistic[2],
		//hmcnr_sttistic[3],hmcnr_sttistic[4],hmcnr_sttistic[5],hmcnr_sttistic[6],hmcnr_sttistic[7],hmcnr_sttistic[8],hmcnr_sttistic[9],hmcnr_sttistic[10]);


		ROSPrintf("hmc_C=%d ,r1=%d,L2 =%d \n",SmartPic_clue->HMC_bin_hist_Ratio[16],SmartPic_clue->HMC_bin_hist_Ratio[15],SmartPic_clue->HMC_bin_hist_Ratio[17]);

	}

	if((printf_Flag&_BIT12)!=0 && (MA_print_count%print_delay==0))
	{
		ROSPrintf("C=%d , L1=%d ,R1= %d ,others \n",center,L1,R1,others);

	}

	prepre_meanHistY = pre_meanHistY;

	pre_meanHistY = meanHistY;
	pn_flag_pre=pn_flag;
}


void scalerVIP_compute_level_I_006_SNR_Mode0(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode1 for RF CVBS SNR
{
	int level_Idx=0;
	unsigned char Lv=0;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_InputMAD_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_FMV_Hist_motionIdx_offset][0]);
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];


	//NOTICE it is only for interlace mode

	//unsigned int noise_relaible = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE);
	//unsigned int motion = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);
	unsigned char motionl_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION);

	//ROSPrintf("\n motionl_level =%d ,relaible = %d \n",motionl_level,noise_relaible);
	level_Idx = motionl_level;

	if(level_Idx < pPQA_InputMAD_TBL[0])
		Lv = 0;
	else if(level_Idx < pPQA_InputMAD_TBL[1])
		Lv = 1;
	else if(level_Idx < pPQA_InputMAD_TBL[2])
		Lv = 2;
	else if(level_Idx < pPQA_InputMAD_TBL[3])
		Lv = 3;
	else if(level_Idx < pPQA_InputMAD_TBL[4])
		Lv = 4;
	else if(level_Idx < pPQA_InputMAD_TBL[5])
		Lv = 5;
	else if(level_Idx < pPQA_InputMAD_TBL[6])
		Lv = 6;
	else if(level_Idx < pPQA_InputMAD_TBL[7])
		Lv = 7;
	else if(level_Idx < pPQA_InputMAD_TBL[8])
		Lv = 8;
	else
		Lv = 9;


	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = level_Idx;

	PQA_Input_Level[I_006_SNR_Mode0] = Lv;
	PQA_Input_rate[I_006_SNR_Mode0] = 0;

}


void scalerVIP_compute_level_I_006_SNR_Mode1(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode2 for SD SNR
{
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	static unsigned int pre_RTNR_MAD_count_Y_avg = 0;

	pre_RTNR_MAD_count_Y_avg = (RTNR_MAD_count_Y_avg+pre_RTNR_MAD_count_Y_avg*3)>>2;

	PQA_Input_rate[I_006_SNR_Mode1] = 255 - (pre_RTNR_MAD_count_Y_avg>255?255:pre_RTNR_MAD_count_Y_avg);
	PQA_Input_Level[I_006_SNR_Mode1] = 0;
}

void scalerVIP_compute_level_I_006_SNR_Mode2(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode3 for HD SNR
{

	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned int temp = 0;
	static unsigned int pre_temp = 0;
	static unsigned int pre_RTNR_MAD_count_Y_avg = 0;
	static unsigned int pre_RTNR_MAD_count_Y2_avg = 0;
	static unsigned int pre_RTNR_MAD_count_Y3_avg = 0;

	pre_RTNR_MAD_count_Y_avg = (RTNR_MAD_count_Y_avg+pre_RTNR_MAD_count_Y_avg*3)>>2;
	pre_RTNR_MAD_count_Y2_avg = (RTNR_MAD_count_Y2_avg+pre_RTNR_MAD_count_Y2_avg*3)>>2;
	pre_RTNR_MAD_count_Y3_avg = (RTNR_MAD_count_Y3_avg+pre_RTNR_MAD_count_Y3_avg*3)>>2;

	temp = ((pre_RTNR_MAD_count_Y_avg)-((pre_RTNR_MAD_count_Y2_avg+pre_RTNR_MAD_count_Y3_avg)>>1));
	temp = temp>255?255:temp;

        if(g_IsNot4KVO){
	PQA_Input_rate[I_006_SNR_Mode2] = temp;
	pre_temp = PQA_Input_rate[I_006_SNR_Mode2];

	PQA_Input_Level[I_006_SNR_Mode2] = 0;
        }else{
                PQA_Input_rate[I_006_SNR_Mode2] = 255;
                PQA_Input_Level[I_006_SNR_Mode2] = 0;
        }

}
void scalerVIP_compute_level_I_006_SHP_Mode0(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode1 for RF CVBS RTNR
{
	//unsigned int level_Idx=0, printf_Flag=0, print_delay=200;
	unsigned char Lv=0;

	//unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	//unsigned int *pPQA_InputMAD_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_RTNR_MAD][0]);
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];

	// get spatial content noise meter status
	//unsigned int noise_status = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL);
	//unsigned int noise_relaible = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE);
	//get mean histgram Y
	//unsigned char meanHistY = SmartPic_clue->Hist_Y_Mean_Value;


	unsigned char temporal_noise_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_TEMPORAL_NOISE_LEVEL);



	if(temporal_noise_level <=0)
		Lv = 9;
	else if(temporal_noise_level <= 1)
		Lv = 8;
	else if(temporal_noise_level <= 2)
		Lv = 7;
	else if(temporal_noise_level <= 3)
		Lv = 6;
	else if(temporal_noise_level <= 5)
		Lv = 5;
	else if(temporal_noise_level <=7)
		Lv = 4;
	else if(temporal_noise_level <= 9)
		Lv = 3;
	else if(temporal_noise_level <=11)
		Lv = 2;
	else if(temporal_noise_level <= 13)
		Lv = 1;
	else
		Lv=0;

	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0] = Lv;
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_1] = temporal_noise_level;

	PQA_Input_Level[I_006_SHP_Mode0] = Lv;
	PQA_Input_rate[I_006_SHP_Mode0] = 0;



	//printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	//print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.
	//if(((printf_Flag&_BIT0)!=0) && (MA_print_count%print_delay==0))
	//	ROSPrintf("rm0~%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,%d,\n",
	//	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_0], SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_1],
	//	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_2], SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[I_006_RTNR_Mode2],
	//	noise_status, noise_relaible, meanHistY,motion_h_t,motion_h_m,motion_h_b,motion_v_l,motion_v_m,motion_v_r,motion);

}

unsigned int scalerVIP_Cal_Idx_Ave_I_006_Dynamic_SHP(unsigned int lv_index, unsigned char isAll_Flag)
{
	#define windowSize1 64
	#define windowSizeBit1 6

	static unsigned char idx=0;
	static unsigned int levelIdx_arr[windowSize1]={0};

	unsigned char i=0;
	unsigned int sum= 0, ret =0 ;

	if(isAll_Flag==1)
	{
		for(i=0;i<windowSize1;i++)
			levelIdx_arr[i] = lv_index;
		ret = lv_index;
	}
	else
	{
		levelIdx_arr[idx] = lv_index;

		for(i=0;i<windowSize1;i++)
			sum = sum + levelIdx_arr[i];
		ret = sum>>windowSizeBit1;

		idx++;
		if(idx==windowSize1)
			idx=0;
	}
	return ret;
}

void scalerVIP_compute_level_I_006_SHP_Mode2(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode2 for HD SNR
{
	unsigned int level_Idx=0, printf_Flag=0, print_delay=200;
	unsigned char Lv=0;
	unsigned char i;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_InputMAD_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_SHP_MAD][0]);
	//unsigned int *pPQA_Input_HistMeanY_Dark_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_DCC_Histogram_mean_dark][0]);
	//unsigned int *pPQA_Input_HistMeanY_Dark_Gain_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_DCC_Histogram_mean_dark_gain][0]);
	unsigned int tmp;

	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned int motioni[10]={0};

	unsigned short Lv_intp=0;//, sr_d;
	Lv_intp=0;

	unsigned int motion = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);

	motioni[0] = motion;

	// for moving bamboo women, and moving building, more coring effect.
	if( (DynamicOptimizeSystem[198]==1) || (DynamicOptimizeSystem[199]==1) )
		motion = pPQA_InputMAD_TBL[PQA_I_L09];

	//	for change smoothly
	if(motion>pPQA_InputMAD_TBL[PQA_I_L09])
		motion = pPQA_InputMAD_TBL[PQA_I_L09];
	level_Idx = scalerVIP_Cal_Idx_Ave_I_006_Dynamic_SHP(motion, 0);

	if(level_Idx <= pPQA_InputMAD_TBL[0])
		Lv = 9;
	else if(level_Idx <= pPQA_InputMAD_TBL[1])
		Lv = 8;
	else if(level_Idx <= pPQA_InputMAD_TBL[2])
		Lv = 7;
	else if(level_Idx <= pPQA_InputMAD_TBL[3])
		Lv = 6;
	else if(level_Idx <= pPQA_InputMAD_TBL[4])
		Lv = 5;
	else if(level_Idx <= pPQA_InputMAD_TBL[5])
		Lv = 4;
	else if(level_Idx <= pPQA_InputMAD_TBL[6])
		Lv = 3;
	else if(level_Idx <= pPQA_InputMAD_TBL[7])
		Lv = 2;
	else if(level_Idx <= pPQA_InputMAD_TBL[8])
		Lv = 1;
	else
		Lv=0;

	if(Lv==9)
		Lv_intp =0;
	else
	{
		if(level_Idx>pPQA_InputMAD_TBL[PQA_I_L09])
			level_Idx = pPQA_InputMAD_TBL[PQA_I_L09];
		tmp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1])==0)?1:(pPQA_InputMAD_TBL[PQA_I_L09-Lv]-pPQA_InputMAD_TBL[PQA_I_L09-Lv-1]);
		Lv_intp = ((pPQA_InputMAD_TBL[PQA_I_L09-Lv]-level_Idx)<<8) / tmp;
	}

	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_8] = level_Idx;
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_Level_Idx_9] = motion;

	PQA_Input_Level[I_006_SHP_Mode2] = Lv;
	PQA_Input_rate[I_006_SHP_Mode2] = Lv_intp;

	printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
	print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;
	//for debug.
	if((printf_Flag==1) && (MA_print_count%print_delay==0))
	{
		ROSPrintf("sh2~lv=%d,LvI=%d,mo=%d,int=%d\n",
			Lv, level_Idx, motion, Lv_intp);
		ROSPrintf("mo_i=");
		for(i=0;i<10;i++)
			ROSPrintf("%d,",motioni[i]);
		ROSPrintf("\n");
	}
}

//vvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvv

//vvvvvvvvvvvvvvvvvvvvvvv simple mode vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv simple mode vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv simple mode vvv
void scalerVIP_compute_level_I_SPM_LV_CTRL0(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table) // TV006 mode2 for HD SNR
{
	unsigned int current_Signal_Status, MAD_still_idx, FMV_still_idx, MAD_noise_index, wei_sum;
	unsigned char meanHistY, FMV_C, VD_Lv, MAD_Noise_Lv, MAD_Still_Lv, FMV_Still_Lv, Hist_Mean_Y_Lv, i, Lv;
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int *pPQA_Input_SPM_VD_status_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_SPM_VD_status][0]);
	unsigned int *pPQA_Input_SPM_MAD_Noise_Index_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_SPM_MAD_Noise_Index][0]);
	unsigned int *pPQA_Input_SPM_MAD_Still_Index_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_SPM_MAD_Still_Index][0]);
	unsigned int *pPQA_Input_SPM_FMV_Still_Index_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_SPM_FMV_Still_Index][0]);
	unsigned int *pPQA_Input_Hist_Mean_Y_TBL = &(vipTable_shareMem->PQA_Input_Table[PQA_table_select][I_SPM_Hist_Mean_Y][0]);

	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned char *PQA_RunFlag = &(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Run_Flag[0]);

	unsigned int  VD_status_w = pPQA_Input_SPM_VD_status_TBL[PQA_I_L09];
	unsigned int  MAD_Noise_w = pPQA_Input_SPM_MAD_Noise_Index_TBL[PQA_I_L09];
	unsigned int  MAD_Still_w = pPQA_Input_SPM_MAD_Still_Index_TBL[PQA_I_L09];
	unsigned int  FMV_Still_w = pPQA_Input_SPM_FMV_Still_Index_TBL[PQA_I_L09];
	unsigned int  Hist_Mean_Y_w = pPQA_Input_Hist_Mean_Y_TBL[PQA_I_L09];

	/* I_SPM_VD_status */
	current_Signal_Status = SmartPic_clue->VD_Signal_Status_value_avg;
	VD_Lv = PQA_I_L09;
	if (VD_status_w != 0) {
		for (i=0;i<PQA_I_L09;i++)
			if (current_Signal_Status < pPQA_Input_SPM_VD_status_TBL[i]) {
				VD_Lv = i;
				break;
			}
	}

	/* I_SPM_MAD_Noise_Index */
	MAD_noise_index = SmartPic_clue->RTNR_MAD_count_Y2_avg_ratio;
	MAD_Noise_Lv = PQA_I_L09;
	if (MAD_Noise_w != 0) {
		for (i=0;i<PQA_I_L09;i++)
			if (MAD_noise_index < pPQA_Input_SPM_MAD_Noise_Index_TBL[i]) {
				MAD_Noise_Lv = i;
				break;
			}
	}

	/* I_SPM_MAD_Still_Index */
	MAD_still_idx = (SmartPic_clue->RTNR_MAD_count_Y4_avg_ratio>1000)?(1000):(SmartPic_clue->RTNR_MAD_count_Y4_avg_ratio);
	MAD_still_idx = 1000 - MAD_still_idx;
	MAD_Still_Lv = PQA_I_L09;
	if (MAD_Still_w != 0) {
		for (i=0;i<PQA_I_L09;i++)
			if (MAD_still_idx < pPQA_Input_SPM_MAD_Still_Index_TBL[i]) {
				MAD_Still_Lv = i;
				break;
			}
	}

	/* I_SPM_FMV_Still_Index */
	if (SmartPic_clue->GMV == 3) {
		FMV_C = FMV_Hist_Bin_Num >> 1;
		FMV_still_idx = (SmartPic_clue->FMV_hist_Ratio[FMV_C] * 10) + (SmartPic_clue->FMV_hist_Ratio[FMV_C-1] * 3) + (SmartPic_clue->FMV_hist_Ratio[FMV_C+1] * 3);
		FMV_still_idx = FMV_still_idx >>4;
	} else {
		FMV_still_idx = 0;
	}
	FMV_Still_Lv = PQA_I_L09;
	if (FMV_Still_w != 0) {
		for (i=0;i<PQA_I_L09;i++)
			if (FMV_still_idx < pPQA_Input_SPM_FMV_Still_Index_TBL[i]) {
				FMV_Still_Lv = i;
				break;
			}
	}

	/* I_SPM_Hist_Mean_Y */
	meanHistY = SmartPic_clue->Hist_Y_Mean_Value;
	Hist_Mean_Y_Lv = PQA_I_L09;
	if (Hist_Mean_Y_w != 0) {
		for (i=0;i<PQA_I_L09;i++)
			if (meanHistY < pPQA_Input_Hist_Mean_Y_TBL[i]) {
				Hist_Mean_Y_Lv = i;
				break;
			}
	}

	/* cal final lv by weighting */
	wei_sum = VD_status_w + MAD_Noise_w + MAD_Still_w + FMV_Still_w + Hist_Mean_Y_w;
	Lv = ((VD_status_w * VD_Lv) + (MAD_Noise_w * MAD_Noise_Lv) + (MAD_Still_w * MAD_Still_Lv) + (FMV_Still_w * FMV_Still_Lv) + (Hist_Mean_Y_w * Hist_Mean_Y_Lv)) / wei_sum;

	PQA_Input_Level[I_SPM_LV_CTRL0] = Lv;
	PQA_Input_rate[I_SPM_LV_CTRL0] = 0;

	/* info recording*/
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_SPM_LvIdx_VD] = current_Signal_Status;
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_SPM_LvIdx_MAD_Noise] = MAD_noise_index;
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_SPM_LvIdx_MAD_Still] = MAD_still_idx;
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_SPM_LvIdx_FMV_Still] = FMV_still_idx;
	SmartPic_clue->PQA_ISR_Cal_Info.Level_Index[PQA_SPM_LvIdx_Y] = meanHistY;

#if 1
	unsigned int printf_Flag = system_info_structure_table->ISR_Printf_Flag.PQA_SPM_Flag0;
	unsigned int print_delay = (system_info_structure_table->ISR_Printf_Flag.Delay_Time == 0)?(1):(system_info_structure_table->ISR_Printf_Flag.Delay_Time);
	//for debug.
	if(((printf_Flag&_BIT0)!=0))
	{
		if(MA_print_count%print_delay==0)
		{
			printk("Cal_SPM, current_Signal_Status=%d, MAD_noise_index=%d, MAD_still_idx=%d, FMV_still_idx=%d, meanHistY=%d\n",
				current_Signal_Status, MAD_noise_index, MAD_still_idx, FMV_still_idx, meanHistY);
			printk("Cal_SPM, VD_status_w=%d, MAD_Noise_w=%d, MAD_Still_w=%d, FMV_Still_w=%d, Hist_Mean_Y_w=%d\n",
				VD_status_w, MAD_Noise_w, MAD_Still_w, FMV_Still_w, Hist_Mean_Y_w);
			printk("Cal_SPM, VD_Lv=%d, MAD_Noise_Lv=%d, MAD_Still_Lv=%d, FMV_Still_Lv=%d, Hist_Mean_Y_Lv=%d, Lv=%d\n",
				VD_Lv, MAD_Noise_Lv, MAD_Still_Lv, FMV_Still_Lv, Hist_Mean_Y_Lv, Lv);
		}
	}
#endif


}
//vvvvvvvvvvvvvvvvvvvvvvv simple mode vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv simple mode vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv simple mode vvv
//=====================================================================================================================

void scalerVIP_PQA_level_Ctrl(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table)
{
	unsigned char i;

	for(i=0;i<PQA_INPUT_TYPE_MAX;i++)
	{
		if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Flow_Ctrl_Input_Type_setFlag[i]==1)
			system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Run_Flag[i] = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Flow_Ctrl_Input_Type[i];
	}

	for(i=0;i<PQA_INPUT_ITEM_MAX;i++)
	{
		if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Flow_Ctrl_Input_Item_setFlag[i]==1)
		{
			SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[i] = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Flow_Ctrl_Input_Item[i];
			SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[i] = 0;
		}
	}

#if 0
	if(MA_print_count%20==0)
	{
		for(i=0;i<PQA_INPUT_TYPE_MAX;i++)
			ROSPrintf("%d,", system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Run_Flag[i]);
		ROSPrintf("\n");
		for(i=0;i<PQA_INPUT_TYPE_MAX;i++)
			ROSPrintf("%d,", system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Flow_Ctrl_Input_Type[i]);
		ROSPrintf("\n");
	}
#endif
}

void scalerVIP_compute_PQA_level(SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table)
{
	unsigned int *pPQA_InputTable = &(vipTable_shareMem->PQA_Input_Table[0][0][0]);
	unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
	unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];
	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;

//vvvvvvvvvvvvvvvvvvvvvvvTV_005_stylevvvvvvvvvvvvvvvvvvvvvvv
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_005_RFCVBS]==1)
	scalerVIP_compute_level_I_005_RFCVBS_DNR(PQA_table_select, pPQA_InputTable, PQA_Input_Level, PQA_Input_rate);

	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_005_SDHD]==1)
	scalerVIP_compute_level_I_005_SDHD_DNR(PQA_table_select, pPQA_InputTable, PQA_Input_Level, PQA_Input_rate);
//^^^^^^^^^^^^^^^^^^TV_005_style^^^^^^^^^^^^^^^^^^
	if((system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_MOTION_RTNR]==1)||
	(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_MOTION_SPNR]==1))
	scalerVIP_RTNR_level_compute((SmartPic_clue->MAD_motion_status), (SmartPic_clue->block_motion_status), PQA_Input_Level, PQA_Input_rate);

//vvvvvvvvvvvvvvvvvvvvvvvTV_002_stylevvvvvvvvvvvvvvvvvvvvvvv
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_002_RTNR_2]==1)
	{
		//scalerVIP_compute_level_I_002_RTNR2(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV002 mode2 for HD RTNR
		//scalerVIP_compute_level_I_002_CorrectionBit(vipTable_shareMem, SmartPic_clue, system_info_structure_table);
		Scaler_scalerVIP_compute_level_I_002_RTNR2_tv002(vipTable_shareMem, SmartPic_clue, system_info_structure_table, MA_print_count);
	}
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_002_RTNR_0]==1)
		Scaler_scalerVIP_compute_level_I_002_RTNR0_tv002(vipTable_shareMem, SmartPic_clue, system_info_structure_table, MA_print_count);
//^^^^^^^^^^^^^^^^^^TV_002_style^^^^^^^^^^^^^^^^^^


//vvvvvvvvvvvvvvvvvvvvvvvTV_BitRate_Controlvvvvvvvvvvvvvvvvvvvvvvv
if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_BitRate_Crtl]==1)
	scalerVIP_compute_level_I_BITRate(vipTable_shareMem, SmartPic_clue, RPC_SmartPic_clue, system_info_structure_table); // for BITRate_Ctrl
//^^^^^^^^^^^^^^^^^^TV_BitRate_Control^^^^^^^^^^^^^^^^^^


//vvvvvvvvvvvvvvvvvvvvvvvTV_003_stylevvvvvvvvvvvvvvvvvvvvvvv
	if((system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_003_RTNR_TH1]==1)||
	(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_003_RTNR_TH2]==1)||
	(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_003_RTNR_TH3]==1)||
	(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_003_RTNR_TH4]==1)||
	(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_003_RTNR_TH5]==1)||
	(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_003_RTNR_TH6]==1)||
	(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_003_RTNR_TH7]==1))
	{
	scalerVIP_TV003_MAD_Y(PQA_Input_Level, PQA_Input_rate);
	}

//^^^^^^^^^^^^^^^^^^TV_003_style^^^^^^^^^^^^^^^^^^

//=====================================================================================================================
//vvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvv
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_RTNR_Mode0]==1)
		scalerVIP_compute_level_I_006_RTNR_Mode0(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode0 for RF CVBS RTNR
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_RTNR_Mode1]==1)
		scalerVIP_compute_level_I_006_RTNR_Mode1(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode1 for SD RTNR
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_RTNR_Mode2]==1)
		scalerVIP_compute_level_I_006_RTNR_Mode2(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode2 for HD RTNR
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_RTNR_Mode4]==1)
		scalerVIP_compute_level_I_006_RTNR_Mode4(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode4  for Progressive mode RTNR

	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_RTNR_Mode2_HMCNR]==1)
		scalerVIP_compute_level_I_006_RTNR_Mode2_HMCNR(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode2 for HD hmcnr



	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_SNR_Mode0]==1)
		scalerVIP_compute_level_I_006_SNR_Mode0(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode0 for RF CVBS SNR
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_SNR_Mode1]==1)
		scalerVIP_compute_level_I_006_SNR_Mode1(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode1 for SD SNR
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_SNR_Mode2]==1)
		scalerVIP_compute_level_I_006_SNR_Mode2(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode2 for HD SNR
	//dynamic shp
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_SHP_Mode0]==1)
		scalerVIP_compute_level_I_006_SHP_Mode0(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode0 for NTSC SHP
	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_006_SHP_Mode2]==1)
		scalerVIP_compute_level_I_006_SHP_Mode2(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode2 for HD SNR


//vvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvTV_006_stylevvv

//vvvvvvvvvvvvvvvvvvvvvvv simple mode vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv simple mode vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv simple mode vvv

	if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_Input_Item_Check_Flag[I_SPM_LV_CTRL0]==1)
		scalerVIP_compute_level_I_SPM_LV_CTRL0(vipTable_shareMem, SmartPic_clue, system_info_structure_table); // TV006 mode2 for HD SNR

//vvvvvvvvvvvvvvvvvvvvvvv simple mode vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv simple mode vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv simple mode vvv
//=====================================================================================================================
}
#if 0
void scalerVIP_PQ_Adaptive_offset_temp(unsigned char src, unsigned char index)
{
	if(!PQA_TABLE)
	{
		ROSPrintf("PQ data ERROR, PQA_TABLE is NULL!!\n");
		return;
	}
	unsigned short PQA_ITEM_count;
	unsigned int PQA_row, NR_Table = ((src*PQA_MODE_MAX*PQA_ITEM_MAX*PQA_LEVEL_MAX) + (PQA_MODE_OFFSET*PQA_ITEM_MAX*PQA_LEVEL_MAX));

	unsigned int PQA_Reg;
	unsigned char PQA_Bitup, PQA_Bitlow, PQA_Input_type;

	for(PQA_ITEM_count = 0; PQA_ITEM_count < PQA_ITEM_MAX; PQA_ITEM_count++)
	{
		//=======================================================================
		PQA_row = NR_Table + (PQA_ITEM_count*PQA_LEVEL_MAX);


		//=======================================================================
		PQA_Reg = *(PQA_TABLE+PQA_row+PQA_reg);
		PQA_Bitup = *(PQA_TABLE+PQA_row+PQA_bitup);
		PQA_Bitlow = *(PQA_TABLE+PQA_row+PQA_bitlow);
		PQA_Input_type = *(PQA_TABLE+PQA_row+PQA_input_type);

		//=======================================================================
		if(PQA_Reg == 0xffffffff || PQA_ITEM_count >= PQA_ITEM_MAX)						//Data Finish
			break;

		if(index == PQA_Input_type)
		{
			PQA_TABLE_OFFSET_TEMP[PQA_ITEM_count] = (rtd_inl(PQA_Reg) >> PQA_Bitlow) & andMASK_Table2[(PQA_Bitup-PQA_Bitlow+1)];	//data
		}

	}
}
#endif
void scalerVIP_PQ_Adaptive_Table(unsigned char mode, SLR_VIP_TABLE* vipTable_shareMem, _clues* SmartPic_clue, _system_setting_info* system_info_structure_table)
{
	unsigned short PQA_ITEM_count, PQA_ITEM_count_offset;
	unsigned int PQA_row, PQA_row_offset;

	unsigned int PQA_Reg, PQA_Reg_offset, and_reg, offset_value;
	unsigned char PQA_Bitup, PQA_Bitup_offset, PQA_Bitlow, PQA_Bitlow_offset, PQA_Input_type, PQA_Input_type_offset, PQA_Input_item, PQA_Input_item_offset;
	unsigned int Level_low, Level_high, value = 0;

	unsigned int *g_PQA_Table = &(vipTable_shareMem->PQA_Table[0][0][0][0]);
	unsigned short *PQA_Input_Level = &(SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0]);
	unsigned short *PQA_Input_rate = &(SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0]);
	unsigned int *PQA_TABLE_OFFSET_TEMP = &(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.OFFSET_TEMP[0]);

	unsigned char PQA_table_select = system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.PQA_table_select;
	unsigned int NR_Table = ((PQA_table_select*PQA_MODE_MAX*PQA_ITEM_MAX*PQA_LEVEL_MAX) + (mode*PQA_ITEM_MAX*PQA_LEVEL_MAX));

	unsigned char i=0;
	unsigned char idx_tmp=0;

	if(g_PQA_Table == NULL ||
		PQA_TABLE_OFFSET_TEMP == NULL ||
		PQA_Input_Level == NULL ||
		PQA_Input_rate == NULL)
	{
		if(MA_print_count%360==0)
			ROSPrintf("PQ data ERROR, PQA_TABLE is NULL!!\n");
		return;
	}

	// tool ctrl for input item and input type
	scalerVIP_PQA_level_Ctrl(vipTable_shareMem,  SmartPic_clue,  system_info_structure_table);

	// sort tmp ini
	for(i=0;i<PQA_ITEM_MAX;i++)
		PQA_Sort_Tmp[0][i] = 0xffffffff;

	for(PQA_ITEM_count = 0; PQA_ITEM_count < PQA_ITEM_MAX; PQA_ITEM_count++)
	{
		//=======================================================================
		PQA_row = NR_Table + (PQA_ITEM_count*PQA_LEVEL_MAX);

		//=======================================================================
		PQA_Reg = *(g_PQA_Table+PQA_row+PQA_reg);
		PQA_Bitup = *(g_PQA_Table+PQA_row+PQA_bitup);
		PQA_Bitlow = *(g_PQA_Table+PQA_row+PQA_bitlow);
		PQA_Input_type = *(g_PQA_Table+PQA_row+PQA_input_type);
		PQA_Input_item = *(g_PQA_Table+PQA_row+PQA_input_item);

		if(PQA_Bitup>31 || PQA_Bitup<0 || PQA_Bitlow>31 || PQA_Bitlow<0 || PQA_Bitlow>PQA_Bitup ){
			if(MA_print_count%360==0)
				ROSPrintf("PQ data ERROR, PQA_Bitup = %d,	PQA_Bitlow = %d\n",PQA_Bitup,PQA_Bitlow);
			return;
		}

		//=======================================================================
		if(PQA_Reg == 0xffffffff || PQA_ITEM_count >= PQA_ITEM_MAX)						//Data Finish
			break;

//		if(PQA_RUN[PQA_Input_type] == 0)														//continue this data
		if(system_info_structure_table->PQ_Setting_Info.PQA_Setting_INFO.Run_Flag[PQA_Input_type] == 0 || !scalerVIP_CheckRegisterAccessProtect(PQA_Reg))														//continue this data
			continue;

		//=======================================================================

		//=======================================================================
		for(i=0;i<PQA_ITEM_MAX;i++)
		{
			if(PQA_Reg == PQA_Sort_Tmp [0][i])
			{
				idx_tmp = i;
				break;
			}
			else if(PQA_Sort_Tmp [0][i] == 0xffffffff && ( PQA_Reg >= 0xb8000000 && PQA_Reg <= 0xb8ffffff ))
			{
				PQA_Sort_Tmp[0][i]=PQA_Reg ;
                if(( PQA_Sort_Tmp[0][i] >= 0xb8019000 ) && ( PQA_Sort_Tmp[0][i] <= 0xb8019ffc) )
                {
                    PQA_Sort_Tmp[1][i]=VDPQ_rtd_inl(PQA_Reg) ;
                }
                else
                {
				PQA_Sort_Tmp[1][i]=rtd_inl(PQA_Reg) ;
                }
				idx_tmp = i;
				break;
			}
		}

		//=======================================================================

		// set rtnrC running flag for scalerVideo.c "void LG_XCRemove_by_RTNR_C(unsigned char format, unsigned char MA_motion)", elieli
		scalerVIP_PQA_TBL_ContentCheck(PQA_Reg, &(SmartPic_clue->PQA_ISR_Cal_Info.ContentCheck_Flag[0]));

		if(PQA_Input_Level[PQA_Input_item] < 9)
		{
			Level_low = *(g_PQA_Table+PQA_row+PQA_L00+PQA_Input_Level[PQA_Input_item]);
			Level_high = *(g_PQA_Table+PQA_row+PQA_L00+PQA_Input_Level[PQA_Input_item]+1);
			value = (((Level_high - Level_low)*PQA_Input_rate[PQA_Input_item])>>8) + Level_low;
		}
		else
			value = *(g_PQA_Table+PQA_row+PQA_L09);

		if(mode == PQA_MODE_WRITE)		//WRITE + OFFSET
		{
			for(PQA_ITEM_count_offset = 0; PQA_ITEM_count_offset < PQA_ITEM_MAX; PQA_ITEM_count_offset++)
			{
				//=======================================================================
				PQA_row_offset = ((PQA_table_select*PQA_MODE_MAX*PQA_ITEM_MAX*PQA_LEVEL_MAX) + (PQA_MODE_OFFSET*PQA_ITEM_MAX*PQA_LEVEL_MAX)) + (PQA_ITEM_count_offset*PQA_LEVEL_MAX);

				//=======================================================================
				PQA_Reg_offset = *(g_PQA_Table+PQA_row_offset+PQA_reg);
				PQA_Bitup_offset = *(g_PQA_Table+PQA_row_offset+PQA_bitup);
				PQA_Bitlow_offset = *(g_PQA_Table+PQA_row_offset+PQA_bitlow);
				PQA_Input_type_offset = *(g_PQA_Table+PQA_row_offset+PQA_input_type);
				PQA_Input_item_offset = *(g_PQA_Table+PQA_row_offset+PQA_input_item);
				//=======================================================================
				if(PQA_Reg_offset == 0xffffffff || PQA_ITEM_count_offset >= PQA_ITEM_MAX)						//Data Finish
					break;

				if((PQA_Reg == PQA_Reg_offset)&&(PQA_Bitup == PQA_Bitup_offset)&&(PQA_Bitlow == PQA_Bitlow_offset)&&(PQA_Input_type==PQA_Input_type_offset))
				{
					PQA_TABLE_OFFSET_TEMP[PQA_ITEM_count_offset] = value;
					break;
				}
			}
		}

		if(mode == PQA_MODE_OFFSET)															//offset function
		{
			value = (value + PQA_TABLE_OFFSET_TEMP[PQA_ITEM_count]);
			if(value >  andMASK_Table2[31])								//if sub < 0
				value = 0;
			else if(value >  andMASK_Table2[(PQA_Bitup-PQA_Bitlow+1)])		//if > bit num
				value = andMASK_Table2[(PQA_Bitup-PQA_Bitlow+1)];
		}

		if(value > (1<<(PQA_Bitup-PQA_Bitlow)))												//max value
			value = value & andMASK_Table2[(PQA_Bitup-PQA_Bitlow+1)];

		//=======================================================================
		offset_value = value<<PQA_Bitlow;													//Read Level
		and_reg = ((andMASK_Table1[(PQA_Bitup-PQA_Bitlow)]<<PQA_Bitlow)+andMASK_Table2[PQA_Bitlow]);

		//=======================================================================

		// write to tmp buffer
		PQA_Sort_Tmp[1][idx_tmp] = ((PQA_Sort_Tmp[1][idx_tmp] & (and_reg)) | (offset_value));

		//rtdf_maskl(PQA_Reg, and_reg, offset_value);								//Write Data
		//if (scalerVIP_CheckRegisterAccessProtect(PQA_Reg))
			//rtd_outl(PQA_Reg, ((rtd_inl(PQA_Reg) & (and_reg)) | (offset_value)));

	}

	for(i=0;i<PQA_ITEM_MAX;i++)
	{
		if(PQA_Sort_Tmp[0][i]==0xffffffff)
			break;
		if( ( PQA_Sort_Tmp[0][i] >= 0xb8019000 ) && ( PQA_Sort_Tmp[0][i] <= 0xb8019ffc ) ) { /*AVD flag change and protection*/
			VDPQ_rtd_outl(PQA_Sort_Tmp[0][i], PQA_Sort_Tmp[1][i]);
		} else {
			rtd_outl(PQA_Sort_Tmp[0][i], PQA_Sort_Tmp[1][i]);
		}
	}
}

void scalerVIP_Reset_PQA_TBL_ContentCheck_Flag(unsigned char* ContentCheck_Flag)
{
	unsigned char i;
	for(i=0;i<PQA_CC_MAX;i++)
		ContentCheck_Flag[i] = 0;
}

void scalerVIP_PQA_TBL_ContentCheck(unsigned int PQA_Reg, unsigned char* ContentCheck_Flag)
{
	switch (PQA_Reg)
	{
		case DI_IM_DI_RTNR_C_TH0_TH3_reg:
			ContentCheck_Flag[PQA_CC_RTNR_C_TH]=1;
			break;
		case DI_IM_DI_RTNR_C_TH4_TH6_reg:
			ContentCheck_Flag[PQA_CC_RTNR_C_TH]=1;
			break;
		case DI_IM_DI_RTNR_C_K_reg:
			ContentCheck_Flag[PQA_CC_RTNR_C_K]=1;
			break;
		default:
			break;
	}
}


#if 0
void scalerVIP_RTNR_set_sharpness(int level, int SC)
{

		static unsigned char level_out;
		_clues *SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();

		if(SmartPic_clue == NULL)
		{
			if(MA_print_count%360==0)
				ROSPrintf("==SmartPic_clue 0,scalerVIP_RTNR_set_sharpness=\n");
			return;
		}
		unsigned short *PQA_Input_Level = &SmartPic_clue->PQA_ISR_Cal_Info.Input_Level[0];
		unsigned short *PQA_Input_rate = &SmartPic_clue->PQA_ISR_Cal_Info.Input_rate[0];

		if(MA_print_count%frame_print==0&&SST_debug)
		{
		ROSPrintf("Set Mpeg sharpness input level= %d \n",level);


		}

		level=level>9?9:level;
		level=level<0?0:level;
		level*=100;

		if(SC)// scene change
		{

			level_out = level;

		}
	else
		{
			level_out = ((level_out*(16-blend_ratio) + level*blend_ratio))/(16);

		}
		level_out/=100;
		PQA_Input_Level[I_MPEG_SHARP] = level_out;
		PQA_Input_rate[I_MPEG_SHARP] =0;

			//write table to register
	if(MA_print_count%frame_print==0&&SST_debug)
		{
		ROSPrintf("Set Mpeg sharpness level= %d \n",level_out);


		}


}
#endif


#if 0
#define table_num 10
#define table_elemt 10
#define blend_ratio 4
#define frame_print 60
#define SST_debug 0
static unsigned short Set_sharp_table[table_num][table_elemt]= //this is offset table
{
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},
	{	0,	0,	0,	0,	0,	0,	0,	0,	0,	0},

};
unsigned short Set_sharp_table_pre[table_elemt]={0,0,0,0,0,0,0,0,0,0};
//unsigned short Set_sharp_table_cur[table_elemt]={0,0,0,0,0,0,0,0,0,0};
unsigned short arry_from_osd[table_elemt]={0,0,0,0,0,0,0,0,0,0};

void scalerVIP_RTNR_set_sharpness(int level, int SC)
{
	int i;


	color_sharp_dm_peaking_gain_RBUS dm_peaking_gain_reg;
	dm_peaking_bound_RBUS dm_peaking_bound_reg;
	color_sharp_dm_segpk_edgpk3_RBUS dm_segpk_edgpk3_reg;
	color_sharp_dm_segpk_edgpk4_RBUS dm_segpk_edgpk4_reg;

	PQA_Input_Level[I_MPEG_SHARP] = RTNR_level_SdHd;
	PQA_Input_rate[I_MPEG_SHARP] =0;
	// prepare delta table , blending....
	if(SC)// scene change
		{
		for(i=0;i<table_elemt;i++)
			{

			Set_sharp_table_pre[i] = Set_sharp_table[level][i];

			}

		}
	else
		{

		for(i=0;i<table_elemt;i++)
			{

			Set_sharp_table_pre[i] = ((Set_sharp_table_pre[i]*blend_ratio + Set_sharp_table[level][i]*100))/(blend_ratio+1);
			//Set_sharp_table_pre[i] = Set_sharp_table_pre[i] <0?0:Set_sharp_table_pre[i];

			}
		}


	//write table to register
	if(MA_print_count%frame_print==0&&SST_debug)
	ROSPrintf("Set sharpness ");

	for(i=0;i<table_elemt;i++)
		{
		int write = (Set_sharp_table_pre[i]+50) /100;// rounding...

		if(MA_print_count%frame_print==0&&SST_debug)
		ROSPrintf(" %d",write);
		}



	if(MA_print_count%frame_print==0&&SST_debug)
	ROSPrintf("\n ");


	//map table
	int apply;

	apply=arry_from_osd[0]-(Set_sharp_table_pre[0]+50) /100;// tex gain pos
	apply=apply<0?0:apply;
	dm_peaking_gain_reg.gain_pos=apply;

	apply=arry_from_osd[1]-(Set_sharp_table_pre[1]+50) /100;// tex gain neg
	apply=apply<0?0:apply;
	dm_peaking_gain_reg.gain_neg=apply;

	apply=arry_from_osd[2]-(Set_sharp_table_pre[2]+50) /100;// tex hv pos
	apply=apply<0?0:apply;
	dm_peaking_bound_reg.hv_pos=apply;

	apply=arry_from_osd[3]-(Set_sharp_table_pre[3]+50) /100;// tex hv neg
	apply=apply<0?0:apply;
	dm_peaking_bound_reg.hv_neg=apply;

	apply=arry_from_osd[4]+(Set_sharp_table_pre[4]+50) /100;// LV use add
	apply=apply>255?255:apply;
	dm_peaking_bound_reg.lv=apply;

	apply=arry_from_osd[5]-(Set_sharp_table_pre[5]+50) /100;// edg gain pos
	apply=apply<0?0:apply;
	dm_segpk_edgpk3_reg.gain_pos=apply;

	apply=arry_from_osd[6]-(Set_sharp_table_pre[6]+50) /100;// edg gain neg
	apply=apply<0?0:apply;
	dm_segpk_edgpk3_reg.gain_neg=apply;

	apply=arry_from_osd[7]-(Set_sharp_table_pre[7]+50) /100;// edg hv pos
	apply=apply<0?0:apply;
	dm_segpk_edgpk4_reg.hv_pos=apply;

	apply=arry_from_osd[8]-(Set_sharp_table_pre[8]+50) /100;// edg hv neg
	apply=apply<0?0:apply;
	dm_segpk_edgpk4_reg.hv_neg=apply;

	apply=arry_from_osd[9]+(Set_sharp_table_pre[9]+50) /100; // LV use add
	apply=apply>255?255:apply;
	dm_segpk_edgpk4_reg.lv=apply;

	//

	rtd_outl(COLOR_SHARP_DM_PEAKING_GAIN_reg, dm_peaking_gain_reg.regValue);
	rtd_outl(COLOR_SHARP_DM_PEAKING_BOUND_reg, dm_peaking_bound_reg.regValue);
	rtd_outl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg, dm_segpk_edgpk3_reg.regValue);
	rtd_outl(COLOR_SHARP_DM_SEGPK_EDGPK4_reg, dm_segpk_edgpk4_reg.regValue);


}
#endif

// Sirius new function: Histogram section for high precision
/****** NOTE: Data is not valid until next frame sync!!! ******/
void scalerVIP_Histogram_Section( unsigned char select1, unsigned char select2 )
{
	histogram_ich1_c0_sectionhist_in_cselect_RBUS histogram_ich1_c0_sectionhist_in_cselect_RBUS_reg;

	histogram_ich1_c0_sectionhist_in_cselect_RBUS_reg.regValue = rtd_inl(HISTOGRAM_ICH1_C0_SectionHist_IN_CSELECT_reg);

	histogram_ich1_c0_sectionhist_in_cselect_RBUS_reg.ch1_c0_section0_bin_sel = select1;
	histogram_ich1_c0_sectionhist_in_cselect_RBUS_reg.ch1_c0_section1_bin_sel = select2;

	rtd_outl(HISTOGRAM_ICH1_C0_SectionHist_IN_CSELECT_reg, histogram_ich1_c0_sectionhist_in_cselect_RBUS_reg.regValue);
}

SLR_VIP_TABLE* scaler_GetShare_Memory_VIP_TABLE_Struct(void)
{
	if(g_Share_Memory_VIP_TABLE_Struct_isr==NULL)
	{
		if(MA_print_count%360==0)
		{
			ROSPrintf("g_Share_Memory_VIP_TABLE_Struct_isr NULL \n");
		}
		return NULL;
	}
	return g_Share_Memory_VIP_TABLE_Struct_isr;
}

_clues* scaler_GetShare_Memory_SmartPic_Clue_Struct(void)
{
	if(SmartPic_clue==NULL)
	{
		if(MA_print_count%360==0)
		{
			ROSPrintf("Share_Memory_SmartPic_clue_Struct NULL \n");
		}
		return NULL;
	}
	return SmartPic_clue;
}

_RPC_clues* scaler_GetShare_Memory_RPC_SmartPic_Clue_Struct(void)
{
	if(RPC_SmartPic_clue==NULL)
	{
		if(MA_print_count%360==0)
		{
			ROSPrintf("Share_Memory_SmartPic_clue_Struct NULL \n");
		}
		return NULL;
	}
	return RPC_SmartPic_clue;
}


_system_setting_info* scaler_GetShare_Memory_system_setting_info_Struct(void)
{
	if(system_info_structure_table==NULL)
	{
		if(MA_print_count%360 == 0)
		{
		//	ROSPrintf("system_info_structure_table NULL \n");
		}
		return NULL;
	}
	return system_info_structure_table;
}

_RPC_system_setting_info* scaler_GetShare_Memory_RPC_system_setting_info_Struct(void)
{
	if(RPC_system_info_structure_table==NULL)
	{
		if(MA_print_count%360 == 0)
		{
		//	ROSPrintf("system_info_structure_table NULL \n");
		}
		return NULL;
	}
	return RPC_system_info_structure_table;
}



/*******************************************************************************
* Program : RPC interface from AP
******************************************************************************/
//------------------------------------------------
// csfanchiang add for AT 20101005, get & set info from/to user space
//------------------------------------------------

void scalerVIP_Share_Memory_Access_NR_Init()
{

}
void scalerVIP_Share_Memory_Access_Sharpness_Init()
{

}

void vip_suspend(void)
{
	unsigned char ucAutoMA = 0;
	//ROSPrintf("[vip] suspend\n");

#ifdef VCPU_INTERRUPT
	scalerIRQ_setAutoMAFlag((unsigned long)&ucAutoMA);
#endif

}

int DC_off_on_flg = 0;
void vip_resume(void)
{
	ini_ReadSrcDet=0;

	DC_off_on_flg = 1;  // game mode DC off/on init
	return;
}

#ifdef VCPU_INTERRUPT
ROSPM_DEVICE vip_device =
{
    .name = "VIP",
    .instance = NULL,
    .suspend = vip_suspend,
    .resume = vip_resume,
};
#endif

//======== check sum========
#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
void scalerVIP_Share_Memory_Access_VIP_TABLE_CRC_Struct(unsigned long arg)
{
	vip_table_crc = ((VIP_table_crc_value *)arg);
}

void scalerVIP_Share_Memory_Access_VIP_TABLE_Struct(unsigned long arg)
{
	g_Share_Memory_VIP_TABLE_Struct= ((SLR_VIP_TABLE *)arg);

	scalerVIP_Share_Memory_Access_NR_Init();
	scalerVIP_Share_Memory_Access_Sharpness_Init();

	ROSPM_AddDevice(&vip_device);

}
#endif

void fwif_color_PrintArray_UINT32(unsigned int * pwTemp ,int nSize,int nID)
{
	int i;
	if (pwTemp) {
		for (i = 0; i < (nSize); i++)
			ROSPrintf("Share_Memory_Video_VIP_TABLE, Array ID%d [%d]=%d\n ",nID,i,pwTemp[i]);
	}
}
void fwif_color_PrintArray_INT32(int * pwTemp ,int nSize,int nID)
{
	int i;
	if (pwTemp) {
	for (i = 0; i < (nSize); i++)
		ROSPrintf("Share_Memory_Video_VIP_TABLE, Array ID%d [%d]=%d\n ",nID,i,pwTemp[i]);
	}
}
void fwif_color_PrintArray_UINT16(unsigned short * pwTemp ,int nSize,int nID)
{
	int i;
	if (pwTemp) {
	for (i = 0; i < (nSize); i++)
		ROSPrintf("Share_Memory_Video_VIP_TABLE, Array ID%d [%d]=%x\n ",nID,i,pwTemp[i]);
	}
}

void fwif_color_PrintArray_INT16(short * pwTemp ,int nSize,int nID)
{
	int i;
	if (pwTemp) {
	for (i = 0; i < (nSize); i++)
		ROSPrintf("Share_Memory_Video_VIP_TABLE, Array ID%d [%d]=%d\n ",nID,i,pwTemp[i]);
	}
}
void fwif_color_PrintArray_UINT8(unsigned char * pwTemp ,int nSize,int nID)
{
	int i;
	if (pwTemp) {
	for (i = 0; i < (nSize); i++)
		ROSPrintf("Share_Memory_Video_VIP_TABLE, Array ID%d [%d]=%d\n ",nID,i,pwTemp[i]);
	}
}

void scalerVIP_Share_Memory_Access_VIP_TABLE_Custom_Struct(unsigned long arg)
{
	g_Share_Memory_VIP_TABLE_Custom_Struct_isr= ((SLR_VIP_TABLE_CUSTOM_TV001 *)arg);
	//ROSPrintf("==  scalerVIP_Share_Memory_Access_VIP_TABLE_Custom_Struct==\n ");
}

void* scalerVIP_Get_Share_Memory_VIP_TABLE_Custom_Struct(void)
{
	if(system_info_structure_table==NULL)
	{
		if(MA_print_count%360 == 0)
		{
			ROSPrintf("VIP_TABLE_Custom_Struct NULL \n");
		}
		return NULL;
	}

	return (void*)g_Share_Memory_VIP_TABLE_Custom_Struct_isr;
}

void scalerVIP_GetNrAvgcount(unsigned long arg)
{

	//ROSPrintf("enter scalerVIP_GetNrAvgcount\n");
	*(unsigned char*)arg = VD_noise_status_Num;
}

void scalerVIP_SetNrAvgcount(unsigned long arg)
{

	//ROSPrintf("enter scalerVIP_SetNrAvgcount\n");
	VD_noise_status_Num = *(unsigned char*)arg;
}

void scalerVIP_Set_TV_05_style_ON(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_Set_TV_05_style_ON = %d\n", arg);
	TV_05_style_ON = *(unsigned char*)arg;
}

void scalerVIP_Set_AUTO_NR_style(unsigned long arg)
{
	//ROSPrintf("enter SCALERIOC_SET_NR_style = %d\n", arg);
	//AUTO_NR_style = *(unsigned char*)arg;
	AUTO_NR_style = (unsigned char)arg;
}

void scalerVIP_Get_AUTO_NR_style(unsigned long arg)
{
	*(unsigned char*)arg = AUTO_NR_style;
}

void scalerVIP_Set_DccScurveLevel(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_Set_DccScurveLevel = %d\n", arg);
	DccScurveLevel = *(unsigned char*)arg;
}

void scalerVIP_GetTVAutoNR_Mode(unsigned long arg)
{

	//ROSPrintf("enter scalerVIP_GetTVAutoNR_Mode\n");
	*(unsigned char*)arg = TVAutoNR_Mode;
}

void scalerVIP_SetTVAutoNR_Mode(unsigned long arg)
{

	//ROSPrintf("enter scalerVIP_SetTVAutoNR_Mode\n");
	TVAutoNR_Mode = *(unsigned char*)arg;
}



void scalerVIP_SET_DNR_LEVEL_TABLE(unsigned long arg)
{

	//ROSPrintf("enter scalerVIP_SET_DNR_LEVEL_TABLE\n");
	DNR_LEVEL_TABLE= (unsigned char *)arg;

}

// Hawaii add for new AutoView 20131001
void scalerVIP_SET_AutoView_flag(unsigned long arg)
{

	ROSPrintf("enter scalerVIP_SET_DCC_Hist_table\n");
	AutoView_flag= (unsigned char)arg;

	//Main_Set_SC=1;//SceneChange

	ROSPrintf("AutoView_flag =%d \n",AutoView_flag);
}

void scalerVIP_COEFF_BY_Y_REG(unsigned long arg)
{
	COEFF_BY_Y_REG = (unsigned int*)arg;
}

void scalerVIP_NR_TABLE32(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_NR_TABLE32\n");
	NR_TABLE32 = (unsigned int*)arg;
}

void scalerVIP_NR_TABLE8(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_NR_TABLE8\n");
	NR_TABLE8 = (unsigned char*)arg;
}

// move to share memory access struct, elieli
/*
void scalerVIP_PQA_TABLE_OFFSET_TEMP(unsigned long arg)
{
	//ROSPrintf("enter PQA_TABLE_OFFSET_TEMP\n");
	PQA_TABLE_OFFSET_TEMP = (unsigned int*)arg;
}
*/

// Hawaii add for Edge Peaking 20131022
void scalerVIP_Edge_Peaking_Table(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_NR_TABLE8\n");
	Edge_Peaking_Table = (unsigned short*)arg;
}



void scalerVIP_PWM_TABLE(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_NR_TABLE8\n");
	PWM_table_tv057 = (unsigned char*)arg;
}

// Hawaii add for Edge Peaking 20131022
void scalerVIP_Mem_Edge_AutoPk_data(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Mem_Edge_AutoPk_data\n");
	Edge_AutoPk_data = (unsigned short*)arg;
}

void scalerVIP_SET_INTELLIGENT_PICTURE_2D_PEAKING_TABLE(unsigned long arg)
{
	intelligent_picture_table = (unsigned short*)arg;
	Sharpness_OSD_update = _TRUE;
}

void scalerVIP_GET_VD_NOISE_LEVEL(unsigned long arg)
{
	*(unsigned char*)arg = VD_noise_level;
}

void scalerVIP_SetTable_HMCNR(unsigned char arg) //planck 20100810
{
	 TableNR_HMCNR=(unsigned char)arg;
}

void scalerVIP_SetTable_VerticalNR(unsigned char arg) //planck 20100810
{
	 TableNR_VerticalNR=(unsigned char)arg;
}

void scalerVIP_GetDNR_log(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetDNR_log\n");

	*(unsigned char*)arg = DNR_log;
}

void scalerVIP_SetDNR_log(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SETDNR_log\n");

	DNR_log = *(unsigned char*)arg;
}

void scalerVIP_GetRTNR_log(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetRTNR_log\n");

	*(unsigned char*)arg = RTNR_log;
}

void scalerVIP_SetRTNR_log(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SETRTNR_log\n");

	RTNR_log = *(unsigned char*)arg;
}

void scalerVIP_GetSNR_log(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetSNR_log\n");

	*(unsigned char*)arg = SNR_log;
}

void scalerVIP_SetSNR_log(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SETSNR_log\n");

	SNR_log = *(unsigned char*)arg;
}

void scalerVIP_GetINR_log(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetINR_log\n");

	*(unsigned char*)arg = INR_log;
}

void scalerVIP_SetINR_log(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SETINR_log\n");

	INR_log = *(unsigned char*)arg;
}

void scalerVIP_Get_DEBUG_AUTO_NR(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetINR_log\n");

	*(unsigned char*)arg = DEBUG_AUTO_NR;
}

void scalerVIP_Set_DEBUG_AUTO_NR(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SETINR_log\n");

	DEBUG_AUTO_NR = *(unsigned char*)arg;
}
void scalerVIP_Get_DEBUG_VD_NOISE(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetINR_log\n");

	*(unsigned char*)arg = DEBUG_VD_NOISE;
}

void scalerVIP_Set_DEBUG_VD_NOISE(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SETINR_log\n");

	DEBUG_VD_NOISE = *(unsigned char*)arg;
}
void scalerVIP_Get_DEBUG_RTNR_MAD(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetINR_log\n");

	*(unsigned char*)arg = DEBUG_RTNR_MAD;
}

void scalerVIP_Set_DEBUG_RTNR_MAD(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SETINR_log\n");

	DEBUG_RTNR_MAD = *(unsigned char*)arg;
}
void scalerVIP_Get_DEBUG_HISTOGRAM_MEAN(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetINR_log\n");

	*(unsigned char*)arg = DEBUG_HISTOGRAM_MEAN;
}

void scalerVIP_Set_DEBUG_HISTOGRAM_MEAN(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SETINR_log\n");

	DEBUG_HISTOGRAM_MEAN = *(unsigned char*)arg;
}

// move "DNR table select info" to system_info_struct and replace by PQA table, elieli
/*
void scalerVIP_Get_DNRTABLE(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GET_DNRTABLE\n");

	*(unsigned char*)arg = DNR_TABLE_SECET;
}
void scalerVIP_Set_DNRTABLE(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SET_DNRTABLE\n");

	DNR_TABLE_SECET = *(unsigned char*)arg;
}
*/



//Elsie 20130820: RTNR K-force, 20130930 sync from Magellan
void scalerVIP_Set_RTNR_K_force(unsigned long arg)
{
	// The least 3 significant bits are offset, the others are level.
	RTNR_K_force_level = (unsigned char)arg>>3;
	RTNR_K_force_offset = (unsigned char)arg & 0x7;
}

//20130521 added by Hawaii for Dynamic Peaking Display
void scalerVIP_Get_DCC_Histogram_Mean_value(unsigned long arg)
{	unsigned char DCC_Histogram_Mean_value_protected;
	//scalerDrvPrint("enter scalerVIP_Get_DCC_Histogram_Mean_value\n");
	// protect due to  Dynamic Peaking Display just need value 0 to 255
	if((SmartPic_clue->Hist_Y_Mean_Value)>=255)
		DCC_Histogram_Mean_value_protected = 255;
	else if((SmartPic_clue->Hist_Y_Mean_Value)<=0)
		DCC_Histogram_Mean_value_protected = 0;
	else
		DCC_Histogram_Mean_value_protected = (SmartPic_clue->Hist_Y_Mean_Value);

	*(unsigned char*)arg = DCC_Histogram_Mean_value_protected;
	//ROSPrintf("===== [ScalerVIP.c] ===== Histogram_Mean_value = %d \n",DCC_Histogram_Mean_value_protected);
}

void scalerVIP_Get_RTNR_MAD_count_Y_sum_avg(unsigned long arg)
{
	unsigned char RTNR_MAD_count_Y_sum_avg_protected;
	//scalerDrvPrint("enter scalerVIP_Get_RTNR_MAD_count_Y_sum_avg\n");
	// protect due to  Dynamic Peaking Display just need value 0 to 255
	if(RTNR_MAD_count_Y_sum_avg>=255)
		RTNR_MAD_count_Y_sum_avg_protected = 255;
	else if(RTNR_MAD_count_Y_sum_avg<=0)
		RTNR_MAD_count_Y_sum_avg_protected = 0;
	else
		RTNR_MAD_count_Y_sum_avg_protected = RTNR_MAD_count_Y_sum_avg;

	*(unsigned char*)arg = RTNR_MAD_count_Y_sum_avg_protected;

	//ROSPrintf("===== [ScalerVIP.c] ===== RTNR_MAD_count_Y_sum_avg = %d \n",RTNR_MAD_count_Y_sum_avg_protected);
}


void scalerVIP_SetMpegNR(unsigned long arg)
{
	scalerVip_mpegNR= (SCALERVIP_MPEGNR)arg;

}

void scalerVIP_GetMpegNR(unsigned long arg)
{
	*(SCALERVIP_MPEGNR*)arg = scalerVip_mpegNR;
}

void scalerVIP_SetTableSNR_Y(unsigned char arg)
{
	 TableNR_SNR_Y=(unsigned char)arg;
}

void scalerVIP_SetTableSNR_C(unsigned char arg)
{
	 TableNR_SNR_C=(unsigned char)arg;
}

void scalerVIP_SetTableNRTemporal(unsigned char arg) //planck 20100810
{
	 TableNRTemporal=(unsigned char)arg;
}

void scalerVIP_SetTableRTNR_Y(unsigned char arg) //planck 20100810
{
	 TableNR_RTNR_Y=(unsigned char)arg;
}

void scalerVIP_SetTableRTNR_C(unsigned char arg) //planck 20100810
{
	 TableNR_RTNR_C=(unsigned char)arg;
}

void scalerVIP_SetMpegNR_H(unsigned long arg)
{
	 TableNR_MPEGNR_H=(unsigned char)arg;
}

void scalerVIP_SetMpegNR_V(unsigned long arg)
{
	 TableNR_MPEGNR_V=(unsigned char)arg;
}

void scalerVIP_SetCorrectionBIT1_Duty_Debug(unsigned long arg)
{
	correctionBit1_duty_debug = arg;
}

void scalerVIP_SetTableUnShpMask(unsigned char arg) //planck 20100810
{
	 VIP_FACTORY_UnShpMask=(unsigned char)arg;

}

void scalerVIP_SetTableSCALEPK(unsigned char arg) //planck 20100810
{
	 VIP_FACTORY_SCALEPK=(unsigned char)arg;

}

void scalerVIP_SetTableSHP1D2D_EGSM(unsigned char arg) //planck 20100810
{
	 VIP_FACTORY_SHP1D2D_EGSM=(unsigned char)arg;

}


void scalerVIP_getAutoMADebugMsg(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_getAutoMADebugMsg\n");
	*(unsigned char*)arg = AutoMADebugMsg;
}


void scalerVIP_setAutoMADebugMsg(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_setAutoMADebugMsg\n");

	AutoMADebugMsg = *(unsigned char*)arg;
}


unsigned char drvif_module_vdc_NoiseStatus_isr(void)
{
	return (unsigned char)VDPQ_rtd_inl(VDTOP_NOISE_STATUS_reg);
}

void scalerVIP_SetTableDCTI(unsigned char arg) //Leo Chen 20101217
{
	 TableDCTI=(unsigned char)arg;
	  //ROSPrintf("ooo---scalerVIP_SetTableDCTI=%x ---ooo\n",TableDCTI);
}

void scalerVIP_SetICM_Global_Sat(unsigned short arg) //Leo Chen 20101217
{
	 scalerVip_ICM_Global_Sat=(unsigned short)arg;
	 ROSPrintf("ooo---scalerVIP_SetICM_Global_Sat=%x ---ooo\n",scalerVip_ICM_Global_Sat);
}

void scalerVIP_SetScaler_FIR_H(unsigned char arg) //Leo Chen 20101217
{
	 scalerVip_Scaler_FIR_H=(unsigned char)arg;
	 ROSPrintf("ooo---scalerVIP_SetScaler_FIR_H=%x ---ooo\n",scalerVip_Scaler_FIR_H);
}

void scalerVIP_SetScaler_FIR_V(unsigned char arg) //Leo Chen 20101217
{
	 scalerVip_Scaler_FIR_V=(unsigned char)arg;
	 ROSPrintf("ooo---scalerVIP_SetScaler_FIR_V=%x ---ooo\n",scalerVip_Scaler_FIR_V);
}

void scalerVIP_SetScaler_FIR_H_8tap(unsigned char arg) //20140327 roger
{
	 scalerVip_Scaler_FIR_H_8tap=(unsigned char)arg;
	 ROSPrintf("ooo---scalerVIP_SetScaler_FIR_H_8tap=%x ---ooo\n",scalerVip_Scaler_FIR_H_8tap);
}

void scalerVIP_SetScaler_FIR_V_6tap(unsigned char arg) //20140327 roger
{
	 scalerVip_Scaler_FIR_V_6tap=(unsigned char)arg;
	 ROSPrintf("ooo---scalerVIP_SetScaler_FIR_V_6tap=%x ---ooo\n",scalerVip_Scaler_FIR_V_6tap);
}


void scalerVIP_SetPeaking_POS_RANGE_MAX(unsigned int arg)
{
	 scalerVip_PEAKING_POS_RANGE_MAX=(unsigned int)arg;
	 //following print will cause videl lag in mantis#40711, mark it. If need debug, please unmark local
//	 ROSPrintf("ooo---scalerVip_PEAKING_POS_RANGE_MAX=%x ---ooo\n",scalerVip_PEAKING_POS_RANGE_MAX);
}


void scalerVIP_SetPeaking_NEG_RANGE_MAX(unsigned int arg)
{
	 scalerVip_PEAKING_NEG_RANGE_MAX=(unsigned int)arg;
	 //following print will cause videl lag in mantis#40711, mark it. If need debug, please unmark local
//	 ROSPrintf("ooo---scalerVip_PEAKING_NEG_RANGE_MAX=%x ---ooo\n",scalerVip_PEAKING_NEG_RANGE_MAX);
}


void scalerVIP_SetPeaking_Coring(unsigned char arg)
{
	 scalerVip_PEAKING_CORING=(unsigned char)arg;
	 //following print will cause videl lag in mantis#40711, mark it. If need debug, please unmark local
//	 ROSPrintf("ooo---scalerVip_PEAKING_CORING=%x ---ooo\n",scalerVip_PEAKING_CORING);
}


void scalerVIP_SetPeaking_Level(unsigned char arg)
{
	 scalerVip_PEAKING_LEVEL=(unsigned char)arg;
	 //following print will cause videl lag in mantis#40711, mark it. If need debug, please unmark local
//	 ROSPrintf("ooo---scalerVip_PEAKING_LEVEL=%x ---ooo\n",scalerVip_PEAKING_LEVEL);
}


unsigned char scalerVIP_GetBrightness(void)
{
	return scalerVipBrightness;
}

void scalerVIP_SetBrightness(unsigned char brightness)
{
	scalerVipBrightness = brightness;
}

unsigned char scalerVIP_GetContrast(void)
{
	return scalerVipContrast;
}

void scalerVIP_SetContrast(unsigned char contrast)
{
	scalerVipContrast = contrast;
}

/**
 * User space sets value of TableNRSpatial.
 *
 * @param	arg: user space address
 * @return	void
 */
void scalerVIP_setTableNRSpatial(unsigned long arg)
{
	TableNRSpatial = *(unsigned char*)arg;
}

/**
 * User space gets value of TableNRSpatial.
 *
 * @param	arg: user space address
 * @return	void
 */
void scalerVIP_getTableNRSpatial(unsigned long arg)
{
	*(unsigned char*)arg = TableNRSpatial;
}

/**
 * User space sets value of picture mode.
 *
 * @param	arg: user space address
 * @return	void
 */
void scalerVIP_setPictureMode(unsigned long arg)
{

	PictureMode = (unsigned char)arg;
}

void scalerVIP_SetMainTotalPixelInv(unsigned long arg)//Leo Chen 20100810
{
	//Main_total_pixel_inv= (unsigned int)arg;
}

void scalerVIP_GetPinBlAdj(unsigned long arg)//Leo Chen 20101001
{
	m_PIN_BL_ADJ= (unsigned int)arg;
}
void scalerVIP_GetPinBlOnOff(unsigned long arg)//Leo Chen 20101001
{
	m_PIN_BL_ON_OFF= (unsigned int)arg;
}
void scalerVIP_GetBacklightOn(unsigned long arg)//Leo Chen 20101001
{
	m_BACKLIGHT_ON= (unsigned int)arg;
}

void scalerVIP_setDcrTable()
{

#if 1 // only for TV001 DCR

	SLR_VIP_TABLE* Share_Memory_VIP_TABLE_Struct = NULL;
	Share_Memory_VIP_TABLE_Struct = scaler_GetShare_Memory_VIP_TABLE_Struct();

	if((Share_Memory_VIP_TABLE_Struct == NULL)) {
		if(MA_print_count%360==0) {
			ROSPrintf("\n====Share Memory PQ data ERROR====\n\n");
			ROSPrintf(" Mem0 = %x\n",Share_Memory_VIP_TABLE_Struct);
			ROSPrintf("\n===============================\n\n");
		}
		return;
	}

	DCR_TABLE = (unsigned char *)&Share_Memory_VIP_TABLE_Struct->DCR_TABLE[0][0];
#ifdef DCR_debug_en
	if(MA_print_count%250==0){
		printk(KERN_NOTICE "scalerVIP DCR %d	%d	%d	%d	%d\n", DCR_TABLE[0],DCR_TABLE[1],DCR_TABLE[2],DCR_TABLE[3],DCR_TABLE[4] );
		printk(KERN_NOTICE "scalerVIP DCR %d	%d	%d	%d	%d\n", DCR_TABLE[20],DCR_TABLE[21],DCR_TABLE[22],DCR_TABLE[23],DCR_TABLE[24] );
	}
#endif

#else
	m_nTPV_New_DCR=((ISR_SCALERDRV_DCRTABLE*)arg)->nTPV_New_DCR;
	if(m_nTPV_New_DCR) {
		m_bDefault_OFF=((ISR_SCALERDRV_DCRTABLE*)arg)->nDCRDefault;
		ROSPrintf("===  TPV_NEW_DCR m_nTPV_New_DCR = %d	m_bDefault_OFF = %d \n", m_nTPV_New_DCR ,m_bDefault_OFF);
		//m_bDefault_OFF=!m_bDefault_OFF;
		m_bDefault_OFF = (m_bDefault_OFF == 0) ?(1) : (0);
		ROSPrintf("===  TPV_NEW_DCR m_bDefault_OFF = %d \n" ,m_bDefault_OFF);
		DCR_TABLE = (unsigned char *)&g_Share_Memory_VIP_TABLE_Custom_Struct_isr->DCR_TABLE[0][0][0];
		//DCR_TABLE = (unsigned char *)(&((ISR_SCALERDRV_DCRTABLE*)arg)->DCR_Table[0][0][0]);
		ROSPrintf("scalerVIP TPV_NEW_DCR %d	%d	%d	%d	%d\n", DCR_TABLE[0],DCR_TABLE[1],DCR_TABLE[2],DCR_TABLE[3],DCR_TABLE[4] );
		ROSPrintf("scalerVIP TPV_NEW_DCR %d	%d	%d	%d	%d\n", DCR_TABLE[20],DCR_TABLE[21],DCR_TABLE[22],DCR_TABLE[23],DCR_TABLE[24] );
		ROSPrintf("scalerVIP TPV_NEW_DCR %d	%d	%d	%d	%d\n", DCR_TABLE[25],DCR_TABLE[26],DCR_TABLE[27],DCR_TABLE[28],DCR_TABLE[29] );
		ROSPrintf("scalerVIP TPV_NEW_DCR %d	%d	%d	%d	%d\n", DCR_TABLE[50],DCR_TABLE[51],DCR_TABLE[52],DCR_TABLE[53],DCR_TABLE[54] );
		ROSPrintf("scalerVIP TPV_NEW_DCR %d	%d	%d	%d	%d\n", DCR_TABLE[55],DCR_TABLE[56],DCR_TABLE[57],DCR_TABLE[58],DCR_TABLE[59] );

		//20130502
		#ifdef fix_DCR_Table_memory
		//20130502
   		int i,offset;
		offset=2*DCR_TABLE_ROW_NUM*DCR_TABLE_COL_NUM;
		//================
		for(i=0; i<DCR_TABLE_COL_NUM*DCR_TABLE_ROW_NUM;i++)
		{
			DCR_Table_TPV_non_TV[i]=DCR_TABLE[offset+i];
		}
		#ifdef fix_DCR_Table_2694A_global
		offset=DCR_TABLE_COL_NUM*(DCR_TABLE_ROW_NUM+4);
		for(i=0; i<DCR_TABLE_COL_NUM*2;i++)
			DCR_Table_TPV_global_setting[i]=DCR_TABLE[offset+i];
		#endif
		#endif
		//================
		ROSPrintf("scalerVIP DCR %d	%d	%d	%d	%d\n", DCR_TABLE[60],DCR_TABLE[61],DCR_TABLE[62],DCR_TABLE[63],DCR_TABLE[64] );
		ROSPrintf("scalerVIP DCR %d	%d	%d	%d	%d\n", DCR_TABLE[65],DCR_TABLE[66],DCR_TABLE[67],DCR_TABLE[68],DCR_TABLE[69] );
		ROSPrintf("scalerVIP DCR %d	%d	%d	%d	%d\n", DCR_TABLE[70],DCR_TABLE[71],DCR_TABLE[72],DCR_TABLE[73],DCR_TABLE[74] );
		ROSPrintf("scalerVIP DCR %d	%d	%d	%d	%d\n", DCR_TABLE[75],DCR_TABLE[76],DCR_TABLE[77],DCR_TABLE[78],DCR_TABLE[79] );
        	ROSPrintf("scalerVIP DCR %d 	%d	%d	%d	%d\n", DCR_TABLE[80],DCR_TABLE[81],DCR_TABLE[82],DCR_TABLE[83],DCR_TABLE[84] );
		ROSPrintf("scalerVIP DCR %d 	%d	%d	%d	%d\n", DCR_TABLE[85],DCR_TABLE[86],DCR_TABLE[87],DCR_TABLE[88],DCR_TABLE[89] );

	} else {

		DCR_TABLE = (unsigned char *)Share_Memory_VIP_TABLE_Struct->DCR_TABLE[0][0];
		ROSPrintf("scalerVIP DCR %d	%d	%d	%d	%d\n", DCR_TABLE[0],DCR_TABLE[1],DCR_TABLE[2],DCR_TABLE[3],DCR_TABLE[4] );
		ROSPrintf("scalerVIP DCR %d	%d	%d	%d	%d\n", DCR_TABLE[20],DCR_TABLE[21],DCR_TABLE[22],DCR_TABLE[23],DCR_TABLE[24] );

	}
#endif
}

void scalerVIP_Set_DCR_BackLightMappingRange(void)
{
	_system_setting_info* system_info_structure_table = NULL;

	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

	if((system_info_structure_table == NULL)) {
		if(MA_print_count%360==0) {
			ROSPrintf("\n====Share Memory PQ data ERROR====\n\n");
			ROSPrintf(" Mem2 = %x\n",system_info_structure_table);
			ROSPrintf("\n===============================\n\n");
		}
		return;
	}

	scalerVIP_SetIsIncreseMode(system_info_structure_table->OSD_Info.isIncreaseMode_Flag);
	scalerVIP_SetDcrUIMaxValue(system_info_structure_table->OSD_Info.backlightLevel_uiMax);
	scalerVIP_SetDcrUIMinValue(system_info_structure_table->OSD_Info.backlightLevel_uiMin);
	scalerVIP_SetBlLvActMax(system_info_structure_table->OSD_Info.backlightLevel_actMax);
	scalerVIP_SetBlLvActMin(system_info_structure_table->OSD_Info.backlightLevel_uiMin);
	scalerVIP_SetDcrOnOff(system_info_structure_table->OSD_Info.OSD_DCR_Mode);
	scalerVIP_GetBlLvFromUser(system_info_structure_table->OSD_Info.OSD_Backlight);

}

void scalerVIP_SetIsIncreseMode(unsigned char arg)//Leo Chen 20101001
{
	m_isIncreaseMode= (unsigned int)arg;
}
void scalerVIP_SetDcrUIMaxValue(unsigned int arg)//Leo Chen 20101001
{
	m_DCR_UI_Max_Value= (unsigned int)arg;
}

void scalerVIP_SetDcrUIMinValue(unsigned int arg)//Leo Chen 20101001
{
	m_DCR_UI_Min_Value= (unsigned int)arg;
}

void scalerVIP_SetDcrOnOff(unsigned char arg)//Leo Chen 20101111
{
	m_DCR_On_Off= (unsigned char)arg;
	m_nDCR_Mode = m_DCR_On_Off;
	m_DCR_On_Off = (m_DCR_On_Off == 0) ?(0) : (1);
	/*ROSPrintf("m_DCR_On_Off=%d\n",m_DCR_On_Off);*/
}

void scalerVIP_GetBlLvFromUser(unsigned char arg)//Leo Chen 20101111
{
	m_BL_LV_From_User= (unsigned int)arg;

	m_DCR_refresh = TRUE; //Leo Chen 20101209
	DCR_refresh_TV057=TRUE;
}

void scalerVIP_SetBlLvActMax(unsigned int arg)//Leo Chen 20101111
{
	m_BL_LV_Act_Max= (unsigned int)arg;
}

void scalerVIP_SetBlLvActMin(unsigned int arg)//Leo Chen 20101111
{
	m_BL_LV_Act_Min= (unsigned int)arg;
}

void scalerVIP_SetDefaultDCRMode(unsigned long arg)
{
	m_bDefault_OFF= (unsigned int)arg;
	m_bDefault_OFF = (m_bDefault_OFF == 0) ?(1) : (0);
//printf("m_bDefault_OFF=%d\n",m_bDefault_OFF);
}



/**
 * Get histogram value by index
 *
 * @param	idx: index of histogram
 * @return	histogram value
 */
unsigned int scalerVIP_getColorHistValue(unsigned char idx)
{
	//scalerDrvPrint( "enter scalerVIP_getColorHistValue\n" );	// too many messages, use it carefully
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);
	return reg_HistCnt[idx];
}

/**
 * Scaler task (user space) set RTNR_Y table into scaler driver (kernel space).
 *
 * @param	arg: pointer of RTNR_Y table
 * @return	void
 */
void scalerVIP_setRTNR_Y_Table(unsigned long arg)
{
	unsigned char length = 0;
	unsigned char *ptr = (unsigned char*)arg;

	if ( RTNR_Y_Table != NULL ) {
		// oliver-
		//kfree(RTNR_Y_Table);
	}

	length = *ptr;

	RTNR_Y_Table = ptr+1;

}

/**
 * Scaler task (user space) set RTNR_C table into scaler driver (kernel space).
 *
 * @param	arg: pointer of RTNR_C table
 * @return	void
 */
void scalerVIP_setRTNR_C_Table(unsigned long arg)
{
	unsigned char length = 0;
	unsigned char *ptr = (unsigned char*)arg;

	if ( RTNR_C_Table == NULL ) {
		ROSPrintf( "Please set RTNR table before update RTNR table.\n" );
	}
	length = *(unsigned char *)ptr;

	RTNR_C_Table = ptr+1;

}

/**
 * Scaler task (user space) update RTNR_Y table into scaler driver (kernel space).
 *
 * @param	arg: pointer of new value
 * @return	SUCCESS or FAILED
 */
unsigned char scalerVIP_updateRTNR_Y_Table(unsigned long arg)
{
	unsigned char src_idx = 0;
	unsigned char *ptr = (unsigned char*)arg;

	nonAuto_RTNR_Y_LEVEL = *(ptr+1);

	if ( RTNR_Y_Table == NULL ) {
		ROSPrintf( "Please set RTNR table before update RTNR table.\n" );
		return FAILED;
	}

	src_idx = *(unsigned char *)ptr;

	RTNR_Y_Table[src_idx] = *(ptr+1);

	return SUCCESS;
}

/**
 * Scaler task (user space) update RTNR_C table into scaler driver (kernel space).
 *
 * @param	arg: pointer of new value
 * @return	SUCCESS or FAILED
 */
unsigned char scalerVIP_updateRTNR_C_Table(unsigned long arg)
{
	unsigned char src_idx = 0;
	unsigned char *ptr = (unsigned char*)arg;
	//scalerDrvPrint( "enter scalerVIP_updateRTNR_C_Table\n" );

	nonAuto_RTNR_C_LEVEL = *(ptr+1);

	if ( RTNR_C_Table == NULL ) {
		scalerDrvPrint( "Please set RTNR table before update RTNR table.\n" );
		return FAILED;
	}

	src_idx = *(unsigned char *)ptr;

	RTNR_C_Table[src_idx] =  *(ptr+1);


	return SUCCESS;
}

/**
 * get RTNR value in kernel space.
 * Because of synchronization problem, rtnr value in kernel space is read only.
 *
 * @param	src_idx: source index
 * @return	RTNR value
 */
unsigned char scalerVIP_getRTNR_Y(unsigned char src_idx)
{
	//ROSPrintf( "enter scalerVIP_getRTNR_Y\n" );
	if ( RTNR_Y_Table == NULL )
		return 0;
	else
	{
		return RTNR_Y_Table[src_idx];
	}
}

/**
 * get RTNR value in kernel space.
 * Because of synchronization problem, rtnr value in kernel space is read only.
 *
 * @param	src_idx: source index
 * @return	RTNR value
 */
unsigned char scalerVIP_getRTNR_C(unsigned char src_idx)
{
	//ROSPrintf( "enter scalerVIP_getRTNR_C\n" );
	if ( RTNR_C_Table == NULL )
		return 0;
	else
	{
		return RTNR_C_Table[src_idx];
	}
}


void scalerVIP_GetAutoNR(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetAutoMA6FlagMsg\n");
	*(unsigned char*)arg = AutoNR_Enable;
}
void scalerVIP_SetAutoNR(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_setAutoNRMsg\n");

	AutoNR_Enable = *(unsigned char*)arg;
	pre_VD_noise_level = 255;
	pre_DNR_Auto_lvl_SdHd = 255;
}

void scalerVIP_GetAutoNR_by_Low_Mid_High(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_GetAutoNR_by_Low_Mid_High\n");
	*(unsigned char*)arg = AutoNR_Enable_by_Low_Mid_High;
}
void scalerVIP_SetAutoNR_by_Low_Mid_High(unsigned long arg)
{
	//ROSPrintf("enter scalerVIP_SetAutoNR_by_Low_Mid_High\n");
	AutoNR_Enable_by_Low_Mid_High = *(unsigned char*)arg;
}

/**
 * Scaler task (user space) set DNR table into scaler driver (kernel space).
 *
 * @param	arg: pointer of DNR table
 * @return	void
 */
void scalerVIP_setDNRTable(unsigned long arg)
{
	unsigned char length = 0;
	unsigned char *ptr = (unsigned char*)arg;

	//ROSPrintf( "enter scalerVIP_setDNRTable\n" );
	if ( DNR_Table != NULL ) {
	}

	length =  *ptr;

	DNR_Table = ptr+1;
}

/**
 * Scaler task (user space) update DNR table into scaler driver (kernel space).
 *
 * @param	arg: pointer of new value
 * @return	SUCCESS or FAILED
 */
unsigned char scalerVIP_updateDNRTable(unsigned long arg)
{
	unsigned char src_idx = 0;
	unsigned char *ptr = (unsigned char*)arg;
	//ROSPrintf( "enter scalerVIP_updateDNRTable\n" );

	if ( DNR_Table == NULL ) {
		ROSPrintf( "Please set DNR table before update DNR table.\n" );
		return FAILED;
	}

	src_idx = *ptr;

	DNR_Table[src_idx] = *(ptr+1);

	return SUCCESS;
}

/**
 * get DNR value in kernel space.
 * Because of synchronization problem, dnr value in kernel space is read only.
 *
 * Usage:
 *	scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src) or
 *	scalerVIP_getDNR(scaler_disp_info[_CHANNEL2].input_src)
 *
 * @param	src_idx: source index
 * @return	DNR value
 */
unsigned char scalerVIP_getDNR(unsigned char src_idx)
{
	//ROSPrintf( "enter scalerVIP_getDNR\n" );
	if ( DNR_Table == NULL )
		return 0;
	else
	{
		return DNR_Table[src_idx];
	}
}

void scaler_Set_Dcr_Panasonic_Enable(unsigned long  arg)
{

	m_nTV057_New_DCR=*(unsigned char*)arg;
	DCR_refresh_TV057 =TRUE;
}

void scaler_Set_Dcr_Powersave_Enable(unsigned long  arg)
{

	//ROSPrintf("[Young]## scaler_Set_Dcr_Powersave_Enabley arg=%d@@ \n",arg);
	VIP_DCR_powersave_enable=*(unsigned char*)arg;

	//ROSPrintf("[Young]## scaler_Set_Dcr_Powersave_Enabley VIP_DCR_powersave_enable=%d@@ \n",VIP_DCR_powersave_enable);

}

unsigned char scalerVIP_Update_TSB_Active_Backlight_Table(unsigned long arg)
{
	//unsigned char src_idx = 0;
	unsigned char *ptr = (unsigned char*)arg;
	unsigned char* Active_Backlight_info=NULL;
	//unsigned char i;

	Active_Backlight_info = ptr;

	BlackAPL_a_HSCA=Active_Backlight_info[0];
	BlackAPL_b_HSCB=Active_Backlight_info[1];
	BlackAPL_c_HSCC=Active_Backlight_info[2];
	BlackAPL_d_HSCD=Active_Backlight_info[3];
	BlackAPL_e_HSCE=Active_Backlight_info[4];
	BlackAPL_f_HSCF=Active_Backlight_info[5];
	BlackAPL_g_HSCG=Active_Backlight_info[6];
	BlackAPL_h_HSCH=Active_Backlight_info[7];

	BlackAPL_BL_Th1_SABH=Active_Backlight_info[8];
	BlackAPL_BL_Th1_SABL=Active_Backlight_info[9];
	BlackAPL_BL_Th2_EABH=Active_Backlight_info[10];
	BlackAPL_BL_Th2_EABL=Active_Backlight_info[11];
	BlackAPL_BL_Th3_MLBL=Active_Backlight_info[12];
	BlackAPL_M_ATAB=Active_Backlight_info[13];
	BlackAPL_KU_USAB=Active_Backlight_info[14];
	BlackAPL_KD_DSAB=Active_Backlight_info[15];

	APL_BL_MAX = Active_Backlight_info[16];
	APL_BL_MIN = Active_Backlight_info[17];

	//for(i=0; i<18; i++){
		//ROSPrintf("scalerVIP_Update_TSB_Active_Backlight_Table[%d]= %d\n",i, Active_Backlight_info[i]);
	//}

	return SUCCESS;
}


//RenChen sync from L3300
void scalerVIP_SetNoisereduction_Vfilter(unsigned long arg)
{

	//scalerDrvPrint("enter scalerVIP_SetNoisereduction_Vfilter\n");
	Noisereduction_Vfilter = *(unsigned char*)arg;
}

//RenChen sync from L3300
void scalerVIP_GetNoisereduction_Vfilter_ON(unsigned long arg)
{

	//scalerDrvPrint("enter scalerVIP_GetNoisereduction_Vfilter_ON\n");
	*(unsigned char*)arg = Noisereduction_Vfilter_ON;

}

//Profile RGB for ambilight sensor
#ifdef ISR_AMBILIGHT_ENABLE
void scalerVIP_Set_Profile_RGB_Data_Flag_V(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Set_Profile_RGB_Data_Flag_V\n");

	Profile_RGB_data_flag_V = (unsigned char) arg;

}
void scalerVIP_Get_Profile_RGB_Data_Flag_V(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Get_Profile_RGB_Data_Flag_V\n");

	*(unsigned char*)arg = Profile_RGB_data_flag_V;

}
void scalerVIP_Get_Profile_R_Data_V(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Get_Profile_R_Data_V\n");

	memcpy((unsigned short*)arg, &Profile_R_V[0], sizeof(unsigned short)*16);

}
void scalerVIP_Get_Profile_G_Data_V(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Get_Profile_G_Data_V\n");

	memcpy((unsigned short*)arg, &Profile_G_V[0], sizeof(unsigned short)*16);

}

void scalerVIP_Get_Profile_B_Data_V(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Get_Profile_B_Data_V\n");

	memcpy((unsigned short*)arg, &Profile_B_V[0], sizeof(unsigned short)*16);

}

void scalerVIP_Set_Profile_RGB_Data_Flag_H(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Set_Profile_RGB_Data_Flag_H\n");

	Profile_RGB_data_flag_H = (unsigned char) arg;

}
void scalerVIP_Get_Profile_RGB_Data_Flag_H(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Get_Profile_RGB_Data_Flag_H\n");

	*(unsigned char*)arg = Profile_RGB_data_flag_H;

}
void scalerVIP_Get_Profile_R_Data_H(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Get_Profile_R_Data_H\n");

	memcpy((unsigned short*)arg, &Profile_R_H[0], sizeof(unsigned short)*16);

}
void scalerVIP_Get_Profile_G_Data_H(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Get_Profile_G_Data_H\n");

	memcpy((unsigned short*)arg, &Profile_G_H[0], sizeof(unsigned short)*16);

}

void scalerVIP_Get_Profile_B_Data_H(unsigned long arg)
{
	scalerDrvPrint("enter scalerVIP_Get_Profile_B_Data_H\n");

	memcpy((unsigned short*)arg, &Profile_B_H[0], sizeof(unsigned short)*16);

}
#endif

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
void scalerVIP_SetDCC_system_info_structure_table(unsigned long arg)
{
	ROSPrintf("SetDCC_system_info_structure_table\n");
	system_info_structure_table = ((_system_setting_info*)arg);
}
#endif

void scalerVIP_MA_IEdgeSmooth(unsigned char concentric_flag)
{

    unsigned int motionLevel=0;
    unsigned char spatial_noise_level=0;
    unsigned int natureScore=0;
    static unsigned int notNature=0;
    static unsigned int panCnt=0;
    _system_setting_info *system_info_structure_table=NULL;
    system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

    _clues* SmartPic_clue=NULL;
    SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();

	if((system_info_structure_table == NULL) || (SmartPic_clue == NULL) ) {
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR,system_info_structure_table = %x, SmartPic_clue = %x\n",system_info_structure_table,SmartPic_clue);
		return;
	}

    unsigned int printf_Flag=0,print_delay=0;
    printf_Flag = system_info_structure_table->ISR_Printf_Flag.Flag0;
    print_delay = system_info_structure_table->ISR_Printf_Flag.Delay_Time;

    natureScore=(SmartPic_clue->score_NaturalImage)>>4;


    // identify for not nature image
    spatial_noise_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL);
	if( scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL_RELIABLE) && spatial_noise_level==0)
	{
		notNature+=1;
		if(notNature>5)
			notNature=5;

	}
	else
	{
		if(notNature>0)
		notNature--;
	}

	if( scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN))
	{
		panCnt+=1;
		if(panCnt>10)
			panCnt=10;

	}
	else
	{
		if(panCnt>0)
		panCnt--;
	}


    motionLevel = scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION);

	iedge_smooth_edgesmooth_ex_ctrl_RBUS edgesmooth_ex_ctrl_reg;
	iedge_smooth_edgesmooth_ex_ctrl2_RBUS edgesmooth_ex_ctrl2_reg;
	iedge_smooth_edgesmooth_ex_ctrl3_RBUS edgesmooth_ex_ctrl3_reg;
	iedge_smooth_edgesmooth_mess_direction1_RBUS edgesmooth_mess_direction1_reg;
	iedge_smooth_edgesmooth_blend_weight_lpf_RBUS edgesmooth_blend_weight_lpf_reg;
	iedge_smooth_edgesmooth_unstable_area_RBUS edgesmooth_unstable_area_reg;

	edgesmooth_ex_ctrl_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg);
	edgesmooth_ex_ctrl2_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg);
	edgesmooth_ex_ctrl3_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg);
	edgesmooth_mess_direction1_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_Mess_Direction1_reg);
	edgesmooth_blend_weight_lpf_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_Blend_Weight_LPF_reg);
	edgesmooth_unstable_area_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_Unstable_area_reg);

	//#ifdef VD_log
	if(((printf_Flag&_BIT1)!=0) && (MA_print_count%print_delay==0))
	{
	    ROSPrintf("\n[VDPQ][MA IEGSM]:natureScore=%d, notNature=%d, concentric_flag=%d, motionLevel=%d, pan=%d, ",natureScore,notNature,concentric_flag,motionLevel,(scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN) || scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN)));
		//ROSPrintf("SMD_flag=%d \n\n",SMD_flag_from_scalerVideo);
		ROSPrintf("SMD_flag=%d \n\n", scalerVideo_Get_VD_MiddleWare(VD_STATUS_SMD_IEGSM) );
	}
	//#endif

    // use strong I edge smooth setting for CVBS when motion big and pan
    if(Scaler_InputSrcGetMainChType()== _SRC_CVBS && notNature<=1  )
    {
        // for pan
        if( concentric_flag==0&&(/*scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN) || scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN) ||*/ scalerVideo_Get_VD_MiddleWare(VD_STATUS_SMD_IEGSM))) // SMD_flag_from_scalerVideo: info from VD for LG-NTSC & PAL hanging bed(#2)
        {
            edgesmooth_ex_ctrl_reg.lpf_5tapmode=1;
            //edgesmooth_ex_ctrl_reg.t2df_en=0;
            //edgesmooth_ex_ctrl_reg.crct_en=0;
            edgesmooth_ex_ctrl3_reg.edge_upbnd=80;

            edgesmooth_mess_direction1_reg.mess_4direction_w0=12;
            edgesmooth_mess_direction1_reg.mess_4direction_w1=10;
            edgesmooth_mess_direction1_reg.mess_4direction_w2=8;

            edgesmooth_blend_weight_lpf_reg.blend_weight_lpf_en=0;
            edgesmooth_unstable_area_reg.unstable_area_en=0;

		if(((printf_Flag&_BIT1)!=0) && (MA_print_count%print_delay==0))
		{
	  	 	ROSPrintf("\n[VDPQ][MA IEGSM]: SMD");
		}


        }
        else if(motionLevel>1 && concentric_flag==0)
        {

            edgesmooth_ex_ctrl_reg.lpf_5tapmode=1;
            //edgesmooth_ex_ctrl_reg.t2df_en=0;
            //edgesmooth_ex_ctrl_reg.crct_en=0;
            edgesmooth_ex_ctrl3_reg.edge_upbnd=120-2*motionLevel-notNature;

            edgesmooth_mess_direction1_reg.mess_4direction_w0=12;
            edgesmooth_mess_direction1_reg.mess_4direction_w1=10;
            edgesmooth_mess_direction1_reg.mess_4direction_w2=8;

            edgesmooth_blend_weight_lpf_reg.blend_weight_lpf_en=0;
            edgesmooth_unstable_area_reg.unstable_area_en=1;
            edgesmooth_unstable_area_reg.unstable_area_thd=16-(motionLevel>>1);

		if(((printf_Flag&_BIT1)!=0) && (MA_print_count%print_delay==0))
		{
	  	 	ROSPrintf("\n[VDPQ][MA IEGSM]: motionLevel>1");
		}


        }
	else if(panCnt>0)
	{
	      edgesmooth_ex_ctrl2_reg.t2df_upbnd=140-panCnt*6;
		edgesmooth_ex_ctrl3_reg.edge_upbnd=100-panCnt*2;
		//ROSPrintf("\n[VDPQ][MA IEGSM]: STATUS_PAN");

        }
        else// normal setting
        {
            edgesmooth_ex_ctrl_reg.lpf_5tapmode=0;
            //edgesmooth_ex_ctrl_reg.t2df_en=1;
	      edgesmooth_ex_ctrl2_reg.t2df_upbnd=140;
            //edgesmooth_ex_ctrl_reg.crct_en=1;
            edgesmooth_ex_ctrl3_reg.edge_upbnd=100;
            edgesmooth_mess_direction1_reg.mess_4direction_w0=6;
            edgesmooth_mess_direction1_reg.mess_4direction_w1=4;
            edgesmooth_mess_direction1_reg.mess_4direction_w2=2;

            edgesmooth_blend_weight_lpf_reg.blend_weight_lpf_en=0;
            edgesmooth_unstable_area_reg.unstable_area_en=0;
            edgesmooth_unstable_area_reg.unstable_area_thd=16;

        }


    }
	else if(Scaler_InputSrcGetMainChType()== _SRC_CVBS && notNature>1) // normal setting
    {

            edgesmooth_ex_ctrl_reg.lpf_5tapmode=0;
            //edgesmooth_ex_ctrl_reg.t2df_en=1;
	     edgesmooth_ex_ctrl2_reg.t2df_upbnd=140;
            //edgesmooth_ex_ctrl_reg.crct_en=1;
	     //edgesmooth_ex_ctrl_reg.edge_en=1;
            edgesmooth_ex_ctrl3_reg.edge_upbnd=100;
            edgesmooth_mess_direction1_reg.mess_4direction_w0=6;
            edgesmooth_mess_direction1_reg.mess_4direction_w1=4;
            edgesmooth_mess_direction1_reg.mess_4direction_w2=2;

            edgesmooth_blend_weight_lpf_reg.blend_weight_lpf_en=0;
            edgesmooth_unstable_area_reg.unstable_area_en=0;
            edgesmooth_unstable_area_reg.unstable_area_thd=16;

    }

        rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg,edgesmooth_ex_ctrl_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL2_reg,edgesmooth_ex_ctrl2_reg.regValue);
    	rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL3_reg,edgesmooth_ex_ctrl3_reg.regValue);
    	rtd_outl(IEDGE_SMOOTH_EdgeSmooth_Mess_Direction1_reg,edgesmooth_mess_direction1_reg.regValue);
    	rtd_outl(IEDGE_SMOOTH_EdgeSmooth_Blend_Weight_LPF_reg,edgesmooth_blend_weight_lpf_reg.regValue);
    	rtd_outl(IEDGE_SMOOTH_EdgeSmooth_Unstable_area_reg,edgesmooth_unstable_area_reg.regValue);


	//if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Snr==TRUE))
	//ROSPrintf( "** notNature = %d, SMD_flag_from_scalerVideo = %d, motionLevel  = %d\n", notNature, SMD_flag_from_scalerVideo, motionLevel );




}

void scalerVIP_IEedgeSmooth_Linemode_check(void)
{
	// this function is for I edge smooth line mode check (b802_5100.10:9)
	// 0:3 line, 1:5 line, 2 :11 line
	// Mac3 : only when UZD is disable, we can 11 line mode ( for vertical mosquito NR needed )

	// Mag2 : no need to check UZD status, only input width issue
    // * When 3 line mode : input width <= 4096
    // * When 5 line mode : input width <= 2048
    // * When 11line mode : input width <= 1024

	int mnr_v_en=0;
	SLR_VIP_TABLE *vipTable_shareMem = scaler_GetShare_Memory_VIP_TABLE_Struct();
	unsigned char which_source = 0;
	unsigned char which_table_index = 0;
	DRV_IEdgeSmooth_Coef *iegsm_coef=NULL;

	//Elsie 20141001: width detection
	unsigned short IWid;
	unsigned char di_en_flag, di_go_through_flag;

	if (RPC_system_info_structure_table)
		which_source=(RPC_system_info_structure_table->VIP_source);

	iedge_smooth_edgesmooth_ex_ctrl_RBUS edgesmooth_ex_ctrl_reg;
	iedge_smooth_edsm_db_ctrl_RBUS       edsm_db_ctrl_reg;

	nr_mosquito_ctrl_RBUS nr_mosquito_ctrl_RBUS_reg;

	di_im_di_active_window_control_RBUS di_active_window_control_reg;
	di_im_di_weave_window_control_RBUS di_weave_window_control_reg;
	di_im_di_control_RBUS di_im_di_control_reg;
	vgip_vgip_chn1_act_hsta_width_RBUS vgip_chn1_act_hsta_width_reg;
	vgip_data_path_select_RBUS vgip_data_path_select_reg1;

	di_im_di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
	di_active_window_control_reg.regValue = rtd_inl(DI_IM_DI_ACTIVE_WINDOW_CONTROL_reg);
	di_weave_window_control_reg.regValue = rtd_inl(DI_IM_DI_WEAVE_WINDOW_CONTROL_reg);
	vgip_chn1_act_hsta_width_reg.regValue = rtd_inl(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg);
	vgip_data_path_select_reg1.regValue = rtd_inl(VGIP_Data_Path_Select_reg);

	edgesmooth_ex_ctrl_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg);
	nr_mosquito_ctrl_RBUS_reg.regValue = rtd_inl(NR_MOSQUITO_CTRL_reg);
	edsm_db_ctrl_reg.regValue =         rtd_inl(IEDGE_SMOOTH_EDSM_DB_CTRL_reg);

    // get current width
	di_en_flag = di_im_di_control_reg.ip_enable;
	di_go_through_flag = vgip_data_path_select_reg1.uzd1_in_sel;

	if(di_en_flag & di_go_through_flag)
	{
		// width from DI
		IWid = ((di_weave_window_control_reg.hsize_msb<<11)+di_active_window_control_reg.hsize);
	}
	else	// Elsie 20141119: not go through DI, width from VGIP
	{
		IWid = vgip_chn1_act_hsta_width_reg.ch1_ih_act_wid;
	}


    // for vertical mosquito NR line mode select
	mnr_v_en = nr_mosquito_ctrl_RBUS_reg.mosquitonr_vertical_en;

	if( mnr_v_en==1 && IWid<=1024)
	{
		edgesmooth_ex_ctrl_reg.lbuf_linemode = 2; // 11 line
		if(edsm_db_ctrl_reg.edsm_db_en)
		{
			edsm_db_ctrl_reg.edsm_db_apply=1;
		}
	}
	else if (vipTable_shareMem)
	{
		nr_mosquito_ctrl_RBUS_reg.mosquitonr_vertical_en = 0; // disable vertical mosquito NR when width over 1024
		// use line mode set in IEGSM table
		which_table_index = vipTable_shareMem->VIP_QUALITY_Extend2_Coef[which_source][VIP_QUALITY_FUNCTION_iESM_table];
		iegsm_coef = &vipTable_shareMem->I_EDGE_Smooth_Coef[which_table_index];
		edgesmooth_ex_ctrl_reg.lbuf_linemode = iegsm_coef->S_IESM_Basic.IESM_5line_En;
	}

	rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg, edgesmooth_ex_ctrl_reg.regValue);
	rtd_outl(NR_MOSQUITO_CTRL_reg,nr_mosquito_ctrl_RBUS_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_EDSM_DB_CTRL_reg,edsm_db_ctrl_reg.regValue);
}
unsigned char scalerVIP_Get_hpan_vfir()
{
	return h_pan_vfir_value;
}
void scalerVIP_Set_hpan_vfir(unsigned char value)
{
	if (value > 32)
		value = 32; //for clip
	h_pan_vfir_value = value;
}
void scalerVIP_Set_vfir_ctrl(unsigned char enable)
{
	iedge_smooth_vfilter_0_RBUS vfilter_reg;
	vfilter_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_0_reg);

	if (enable)
		vfilter_reg.avlpf_en = 1;
	else
		vfilter_reg.avlpf_en = 0;

	rtd_outl(IEDGE_SMOOTH_VFILTER_0_reg, vfilter_reg.regValue);
}



void scalerVIP_Dynamic_Vertical_NR(void)
{
	static unsigned char pre_source =255;
	iedge_smooth_vfilter_0_RBUS iedge_smooth_vfilter_reg;
	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);
	static unsigned char ori_vnr_weight=0;
	static unsigned char ori_text_coring=0;
	color_sharp_dm_peaking_bound_1_RBUS color_sharp_dm_peaking_bound_1_reg;
	unsigned char hpan_vfir=0,tnr_vfir=0,vfir_value;
	unsigned char sat_th=60;

	iedge_smooth_vfilter_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_0_reg);
	color_sharp_dm_peaking_bound_1_reg.regValue= rtd_inl(COLOR_SHARP_DM_PEAKING_BOUND_1_reg);

    	iedge_smooth_edgesmooth_mess_direction1_RBUS edgesmooth_mess_direction1_reg;
	edgesmooth_mess_direction1_reg.regValue = scaler_rtd_inl(IEDGE_SMOOTH_EdgeSmooth_Mess_Direction1_reg);


	char temp=0;
	if(pre_source !=cur_source)
	{
		ori_vnr_weight=iedge_smooth_vfilter_reg.vfir_weight;
		ori_text_coring = color_sharp_dm_peaking_bound_1_reg.lv;
	}
	pre_source = cur_source;

	temp=iedge_smooth_vfilter_reg.vfir_weight;
	unsigned char spatial_noise_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_SPATIAL_NOISE_LEVEL);
	unsigned char temporal_noise_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_CONTENT_TEMPORAL_NOISE_LEVEL);


	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Reverse_3==TRUE))
	{
	//	ROSPrintf("SNR=%d,TNR=%d,tmp=%d\n", spatial_noise_level,temporal_noise_level,temp);
	}
	switch(cur_source)
	{
		case VIP_QUALITY_HDMI_480P:
		case VIP_QUALITY_HDMI_576P:
		case VIP_QUALITY_HDMI_720P:
		case VIP_QUALITY_HDMI_480I:
		case VIP_QUALITY_HDMI_576I:

			break;


		case VIP_QUALITY_DTV_480I:
		case VIP_QUALITY_DTV_576I:
		case VIP_QUALITY_DTV_480P:
		case VIP_QUALITY_DTV_576P:


		break;
		case VIP_QUALITY_HDMI_1080I:
		case VIP_QUALITY_HDMI_1080P:

			//rtd_outl(IEDGE_SMOOTH_VFILTER_0_reg, iedge_smooth_vfilter_reg.regValue);


		break;
		case VIP_QUALITY_CVBS_NTSC :
		{
	            static unsigned char pre_vif_weight = 0;
	            unsigned char TargetWeight = iedge_smooth_vfilter_reg.vfir_weight;

	            if((scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==1))
	                TargetWeight = 5;

	            if( scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN) >= 2 )
	                TargetWeight = 20;

	            if( pre_vif_weight < TargetWeight )
	                pre_vif_weight++;
	            else if( pre_vif_weight > TargetWeight )
	                pre_vif_weight--;
	            else
	                pre_vif_weight = pre_vif_weight;

	            if( pre_vif_weight > 31 )
	                pre_vif_weight = 31;
	            else if( pre_vif_weight < 0 )
	                pre_vif_weight = 0;

	            iedge_smooth_vfilter_reg.vfir_weight = pre_vif_weight;
	            rtd_outl(IEDGE_SMOOTH_VFILTER_0_reg, iedge_smooth_vfilter_reg.regValue);

	            if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Reverse_3==TRUE))
	                ROSPrintf("(NTSC) lpf target value = %d, write %d\n", TargetWeight, iedge_smooth_vfilter_reg.vfir_weight);

	      		  break;
	        }
		case VIP_QUALITY_CVBS_PAL:
		{
	            static unsigned char pre_vif_weight = 0;
	            unsigned char TargetWeight = iedge_smooth_vfilter_reg.vfir_weight;

	            if((scalerVIP_DI_MiddleWare_MCNR_Get_Pan_Flag()==1))
	                TargetWeight = 5;

	            if( scalerVIP_DI_MiddleWare_GetStatus(STATUS_VPAN) >= 2 )
	                TargetWeight = 20;

	            if( DynamicOptimizeSystem[189] == 1 )
	                TargetWeight = 10;

	            if( pre_vif_weight < TargetWeight )
	                pre_vif_weight++;
	            else if( pre_vif_weight > TargetWeight )
	                pre_vif_weight--;
	            else
	                pre_vif_weight = pre_vif_weight;

	            if( pre_vif_weight > 31 )
	                pre_vif_weight = 31;
	            else if( pre_vif_weight < 0 )
	                pre_vif_weight = 0;

	            iedge_smooth_vfilter_reg.vfir_weight = pre_vif_weight;
	            rtd_outl(IEDGE_SMOOTH_VFILTER_0_reg, iedge_smooth_vfilter_reg.regValue);

	            if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Reverse_3==TRUE))
	                ROSPrintf("(PAL) lpf target value = %d, write %d\n", TargetWeight, iedge_smooth_vfilter_reg.vfir_weight);

	            break;
	        }
	        case VIP_QUALITY_TV_NTSC:
	        case VIP_QUALITY_TV_PAL:
	        case VIP_QUALITY_TV_PAL_M:
	        case VIP_QUALITY_TV_SECAN:
	        case VIP_QUALITY_TV_NTSC443:
	        {

	            static int vfir_weight = 0;
	            vdtop_noise_status_RBUS vdtop_noise_status_reg;
	            vdtop_noise_status_reg.regValue = VDPQ_rtd_inl(VDTOP_NOISE_STATUS_reg);
	            int TargetWeight = 20 + vdtop_noise_status_reg.status_noise + spatial_noise_level;

	            if( TargetWeight > vfir_weight )
	                vfir_weight++;
	            else if( TargetWeight < vfir_weight )
	                vfir_weight--;
	            else
	                vfir_weight = vfir_weight;

	            if( vfir_weight > 26 )
	                vfir_weight = 26;
	            else if( vfir_weight < 0 )
	                vfir_weight = 0;

	            iedge_smooth_vfilter_reg.vfir_weight = vfir_weight;
	            rtd_outl(IEDGE_SMOOTH_VFILTER_0_reg, iedge_smooth_vfilter_reg.regValue);
	            break;
	        }
		default:
			break;
	}



}
void scalerVIP_BTR_Detecte(void)
{
	static unsigned char pre_source =255;
	static unsigned char ori_btr=0;
	unsigned char cur_source=0;
	_RPC_system_setting_info* RPC_system_info_structure_table = NULL;
	di_im_di_btr_control_RBUS BTR_Control_Reg;
	unsigned char motionl_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION);
	BTR_Control_Reg.regValue=rtd_inl(DI_IM_DI_BTR_CONTROL_reg);

	RPC_system_info_structure_table = scaler_GetShare_Memory_RPC_system_setting_info_Struct();

	if(RPC_system_info_structure_table == NULL || SmartPic_clue ==NULL){
		if(MA_print_count%360==0)
			ROSPrintf("scalerVIP_BTR_Detecte Share Memory PQ data ERROR, system_info = %x,SmartPic_clue=%d \n",RPC_system_info_structure_table, SmartPic_clue);
		return;
	}
	cur_source=(RPC_system_info_structure_table->VIP_source);

	if(pre_source !=cur_source)
	{
		ori_btr=BTR_Control_Reg.btr_blendtemporalrecoveryen;
	}
	pre_source = cur_source;

	//ROSPrintf("motionl_level=%d \n", motionl_level);

	switch(cur_source)
	{
		case VIP_QUALITY_CVBS_NTSC:
		case VIP_QUALITY_CVBS_PAL:
		case VIP_QUALITY_CVBS_S_NTSC:
		case VIP_QUALITY_CVBS_S_PAL:
		case VIP_QUALITY_TV_NTSC:
		case VIP_QUALITY_TV_PAL:
		case VIP_QUALITY_YPbPr_480I:
		case VIP_QUALITY_YPbPr_576I:
		case VIP_QUALITY_HDMI_480I:
		case VIP_QUALITY_HDMI_576I:
		case VIP_QUALITY_DTV_480I:
		case VIP_QUALITY_DTV_576I:
		case VIP_QUALITY_CVBS_SECAN:
		case VIP_QUALITY_CVBS_S_SECAN:
		case VIP_QUALITY_TV_SECAN:
		case VIP_QUALITY_SCART_NTSC:
		case VIP_QUALITY_SCART_PAL:
		case VIP_QUALITY_SCART_SECAN:
		case VIP_QUALITY_SCART_RGB_NTSC:
		case VIP_QUALITY_SCART_RGB_PAL:
		case VIP_QUALITY_SCART_RGB_SECAN:
		case VIP_QUALITY_CVBS_PAL_M:
		case VIP_QUALITY_CVBS_S_PAL_M:
		case VIP_QUALITY_TV_PAL_M:
		case VIP_QUALITY_TV_NTSC443:
			if(((motionl_level<4)||(SmartPic_clue->SceneChange_NR))&&ori_btr==1)
			{
				BTR_Control_Reg.btr_blendtemporalrecoveryen=0;
				rtd_outl(DI_IM_DI_BTR_CONTROL_reg, BTR_Control_Reg.regValue);
			}
			else
			{
				BTR_Control_Reg.btr_blendtemporalrecoveryen=1;
				rtd_outl(DI_IM_DI_BTR_CONTROL_reg, BTR_Control_Reg.regValue);
			}

		break;
	default:

		break;
	}

	#if 0	//20150724 roger mark, we have new method to avoid fall into film22
	if(system_info_structure_table->Project_ID == VIP_Project_ID_TV006){
		if (cur_source == VIP_QUALITY_HDMI_1080I){
		di_im_di_control_RBUS di_control_reg;
		di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
			if (motionl_level <= 15){ // global motion less then 15 disable 22 film mode
			di_control_reg.film_enable = di_control_reg.film_enable & 0x1B; //11011
			}else {
			di_control_reg.film_enable = 0x1C;// 11100
		}
		rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);
	}
	}
	#endif
}

void scalerVIP_Dynamic_DeXCXL_CTRL(_RPC_system_setting_info *VIP_RPC_system_info_structure_table, SLR_VIP_TABLE* Share_VIP_TABLE_Struct)
{
	de_xcxl_de_xcxl_blend_RBUS de_xcxl_de_xcxl_blend_reg;
	unsigned char de_xc_tbl_sel = 0;
	unsigned char vip_src = VIP_RPC_system_info_structure_table->VIP_source;
	/* turn off de-xc while film*/
	if (sat_ratio_mean_value <=35  || pattern_gen_pan_flag == 1)
	{
		de_xcxl_de_xcxl_blend_reg.regValue = 0;
	}
	else
	{
		de_xc_tbl_sel = Share_VIP_TABLE_Struct->VIP_QUALITY_Extend_Coef[vip_src][VIP_QUALITY_FUNCTION_I_De_XC];
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_0 = I_De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_0;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_1 = I_De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_1;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_2 = I_De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_2;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_3 = I_De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_3;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_4 = I_De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_4;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_5 = I_De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_5;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_6 = I_De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_6;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_7 = I_De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_7;
	}
	rtd_outl(DE_XCXL_De_XCXL_BLEND_reg, de_xcxl_de_xcxl_blend_reg.regValue);	/* is not db*/

}

#ifdef CONFIG_HW_SUPPORT_MEMC
void scalerVIP_IP_OnOff_By_MEMC_Film(_system_setting_info* system_info_structure_table) //rord.tsao 2016/0325
{
	// when content is film need disable smd.
	// some time film detected not correct in pq block,used memc film flag to disable.

	di_di_smd_additionalcoeff1_RBUS init_di_smd_additionalcoeff1_reg;
	di_color_recovery_option_RBUS Color_Recovery_Option_Reg;
	di_im_di_pan_detection_control_1_RBUS di_pan_detection_control_1_reg;
	di_im_di_hfd_ma_error_recovery_RBUS di_im_di_hfd_ma_error_recovery_reg;
	//de_xcxl_de_xcxl_blend_RBUS de_xcxl_de_xcxl_blend_reg;

	//unsigned char de_xc_tbl_sel = 0;

	// -----------------------------------------------------------------------------
	// Determin is Film or not

	// Film information from MEMC

	unsigned char *FilmInfo = Scaler_MEMC_GetCadence();
	if( FilmInfo == NULL )
	{
		if( MA_print_count%120 == 0)
			ROSPrintf("[%s] Film information ptr from MEMC error\n", __func__);
		return;
	}

	// Debounce
	static unsigned char isFilm = 40;
	if( FilmInfo[_FILM_MEMC_OUT_ALL] == 0 && isFilm > 0 )
		isFilm--;
	else if( FilmInfo[_FILM_MEMC_OUT_ALL] != 0 )
		isFilm = 40;

	// -----------------------------------------------------------------------------

	init_di_smd_additionalcoeff1_reg.regValue= rtd_inl(DI_DI_SMD_AdditionalCoeff1_reg);
	Color_Recovery_Option_Reg.regValue = rtd_inl(DI_Color_Recovery_Option_reg);
	if((DynamicOptimizeSystem[174]==1)&&(Color_Recovery_Option_Reg.game_mode_3a!=1))
	{
		init_di_smd_additionalcoeff1_reg.smd_result_en =1;
		rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);

	}
	else if( (isFilm!=0) || (Color_Recovery_Option_Reg.game_mode_3a==1) )
	{
		init_di_smd_additionalcoeff1_reg.smd_result_en =0;
		rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);

		if(system_info_structure_table->VIP_source ==VIP_QUALITY_HDMI_576I||system_info_structure_table->VIP_source ==VIP_QUALITY_HDMI_480I)
		{
			di_pan_detection_control_1_reg.regValue = rtd_inl(DI_IM_DI_PAN_DETECTION_CONTROL_1_reg);
			di_pan_detection_control_1_reg.pan_en=0;
			rtd_outl(DI_IM_DI_PAN_DETECTION_CONTROL_1_reg,di_pan_detection_control_1_reg.regValue);
		}
	}
	else if((static_move==1)&&(Color_Recovery_Option_Reg.game_mode_3a!=1)&&(isFilm==0))
	{
		init_di_smd_additionalcoeff1_reg.smd_result_en =1;
		rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);

	}

	/* HMC off while film*/
	di_im_di_hfd_ma_error_recovery_reg.regValue = rtd_inl(DI_IM_DI_HFD_MA_ERROR_RECOVERY_reg);
	//if (FilmInfo[_FILM_MEMC_OUT_ALL] != 0)
	if( isFilm != 0 )
	{

		di_im_di_hfd_ma_error_recovery_reg.hmc_window_en = 1;
		di_im_di_hfd_ma_error_recovery_reg.hmc_window_top = 0;
		di_im_di_hfd_ma_error_recovery_reg.hmc_window_bot = 1023;
	}
	else
	{
		di_im_di_hfd_ma_error_recovery_reg.hmc_window_en = 0;
	}
	rtd_outl(DI_IM_DI_HFD_MA_ERROR_RECOVERY_reg, di_im_di_hfd_ma_error_recovery_reg.regValue);
#if 0	/* move to scalerVIP_Dynamic_DeXCXL_CTRL*/
	/* turn off de-xc while film*/
	if (sat_ratio_mean_value <=35 )
	{
		de_xcxl_de_xcxl_blend_reg.regValue = 0;
	}
	else
	{
		de_xc_tbl_sel = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.table_select;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_0 = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_0;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_1 = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_1;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_2 = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_2;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_3 = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_3;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_4 = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_4;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_5 = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_5;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_6 = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_6;
		de_xcxl_de_xcxl_blend_reg.dexc_blending_table_7 = system_info_structure_table->PQ_Setting_Info.I_De_XC_CTRL.De_XC_TBL[de_xc_tbl_sel].dexc_blending_table_7;
	}
	rtd_outl(DE_XCXL_De_XCXL_BLEND_reg, de_xcxl_de_xcxl_blend_reg.regValue);	/* is not db*/
#endif
}

#endif
void scalerVIP_SMD_weake_move_Detecte(void)
{
	di_di_gst_fmv_pan_coeff2_RBUS di_di_gst_fmv_pan_coeff2;
	di_di_smd_sampling_gmvc_RBUS di_di_smd_sampling_gmvc;
	di_di_smd_gmvcoeff3_RBUS init_di_smd_gmvcoeff3_reg;
	di_di_smd_gmvcoeff1_RBUS smd_gmvcoeff1_reg;
	di_di_smd_gmvcoeff2_RBUS smd_gmvcoeff2_reg;
	di_di_smd_choosecandidate_RBUS smd_choosecandidate_reg;
	di_im_di_zoommotion_detector_RBUS zoommotion_detector_reg;
	di_di_smd_additionalcoeff2_RBUS init_di_smd_additionalcoeff2_reg;

	unsigned char cur_source=(RPC_system_info_structure_table->VIP_source);

	unsigned char hgmv=0,vgmv=0;
	unsigned short match_percent1=0,match_percent2=0;
	char which_source=(RPC_system_info_structure_table->VIP_source);

	if(which_source == VIP_QUALITY_HDMI_1080I)
		return;
	di_di_gst_fmv_pan_coeff2.regValue=rtd_inl(DI_DI_GST_FMV_Pan_Coeff2_reg);
	di_di_gst_fmv_pan_coeff2.gst_fmvhist_sad_diff=1;
	rtd_outl(DI_DI_GST_FMV_Pan_Coeff2_reg, di_di_gst_fmv_pan_coeff2.regValue);

	di_di_smd_sampling_gmvc.regValue=rtd_inl(DI_DI_SMD_Sampling_GMVc_reg);
	if((DynamicOptimizeSystem[107]==1)&&cur_source==VIP_QUALITY_HDMI_1080I)
	{
	//	di_di_smd_sampling_gmvc.smd_close2gmv_mvselect =3;
	}
	else
	{
	//	di_di_smd_sampling_gmvc.smd_close2gmv_mvselect =3;
	}
	rtd_outl(DI_DI_SMD_Sampling_GMVc_reg, di_di_smd_sampling_gmvc.regValue);

	init_di_smd_gmvcoeff3_reg.regValue=rtd_inl(DI_DI_SMD_GMVCoeff3_reg);
	hgmv =init_di_smd_gmvcoeff3_reg.smd_gmv1_x;
	vgmv =init_di_smd_gmvcoeff3_reg.smd_gmv1_y;

	unsigned char motionl_level = scalerVIP_DI_MiddleWare_GetStatus(STATUS_MOTION);

	if(((hgmv==3)&&(vgmv==3))||DynamicOptimizeSystem[180]==1) //hGMV , VGMA=0
	{
		smd_gmvcoeff1_reg.regValue= rtd_inl(DI_DI_SMD_GMVCoeff1_reg);
		smd_gmvcoeff2_reg.regValue= rtd_inl(DI_DI_SMD_GMVCoeff2_reg);
		smd_choosecandidate_reg.regValue =  rtd_inl(DI_DI_SMD_ChooseCandidate_reg);
		zoommotion_detector_reg.regValue= rtd_inl(DI_IM_DI_ZoomMotion_Detector_reg);

		init_di_smd_additionalcoeff2_reg.regValue =  rtd_inl(DI_DI_SMD_AdditionalCoeff2_reg);

		if(smd_gmvcoeff1_reg.smd_gmv_ctr==0)
			smd_gmvcoeff1_reg.smd_gmv_ctr=1;


		match_percent1 = smd_gmvcoeff1_reg.smd_gmv1_max_ctr*100/smd_gmvcoeff1_reg.smd_gmv_ctr;
		match_percent2=smd_gmvcoeff2_reg.smd_gmv2_max_ctr*100/smd_gmvcoeff1_reg.smd_gmv_ctr;

		if((match_percent1>95&&match_percent2<10&&motionl_level<3)||zoommotion_detector_reg.smd_zoommotion_flag !=0||DynamicOptimizeSystem[180]==1)
		{
			smd_choosecandidate_reg.smd_reliablerange_sad_th=50;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=0x1f;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=0x07;

		}
		else
		{
			smd_choosecandidate_reg.smd_reliablerange_sad_th=125;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset=0x0f;
			init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain=0x02;

		}
		gSmd_weak_move =smd_choosecandidate_reg.smd_reliablerange_sad_th; // for lg pattern used
		gSmd_offset = init_di_smd_additionalcoeff2_reg.smd_search_gmv_offset;
		gSmd_gain=init_di_smd_additionalcoeff2_reg.smd_search_gmv_gain;

		//rtd_outl(DI_DI_SMD_CHOOSECANDIDATE_reg, smd_choosecandidate_reg.regValue);
		rtd_outl(DI_DI_SMD_AdditionalCoeff2_reg,init_di_smd_additionalcoeff2_reg.regValue);

		if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Slow_Motion1==TRUE))
		{
			ROSPrintf("total_gmv=%d, gmv1=%d ,gmv2=%d \n ",smd_gmvcoeff1_reg.smd_gmv_ctr,smd_gmvcoeff1_reg.smd_gmv1_max_ctr, smd_gmvcoeff2_reg.smd_gmv2_max_ctr);
			ROSPrintf("match_percent1=%d, match_percent2=%d \n ", match_percent1,match_percent2);
			ROSPrintf("motionl_level=%d, zoom=%d \n", motionl_level,zoommotion_detector_reg.smd_zoommotion_flag);

		}
		if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.Slow_Motion2==TRUE))
		{
			ROSPrintf("DynamicOptimizeSystem[180]=%d\n", DynamicOptimizeSystem[180]);
			ROSPrintf("choosecandidate=%d\n",smd_choosecandidate_reg.regValue);
			ROSPrintf("\n \n");

		}

	}


}
void scalerVIP_quality_init(unsigned long arg)
{
	//========== clear mpegnr data ==========
	unsigned int* init_value = (unsigned int*)arg;
	//clear mpeg nr data
	NoiseSum_spatial=0;
	MpegRatioSum=0;
	MpegRatioSum_Count=0;
	ContainStill_Count=0;
	Field_Count=0;
	kernel_quality_init=1;

	//flora, add for Sirius non8x8 detector
	XSTEP_NUM= (unsigned char)(*(init_value+QUALITY_INIT_MPEGNR));
	/*
	ROSPrintf("1.[mpeg_data_reset]ucMode_Curr=%d\n",scaler_disp_info[SLR_MAIN_DISPLAY].ucMode_Curr);
	ROSPrintf("1.[mpeg_data_reset]XSTEP_NUM=%d\n",XSTEP_NUM);
	*/
	xstep_idx_detect=0;
	xstep_idx_apply=0;
	mpegnr_ich1_det_hist_hor_step_RBUS ich1_det_hist_hor_step_reg;
	ich1_det_hist_hor_step_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_det_Hist_Hor_step_reg);
	ich1_det_hist_hor_step_reg.cp_histhor_det_xstep=array_xstep[0];
	scaler_rtd_outl(MPEGNR_ICH1_det_Hist_Hor_step_reg, ich1_det_hist_hor_step_reg.regValue);

	//========== ICM global saturation ==========
	//scalerVip_ICM_Global_Sat = *(init_value+QUALITY_INIT_ICM_GLOBAL_SAT);
	//ROSPrintf("ooo---scalerVIP_SetICM_Global_Sat=%x ---ooo\n",scalerVip_ICM_Global_Sat);

	//========== dcc table select ==========
	//scalerDrvPrint("DCLlinux");
	//DCC_TABLE_Select = (unsigned char)(*(init_value+QUALITY_INIT_DCC_TABLE));
	//Main_Set_SC=1;//SceneChange
	//ROSPrintf("Main_DCC_TABLE_Select =%d \n",DCC_TABLE_Select);

	//========== dcc style ==========
	//DCC_Style = (unsigned char)(*(init_value+QUALITY_INIT_DCC_STYLE));
	//ROSPrintf("ooo---DCC_Style=%x ---ooo\n",DCC_Style);

	//========== scaler FIR H ==========
	//scalerVip_Scaler_FIR_H = (unsigned char)(*(init_value+QUALITY_INIT_SCALER_FIR_H));
	//ROSPrintf("ooo---scalerVIP_SetScaler_FIR_H=%x ---ooo\n",scalerVip_Scaler_FIR_H);

	//========== scaler FIR V ==========
	//scalerVip_Scaler_FIR_V = (unsigned char)(*(init_value+QUALITY_INIT_SCALER_FIR_V));
	//ROSPrintf("ooo---scalerVIP_SetScaler_FIR_V=%x ---ooo\n",scalerVip_Scaler_FIR_V);

	//========== DNR table ==========
	//DNR_TABLE_SECET = (unsigned char)(*(init_value+QUALITY_INIT_DNRTABLE));
}

void scalerVIP_picmode_init(unsigned long arg)
{

	unsigned int* init_value = (unsigned int*)arg;

	PictureMode = (unsigned char)(*(init_value+PICMODE_INIT_PICTURE_MODE));

	AUTO_NR_style = (unsigned char)(*(init_value+PICMODE_INIT_NR_STYLE));

	scalerVip_mpegNR = (SCALERVIP_MPEGNR)(*(init_value+PICMODE_INIT_MPEGNR));


	scalerDrvPrint("DCLlinux");
}

#ifdef ISR_IS_3DLR_FUNCTIOM_ENABLE
void scalerVIP_is3DLR(void)
{
	if((scalerInfo_getPanelInfo_3DPanelType() == 1) && (scalerInfo_check_is_3dMode() == TRUE) &&
		(VODMA_3D_Check_Is_Idma3dMode() == FALSE))
	{
		if(scalerInfo_getDisp3dInfo_3dType() == HDMI3D_SIDE_BY_SIDE_HALF)
		{
			is3DLRmode = TRUE;
		}
		else if(scalerInfo_getDisp3dInfo_3dType() == HDMI3D_TOP_AND_BOTTOM)
		{
			is3DLRmode = TRUE;
		}
		else if(scalerInfo_getDisp3dInfo_3dType() == HDMI3D_FRAME_PACKING)
		{
			is3DLRmode = FALSE;
		}
		else if(scalerInfo_getDisp3dInfo_3dType() ==HDMI3D_2D_CVT_3D)
		{
			is3DLRmode = FALSE;
		}
		else
		{
			is3DLRmode = FALSE;
		}
	}
	else
	{
		is3DLRmode = FALSE;
	}
}
#endif

void scalerVIP_TV003_MAD_Y(unsigned short *PQA_Input_Level, unsigned short *PQA_Input_rate)
{
	unsigned char count_Y = 8;

	unsigned int mad_y_th1_1[8] = 	{0x004,	0x008,	0x00c,	0x010,	0x014,	0x018,	0x01c,	0x001};
	unsigned int mad_y_th2_1[8] = 	{0x008,	0x00c,	0x010,	0x014,	0x018,	0x01c,	0x7ff,	0x004};
	unsigned int mad_y_th1_2[8] = 	{0x004,	0x008,	0x00c,	0x010,	0x014,	0x018,	0x020,	0x001};
	unsigned int mad_y_th2_2[8] = 	{0x00c,	0x010,	0x014,	0x018,	0x01c,	0x020,	0x7ff,	0x008};

	static unsigned int mad_y_count[8] = {0};
	static unsigned int mad_y_std[8] = {0};

	static unsigned char RTNR_level[8] = {0};

	static unsigned int MAD_count = 0;

	if(RPC_SmartPic_clue->SceneChange)
		return;

	di_im_di_rtnr_mad_y_th_RBUS im_di_rtnr_mad_y_th_reg;
//	di_im_di_rtnr_mad_c_th_RBUS im_di_rtnr_mad_c_th_reg;
	im_di_rtnr_mad_y_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_TH_reg);
//	im_di_rtnr_mad_c_th_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_C_TH_reg);

#if 1
	if(SmartPic_clue->Hist_Y_Mean_Value<15)
	{
		im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = mad_y_th1_1[MAD_count%count_Y];
		im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = mad_y_th2_1[MAD_count%count_Y];
	}
	else if(SmartPic_clue->Hist_Y_Mean_Value<25)
	{
		im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = ((mad_y_th1_2[MAD_count%count_Y]-mad_y_th1_1[MAD_count%count_Y])*(SmartPic_clue->Hist_Y_Mean_Value-15)/(20-15))+mad_y_th1_1[MAD_count%count_Y];
		im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = ((mad_y_th2_2[MAD_count%count_Y]-mad_y_th2_1[MAD_count%count_Y])*(SmartPic_clue->Hist_Y_Mean_Value-15)/(20-15))+mad_y_th2_1[MAD_count%count_Y];
	}
	else
#endif
	{
		im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th1 = mad_y_th1_2[MAD_count%count_Y];
		im_di_rtnr_mad_y_th_reg.cp_temporal_mad_y_th2 = mad_y_th2_2[MAD_count%count_Y];
	}

	rtd_outl(DI_IM_DI_RTNR_MAD_Y_TH_reg, im_di_rtnr_mad_y_th_reg.regValue);
//	rtd_outl(DI_IM_DI_RTNR_MAD_C_TH_reg, im_di_rtnr_mad_c_th_reg.regValue);

	di_im_di_rtnr_mad_y_counter_RBUS im_di_rtnr_mad_y_counter_reg;
	im_di_rtnr_mad_y_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);

//	mad_y_count[MA_print_count%10] = (unsigned int)im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery;

//	mad_y_std[MAD_count%count_Y] = (ABS(im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery, mad_y_count[MAD_count%count_Y])>>7)*(ABS(im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery, mad_y_count[MAD_count%count_Y])>>7);
	mad_y_std[MAD_count%count_Y] = (ABS(im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery, mad_y_count[MAD_count%count_Y]))<<1;
	mad_y_count[MAD_count%count_Y] = (7 * (unsigned int)im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery + 1*mad_y_count[MAD_count%count_Y])>>3;
//	mad_y_std[MA_print_count%count_Y] = (3*((ABS(im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery, mad_y_count[MA_print_count%count_Y])>>4)) + 1*mad_y_std[MA_print_count%count_Y])>>2;


	if(MAD_count%count_Y == 0)
	{

		unsigned char Max_level = 9;

		RTNR_level[0] = ((unsigned short)((mad_y_count[0]*1)/(mad_y_count[7]+1))>Max_level)?Max_level:((unsigned short)((mad_y_count[0]*1)/(mad_y_count[7]+1)));
		RTNR_level[1] = ((unsigned short)((mad_y_count[1]*2)/(mad_y_count[7]+1))>Max_level)?Max_level:((unsigned short)((mad_y_count[1]*2)/(mad_y_count[7]+1)));
		RTNR_level[2] = ((unsigned short)((mad_y_count[2]*3)/(mad_y_count[7]+1))>Max_level)?Max_level:((unsigned short)((mad_y_count[2]*3)/(mad_y_count[7]+1)));
		RTNR_level[3] = ((unsigned short)((mad_y_count[3]*4)/(mad_y_count[7]+1))>Max_level)?Max_level:((unsigned short)((mad_y_count[3]*4)/(mad_y_count[7]+1)));
		RTNR_level[4] = ((unsigned short)((mad_y_count[4]*5)/(mad_y_count[7]+1))>Max_level)?Max_level:((unsigned short)((mad_y_count[4]*5)/(mad_y_count[7]+1)));
		RTNR_level[5] = ((unsigned short)((mad_y_count[5]*6)/(mad_y_count[7]+1))>Max_level)?Max_level:((unsigned short)((mad_y_count[5]*6)/(mad_y_count[7]+1)));
		RTNR_level[6] = ((unsigned short)((mad_y_count[6]*7)/(mad_y_count[7]+1))>Max_level)?Max_level:((unsigned short)((mad_y_count[6]*7)/(mad_y_count[7]+1)));

#if 0
#if 1
		ROSPrintf("a = 	");
		for(i = 0; i< count_Y; i++)
		{
			ROSPrintf("%d,	",mad_y_count[i]);
		}
		ROSPrintf("\n");
		ROSPrintf("b = 	");
		for(i = 0; i< count_Y; i++)
		{
			ROSPrintf("%d,	",mad_y_std[i]);
		}
		ROSPrintf("\n");
#endif
		ROSPrintf("c = 	");
		for(i = 0; i< count_Y; i++)
		{
			//ROSPrintf("%d,	",((unsigned short)(mad_y_count[i]/(mad_y_std[i]+1))));
			ROSPrintf("%d,	",RTNR_level[i]);
		}
		ROSPrintf("\n");
#endif
//		if((mad_y_count_sun!=0) && (mad_y_std_sun!=0))
//			ROSPrintf("b=	%d,		%d,		%d,		%d\n", mad_y_count_sun, mad_y_std_sun, ((mad_y_count_ave)/mad_y_count_sun), ((mad_y_std_ave)/mad_y_std_sun));
	}
	MAD_count++;
	PQA_Input_Level[I_003_RTNR_TH1] = ((unsigned char)PQA_Input_Level[I_003_RTNR_TH1]>RTNR_level[0])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH1]-1):(((unsigned char)PQA_Input_Level[I_003_RTNR_TH1]<RTNR_level[0])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH1]+1):((unsigned char)PQA_Input_Level[I_003_RTNR_TH1]));
	PQA_Input_Level[I_003_RTNR_TH2] = ((unsigned char)PQA_Input_Level[I_003_RTNR_TH2]>RTNR_level[1])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH2]-1):(((unsigned char)PQA_Input_Level[I_003_RTNR_TH2]<RTNR_level[1])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH2]+1):((unsigned char)PQA_Input_Level[I_003_RTNR_TH2]));
	PQA_Input_Level[I_003_RTNR_TH3] = ((unsigned char)PQA_Input_Level[I_003_RTNR_TH3]>RTNR_level[2])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH3]-1):(((unsigned char)PQA_Input_Level[I_003_RTNR_TH3]<RTNR_level[2])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH3]+1):((unsigned char)PQA_Input_Level[I_003_RTNR_TH3]));
	PQA_Input_Level[I_003_RTNR_TH4] = ((unsigned char)PQA_Input_Level[I_003_RTNR_TH4]>RTNR_level[3])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH4]-1):(((unsigned char)PQA_Input_Level[I_003_RTNR_TH4]<RTNR_level[3])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH4]+1):((unsigned char)PQA_Input_Level[I_003_RTNR_TH4]));
	PQA_Input_Level[I_003_RTNR_TH5] = ((unsigned char)PQA_Input_Level[I_003_RTNR_TH5]>RTNR_level[4])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH5]-1):(((unsigned char)PQA_Input_Level[I_003_RTNR_TH5]<RTNR_level[4])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH5]+1):((unsigned char)PQA_Input_Level[I_003_RTNR_TH5]));
	PQA_Input_Level[I_003_RTNR_TH6] = ((unsigned char)PQA_Input_Level[I_003_RTNR_TH6]>RTNR_level[5])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH6]-1):(((unsigned char)PQA_Input_Level[I_003_RTNR_TH6]<RTNR_level[5])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH6]+1):((unsigned char)PQA_Input_Level[I_003_RTNR_TH6]));
	PQA_Input_Level[I_003_RTNR_TH7] = ((unsigned char)PQA_Input_Level[I_003_RTNR_TH7]>RTNR_level[6])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH7]-1):(((unsigned char)PQA_Input_Level[I_003_RTNR_TH7]<RTNR_level[6])?((unsigned char)PQA_Input_Level[I_003_RTNR_TH7]+1):((unsigned char)PQA_Input_Level[I_003_RTNR_TH7]));

	PQA_Input_rate[I_003_RTNR_TH1] = 0;
	PQA_Input_rate[I_003_RTNR_TH2] = 0;
	PQA_Input_rate[I_003_RTNR_TH4] = 0;
	PQA_Input_rate[I_003_RTNR_TH5] = 0;
	PQA_Input_rate[I_003_RTNR_TH6] = 0;
	PQA_Input_rate[I_003_RTNR_TH7] = 0;
}



void scalerVIP_TV003_share_memory_table(unsigned long arg)
{
	ROSPrintf("scalerVIP_TV003_share_memory_table\n");
	TV003_share_memory_struct = (RPC_TV003_Table*)arg;
}


//#######################################################
//--------- NetFlix Smooth toggle Program -----------------------------------
void scalerVIP_NetFlix_smoothtoggle_enable(_RPC_clues* SmartPic_clue,_RPC_system_setting_info* RPC_system_info_structure_table)
{
	//_clues* SmartPic_clue=NULL;
	//_system_setting_info* system_info_structure_table = NULL;
	//SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();
	//system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

 if((RPC_system_info_structure_table->VIP_source >= VIP_QUALITY_PVR_480I) && (RPC_system_info_structure_table->VIP_source <=VIP_QUALITY_PVR_4k2kP_30))	//Netflix
 	RPC_SmartPic_clue->S_NetFlix_info.Netflix_Enable =1;
 else
 	RPC_SmartPic_clue->S_NetFlix_info.Netflix_Enable =0;
}

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT// mark for non-used function in kernel, CSFC 20160728
void scalerVIP_smoothtoggle_init_isr(unsigned char display, unsigned short vo_width, unsigned short vo_height,unsigned short Cap_width, unsigned short Cap_height)
{
	_clues* SmartPic_clue=NULL;
	di_im_di_control_RBUS im_di_control_reg;
	di_im_di_film_new_function_main_RBUS di_im_di_film_new_function_main_reg;
	iedge_smooth_edgesmooth_ex_ctrl_RBUS edgesmooth_ex_ctrl_reg;
	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();
	if (SmartPic_clue == NULL) {
		return;
	}
	//=== 20140704 CSFC for vip video fw infomation ====
	RPC_SmartPic_clue->S_NetFlix_info.Netflix_CapWid = Cap_width;
	RPC_SmartPic_clue->S_NetFlix_info.Netflix_CapLen = Cap_height;
	//====================================

	//init. coef. re-setting by timing
	scalerVIP_hist_init(display, Cap_width, Cap_height);
	scalerVIP_MPEG_BLK_init(display, vo_width, vo_height);
	//frank@0904 change below code to solve 4k2k smooth toggle video fail issue
	if(display == _CHANNEL1){
		edgesmooth_ex_ctrl_reg.regValue = rtd_inl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg);
		if(vo_width <= 2048){
			edgesmooth_ex_ctrl_reg.lbuf_linemode = 2;//11 line spnr
		}else{
			edgesmooth_ex_ctrl_reg.lbuf_linemode = 0;//5 line spnr
		}
		rtd_outl(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg,edgesmooth_ex_ctrl_reg.regValue);
	}
	rtdf_clearBits(DI_IM_DI_HMC_ADJUSTABLE2_reg, (_BIT15));

	di_im_di_film_new_function_main_reg.regValue = rtd_inl(DI_IM_DI_FILM_NEW_FUNCTION_MAIN_reg);
	im_di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
	m_film_isr = im_di_control_reg.film_enable;
	g_fw_film_en = di_im_di_film_new_function_main_reg.fw_film_en;
	im_di_control_reg.film_enable = 0;// write_enable[16]

	/* henry @ mac5 161219 DI write enable bit */
	di_control_reg.write_enable_5 = 1;
	//im_di_control_reg.regValue = im_di_control_reg.regValue | DI_IM_DI_CONTROL_write_enable_5_mask;

	di_im_di_film_new_function_main_reg.fw_film_en = 0;
	rtd_outl(DI_IM_DI_CONTROL_reg, im_di_control_reg.regValue);
	rtd_outl(DI_IM_DI_FILM_NEW_FUNCTION_MAIN_reg, di_im_di_film_new_function_main_reg.regValue);
	m_film_clear_isr = 1;

	//auto function smooth toggle flag
	RPC_SmartPic_clue->S_NetFlix_info.NetFlix_smooth_Toggle_info.hist_init_flag = 1;
	RPC_SmartPic_clue->S_NetFlix_info.NetFlix_smooth_Toggle_info.TimingChange_flag_for_RTNR = 1;
	RPC_SmartPic_clue->S_NetFlix_info.NetFlix_smooth_Toggle_info.MPEG_BLK_init = 1;

	if(DOLBY_V_TOP_TOP_CTL_get_dolby_mode(rtd_inl(DOLBY_V_TOP_TOP_CTL_reg)) != 0)
       {
               scaler_HDR10_set_sta(vo_width, vo_height);
       }
}

void scalerVIP_MPEG_BLK_init(unsigned char channel, unsigned short width, unsigned short height )
{
	if(channel != _CHANNEL1)
		return;

   unsigned short UZD_outH, VGIP_outH;
   unsigned short UZD_outV, VGIP_outV;

   VGIP_outV = height;
   VGIP_outH = width;
   UZD_outV	 = height;
   UZD_outH	 = width;


    //=========mpeg detection registers=================
    //horizotal mpeg detection region
    mpegnr_ich1_hist_blking_hor_range_RBUS ich1_hist_blking_hor_range_reg;
    ich1_hist_blking_hor_range_reg.regValue = rtd_inl(MPEGNR_ICH1_Hist_Blking_Hor_Range_reg);
    ich1_hist_blking_hor_range_reg.cp_histhorstart = 0;//modify, 20120910, mpeg Blking Range start have to set 0.
    ich1_hist_blking_hor_range_reg.cp_histhorend = VGIP_outH;
    rtd_outl(MPEGNR_ICH1_Hist_Blking_Hor_Range_reg, ich1_hist_blking_hor_range_reg.regValue);

    mpegnr_ich1_hist_blking_ver_range_RBUS ich1_hist_blking_ver_range_reg;
    ich1_hist_blking_ver_range_reg.regValue = rtd_inl(MPEGNR_ICH1_Hist_Blking_Ver_Range_reg);
    ich1_hist_blking_ver_range_reg.cp_histverstart = 0;//modify, 20120910, mpeg Blking Range start have to set 0.
    ich1_hist_blking_ver_range_reg.cp_histverend = VGIP_outV;
    rtd_outl(MPEGNR_ICH1_Hist_Blking_Ver_Range_reg, ich1_hist_blking_ver_range_reg.regValue);

	//-------------------------------------------------------------------------------------

    //vertical mpeg detection region
    di_noiseest_hor_range_RBUS noiseest_hor_range_reg;
    noiseest_hor_range_reg.regValue = rtd_inl(DI_NoiseEst_Hor_Range_reg);
    noiseest_hor_range_reg.cp_noiseesthorstart = 0;//modify, 20120910, mpeg Blking Range start have to set 0.
    noiseest_hor_range_reg.cp_noiseesthorend = UZD_outH;
    rtd_outl(DI_NoiseEst_Hor_Range_reg, noiseest_hor_range_reg.regValue);

    di_noiseest_ver_range_RBUS noiseest_ver_range_reg;
    noiseest_ver_range_reg.regValue = rtd_inl(DI_NoiseEst_Ver_Range_reg);
    noiseest_ver_range_reg.cp_noiseestverstart = 0;//modify, 20120910, mpeg Blking Range start have to set 0.
    noiseest_ver_range_reg.cp_noiseestverend = UZD_outV;
    rtd_outl(DI_NoiseEst_Ver_Range_reg, noiseest_ver_range_reg.regValue);

	//MPEG_H&V_his_ENABLE
 	mpegnr_ich1_mpegstart_RBUS ich1_mpegstart_reg;
	di_mpeg_hist_blking_RBUS mpeg_hist_blking_reg;

	ich1_mpegstart_reg.regValue = rtd_inl(MPEGNR_ICH1_MPEGStart_reg);
	mpeg_hist_blking_reg.regValue = rtd_inl(DI_Mpeg_Hist_Blking_reg);

	ich1_mpegstart_reg.cp_histhoren= 1;//histogram hosrizotal enable
	mpeg_hist_blking_reg.cp_histveren= 1;//histogram vertical enable

	rtd_outl(MPEGNR_ICH1_MPEGStart_reg, ich1_mpegstart_reg.regValue);
	rtd_outl(DI_Mpeg_Hist_Blking_reg, mpeg_hist_blking_reg.regValue);

//-------------------------------------------------------------------------------------

}


void scalerVIP_hist_init(unsigned char display, unsigned short width, unsigned short height)
{
	_RPC_system_setting_info* RPC_system_info_structure_table = NULL;
	RPC_system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

	if((RPC_system_info_structure_table == NULL))
	{
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR,system_info = %x, \n", RPC_system_info_structure_table);
		return;
	}

//	ROSPrintf("scalerVIP_hist_init	%d	%d\n",width,height);
//	ROSPrintf("scalerVIP_hist_init	%d	%d\n",width,height);
//	ROSPrintf("scalerVIP_hist_init	%d	%d\n",width,height);

	histogram_ich1_hist_in_cselect_RBUS ich1_hist_in_cselect_Reg;
	histogram_ich1_hist_in_range_hor_RBUS ich1_hist_in_range_hor_Reg;
	histogram_ich1_hist_in_range_ver_RBUS ich1_hist_in_range_ver_Reg;
#ifdef VIP_CONFIG_DUAL_CHANNEL
	histogram_ich2_hist_in_cselect_RBUS ich2_hist_in_cselect_Reg;
	histogram_ich2_hist_in_range_hor_RBUS ich2_hist_in_range_hor_Reg;
	histogram_ich2_hist_in_range_ver_RBUS ich2_hist_in_range_ver_Reg;

#endif

//	unsigned short ret;
	unsigned char shift_bits = 0;
	unsigned int total_pixel = 0;
	static unsigned int Main_total_pixel = 0;
#ifdef VIP_CONFIG_DUAL_CHANNEL
	static unsigned int Sub_total_pixel = 0;
#endif

	if (display == SLR_MAIN_DISPLAY)
	{
		ich1_hist_in_cselect_Reg.regValue = rtd_inl(HISTOGRAM_ICH1_Hist_IN_CSELECT_reg);
		ich1_hist_in_cselect_Reg.ch1_his_enable_histog = 0;

		//20120816 fix 3d en DCR
//		if(Scaler_Disp3dGetInfo(SLR_DISP_3D_3DTYPE)==SLR_3D_FRAMESEQUENCE)
//		{
//			VIPprintf("fwif_color_hist_init,3d_en\n");
//			ich1_hist_in_cselect_Reg.ch1_3d_en = 1;
//		}
//		else
			ich1_hist_in_cselect_Reg.ch1_3d_en = 0;
		//~20120816 fix 3d en DCR
		rtd_outl(HISTOGRAM_ICH1_Hist_IN_CSELECT_reg, ich1_hist_in_cselect_Reg.regValue);

		Main_total_pixel = (width*height) + 1;
		total_pixel = Main_total_pixel;
		//VIPprintf("\n$$$$[DCC] width=%d, height=%d,total_pixel=%d\n",width,height,total_pixel);

		if (total_pixel <= 0x10000) // (2^16)
			shift_bits = 0;
		else if (total_pixel > 0x10000 && total_pixel <= 0x20000)//(2^16) ~ (2^17)
			shift_bits = 0;
		else if (total_pixel > 0x20000 && total_pixel <= 0x40000)// (2^17) ~ (2^18)
			shift_bits = 1;
		else if (total_pixel > 0x40000 && total_pixel <= 0x80000)// (2^18) ~ (2^19)
			shift_bits = 2;
		else if (total_pixel > 0x80000 && total_pixel <= 0x100000)// (2^19) ~ (2^20)
			shift_bits = 3;
		else if (total_pixel > 0x100000 && total_pixel <= 0x200000)// (2^20) ~ (2^21)
			shift_bits = 4;
		else if (total_pixel > 0x200000 && total_pixel <= 0x400000)// (2^21) ~ (2^22)
			shift_bits = 5;
		else if ((total_pixel > 0x400000 && total_pixel <= 0x800000))// (2^22) ~ (2^23)
			shift_bits = 6;
		else
			shift_bits = 7;

		//=== 20140512 CSFC for vip video fw infomation ====
		RPC_system_info_structure_table->DCC_hist_shift_bit = shift_bits;
		//====================================

		/* Leo Chen, 20100809, added for dark_area_AutoNR */
/*
		Main_total_pixel_inv = (1<<24)/ ((Main_total_pixel>>shift_bits)+1);

		if (0 != (ret = vip_SendRPC(SCALERIOC_MAIN_TOTAL_PIXEL_INV, Main_total_pixel_inv, RPC_SEND_VALUE_ONLY)))
		{
			printf("ret=%d, set SCALERIOC_MAIN_TOTAL_PIXEL_INV to driver fail !!!\n", ret);
		}
*/

		//VIPprintf("Main_total_pixel_inv = %d",Main_total_pixel_inv); //Leo test
		//VIPprintf("ret = %d",ret); //Leo test


		// Histogram init
		ich1_hist_in_range_hor_Reg.regValue = rtd_inl(HISTOGRAM_ICH1_Hist_IN_Range_Hor_reg);
		ich1_hist_in_range_hor_Reg.ch1_his_horend = width-1;
		ich1_hist_in_range_hor_Reg.ch1_his_horstart = 0;
		rtd_outl(HISTOGRAM_ICH1_Hist_IN_Range_Hor_reg, ich1_hist_in_range_hor_Reg.regValue);
		ich1_hist_in_range_ver_Reg.regValue = rtd_inl(HISTOGRAM_ICH1_Hist_IN_Range_Ver_reg);
		ich1_hist_in_range_ver_Reg.ch1_his_verend = height-1;
		ich1_hist_in_range_ver_Reg.ch1_his_verstart = 0;
		rtd_outl(HISTOGRAM_ICH1_Hist_IN_Range_Ver_reg, ich1_hist_in_range_ver_Reg.regValue);
		ich1_hist_in_cselect_Reg.regValue = rtd_inl(HISTOGRAM_ICH1_Hist_IN_CSELECT_reg);
	   	ich1_hist_in_cselect_Reg.ch1_his_even_odd_pos_sel = 0;//after scale down
		ich1_hist_in_cselect_Reg.ch1_his_shift_sel = shift_bits;
		ich1_hist_in_cselect_Reg.ch1_his_mode_sel = 1;
		ich1_hist_in_cselect_Reg.ch1_his_num_flds = 0;
		ich1_hist_in_cselect_Reg.ch1_his_enable_histog = 1;
		rtd_outl(HISTOGRAM_ICH1_Hist_IN_CSELECT_reg, ich1_hist_in_cselect_Reg.regValue);
		//o-------------------------------------------------------------------------o
	}
#ifdef VIP_CONFIG_DUAL_CHANNEL
	else
	{
		ich2_hist_in_cselect_Reg.regValue = rtd_inl(HISTOGRAM_ICH2_Hist_IN_CSELECT_reg);
		ich2_hist_in_cselect_Reg.ch2_his_enable_histog = 0;
		rtd_outl(HISTOGRAM_ICH2_Hist_IN_CSELECT_reg, ich2_hist_in_cselect_Reg.regValue);

		Sub_total_pixel = width*height;
		total_pixel = Sub_total_pixel;

		if (total_pixel <= 0x10000)
			shift_bits = 0;
		else if (total_pixel > 0x10000 && total_pixel <= 0x20000)
			shift_bits = 1;
		else if (total_pixel > 0x20000 && total_pixel <= 0x40000)
			shift_bits = 2;
		else if (total_pixel > 0x40000 && total_pixel <= 0x80000)
			shift_bits = 3;
		else if (total_pixel > 0x80000 && total_pixel <= 0x100000)
			shift_bits = 4;
		else
			shift_bits = 5;

		// Histogram init
		ich2_hist_in_range_hor_Reg.regValue = rtd_inl(HISTOGRAM_ICH2_Hist_IN_Range_Hor_reg);
		ich2_hist_in_range_hor_Reg.ch2_his_horend = width-1;
		ich2_hist_in_range_hor_Reg.ch2_his_horstart = 0;
		rtd_outl(HISTOGRAM_ICH2_Hist_IN_Range_Hor_reg, ich2_hist_in_range_hor_Reg.regValue);
		ich2_hist_in_range_ver_Reg.regValue = rtd_inl(HISTOGRAM_ICH2_Hist_IN_Range_Ver_reg);
		ich2_hist_in_range_ver_Reg.ch2_his_verend = height-1;
		ich2_hist_in_range_ver_Reg.ch2_his_verstart = 0;
		rtd_outl(HISTOGRAM_ICH2_Hist_IN_Range_Ver_reg, ich2_hist_in_range_ver_Reg.regValue);
		ich2_hist_in_cselect_Reg.regValue = rtd_inl(HISTOGRAM_ICH2_Hist_IN_CSELECT_reg);
	   	ich2_hist_in_cselect_Reg.ch2_his_even_odd_pos_sel = 0;//after scale down
		ich2_hist_in_cselect_Reg.ch2_his_shift_sel = shift_bits;
		ich2_hist_in_cselect_Reg.ch2_his_mode_sel = 1;
		ich2_hist_in_cselect_Reg.ch2_his_num_flds = 0;
		ich2_hist_in_cselect_Reg.ch2_his_enable_histog = 1;
		rtd_outl(HISTOGRAM_ICH2_Hist_IN_CSELECT_reg, ich2_hist_in_cselect_Reg.regValue);
	}
#endif

}
#endif

unsigned char scalerVIP_CheckRegisterAccessProtect(unsigned int regAddr)
{
	#define REG_BLOCK_VD 0xb8019000
	#define REG_BLOCK_MASK 0xfffff000
	//VD register
	if (((Scaler_InputSrcGetMainChFrom() != _SRC_FROM_VDC) || !vd_pwr_ok) && ((regAddr&REG_BLOCK_MASK)==REG_BLOCK_VD))
		return false;
	else
		return true;
}

#ifdef ISR_TV002_BRIGHTNESS_PLUS_FUNCTION_ENABLE
// for TV002 Brighness plus
unsigned short scalerVIP_Brightness_Plus_Cal_OverSat_Protect_Gain(unsigned short BP_Gain, unsigned char Max_Bright_bin, SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem, _clues* SmartPic_clue)
{
	unsigned int boundary = 235; // 16-235
	unsigned char weightMax=8, weightMax_bit=3;

	if(vipCustomTBL_ShareMem==NULL)
	{
		if(MA_print_count%250==0)
			ROSPrintf("Customer TBL is NULL, return\n");
		return BP_Gain;
	}

	unsigned short table_sel = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.BP_TBL_Select;
	unsigned short tol = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Gain_Limit.OverSat_Tol;
	unsigned short th = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Gain_Limit.OverSat_Th;
	unsigned short stepBit = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Gain_Limit.OverSat_StepBit;
	unsigned short BP_En = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Enable;
	unsigned short en = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Gain_Limit.Enable;
	unsigned short shiftBit = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.BP_Shift_Bit;

	unsigned int Gain_Value = BP_Gain;
	unsigned int Final_LimitGain = Gain_Value;
	unsigned int allowedY, allowedGain, tmp;
	unsigned short weight=0, i=0;
	unsigned short bin_ignore_th = th;
	unsigned short debug_Log = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log;
	unsigned short debug_Log_delay = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log_Delay;
	unsigned int *Y_hist_ratio = SmartPic_clue->Y_Main_Hist_Ratio;

	if(debug_Log_delay==0)
		debug_Log_delay=1;

	if(en==0 || Gain_Value<=di_pow(2, shiftBit) || BP_En==0)
		return BP_Gain;

	allowedY = (boundary*tol)>>shiftBit;

	for(i=0;i<(Max_Bright_bin);i++)
	{
		tmp = (Max_Bright_bin-i)*8-1;
		if(allowedY<=tmp)
			allowedGain=di_pow(2, shiftBit);
		else
			allowedGain = (allowedY<<shiftBit)/tmp;

		if(allowedGain>=Gain_Value)
			tmp = Gain_Value;
		else
		{

			if((Y_hist_ratio[Max_Bright_bin-i-1])>=bin_ignore_th)
				weight = 0;
			else if(stepBit>=10) // No Blending
				weight = weightMax;
			else
			{
				weight = (bin_ignore_th - (Y_hist_ratio[Max_Bright_bin-i-1])+((1<<stepBit)-1))>>stepBit;
				if(weight > weightMax)
					weight = weightMax;
			}
			tmp = (allowedGain*(weightMax - weight) + Gain_Value * weight)>>weightMax_bit;
		}
		//select min gain
		if(tmp<Final_LimitGain)
			Final_LimitGain = tmp;

		if((debug_Log&_BIT2)!=0)
		{
			if(MA_print_count%debug_Log_delay==0)
				ROSPrintf("=%d,%d,%d,%d,%d=\n",allowedGain, tmp, Final_LimitGain, weight, Gain_Value);
		}
	}


	if((debug_Log&_BIT1)!=0)
	{
		if(MA_print_count%debug_Log_delay==0)
			ROSPrintf("LC=%d,FC=%d\n",allowedY,Final_LimitGain);
	}

	return Final_LimitGain;
}

unsigned short scalerVIP_Brightness_Plus_Smooth_Gain_Cal(unsigned short BP_Gain, SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem)
{
	if(vipCustomTBL_ShareMem==NULL)
	{
		if(MA_print_count%250==0)
			ROSPrintf("Customer TBL is NULL, return\n");
		return BP_Gain;
	}

	unsigned short table_sel = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.BP_TBL_Select;
	unsigned short ini = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Init_Flag;
	unsigned short step = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Step;
	unsigned short delayF = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Delay_Flame;
	unsigned short Enable = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Enable;
	static unsigned short pre_Gain = 0;
	static unsigned short counter=0;
	unsigned short debug_Log = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log;
	unsigned short debug_Log_delay = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log_Delay;
	unsigned short BP_En = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Enable;

	if(debug_Log_delay==0)
		debug_Log_delay=1;

	if(step==0 || Enable==0 || BP_En==0)
		return BP_Gain;

	// bit0 for BP gain initialize, bit1 for offset initialize
	if(((ini&_BIT0)>>0)==1)
	{
		ini = ini&(~_BIT0);
		vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Init_Flag=ini;
		pre_Gain = BP_Gain;
		counter = 0;
		return BP_Gain;
	}

	if(counter > delayF)
	{
		if(BP_Gain>(pre_Gain+step))
			pre_Gain = pre_Gain + step;
		else if(BP_Gain<(pre_Gain-step))
			pre_Gain = pre_Gain - step;
		else
			pre_Gain = BP_Gain;
		counter = 0;

		//bit4 for smooth log
		if((debug_Log&_BIT4)!=0)
		{
			if(MA_print_count%debug_Log_delay==0)
				ROSPrintf("s=%d,%d\n",pre_Gain, BP_Gain);
		}
	}
	counter++;
	return pre_Gain;
}

short scalerVIP_Brightness_Plus_Smooth_Offset_Cal(short RGB_Offset, SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem)
{
	if(vipCustomTBL_ShareMem==NULL)
	{
		if(MA_print_count%250==0)
			ROSPrintf("Customer TBL is NULL, return\n");
		return RGB_Offset;
	}

	unsigned short table_sel = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.BP_TBL_Select;
	unsigned short ini = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Init_Flag;
	unsigned short step = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Step_offset;
	unsigned short delayF = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Delay_Flame_offset;
	unsigned short Enable = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Enable;
	static short pre_offset = 0;
	static unsigned short counter=0;
	//short pre_offset_tmp=0;
	unsigned short debug_Log = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log;
	unsigned short debug_Log_delay = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log_Delay;
	unsigned short BP_En = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Enable;

	if(debug_Log_delay==0)
		debug_Log_delay=1;

	if(step==0 || Enable==0 || BP_En==0)
		return RGB_Offset;

	// bit0 for BP gain initialize, bit1 for offset initialize
	if(((ini&_BIT1)>>1)==1)
	{
		ini = ini&(~_BIT1);
		vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Init_Flag=ini;
		pre_offset = RGB_Offset;
		counter = 0;
		return RGB_Offset;
	}

	if(counter > delayF)
	{
		if(RGB_Offset>(pre_offset+step))
			pre_offset = pre_offset + step;
		else if(RGB_Offset<(pre_offset-step))
			pre_offset = pre_offset - step;
		else
			pre_offset = RGB_Offset;
		counter = 0;

		//bit5 for smooth log
		if((debug_Log&_BIT5)!=0)
		{
			if(MA_print_count%debug_Log_delay==0)
				ROSPrintf("o=%d,%d\n",pre_offset, RGB_Offset);
		}
	}
	counter++;
	return pre_offset;
}


short scalerVIP_Brightness_Plus_Compensation_RGB_Offset_Cal(unsigned short BP_Gain, unsigned short APL, SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem, _system_setting_info* sysInfo_TBL)
{
	if(vipCustomTBL_ShareMem==NULL)
	{
		if(MA_print_count%250==0)
			ROSPrintf("Customer TBL is NULL, return\n");
		return 0;
	}

	unsigned short table_sel = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.BP_TBL_Select;
	unsigned short BP_En = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Enable;
	unsigned short en = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Enable;
	//unsigned char APL = Scaler_GetAutoMA(BP_APL);
	unsigned short debug_Log = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log;
	unsigned short debug_Log_delay = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log_Delay;
	unsigned short offset_Gain;
	unsigned short G1=0;
	unsigned short G2=0;
	unsigned short P1=0;
	unsigned short P2=0;
	short cmps=0;
	unsigned short shiftBit = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.BP_Shift_Bit;
	unsigned short i;

	if(debug_Log_delay==0)
		debug_Log_delay=1;

	vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Point[BP_SEG_0] = 0;  // fix as o
	vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Point[BP_SEG_MAX-1] = 255;	// fix as 255;

	// turn 0ff all sub function while BP is off
	if(BP_En==0)
		en=0;

	cmps=0;
	if(en==1)
	{
		if(APL==vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Point[BP_SEG_0])
			offset_Gain = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Gain[BP_SEG_0];
		else if(APL==vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Point[BP_SEG_MAX-1])
			offset_Gain = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Gain[BP_SEG_MAX-1];
		else
		{
			for(i=BP_SEG_1; i<BP_SEG_MAX; i++)
			{
				if(APL<=vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Point[i])
				{
					P1 = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Point[i-1];
					P2 = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Point[i];
					G1 = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Gain[i-1];
					G2 = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Cmps_Gain[i];
					break;
				}
			}
			if(P2==P1)
				offset_Gain = G1;
			else
				offset_Gain = G1 + ((G2-G1) * (APL-P1) / (P2-P1));
		}

		// negative error
		if(offset_Gain>1024)
			offset_Gain=0;

		// for precision issue and YUV2RGB out is 14 bit, using 14 bit(1024-15040) to calculate compensation instead of 8 bit(16-235)
		cmps = 1024-((1024*BP_Gain)>>shiftBit); // BP_Gain and offset_Gain is multiply by shiftBit
		cmps = (cmps*offset_Gain)>>shiftBit;
		// debug
		if((debug_Log&_BIT3)!=0)
		{
			if(MA_print_count%debug_Log_delay==0)
			{
				ROSPrintf("BP_CMPs=G1=%d,G2=%d,P1=%d,P2=%d,G=%d,", G1, G2, P1, P2, offset_Gain);
				ROSPrintf("cmps=%d,BP_Gain=%d\n", cmps, BP_Gain);
			}
		}
	}
	return cmps;
}

void scalerVIP_Brightness_Plus_Function(SLR_VIP_TABLE* vipTBL_shareMem, _clues* SmartPic_clue, _system_setting_info* sysInfo_TBL, SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem)
{
	if(vipTBL_shareMem==NULL || SmartPic_clue==NULL || sysInfo_TBL==NULL || vipCustomTBL_ShareMem==NULL)
	{
		if(MA_print_count%250==0)
		{
			ROSPrintf("Mem Null, return, VIP TBL=%x, smartPic=%x, sysInfo=%x, VIP_cus=%x\n",
				vipTBL_shareMem, SmartPic_clue, sysInfo_TBL, vipCustomTBL_ShareMem);
		}
	}

	if(vipCustomTBL_ShareMem==NULL)
	{
		if(MA_print_count%250==0)
			ROSPrintf("Customer TBL is NULL, return\n");
		return;
	}

	unsigned char i = 0;
	unsigned char APL = 0;
//	unsigned char cur_Gain_Value = 100;
	unsigned short G1 = 0; // Scaler_GetAutoMA(BP_G1);
	unsigned short G2 = 0; // Scaler_GetAutoMA(BP_G2);
	unsigned short P1 = 0; // Scaler_GetAutoMA(BP_P1);
	unsigned short P2 = 0; // Scaler_GetAutoMA(BP_P2);
	unsigned short tmp;
	unsigned char Max_Bright_bin= 32;
	unsigned int Gain_Value = 128;
	unsigned int DC_average = 0;
	unsigned int Total_HistCnt = 0;
	unsigned char debug_Log = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log;
	unsigned char debug_Log_delay = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Log_Delay;
	short RGB_offset_cmps;
	unsigned int *reg_HistCnt = SmartPic_clue->Y_Main_Hist;
	unsigned char Debug_EN = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Enable;
	unsigned char shiftBit = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.BP_Shift_Bit;
	unsigned char table_sel = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.BP_TBL_Select;
	DRV_VIP_YUV2RGB_CSMatrix drv_vipCSMatrix_t;
	unsigned char BP_En = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Enable;
	short k11,k12,k13,k22,k23,k32,k33;

	short R,G,B;

	if(debug_Log_delay==0)
		debug_Log_delay=1;

	for(i=0;i<(Max_Bright_bin);i++)
	{
		DC_average+= reg_HistCnt[i]*( i*8);
		Total_HistCnt+= reg_HistCnt[i];
	}

	if(Total_HistCnt == 0 || Max_Bright_bin == 0)
		return;

	APL = ((DC_average/Total_HistCnt)<<5)/(Max_Bright_bin);

	vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.APL = APL;
	if(Debug_EN == 1)
		APL = vipCustomTBL_ShareMem->BP_Function.BP_Ctrl.Debug_Items.Debug_APL;

	// mode 1 fix p1=0, p5=255
	vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Point[BP_SEG_0] = 0;
	vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Point[BP_SEG_MAX-1] = 255;

	if(BP_En==1)
	{
		if(APL==vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Point[BP_SEG_0])
			Gain_Value = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Gain[BP_SEG_0];
		else if(APL==vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Point[BP_SEG_MAX-1])
			Gain_Value = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Gain[BP_SEG_MAX-1];
		else
		{
			for(i=BP_SEG_1; i<BP_SEG_MAX; i++)
			{
				if(APL<=vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Point[i])
				{
					P1 = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Point[i-1];
					P2 = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Point[i];
					G1 = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Gain[i-1];
					G2 = vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].BP_Gain_Point.Gain[i];
					break;
				}
			}
			if(P2==P1)
				Gain_Value = G1;
			else
				Gain_Value = G1 + ((G2-G1) * (APL-P1) / (P2-P1));
		}
	}
	else
	{
		Gain_Value = di_pow(2, shiftBit);
		//turn off all sub function
		//vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Bri_Cmps.Enable=0;
		//vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Gain_Limit.Enable=0;
		//vipCustomTBL_ShareMem->BP_Function.BP_Table[table_sel].Smooth_Change.Enable=0;
	}

	if((debug_Log&_BIT0)!=0)
	{
		if(MA_print_count%debug_Log_delay==0)
		{
			tmp = (P1==P2)?1:(P2-P1);
			ROSPrintf("BP_mode1=G1=%d,G2=%d,P1=%d,P2=%d,G=%d, test=%d,%d, APL=%d, i=%d\n",
				G1, G2, P1, P2, Gain_Value, ((G2-G1) * (APL-P1) / tmp), ((G1-G2) * (APL-P1) / tmp), APL, i);
		}
	}
	// negative error
	if(Gain_Value>di_pow(2, (shiftBit+2)))
		Gain_Value=0;

	// avoid over saturate
	Gain_Value =  scalerVIP_Brightness_Plus_Cal_OverSat_Protect_Gain(Gain_Value, Max_Bright_bin, vipCustomTBL_ShareMem, SmartPic_clue);

	// compensation
	RGB_offset_cmps = scalerVIP_Brightness_Plus_Compensation_RGB_Offset_Cal(Gain_Value, APL, vipCustomTBL_ShareMem, sysInfo_TBL);

	// BP gain smooth
	Gain_Value = scalerVIP_Brightness_Plus_Smooth_Gain_Cal(Gain_Value, vipCustomTBL_ShareMem);

	// offset smooth
	RGB_offset_cmps = scalerVIP_Brightness_Plus_Smooth_Offset_Cal(RGB_offset_cmps, vipCustomTBL_ShareMem);

	for(i=0;i<VIP_YUV2RGB_Y_Seg_Max;i++)
	{
		k11 = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.COEF_By_Y.K11[i];
		k12 = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.COEF_By_Y.K12[i];
		k13 = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.COEF_By_Y.K13[i];
		k22 = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.COEF_By_Y.K22[i];
		k23 = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.COEF_By_Y.K23[i];
		k32 = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.COEF_By_Y.K32[i];
		k33 = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.COEF_By_Y.K33[i];

		if(k11>0x3FF)
			k11 = complement2(k11);	//neg

		if(k12>0x3FF)
			k12 = complement2(k12);	//neg

		if(k13>0x3FF)
			k13 = complement2(k13);	//neg

		if(k22>0x3FF)
			k22 = complement2(k22);	//neg

		if(k23>0x3FF)
			k23 = complement2(k23);	//neg

		if(k32>0x3FF)
			k32 = complement2(k32);	//neg

		if(k33>0x3FF)
			k33 = complement2(k33);	//neg

		drv_vipCSMatrix_t.COEF_By_Y.K11[i] = (k11*Gain_Value)>>shiftBit;
		drv_vipCSMatrix_t.COEF_By_Y.K12[i] = (k12*Gain_Value)>>shiftBit;
		drv_vipCSMatrix_t.COEF_By_Y.K13[i] = (k13*Gain_Value)>>shiftBit;
		drv_vipCSMatrix_t.COEF_By_Y.K22[i] = (k22*Gain_Value)>>shiftBit;
		drv_vipCSMatrix_t.COEF_By_Y.K23[i] = (k23*Gain_Value)>>shiftBit;
		drv_vipCSMatrix_t.COEF_By_Y.K32[i] = (k32*Gain_Value)>>shiftBit;
		drv_vipCSMatrix_t.COEF_By_Y.K33[i] = (k33*Gain_Value)>>shiftBit;
	}

	R = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.RGB_Offset.R_offset;
	G = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.RGB_Offset.G_offset;
	B = sysInfo_TBL->using_YUV2RGB_Matrix_Info.YUV2RGB_CSMatrix.RGB_Offset.B_offset;

	//negative
	if(R>0xFFFF)
		R = complement2(R);
	if(G>0xFFFF)
		G = complement2(G);
	if(B>0xFFFF)
		B = complement2(B);

	R = R + RGB_offset_cmps;
	B = B + RGB_offset_cmps;
	G = G + RGB_offset_cmps;

	drv_vipCSMatrix_t.RGB_Offset.R_offset = R;
	drv_vipCSMatrix_t.RGB_Offset.G_offset = G;
	drv_vipCSMatrix_t.RGB_Offset.B_offset = B;

	drvif_color_set_BrightnessPlus_YUV2RGB_CSMatrix(&drv_vipCSMatrix_t);

}

void drvif_color_set_BrightnessPlus_YUV2RGB_CSMatrix(DRV_VIP_YUV2RGB_CSMatrix *ptr)
{
	unsigned char i;
	unsigned short buffer_status_count, buffer_status_count_th=300;
	yuv2rgb_d_yuv2rgb_control_1_RBUS d_yuv2rgb_control_1_reg;
	yuv2rgb_d_yuv2rgb_tab1_data_0_RBUS yuv2rgb_d_yuv2rgb_tab1_data_0_REG;
	yuv2rgb_d_yuv2rgb_tab1_data_1_RBUS yuv2rgb_d_yuv2rgb_tab1_data_1_REG;
	yuv2rgb_d_yuv2rgb_tab1_data_2_RBUS yuv2rgb_d_yuv2rgb_tab1_data_2_REG;
	yuv2rgb_d_yuv2rgb_tab1_data_3_RBUS yuv2rgb_d_yuv2rgb_tab1_data_3_REG;
	yuv2rgb_d_yuv2rgb_tab1_data_4_RBUS yuv2rgb_d_yuv2rgb_tab1_data_4_REG;
	yuv2rgb_d_yuv2rgb_tab1_data_5_RBUS yuv2rgb_d_yuv2rgb_tab1_data_5_REG;
	yuv2rgb_d_yuv2rgb_tab1_data_6_RBUS yuv2rgb_d_yuv2rgb_tab1_data_6_REG;

	d_yuv2rgb_control_1_reg.regValue = rtd_inl(YUV2RGB_D_YUV2RGB_Control_1_reg);
	d_yuv2rgb_control_1_reg.yuv2rgb_db_en=1;
	d_yuv2rgb_control_1_reg.yuv2rgb_db_read_level = 1;
	rtd_outl(YUV2RGB_D_YUV2RGB_Control_1_reg, d_yuv2rgb_control_1_reg.regValue);

	buffer_status_count = buffer_status_count_th;

	for(i=0;i<VIP_YUV2RGB_Y_Seg_Max;i++)
	{
		yuv2rgb_d_yuv2rgb_tab1_data_0_REG.k11 = ptr->COEF_By_Y.K11[i];
		yuv2rgb_d_yuv2rgb_tab1_data_0_REG.k12 = ptr->COEF_By_Y.K12[i];
		yuv2rgb_d_yuv2rgb_tab1_data_1_REG.k13 = ptr->COEF_By_Y.K13[i];
		yuv2rgb_d_yuv2rgb_tab1_data_2_REG.k22 = ptr->COEF_By_Y.K22[i];
		yuv2rgb_d_yuv2rgb_tab1_data_2_REG.k23 = ptr->COEF_By_Y.K23[i];
		yuv2rgb_d_yuv2rgb_tab1_data_3_REG.k32 = ptr->COEF_By_Y.K32[i];
		yuv2rgb_d_yuv2rgb_tab1_data_3_REG.k33 = ptr->COEF_By_Y.K33[i];


		if(i==VIP_YUV2RGB_Y_Seg_0)
		{
			rtd_outl(YUV2RGB_D_YUV2RGB_Tab1_Data_0_reg, yuv2rgb_d_yuv2rgb_tab1_data_0_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGB_Tab1_Data_1_reg, yuv2rgb_d_yuv2rgb_tab1_data_1_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGB_Tab1_Data_2_reg, yuv2rgb_d_yuv2rgb_tab1_data_2_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGB_Tab1_Data_3_reg, yuv2rgb_d_yuv2rgb_tab1_data_3_REG.regValue);

		}
		else if(i<=VIP_YUV2RGB_Y_Seg_3)
		{
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_1_0_reg+((i-1)*4*4), yuv2rgb_d_yuv2rgb_tab1_data_0_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_1_1_reg+((i-1)*4*4), yuv2rgb_d_yuv2rgb_tab1_data_1_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_1_2_reg+((i-1)*4*4), yuv2rgb_d_yuv2rgb_tab1_data_2_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_1_3_reg+((i-1)*4*4), yuv2rgb_d_yuv2rgb_tab1_data_3_REG.regValue);
		}
		else if(i==VIP_YUV2RGB_Y_Seg_4)
		{
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_4_0_reg, yuv2rgb_d_yuv2rgb_tab1_data_0_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_4_1_reg, yuv2rgb_d_yuv2rgb_tab1_data_1_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_4_2_reg, yuv2rgb_d_yuv2rgb_tab1_data_2_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_4_3_reg, yuv2rgb_d_yuv2rgb_tab1_data_3_REG.regValue);
		}
		else
		{
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_5_0_reg+((i-5)*4*4), yuv2rgb_d_yuv2rgb_tab1_data_0_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_5_1_reg+((i-5)*4*4), yuv2rgb_d_yuv2rgb_tab1_data_1_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_5_2_reg+((i-5)*4*4), yuv2rgb_d_yuv2rgb_tab1_data_2_REG.regValue);
			rtd_outl(YUV2RGB_D_YUV2RGBBYY_Tab_Data_5_3_reg+((i-5)*4*4), yuv2rgb_d_yuv2rgb_tab1_data_3_REG.regValue);
		}
	}

	yuv2rgb_d_yuv2rgb_tab1_data_4_REG.roffset = ptr->RGB_Offset.R_offset;
	yuv2rgb_d_yuv2rgb_tab1_data_5_REG.goffset = ptr->RGB_Offset.G_offset;
	yuv2rgb_d_yuv2rgb_tab1_data_6_REG.boffset = ptr->RGB_Offset.B_offset;
	rtd_outl(YUV2RGB_D_YUV2RGB_Tab1_Data_4_reg, yuv2rgb_d_yuv2rgb_tab1_data_4_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGB_Tab1_Data_5_reg, yuv2rgb_d_yuv2rgb_tab1_data_5_REG.regValue);
	rtd_outl(YUV2RGB_D_YUV2RGB_Tab1_Data_6_reg, yuv2rgb_d_yuv2rgb_tab1_data_6_REG.regValue);

	buffer_status_count=0;
	// double buffer check,
	if(buffer_status_count==0)
	{
		d_yuv2rgb_control_1_reg.yuv2rgb_db_apply = 1;  // 20100811, double buffer en , csfanchiang
		rtd_outl(YUV2RGB_D_YUV2RGB_Control_1_reg, d_yuv2rgb_control_1_reg.regValue);
		do{// check double buffer status complete
			d_yuv2rgb_control_1_reg.regValue	 = rtd_inl(YUV2RGB_D_YUV2RGB_Control_1_reg);
			buffer_status_count++;
		}while(d_yuv2rgb_control_1_reg.yuv2rgb_db_apply!=0 && buffer_status_count<buffer_status_count_th);
	}

}

unsigned short scalerVIP_DBC_get_Mean_and_Peak_Value_in_SmartFit_TV002(SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem, _system_setting_info* system_info_structure_table)
{
	//=======================use smartfit to get mean value 20121228=====================
	unsigned short Hstart = 0;
	unsigned short Hend = 0;
	unsigned short Vstart = 0;
	unsigned short Vend = 0;

	vgip_vgip_chn1_act_hsta_width_RBUS vgip_chn1_act_hsta_width_reg;
	vgip_vgip_chn1_act_vsta_length_RBUS vgip_chn1_act_vsta_length_reg;

	//find the input position start &end
	vgip_chn1_act_hsta_width_reg.regValue  = rtd_inl(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg);
	vgip_chn1_act_vsta_length_reg.regValue = rtd_inl(VGIP_VGIP_CHN1_ACT_VSTA_Length_reg);

	Hstart = vgip_chn1_act_hsta_width_reg.ch1_ih_act_sta;
	Hend = vgip_chn1_act_hsta_width_reg.ch1_ih_act_wid;
	Vstart = vgip_chn1_act_vsta_length_reg.ch1_iv_act_sta;
	Vend = vgip_chn1_act_vsta_length_reg.ch1_iv_act_len;

	//unsigned short Hstart=500,Hend=10,Vstart=10,Vend=10;
	smartfit_auto_h_boundary_RBUS auto_h_boundary_reg;
	smartfit_auto_v_boundary_RBUS auto_v_boundary_reg;
	smartfit_auto_r_g_b_margin_RBUS auto_r_g_b_margin_reg;
	smartfit_auto_adj_RBUS auto_adj_reg;
	auto_h_boundary_reg.regValue	 = rtd_inl(SMARTFIT_AUTO_H_BOUNDARY_reg);
	auto_v_boundary_reg.regValue	 = rtd_inl(SMARTFIT_AUTO_V_BOUNDARY_reg);
	auto_r_g_b_margin_reg.regValue	= rtd_inl(SMARTFIT_AUTO_R_G_B_MARGIN_reg);
	auto_adj_reg.regValue				  = rtd_inl(SMARTFIT_AUTO_ADJ_reg);

	//H & V boundary setting
	auto_h_boundary_reg.hb_sta = Hstart;
	auto_h_boundary_reg.hb_end= Hend;
	auto_v_boundary_reg.vb_sta=Vstart;
	auto_v_boundary_reg.vb_end=Vend;

	rtd_outl(SMARTFIT_AUTO_H_BOUNDARY_reg, auto_h_boundary_reg.regValue);
	rtd_outl(SMARTFIT_AUTO_V_BOUNDARY_reg, auto_v_boundary_reg.regValue);

	//Color Source Select for Detection //20070713 SmartFit YUV definition's wrong on ver.FIB !! Notice whether spec. been changed?

	auto_r_g_b_margin_reg.color_sel=0x02;//auto_r_g_b_margin_reg.color_sel=0x1;

	//MIN color measured, Accumulation Mode, Start Auto-Function Tracking Function
	auto_adj_reg.force_flip = 1;
	auto_adj_reg.sum_max	 = 1;
	auto_adj_reg.now_af  = 1;
	auto_adj_reg.diff_en =0;


	smartfit_auto_field_RBUS auto_field_reg;
	smartfit_auto_result_phase_m_RBUS auto_result_phase_m_reg;
	smartfit_auto_result_phase_l_RBUS auto_result_phase_l_reg;
	auto_field_reg.regValue = rtd_inl(SMARTFIT_AUTO_FIELD_reg);

	unsigned long long SUM;
	unsigned  int  PxlNum,Hlength,vlength,PxlNum2;
	unsigned  int  PEAK = 0;

	auto_field_reg.adj_source = 0;//main(channel 1)

	rtd_outl(SMARTFIT_AUTO_FIELD_reg,auto_field_reg.regValue);

	auto_r_g_b_margin_reg.diff_th = 0;
	rtd_outl(SMARTFIT_AUTO_R_G_B_MARGIN_reg,auto_r_g_b_margin_reg.regValue);


	auto_result_phase_m_reg.regValue =	rtd_inl(SMARTFIT_AUTO_RESULT_PHASE_M_reg);
	auto_result_phase_l_reg.regValue =	rtd_inl(SMARTFIT_AUTO_RESULT_PHASE_L_reg);

	SUM = ( ( (unsigned long long)(auto_result_phase_m_reg.acc_41_32) ) <<32) + (unsigned long long)(auto_result_phase_l_reg.acc_31_0);

	smartfit_auto_result_hsta_end_RBUS auto_result_hsta_end_reg;
	smartfit_auto_result_vsta_end_RBUS auto_result_vsta_end_reg;
	auto_result_hsta_end_reg.regValue  = rtd_inl(SMARTFIT_AUTO_RESULT_HSTA_END_reg);
	auto_result_vsta_end_reg.regValue = rtd_inl(SMARTFIT_AUTO_RESULT_VSTA_END_reg);

	Hstart = auto_result_hsta_end_reg.hx_sta;
	Hend = auto_result_hsta_end_reg.hx_end;
	Vstart = auto_result_vsta_end_reg.vx_sta;
	Vend = auto_result_vsta_end_reg.vx_end;

	Hlength=Hend-Hstart+1;
	vlength=Vend-Vstart+1;
	PxlNum2=Hlength*vlength;
	PxlNum = (Hend-Hstart)*(Vend-Vstart);
	PEAK = (SUM)/(PxlNum2); //PEAK value 64~940 TG45:

	rtd_outl(SMARTFIT_AUTO_ADJ_reg, auto_adj_reg.regValue);

	// for Debug info
	unsigned char Debug_Log = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Log0;
	unsigned char Debug_Log_Delay = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Delay_Flame;
	if(Debug_Log_Delay==0)
		Debug_Log_Delay = 100;
	if((Debug_Log&_BIT4)!=0)
	{
		if(MA_print_count%Debug_Log_Delay==0)
		{
			ROSPrintf("***,Hstart=%d,Hend=%d,Vstart=%d,Vend=%d***\n",Hstart,Hend,Vstart,Vend);
			ROSPrintf("***Hlength=%d,vlength=%d***\n",Hlength,vlength);
			ROSPrintf("***PxlNum=%d ,PxlNum2=%d ,***\n",PxlNum,PxlNum2);
			ROSPrintf("***SUM=%d ***\n",SUM);
			ROSPrintf("***PEAK=%d ,***\n",PEAK);

		}
	}
	//=======================use smartfit to get mean value 20121228=====================
	return (PEAK>>2);
}


unsigned char scalerVIP_DBC_BASIC_BLIGHT_Cal_TV002(SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem, _system_setting_info* system_info_structure_table)
{
	unsigned char BL_TOP_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.BL_TOP;
	unsigned char BL_MIDDLE_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.BL_MIDDLE;
	unsigned char BL_BOTTOM_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.BL_BOTTOM;
	unsigned char BL_SETUDEN_Reg =vipCustomTBL_ShareMem->DBC.DBC_SW_REG.BL_SETUDEN;
	unsigned char BL_PSH_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.BL_PSH;

	unsigned char USER_BLIGHT = system_info_structure_table->OSD_Info.OSD_Backlight;
	//unsigned char mode = system_info_structure_table->OSD_Info.OSD_DCR_Mode;
	VIP_DBC_POWER_SAVING_MODE mode = (VIP_DBC_POWER_SAVING_MODE)vipCustomTBL_ShareMem->DBC.DBC_STATUS.OSD_PowerSave;
	unsigned char BASIC_BLIGHT;

	if(USER_BLIGHT > 10)
		USER_BLIGHT = 10;

	switch(mode)
	{
		case D_PS_Off:
		case D_PS_Picture_Off:
		default:
			if(USER_BLIGHT >= 5)
				BASIC_BLIGHT = ((BL_TOP_Reg - BL_MIDDLE_Reg)*(USER_BLIGHT - 5) / 5) + BL_MIDDLE_Reg;
			else
				BASIC_BLIGHT = ((BL_MIDDLE_Reg - BL_BOTTOM_Reg)*USER_BLIGHT / 5) + BL_BOTTOM_Reg;
		break;
		case D_PS_Low:
			if(USER_BLIGHT >= 5)
				BASIC_BLIGHT = (((BL_TOP_Reg - BL_MIDDLE_Reg)*(USER_BLIGHT - 5) / 5) + BL_MIDDLE_Reg);
			else
				BASIC_BLIGHT = (((BL_MIDDLE_Reg - BL_BOTTOM_Reg)*USER_BLIGHT / 5) + BL_BOTTOM_Reg);
			BASIC_BLIGHT = BASIC_BLIGHT - BL_SETUDEN_Reg;
		break;
		case D_PS_High:
			BASIC_BLIGHT = BL_PSH_Reg;
		break;
	}
	vipCustomTBL_ShareMem->DBC.DBC_STATUS.Basic_Backlight = BASIC_BLIGHT;

	// for Debug info
	unsigned char Debug_Log = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Log0;
	unsigned char Debug_Log_Delay = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Delay_Flame;
	if(Debug_Log_Delay==0)
		Debug_Log_Delay = 100;
	if((Debug_Log&_BIT1)!=0)
	{
		if(MA_print_count%Debug_Log_Delay==0)
		{
			ROSPrintf("basic_BL=%d,USER_BLIGHT=%d,DCR_mode=%d\n",
				BASIC_BLIGHT, USER_BLIGHT, mode);
		}
	}

	return BASIC_BLIGHT;
}

#define APL_mapping_limit_range 1	//rock 20131219 smartFIT APL range 16~240
unsigned char scalerVIP_DBC_DBC_Cal_TV002(SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem, _system_setting_info* system_info_structure_table)
{
	unsigned short APL = 0;

	APL = scalerVIP_DBC_get_Mean_and_Peak_Value_in_SmartFit_TV002(vipCustomTBL_ShareMem, system_info_structure_table);

	if(APL>255)
		APL = 255;
#ifdef APL_mapping_limit_range
	if(APL<16)
		APL = 0;
	else if(APL>240)
		APL = 255;
	else
		APL = ((APL-16)*255 + 112)/(224);	// 240-16
#endif

	unsigned char DBC_APL_LOW_START_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_APL_LOW_START;
	unsigned char DBC_BL_B_LIMIT_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_BL_B_LIMIT;
	unsigned char DBC_APL_LOW_LIMIT_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_APL_LOW_LIMIT;
	unsigned char DBC_PS_APL_TH_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_PS_APL_TH;
	unsigned char DBC_PS_LEVEL_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_PS_LEVEL;
	unsigned char BASIC_BLIGHT = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Basic_Backlight;
	//unsigned char PictureMode = system_info_structure_table->OSD_Info.OSD_DCR_Mode;
	VIP_DBC_POWER_SAVING_MODE PictureMode = (VIP_DBC_POWER_SAVING_MODE)vipCustomTBL_ShareMem->DBC.DBC_STATUS.OSD_PowerSave;

	// for Debug info
	unsigned char Debug_Log = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Log0;
	unsigned char Debug_Log_Delay = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Delay_Flame;
	if(Debug_Log_Delay==0)
		Debug_Log_Delay = 100;
	if((Debug_Log&_BIT3)!=0)
	{
		if(MA_print_count%Debug_Log_Delay==0)
		{
			ROSPrintf("APLInSmartit=%d,\n",
				APL);
		}
	}

	if(APL >= DBC_APL_LOW_START_Reg)
		return	BASIC_BLIGHT;
	else if(APL >= DBC_APL_LOW_LIMIT_Reg)
	{
		if((DBC_APL_LOW_START_Reg - DBC_APL_LOW_LIMIT_Reg) == 0)
		{
			if(MA_print_count%250==0)
				ROSPrintf("DBC SETTING ERROR\n");
			return 0;
		}
		return BASIC_BLIGHT - ((DBC_APL_LOW_START_Reg - APL) * DBC_BL_B_LIMIT_Reg / (DBC_APL_LOW_START_Reg - DBC_APL_LOW_LIMIT_Reg));
	}
	else if(APL >= DBC_PS_APL_TH_Reg)
		return (BASIC_BLIGHT - DBC_BL_B_LIMIT_Reg);
	else
		if(PictureMode == D_PS_High)	//VIP_PICTURE_MODE_DYNAMIC
			return DBC_PS_LEVEL_Reg;
		else
			return (BASIC_BLIGHT - DBC_BL_B_LIMIT_Reg);

}

unsigned char scalerVIP_DBC_Y_Max_Cal_TV002(_clues *SmartPic_clue)
{
	unsigned char i;
	unsigned int *reg_HistCnt = &(SmartPic_clue->Y_Main_Hist[0]);
	for(i = (COLOR_HISTOGRAM_LEVEL-1); i > 0 ; i--)
	{
		if(reg_HistCnt[i] >= 10)
			return ((i<<3)-1);
	}
	return 0;
}

unsigned char scalerVIP_DBC_BackLight_Cal_TV002(SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem, _system_setting_info* system_info_structure_table, _clues *SmartPic_clue)
{
	unsigned char DBC_PS_TIME_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_PS_TIME;
	unsigned char DBC_PS_TM_EXIT_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_PS_TM_EXIT;
	unsigned char DBC_PS_ATN_UP_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_PS_ATN_UP;
	unsigned char DBC_PS_ATN_DN_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_PS_ATN_DN;
	unsigned char DBC_PS_LEVEL_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_PS_LEVEL;
	unsigned char DBC_BL_B_LIMIT_Reg = vipCustomTBL_ShareMem->DBC.DBC_SW_REG.DBC_BL_B_LIMIT;

	static unsigned char status = 1;
	static unsigned short Pre_backlight = 255;
	static unsigned int DBC4PS_count = 0;
	unsigned short DBC = scalerVIP_DBC_DBC_Cal_TV002(vipCustomTBL_ShareMem, system_info_structure_table);
	unsigned short Y_MAX = scalerVIP_DBC_Y_Max_Cal_TV002(SmartPic_clue)*9/10;
	unsigned short backlight = MAX(DBC, Y_MAX);
	unsigned char BASIC_BLIGHT = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Basic_Backlight;
	static unsigned char pre_basic_BL = 0;
	unsigned char dcc_Mode = system_info_structure_table->OSD_Info.OSD_DCC_Mode;

	if(BASIC_BLIGHT < backlight)
		backlight = BASIC_BLIGHT;

	// for Debug info
	unsigned char Debug_Log = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Log0;
	unsigned char Debug_Log_Delay = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Delay_Flame;
	if(Debug_Log_Delay==0)
		Debug_Log_Delay = 100;
	if((Debug_Log&_BIT2)!=0)
	{
		if(MA_print_count%Debug_Log_Delay==0)
		{
			ROSPrintf("dccMode=%d,pre_basic_BL=%d,BASIC_BLIGHT=%d,DBC=%d,YMax=%d\n",
				dcc_Mode, pre_basic_BL, BASIC_BLIGHT,DBC,Y_MAX);
		}
	}

	// basic backlight change from user
	if(pre_basic_BL != BASIC_BLIGHT)
	{
		Pre_backlight = backlight;
		pre_basic_BL = BASIC_BLIGHT;
		return Pre_backlight;
	}

	if(dcc_Mode == 0)
	{
		Pre_backlight = BASIC_BLIGHT;
		return BASIC_BLIGHT;
	}

	if(backlight > Pre_backlight)				//Addition PWM
	{
		if(Pre_backlight >= (BASIC_BLIGHT - DBC_BL_B_LIMIT_Reg))	//not Dark Y
		{
			Pre_backlight = Pre_backlight + 1;
			status = 1;
		}
		else														//Dark Y
		{
			if(status == 0)
			{
				DBC4PS_count++;
				if(DBC4PS_count > DBC_PS_TM_EXIT_Reg)
				{
					DBC4PS_count = 0;
					status = 1;
				}
			}
			else
			{
				if((Pre_backlight + DBC_PS_ATN_UP_Reg) > (BASIC_BLIGHT - DBC_BL_B_LIMIT_Reg))
					Pre_backlight = (BASIC_BLIGHT - DBC_BL_B_LIMIT_Reg);
				else
					Pre_backlight = (Pre_backlight + DBC_PS_ATN_UP_Reg);
			}
		}
	}
	else	 if(backlight < Pre_backlight)		//Reduction PWM
	{
		if(Pre_backlight >= (BASIC_BLIGHT - DBC_BL_B_LIMIT_Reg))	//not Dark Y
		{
			Pre_backlight = Pre_backlight - 1;
			status = 1;
		}
		else														//Dark Y
		{
			if(status == 1)
			{
				DBC4PS_count++;
				if(DBC4PS_count > (DBC_PS_TIME_Reg<<2))
				{
					DBC4PS_count = 0;
					status = 0;
				}
			}
			else
			{
				if(Pre_backlight > DBC_PS_ATN_DN_Reg)
				{
					if((Pre_backlight - DBC_PS_ATN_DN_Reg) < DBC_PS_LEVEL_Reg)
						Pre_backlight = DBC_PS_LEVEL_Reg;
					else
						Pre_backlight = (Pre_backlight - DBC_PS_ATN_DN_Reg);
				}
				else
					Pre_backlight = DBC_PS_LEVEL_Reg;
			}
		}
	}
	return Pre_backlight;
}

void scalerVIP_DBC_CTRL_TV002(SLR_VIP_TABLE_CUSTOM_TV002 *vipCustomTBL_ShareMem, _system_setting_info* system_info_structure_table, _clues *SmartPic_clue)
{
	unsigned short backlight;
	unsigned char m_isIncreaseMode = system_info_structure_table->OSD_Info.isIncreaseMode_Flag;
	unsigned int m_PIN_BL_ADJ = system_info_structure_table->OSD_Info.backlight_pin_adj;

	//if(system_info_structure_table->OSD_Info.OSD_DCR_Mode==3)	// picture off
		//return;
	if((VIP_DBC_POWER_SAVING_MODE)vipCustomTBL_ShareMem->DBC.DBC_STATUS.OSD_PowerSave==D_PS_Picture_Off)	// picture off
		return;

	scalerVIP_DBC_BASIC_BLIGHT_Cal_TV002(vipCustomTBL_ShareMem, system_info_structure_table);
	backlight = scalerVIP_DBC_BackLight_Cal_TV002(vipCustomTBL_ShareMem, system_info_structure_table, SmartPic_clue);

	if(m_isIncreaseMode == 0)
	{
		if(backlight > 0xFF)
			backlight = 0;
		else
			backlight = 0xFF - backlight;
	}
	//scalerVIP_IoGpio_SetPwmDuty(m_PIN_BL_ADJ, backlight);

	// for Debug info
	unsigned char Debug_Log = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Log0;
	unsigned char Debug_Log_Delay = vipCustomTBL_ShareMem->DBC.DBC_STATUS.Debug_Delay_Flame;
	if(Debug_Log_Delay==0)
		Debug_Log_Delay = 100;
	if((Debug_Log&_BIT0)!=0)
	{
		if(MA_print_count%Debug_Log_Delay==0)
		{
			ROSPrintf("backlight=%d,m_incre=%d,ADJ=%d\n",
				backlight, m_isIncreaseMode, m_PIN_BL_ADJ);
		}
	}
}
#endif

//***************************************************************//
//****************Arrange no use function(From Sirius CSFC) ***********//
//***************************************************************//


#if 0
void scalerVIP_OD_CheckBandwidth()
{
	/*
	ddr_dmastatus_RBUS dmastatus_reg;
	oddma_display_ctrl_RBUS oddma_display_ctrl_reg;
	oddma_cap_ctl0_RBUS oddma_cap_ctl0_reg;

	static unsigned int error_counter;
	static char pre_source;

	char which_source=drvif_color_check_source(SLR_MAIN_DISPLAY);

	oddma_display_ctrl_reg.regValue = rtd_inl(OD_DMA_ODDMA_DISPLAY_CTRL_reg);

	oddma_cap_ctl0_reg.regValue = rtd_inl(OD_DMA_ODDMA_CAP_CTL0_reg);

	if (oddma_display_ctrl_reg.disp11_3ddma_en == 1 && oddma_cap_ctl0_reg.cap_en == 1)
	{
		if (which_source != pre_source)
		{
			pre_source = which_source;
			error_counter = 0;
		}

		dmastatus_reg.regValue = rtd_inl(DI_DDR_DMASTATUS_reg);

		if (dmastatus_reg.ccdinr_ovfl > 0 || dmastatus_reg.ccdinr_unfl > 0)
		{
			error_counter++;
			//ROSPrintf("error_counter: %d\n", error_counter);
			rtd_outl(DI_DDR_DMASTATUS_reg, 0xFFFFFFFF);
			rtd_outl(DI_DDR_DMASTATUS_reg, 0x0);
		}
		if (error_counter > 5)
		{
			ROSPrintf("[BandWidth issue] OverDrive function will disable!!!\n");
			rtd_clearbits(OD_DMA_ODDMA_DISPLAY_CTRL_reg, _BIT8); // disp11 disable
			rtd_clearbits(OD_DMA_ODDMA_CAP_CTL0_reg, _BIT19); // cap disable
			rtd_clearbits(OD_OD_CTRL_reg, _BIT0);
			error_counter = 0;
		}
	}
	*/
/*
	unsigned char osd_status = ((rtd_inl(BUS_TV_SB2_DCU1_ARB_CR1_reg) & 0x00000100)>>8);
	if (osd_status == 1 && ((SmartPic_clue->Remmping_Src_Timing_index)==3 || (SmartPic_clue->Remmping_Src_Timing_index)==4))
	{
		rtd_clearbits(OD_DMA_ODDMA_DISPLAY_CTRL_reg, _BIT8);
		rtd_clearbits(OD_DMA_ODDMA_CAP_CTL0_reg, _BIT19);
		rtd_clearbits(OD_OD_CTRL_reg, _BIT0);
	}
	else
	{
		//ROSPrintf("[BandWidth issue] OSD disalbe detected!!! restart OD function\n");
		rtd_setbits(OD_DMA_ODDMA_DISPLAY_CTRL_reg, _BIT8);
		rtd_setbits(OD_DMA_ODDMA_CAP_CTL0_reg, _BIT19);
		rtd_setbits(OD_OD_CTRL_reg, _BIT0);
	}
	*/


	oddma_display11_numwtl_RBUS display11_numwtl_reg;
	display11_numwtl_reg.regValue = rtd_inl(OD_DMA_ODDMA_DISPLAY11_NUMWTL_reg);
	display11_numwtl_reg.disp11_wtlvl = 0x1c0;
	rtd_outl(OD_DMA_ODDMA_DISPLAY11_NUMWTL_reg, display11_numwtl_reg.regValue);
}
#endif



#if 0 //Replase by PQA adaptive control Flow
unsigned int Lerp_NR_TABLE32(unsigned char X_current, unsigned char NR_LEVEL, unsigned short NRY, unsigned short NRX, unsigned char NRX_OFFSET)
{
	unsigned int X_1, X_0, Y_1, Y_0, x_offset_1, x_offset_0;
	if(NR_LEVEL >= Level_Max)
		NR_LEVEL = Level_Max - 1;

	X_1 = (unsigned int)(*(NR_TABLE8+ NRX * NR_LEVEL_MAX + NR_LEVEL));
	X_0 = (unsigned int)(*(NR_TABLE8 + NRX * NR_LEVEL_MAX + NR_LEVEL - 1));

	Y_1 = (unsigned int)(*(NR_TABLE32 + NRY * NR_LEVEL_MAX + NR_LEVEL));
	Y_0 = (unsigned int)(*(NR_TABLE32 + NRY * NR_LEVEL_MAX + NR_LEVEL - 1));

	x_offset_1 = (unsigned int)(*(NR_TABLE8 + NRX_OFFSET * NR_LEVEL_MAX + NR_LEVEL));
	x_offset_0 = (unsigned int)(*(NR_TABLE8 + NRX_OFFSET * NR_LEVEL_MAX + NR_LEVEL - 1));

	return Lerp(X_current, X_1, X_0, Y_1, Y_0, x_offset_1, x_offset_0);
}

unsigned int Lerp_NR_TABLE8(unsigned char X_current, unsigned char NR_LEVEL, unsigned short NRY, unsigned short NRX, unsigned char NRX_OFFSET)
{
	unsigned int X_1, X_0, Y_1, Y_0, x_offset_1, x_offset_0;
	if(NR_LEVEL >= Level_Max)
		NR_LEVEL = Level_Max - 1;

	X_1 = (unsigned int)(*(NR_TABLE8+ NRX * NR_LEVEL_MAX + NR_LEVEL));
	X_0 = (unsigned int)(*(NR_TABLE8 + NRX * NR_LEVEL_MAX + NR_LEVEL - 1));

	Y_1 = (unsigned int)(*(NR_TABLE8 + NRY * NR_LEVEL_MAX + NR_LEVEL));
	Y_0 = (unsigned int)(*(NR_TABLE8 + NRY * NR_LEVEL_MAX + NR_LEVEL - 1));

	x_offset_1 = (unsigned int)(*(NR_TABLE8 + NRX_OFFSET * NR_LEVEL_MAX + NR_LEVEL));
	x_offset_0 = (unsigned int)(*(NR_TABLE8 + NRX_OFFSET * NR_LEVEL_MAX + NR_LEVEL - 1));

	return Lerp(X_current, X_1, X_0, Y_1, Y_0, x_offset_1, x_offset_0);
}
#endif


#if 0 //Replase by PQA adaptive control Flow
void drvif_color_VDNR_AutoMode_RfCvbs(unsigned char channel, unsigned char VD_noise_level)
{
#if 1
	unsigned char VDNR_TABLE = 0;
	//unsigned char temp = VD_noise_level;
	unsigned int current_Signal_Status = 0;

	spnr_cp_ctrl_RBUS				SPNR_CP_Ctrl_reg;
	spnr_spatial_th_RBUS			SPNR_Spatial_Th_reg;
	spnr_spatial_weight_RBUS		SPNR_Spatial_Weight_reg;
	spnr_local_var2_RBUS			SPNR_Local_Var2_reg;

	SPNR_CP_Ctrl_reg.regValue = rtd_inl(VDC_SPNR_CP_CTRL_reg);
	SPNR_Spatial_Th_reg.regValue	= rtd_inl(VDC_SPNR_SPATIAL_TH_reg);
	SPNR_Spatial_Weight_reg.regValue = rtd_inl(VDC_SPNR_SPATIAL_WEIGHT_reg);
	SPNR_Local_Var2_reg.regValue	= rtd_inl(VDC_SPNR_LOCAL_VAR2_reg);

	//current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	if(DEBUG_AUTO_NR == 0)
		current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	else	//	debug enable;
		current_Signal_Status = DEBUG_VD_NOISE;

	if (VD_noise_level <= NR_LEVEL_MAX)
	{
		//VDNR
		VDNR_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_VD_NR];
		SPNR_CP_Ctrl_reg.cp_sresultweight = 			NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_SResultWeight)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_CP_Ctrl_reg.cp_zoranfiltersizey =			NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_ZoranFilterSizeY)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_CP_Ctrl_reg.cp_spatialenabley =			NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_SpatialEnableY)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_CP_Ctrl_reg.cp_spatialenablec =			NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_SpatialEnableC)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_Spatial_Th_reg.cp_spatialthlyx4 =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[VDNR_TABLE]+VD_CP_SpatialThlYx4), VD_noise_status, VD_noise_status_offset);
		SPNR_Spatial_Th_reg.cp_spatialthlyx2 =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[VDNR_TABLE]+VD_CP_SpatialThlYx2), VD_noise_status, VD_noise_status_offset);
		SPNR_Spatial_Th_reg.cp_spatialthly =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[VDNR_TABLE]+VD_CP_SpatialThlY), VD_noise_status, VD_noise_status_offset);
		SPNR_Spatial_Weight_reg.cp_fixedweight1y =		NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_FixedWeight1Y)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_Spatial_Weight_reg.cp_fixedweight2y =		NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_FixedWeight2Y)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_Spatial_Weight_reg.cp_weight1y =			NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_Weight1Y)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_Spatial_Weight_reg.cp_weight2y =			NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_Weight2Y)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_Local_Var2_reg.cp_edge_weight =			NR_TABLE8 [ (DNR_TABLE_8[VDNR_TABLE]+VD_CP_Edge_Weight)* NR_LEVEL_MAX + VD_noise_level-1];
		SPNR_Local_Var2_reg.cp_sw_edge_thl =			Lerp_NR_TABLE32(current_Signal_Status, VD_noise_level, (DNR_TABLE_32[VDNR_TABLE]+VD_CP_Sw_Edge_Thl), VD_noise_status, VD_noise_status_offset);
	}

	rtd_outl(VDC_SPNR_CP_CTRL_reg	   , SPNR_CP_Ctrl_reg.regValue);
	rtd_outl(VDC_SPNR_SPATIAL_TH_reg    , SPNR_Spatial_Th_reg.regValue);
	rtd_outl(VDC_SPNR_SPATIAL_WEIGHT_reg, SPNR_Spatial_Weight_reg.regValue);
	rtd_outl(VDC_SPNR_LOCAL_VAR2_reg    , SPNR_Local_Var2_reg.regValue);
#endif

#if 0
	unsigned char VDNR_TABLE = 0;
	unsigned char temp = VD_noise_level;
	unsigned int current_Signal_Status = 0;
	//Y_NR_CTRL_RBUS Y_NR_CTRL_REG;

	Y_NR_CTRL_REG.regValue = rtd_inl(VDC_Y_NR_CTRL_reg);

	//current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	if(DEBUG_AUTO_NR == 0)
		current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	else	//	debug enable;
		current_Signal_Status = DEBUG_VD_NOISE;

	if(VD_noise_level <= NR_LEVEL_MAX)
	{
		//VDNR
		VDNR_TABLE = *(DNR_LEVEL_TABLE+DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_VD_NR);
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = *(DNR_LEVEL_TABLE+DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_VD_NR)  + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}
		Y_NR_CTRL_REG.y_nr_en =			*(NR_TABLE8 + (DNR_TABLE_8[VDNR_TABLE]+Y_nr_en) * NR_LEVEL_MAX + VD_noise_level - 1);
		Y_NR_CTRL_REG.y_nr_type = 		*(NR_TABLE8 + (DNR_TABLE_8[VDNR_TABLE]+Y_nr_type)* NR_LEVEL_MAX + VD_noise_level - 1);
		if(AutoNR_Enable_by_Low_Mid_High)
			Y_NR_CTRL_REG.y_nr_thr = 		Lerp_NR_rate((DNR_TABLE_8[VDNR_TABLE]+CP_TemporalThlY0), VD_noise_level, rate_Lerp_NR);
		else
			Y_NR_CTRL_REG.y_nr_thr =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[VDNR_TABLE]+Y_nr_thr), VD_noise_status, VD_noise_status_offset);
	}
	rtd_outl(VDC_Y_NR_CTRL_reg, Y_NR_CTRL_REG.regValue);
#endif
}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_VDNR_AutoMode_Off()
{
#if 1
	spnr_cp_ctrl_RBUS spnr_cp_ctrl_RBUS_reg;
	spnr_cp_ctrl_RBUS_reg.regValue= rtd_inl(VDC_SPNR_CP_CTRL_reg);

	spnr_cp_ctrl_RBUS_reg.cp_spatialenabley = 0;
	spnr_cp_ctrl_RBUS_reg.cp_spatialenablec = 0;

	rtd_outl(VDC_SPNR_CP_CTRL_reg, spnr_cp_ctrl_RBUS_reg.regValue);
#endif
}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_RTNR_AutoMode_RfCvbs(unsigned char channel, unsigned char VD_noise_level)
{
	unsigned char RTNR_Y_TABLE = 0, RTNR_C_TABLE = 0;
	unsigned char temp = VD_noise_level;
	unsigned char rtnr_check[2];
	unsigned char i;//, rtnr_check_count=0,check_loop_count=0;
	unsigned char YTH_TEMP[15], CTH_TEMP[7], SAD_EDGE_TEMP[7], SAD_NON_EDGE_TEMP[7], EDGE_TYPE_DIFF_TEMP[7], STATICSTIC_COUNT_TEMP[7];
	unsigned int k_value_0_7_Y = 0x77777777, k_value_8_15_Y=0x77777777, k_value_C = 0x77777777, Y_K_2D_TABLE[8] = {0xffffffff};
	unsigned char AutoNr_RTNR_Coef[8][8];
	//unsigned char correction_ratio = 15;
	//static unsigned char SceneChange_count = 0;
	unsigned char *rtnr_2D_kmap=NULL;
	di_im_di_rtnr_control_RBUS di_im_di_rtnr_control_RBUS_reg;
	di_im_di_rtnr_new_control_RBUS rtnr_new_Ctrl;
	di_im_di_rtnr_new_sobel_th_RBUS rtnr_new_sobel_th;
	di_im_di_rtnr_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);
	rtnr_new_Ctrl.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_CONTROL_reg);
	rtnr_new_sobel_th.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SOBEL_TH_reg);

	if(VD_noise_level <= NR_LEVEL_MAX)
	{
		//RTNRY
		RTNR_Y_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y] + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}

		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_mad_window			=	NR_TABLE8 [ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_RTNR_MAD_Window) * NR_LEVEL_MAX + VD_noise_level - 1];
		//_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction =	NR_TABLE8 + (DNR_TABLE_8[RTNR_Y_TABLE]+CP_RTNR_Rounding_Correction)* NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable			=	NR_TABLE8 [ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_RTNR_Y_Enable)* NR_LEVEL_MAX + VD_noise_level - 1];
		rtnr_new_Ctrl.rtnr_new_method_en =					NR_TABLE8 [ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_New_Method_En) * NR_LEVEL_MAX + VD_noise_level - 1];
		k_value_0_7_Y = NR_TABLE32 [ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K0_K7) * NR_LEVEL_MAX + VD_noise_level - 1];
		k_value_8_15_Y = NR_TABLE32 [ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K8_K15) * NR_LEVEL_MAX + VD_noise_level - 1];

		/*
		YTH_TEMP[14] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY14), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[13] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY13), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[12] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY12), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[11] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY11), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[10] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY10), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[9] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY9), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[8] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY8), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[7] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY7), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[6] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY6), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[5] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY5), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[4] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY4), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[3] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY3), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[2] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY2), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[1] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY1), VD_noise_level, rate_Lerp_NR);
		YTH_TEMP[0] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY0), VD_noise_level, rate_Lerp_NR);
		*/
		YTH_TEMP[14] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY14) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[13] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY13) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[12] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY12) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[11] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY11) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[10] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY10) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[9] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY9) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[8] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY8) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[7] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY7) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[6] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY6) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[5] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY5) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[4] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY4) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[3] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY3) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[2] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY2) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[1] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY1) * NR_LEVEL_MAX + VD_noise_level - 1];
		YTH_TEMP[0] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY0) * NR_LEVEL_MAX + VD_noise_level - 1];

		// 2D_K_map_threshold_setting

		rtnr_new_sobel_th.rtnr_sbl_thm_y =		NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+RTNR_Sbl_Thm_Y) * NR_LEVEL_MAX + VD_noise_level - 1];
		rtnr_new_sobel_th.rtnr_sbl_ths_y =		NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+RTNR_Sbl_Ths_Y) * NR_LEVEL_MAX + VD_noise_level - 1];
		rtnr_new_sobel_th.rtnr_sobel_method =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Sobel_Method) * NR_LEVEL_MAX + VD_noise_level - 1];

		rtnr_new_Ctrl.rtnr_sad_method = 			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Sad_Method) * NR_LEVEL_MAX + VD_noise_level - 1];
		rtnr_new_Ctrl.rtnr_sad_mix_cal_weight = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Sad_Mix_Cal_Weight) * NR_LEVEL_MAX + VD_noise_level - 1];
		rtnr_new_Ctrl.rtnr_moredetail_cotinue_en =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Rtnr_Moredetail_Cotinue_En) * NR_LEVEL_MAX + VD_noise_level - 1];
		rtnr_new_Ctrl.rtnr_statistic_motion_sad_th1 =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Statistic_Motion_SadTh1), VD_noise_level, rate_Lerp_NR);
		rtnr_new_Ctrl.rtnr_statistic_motion_sad_th2 =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Statistic_Motion_SadTh2), VD_noise_level, rate_Lerp_NR);
		rtnr_new_sobel_th.rtnr_statistic_motion_sad_th3 =	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Statistic_Motion_SadTh3), VD_noise_level, rate_Lerp_NR);

		Y_K_2D_TABLE[7] = NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_70_77) * NR_LEVEL_MAX + VD_noise_level - 1];
		Y_K_2D_TABLE[6] = NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_60_67) * NR_LEVEL_MAX + VD_noise_level - 1];
		Y_K_2D_TABLE[5] = NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_50_57) * NR_LEVEL_MAX + VD_noise_level - 1];
		Y_K_2D_TABLE[4] = NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_40_47) * NR_LEVEL_MAX + VD_noise_level - 1];
		Y_K_2D_TABLE[3] = NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_30_37) * NR_LEVEL_MAX + VD_noise_level - 1];
		Y_K_2D_TABLE[2] = NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_20_27) * NR_LEVEL_MAX + VD_noise_level - 1];
		Y_K_2D_TABLE[1] = NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_10_17) * NR_LEVEL_MAX + VD_noise_level - 1];
		Y_K_2D_TABLE[0] = NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_00_07) * NR_LEVEL_MAX + VD_noise_level - 1];

		SAD_EDGE_TEMP[6] =			Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl6), VD_noise_level, rate_Lerp_NR);
		SAD_EDGE_TEMP[5] =			Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl5), VD_noise_level, rate_Lerp_NR);
		SAD_EDGE_TEMP[4] =			Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl4), VD_noise_level, rate_Lerp_NR);
		SAD_EDGE_TEMP[3] =			Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl3), VD_noise_level, rate_Lerp_NR);
		SAD_EDGE_TEMP[2] =			Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl2), VD_noise_level, rate_Lerp_NR);
		SAD_EDGE_TEMP[1] =			Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl1), VD_noise_level, rate_Lerp_NR);
		SAD_EDGE_TEMP[0] =			Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl0), VD_noise_level, rate_Lerp_NR);
		SAD_NON_EDGE_TEMP[6] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl6), VD_noise_level, rate_Lerp_NR);
		SAD_NON_EDGE_TEMP[5] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl5), VD_noise_level, rate_Lerp_NR);
		SAD_NON_EDGE_TEMP[4] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl4), VD_noise_level, rate_Lerp_NR);
		SAD_NON_EDGE_TEMP[3] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl3), VD_noise_level, rate_Lerp_NR);
		SAD_NON_EDGE_TEMP[2] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl2), VD_noise_level, rate_Lerp_NR);
		SAD_NON_EDGE_TEMP[1] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl1), VD_noise_level, rate_Lerp_NR);
		SAD_NON_EDGE_TEMP[0] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl0), VD_noise_level, rate_Lerp_NR);

		STATICSTIC_COUNT_TEMP[6] =	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl6), VD_noise_level, rate_Lerp_NR);
		STATICSTIC_COUNT_TEMP[5] =	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl5), VD_noise_level, rate_Lerp_NR);
		STATICSTIC_COUNT_TEMP[4] =	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl4), VD_noise_level, rate_Lerp_NR);
		STATICSTIC_COUNT_TEMP[3] =	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl3), VD_noise_level, rate_Lerp_NR);
		STATICSTIC_COUNT_TEMP[2] =	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl2), VD_noise_level, rate_Lerp_NR);
		STATICSTIC_COUNT_TEMP[1] =	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl1), VD_noise_level, rate_Lerp_NR);
		STATICSTIC_COUNT_TEMP[0] =	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl0), VD_noise_level, rate_Lerp_NR);

		EDGE_TYPE_DIFF_TEMP[6] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl6), VD_noise_level, rate_Lerp_NR);
		EDGE_TYPE_DIFF_TEMP[5] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl5), VD_noise_level, rate_Lerp_NR);
		EDGE_TYPE_DIFF_TEMP[4] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl4), VD_noise_level, rate_Lerp_NR);
		EDGE_TYPE_DIFF_TEMP[3] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl3), VD_noise_level, rate_Lerp_NR);
		EDGE_TYPE_DIFF_TEMP[2] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl2), VD_noise_level, rate_Lerp_NR);
		EDGE_TYPE_DIFF_TEMP[1] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl1), VD_noise_level, rate_Lerp_NR);
		EDGE_TYPE_DIFF_TEMP[0] =		Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl0), VD_noise_level, rate_Lerp_NR);


		//RTNRC
		RTNR_C_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_C];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_RTNR_C]  + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}

		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable =			NR_TABLE8[(DNR_TABLE_8[RTNR_C_TABLE]+CP_RTNR_C_Enable)* NR_LEVEL_MAX + VD_noise_level - 1];
		k_value_C = NR_TABLE32[ (DNR_TABLE_32[RTNR_C_TABLE]+CP_Temporal_C_K) * NR_LEVEL_MAX + VD_noise_level - 1];

		CTH_TEMP[6] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlC6), VD_noise_level, rate_Lerp_NR);
		CTH_TEMP[5] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlC5), VD_noise_level, rate_Lerp_NR);
		CTH_TEMP[4] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlC4), VD_noise_level, rate_Lerp_NR);
		CTH_TEMP[3] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlC3), VD_noise_level, rate_Lerp_NR);
		CTH_TEMP[2] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlC2), VD_noise_level, rate_Lerp_NR);
		CTH_TEMP[1] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlC1), VD_noise_level, rate_Lerp_NR);
		CTH_TEMP[0] = Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlC0), VD_noise_level, rate_Lerp_NR);


	}


#if 0
	//== Timing control for correction bit	==

	di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_errorthd_y = 32;
	di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_errorthd_c = 16;

	di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en =1;

	if((MA_print_count%correction_ratio)==0  && TV_05_style_ON == 1)
	{
		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 1 ;
	}
	else
	{
		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 0 ;
	}



	if(SmartPic_clue->SceneChange)==1)
	{
		SceneChange_count = 10;
	}
	if(SceneChange_count!=0 && TV_05_style_ON == 1)
	{
		if(SceneChange_count >=10)
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction =1;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en=0;
			NEW_RTNR_Switch = 6;
		}
		else if(SceneChange_count >=5)
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction =0;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en=1;
			NEW_RTNR_Switch = 5;
		}
		else
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction =0;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en=1;
			NEW_RTNR_Switch = 3;
		}

		SceneChange_count --;

		if(SceneChange_count>=10)
			SceneChange_count =10;
		else if(SceneChange_count<=0)
			SceneChange_count =0;
	}
	else
	{
		NEW_RTNR_Switch = 0;
	}
#endif

	rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
	rtd_outl(DI_IM_DI_RTNR_NEW_CONTROL_reg, rtnr_new_Ctrl.regValue);
	rtd_outl(DI_IM_DI_RTNR_NEW_SOBEL_TH_reg, rtnr_new_sobel_th.regValue);

	rtnr_check[0] = di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable;
	rtnr_check[1] = di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable;
	//=========for check double buffer write error=================================
//Elsie 20131003 remove double buffer checking
/*
	do{
		//BusyCheckRegBit(VGIP_MAIN_2_VGIP_CHN1_STATUS_reg, _BIT26,0x0001FFFF);//frank@0430 change wait vsync start
		//WaitFor_IEN_STOP1();

		di_im_di_rtnr_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

		rtnr_check_count = 0;
		check_loop_count++;

		for(i=0;i<2;i++)
		{
			switch(i)
			{
				case 0:
					if(rtnr_check[0] == di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable)
						rtnr_check_count++;
					else
					{
						di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable=rtnr_check[0];
					}
					break;
				case 1:
					if(rtnr_check[1] == di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable)
						rtnr_check_count++;
					else
					{
						di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable=rtnr_check[1];
					}
					break;
				default:
					break;
			}

		}

		if(rtnr_check_count<2)
		{

			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);

		}
		else
			printf("RTNR reg write setting [OK]\n");

	}while(rtnr_check_count<2 && check_loop_count<6 );
*/
	//=================================================================

	for(i=0;i<8;i++)
	{
		AutoNr_RTNR_Coef[i][0] = (Y_K_2D_TABLE[i] & 0x0000000f)>>0;
		AutoNr_RTNR_Coef[i][1] = (Y_K_2D_TABLE[i] & 0x000000f0)>>4;
		AutoNr_RTNR_Coef[i][2] = (Y_K_2D_TABLE[i] & 0x00000f00)>>8;
		AutoNr_RTNR_Coef[i][3] = (Y_K_2D_TABLE[i] & 0x0000f000)>>12;
		AutoNr_RTNR_Coef[i][4] = (Y_K_2D_TABLE[i] & 0x000f0000)>>16;
		AutoNr_RTNR_Coef[i][5] = (Y_K_2D_TABLE[i] & 0x00f00000)>>20;
		AutoNr_RTNR_Coef[i][6] = (Y_K_2D_TABLE[i] & 0x0f000000)>>24;
		AutoNr_RTNR_Coef[i][7] = (Y_K_2D_TABLE[i] & 0xf0000000)>>28;
#if 0
		if(MA_print_count%60==0)
		{
			ROSPrintf("Y_K_2D_TABLE[%d] = %d\n",i ,Y_K_2D_TABLE[i]);
			ROSPrintf("AutoNr_RTNR_Coef[%d][0] = %d\n",i ,AutoNr_RTNR_Coef[i][0]);
			ROSPrintf("AutoNr_RTNR_Coef[%d][1] = %d\n",i ,AutoNr_RTNR_Coef[i][1]);
			ROSPrintf("AutoNr_RTNR_Coef[%d][2] = %d\n",i ,AutoNr_RTNR_Coef[i][2]);
			ROSPrintf("AutoNr_RTNR_Coef[%d][3] = %d\n",i ,AutoNr_RTNR_Coef[i][3]);
			ROSPrintf("AutoNr_RTNR_Coef[%d][4] = %d\n",i ,AutoNr_RTNR_Coef[i][4]);
			ROSPrintf("AutoNr_RTNR_Coef[%d][5] = %d\n",i ,AutoNr_RTNR_Coef[i][5]);
			ROSPrintf("AutoNr_RTNR_Coef[%d][6] = %d\n",i ,AutoNr_RTNR_Coef[i][6]);
			ROSPrintf("AutoNr_RTNR_Coef[%d][7] = %d\n",i ,AutoNr_RTNR_Coef[i][7]);
		}
#endif
	}
/*
	rtnr_2D_kmap = &AutoNr_RTNR_Coef[0][0];
	if(rtnr_2D_kmap!=NULL)
	{
		for(i=0;i<8;i++)
		{
			drvif_color_newrtnr_rtnr_k(i,&rtnr_2D_kmap[i*8]);
		}
	}
	drvif_color_newrtnr_sad_th(1,&SAD_EDGE_TEMP[0]);//for sad edge th setting
	drvif_color_newrtnr_sad_th(0,&SAD_NON_EDGE_TEMP[0]);//for sad nonedge th setting
	drvif_color_newrtnr_sta_th(&STATICSTIC_COUNT_TEMP[0]);
	drvif_color_newrtnr_edgetypediff_th(&EDGE_TYPE_DIFF_TEMP[0]);
	drvif_color_rtnr_y_th_isr(channel, &YTH_TEMP[0]);
	drvif_color_rtnr_c_th_isr(channel, &CTH_TEMP[0]);
	drvif_color_rtnr_y_k(channel, k_value_0_7_Y, k_value_8_15_Y);
	drvif_color_rtnr_c_k(channel, k_value_C);

}
*/
#endif

#if 0//frank@1127 reduce code
void drvif_color_RTNR_AutoMode_Off(unsigned char channel)
{
	fwif_color_rtnr_y_adjust(channel, TableNR_RTNR_Y);
	fwif_color_rtnr_c_adjust(channel, TableNR_RTNR_C);
}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_RTNR_AutoMode_SdHd(unsigned char channel, unsigned char DNR_Auto_lvl_SdHd)
{
	unsigned char RTNR_Y_TABLE = 0, RTNR_C_TABLE = 0;
	unsigned char temp = DNR_Auto_lvl_SdHd;
	unsigned char rtnr_check[2];
	unsigned char i;//, rtnr_check_count=0,check_loop_count=0;
	unsigned char YTH_TEMP[15]={0}, CTH_TEMP[7], SAD_EDGE_TEMP[7], SAD_NON_EDGE_TEMP[7], EDGE_TYPE_DIFF_TEMP[7], STATICSTIC_COUNT_TEMP[7];
	unsigned int k_value_0_7_Y = 0xffffffff, k_value_8_15_Y = 0xffffffff, k_value_C = 0xffffffff;
	//unsigned char correction_ratio = 15;
	//static unsigned char SceneChange_count = 0;
	unsigned int Y_K_2D_TABLE[8];
	unsigned char AutoNr_RTNR_Coef[8][8];
	unsigned char *rtnr_2D_kmap=NULL;
	di_im_di_rtnr_control_RBUS di_im_di_rtnr_control_RBUS_reg;
	di_im_di_rtnr_new_control_RBUS rtnr_new_Ctrl;
	di_im_di_rtnr_new_sobel_th_RBUS rtnr_new_sobel_th;
	di_im_di_rtnr_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);
	rtnr_new_Ctrl.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_CONTROL_reg);
	rtnr_new_sobel_th.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SOBEL_TH_reg);

	if(DNR_Auto_lvl_SdHd <= NR_LEVEL_MAX)
	{
		//RTNRY
		RTNR_Y_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_mad_window = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_RTNR_MAD_Window) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_RTNR_Rounding_Correction)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable = 			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_RTNR_Y_Enable)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_Ctrl.rtnr_new_method_en = 					NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_New_Method_En) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		k_value_0_7_Y = NR_TABLE32 [ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K0_K7) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		k_value_8_15_Y = NR_TABLE32 [ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K8_K15) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		YTH_TEMP[14] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY14) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[13] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY13) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[12] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY12) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[11] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY11) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[10] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY10) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[9] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY9) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[8] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY8) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[7] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY7) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[6] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY6) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[5] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY5) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[4] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[3] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY3) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[2] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[1] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY1) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		YTH_TEMP[0] = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+CP_TemporalThlY0) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		// 2D_K_map_threshold_setting

		rtnr_new_sobel_th.rtnr_sbl_thm_y = 		NR_TABLE32 [ (DNR_TABLE_32[RTNR_Y_TABLE]+RTNR_Sbl_Thm_Y) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_sobel_th.rtnr_sbl_ths_y = 		NR_TABLE32 [ (DNR_TABLE_32[RTNR_Y_TABLE]+RTNR_Sbl_Ths_Y) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_sobel_th.rtnr_sobel_method = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Sobel_Method) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		rtnr_new_Ctrl.rtnr_sad_method = 			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Sad_Method) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_Ctrl.rtnr_sad_mix_cal_weight = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Sad_Mix_Cal_Weight) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_Ctrl.rtnr_statistic_motion_sad_th1 = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Statistic_Motion_SadTh1) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_Ctrl.rtnr_statistic_motion_sad_th2 =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Statistic_Motion_SadTh2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_sobel_th.rtnr_statistic_motion_sad_th3 =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_Statistic_Motion_SadTh3) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		Y_K_2D_TABLE[7] = 				NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_70_77) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		Y_K_2D_TABLE[6] = 				NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_60_67) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		Y_K_2D_TABLE[5] = 				NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_50_57) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		Y_K_2D_TABLE[4] = 				NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_40_47) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		Y_K_2D_TABLE[3] = 				NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_30_37) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		Y_K_2D_TABLE[2] = 				NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_20_27) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		Y_K_2D_TABLE[1] = 				NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_10_17) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		Y_K_2D_TABLE[0] = 				NR_TABLE32[ (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_00_07) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		SAD_EDGE_TEMP[6] =			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl6) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_EDGE_TEMP[5] =			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl5) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_EDGE_TEMP[4] =			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_EDGE_TEMP[3] =			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl3) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_EDGE_TEMP[2] =			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_EDGE_TEMP[1] =			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl1) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_EDGE_TEMP[0] =			NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_Edge_Thl0) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_NON_EDGE_TEMP[6] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl6) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_NON_EDGE_TEMP[5] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl5) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_NON_EDGE_TEMP[4] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_NON_EDGE_TEMP[3] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl3) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_NON_EDGE_TEMP[2] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_NON_EDGE_TEMP[1] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl1) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		SAD_NON_EDGE_TEMP[0] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Sad_NonEdge_Thl0) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		STATICSTIC_COUNT_TEMP[6] =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl6) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		STATICSTIC_COUNT_TEMP[5] =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl5) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		STATICSTIC_COUNT_TEMP[4] =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		STATICSTIC_COUNT_TEMP[3] =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl3) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		STATICSTIC_COUNT_TEMP[2] =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		STATICSTIC_COUNT_TEMP[1] =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl1) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		STATICSTIC_COUNT_TEMP[0] =	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Staticstic_Count_Thl0) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		EDGE_TYPE_DIFF_TEMP[6] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl6) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_TYPE_DIFF_TEMP[5] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl5) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_TYPE_DIFF_TEMP[4] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_TYPE_DIFF_TEMP[3] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl3) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_TYPE_DIFF_TEMP[2] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_TYPE_DIFF_TEMP[1] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl1) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_TYPE_DIFF_TEMP[0] =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+Edge_Type_Diff_Thl0) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		for(i=0;i<8;i++)
		{
			AutoNr_RTNR_Coef[i][0] = (Y_K_2D_TABLE[i] & 0x0000000f)>>0;
			AutoNr_RTNR_Coef[i][1] = (Y_K_2D_TABLE[i] & 0x000000f0)>>4;
			AutoNr_RTNR_Coef[i][2] = (Y_K_2D_TABLE[i] & 0x00000f00)>>8;
			AutoNr_RTNR_Coef[i][3] = (Y_K_2D_TABLE[i] & 0x0000f000)>>12;
			AutoNr_RTNR_Coef[i][4] = (Y_K_2D_TABLE[i] & 0x000f0000)>>16;
			AutoNr_RTNR_Coef[i][5] = (Y_K_2D_TABLE[i] & 0x00f00000)>>20;
			AutoNr_RTNR_Coef[i][6] = (Y_K_2D_TABLE[i] & 0x0f000000)>>24;
			AutoNr_RTNR_Coef[i][7] = (Y_K_2D_TABLE[i] & 0xf0000000)>>28;
		}

		//RTNRC
		RTNR_C_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_C];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_RTNR_C] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable = 			NR_TABLE8[ (DNR_TABLE_8[RTNR_C_TABLE]+CP_RTNR_C_Enable)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		k_value_C = NR_TABLE32 [ (DNR_TABLE_32[RTNR_C_TABLE]+CP_Temporal_C_K) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		CTH_TEMP[6] = NR_TABLE8[ (DNR_TABLE_8[RTNR_C_TABLE]+CP_TemporalThlC6) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		CTH_TEMP[5] = NR_TABLE8[ (DNR_TABLE_8[RTNR_C_TABLE]+CP_TemporalThlC5) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		CTH_TEMP[4] = NR_TABLE8[ (DNR_TABLE_8[RTNR_C_TABLE]+CP_TemporalThlC4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		CTH_TEMP[3] = NR_TABLE8[ (DNR_TABLE_8[RTNR_C_TABLE]+CP_TemporalThlC3) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		CTH_TEMP[2] = NR_TABLE8[ (DNR_TABLE_8[RTNR_C_TABLE]+CP_TemporalThlC2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		CTH_TEMP[1] = NR_TABLE8[ (DNR_TABLE_8[RTNR_C_TABLE]+CP_TemporalThlC1) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		CTH_TEMP[0] = NR_TABLE8[ (DNR_TABLE_8[RTNR_C_TABLE]+CP_TemporalThlC0) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
	}

#if 0
	if( MA_print_count % 30 == 0 ) {
		ROSPrintf("!!!!!!!!!!!!RTNR SDHD setting!!!!!!!!!!!!!\n" );
		ROSPrintf("Current RTNR level: %d\n", DNR_Auto_lvl_SdHd );
		for( i=0; i<15; i++ ) {
			ROSPrintf("YTH_TEMP[%d] = %d\n", i, YTH_TEMP[i] );
		}
	}
#endif
#if 0
	//== Timing control for correction bit	==

	di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_errorthd_y = 32;
	di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_errorthd_c = 16;

	di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en =1;

	if((MA_print_count%correction_ratio)==0)
	{
		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 1 ;
	}
	else
	{
		di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction = 0 ;
	}



	if((SmartPic_clue->SceneChange)==1)
	{
		SceneChange_count = 10;
	}
	if(SceneChange_count!=0)
	{
		if(SceneChange_count >=10)
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction =1;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en=0;
			NEW_RTNR_Switch = 6;
		}
		else if(SceneChange_count >=5)
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction =0;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en=1;
			NEW_RTNR_Switch = 5;
		}
		else
		{
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction =0;
			di_im_di_rtnr_control_RBUS_reg.cp_rtnr_rounding_correction2_en=1;
			NEW_RTNR_Switch = 3;
		}

		SceneChange_count --;

		if(SceneChange_count>=10)
			SceneChange_count =10;
		else if(SceneChange_count<=0)
			SceneChange_count =0;
	}
	else
	{
		NEW_RTNR_Switch = 0;
	}
#endif

	rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);
	rtd_outl(DI_IM_DI_RTNR_NEW_CONTROL_reg, rtnr_new_Ctrl.regValue);
	rtd_outl(DI_IM_DI_RTNR_NEW_SOBEL_TH_reg, rtnr_new_sobel_th.regValue);

	rtnr_check[0] = di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable;
	rtnr_check[1] = di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable;
	//=========for check double buffer write error=================================
//Elsie 20131003 remove double buffer checking
/*
	do{
		BusyCheckRegBit(VGIP_VGIP_CHN1_STATUS_reg, _BIT26,0x0001FFFF);//frank@0430 change wait vsync start

		//WaitFor_IEN_STOP1();

		di_im_di_rtnr_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

		rtnr_check_count = 0;
		check_loop_count++;

		for(i=0;i<2;i++)
		{
			switch(i)
			{
				case 0:
					if(rtnr_check[0] == di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable)
						rtnr_check_count++;
					else
					{
						di_im_di_rtnr_control_RBUS_reg.cp_rtnr_y_enable=rtnr_check[0];
					}
					break;
				case 1:
					if(rtnr_check[1] == di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable)
						rtnr_check_count++;
					else
					{
						di_im_di_rtnr_control_RBUS_reg.cp_rtnr_c_enable=rtnr_check[1];
					}
					break;
				default:
					break;
			}

		}

		if(rtnr_check_count<2)
		{

			rtd_outl(DI_IM_DI_RTNR_CONTROL_reg, di_im_di_rtnr_control_RBUS_reg.regValue);

		}
		else
			printf("RTNR reg write setting [OK]\n");

	}while(rtnr_check_count<2 && check_loop_count<6 );
*/
	//=================================================================

	//rtnr_2D_kmap = &AutoNr_RTNR_Linear_Coef[0][0];
	/*
	rtnr_2D_kmap = &AutoNr_RTNR_Coef[0][0];
	if(rtnr_2D_kmap!=NULL)
	{
		for(i=0;i<8;i++)
		{
			drvif_color_newrtnr_rtnr_k(i,&rtnr_2D_kmap[i*8]);
		}
	}
	drvif_color_newrtnr_sad_th(1,&SAD_EDGE_TEMP[0]);//for sad edge th setting
	drvif_color_newrtnr_sad_th(0,&SAD_NON_EDGE_TEMP[0]);//for sad nonedge th setting
	drvif_color_newrtnr_sta_th(&STATICSTIC_COUNT_TEMP[0]);
	drvif_color_newrtnr_edgetypediff_th(&EDGE_TYPE_DIFF_TEMP[0]);
	drvif_color_rtnr_y_th_isr(channel, &YTH_TEMP[0]);
	drvif_color_rtnr_c_th_isr(channel, &CTH_TEMP[0]);
	drvif_color_rtnr_y_k(channel,k_value_0_7_Y, k_value_8_15_Y);
	drvif_color_rtnr_c_k(channel, k_value_C);
*/

}
#endif
/*
#if 0 // Replase by PQA adaptive control Flow
void drvif_color_RTNR_OF_SNR_AutoMode_RfCvbs(unsigned char display, unsigned char DNR_Auto_level)
{
	unsigned char RTNR_Y_TABLE = 0;
	unsigned int EDGE_STATUS[7];
	unsigned char temp = DNR_Auto_level;
	di_im_di_rtnr_new_snr_control_RBUS rtnr_new_snr_control;
	rtnr_new_snr_control.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SNR_CONTROL_reg);

	if(DNR_Auto_level <= NR_LEVEL_MAX)
	{
		//RTNRY
		RTNR_Y_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_level = temp;
			DNR_Auto_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y] + DNR_Auto_lvl_SdHd;
			DNR_Auto_level = (DNR_Auto_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_level);
		}

		rtnr_new_snr_control.rtnr_snr_en = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_En) * NR_LEVEL_MAX + DNR_Auto_level - 1];
		rtnr_new_snr_control.rtnr_snr_sobel_1_en = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Sobel_1_En) * NR_LEVEL_MAX + DNR_Auto_level - 1];
		rtnr_new_snr_control.rtnr_snr_sobel_2_en = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Sobel_2_En) * NR_LEVEL_MAX + DNR_Auto_level - 1];
		rtnr_new_snr_control.rtnr_snr_sobel_3_en = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Sobel_3_En) * NR_LEVEL_MAX + DNR_Auto_level - 1];
		rtnr_new_snr_control.rtnr_snr_mask = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Mask) * NR_LEVEL_MAX + DNR_Auto_level - 1];

		rtnr_new_snr_control.rtnr_snr_result_edgestatus_invert_en = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Invert) * NR_LEVEL_MAX + DNR_Auto_level - 1];
		rtnr_new_snr_control.rtnr_snr_result_motion_invert_en =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Motion_Invert) * NR_LEVEL_MAX + DNR_Auto_level - 1];
		rtnr_new_snr_control.rtnr_snr_result_offset_invert_en = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Offset_Invert) * NR_LEVEL_MAX + DNR_Auto_level - 1];

		rtnr_new_snr_control.rtnr_snr_result_edgestatus_weight = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Weight) * NR_LEVEL_MAX + DNR_Auto_level - 1];
		rtnr_new_snr_control.rtnr_snr_result_motion_weight = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Motion_Weight) * NR_LEVEL_MAX + DNR_Auto_level - 1];
		rtnr_new_snr_control.rtnr_snr_result_offset = 				NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Offset) * NR_LEVEL_MAX + DNR_Auto_level - 1];

		EDGE_STATUS[6] = 	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th6), VD_noise_level, DNR_Auto_level);
		EDGE_STATUS[5] = 	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th5), VD_noise_level, DNR_Auto_level);
		EDGE_STATUS[4] = 	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th4), VD_noise_level, DNR_Auto_level);
		EDGE_STATUS[3] = 	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th3), VD_noise_level, DNR_Auto_level);
		EDGE_STATUS[2] = 	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th2), VD_noise_level, DNR_Auto_level);
		EDGE_STATUS[1] = 	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th1), VD_noise_level, DNR_Auto_level);
		EDGE_STATUS[0] = 	Lerp_NR_rate((DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th0), VD_noise_level, DNR_Auto_level);


	}
	rtd_outl(DI_IM_DI_RTNR_NEW_SNR_CONTROL_reg, rtnr_new_snr_control.regValue);

	drvif_color_newrtnr_snr_edge_th(&EDGE_STATUS[0]);

}
#endif
*/
/*
#if 0 //Replase by PQA adaptive control Flow
void drvif_color_RTNR_OF_SNR_AutoMode_SdHd(unsigned char display, unsigned char DNR_Auto_lvl_SdHd)
{
	unsigned char RTNR_Y_TABLE = 0;
	unsigned int EDGE_STATUS[7];
	unsigned char temp = DNR_Auto_lvl_SdHd;
	di_im_di_rtnr_new_snr_control_RBUS rtnr_new_snr_control;
	rtnr_new_snr_control.regValue = rtd_inl(DI_IM_DI_RTNR_NEW_SNR_CONTROL_reg);

	if(DNR_Auto_lvl_SdHd <= NR_LEVEL_MAX)
	{
		//RTNRY
		RTNR_Y_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		rtnr_new_snr_control.rtnr_snr_en = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_En) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_snr_control.rtnr_snr_sobel_1_en = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Sobel_1_En) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_snr_control.rtnr_snr_sobel_2_en = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Sobel_2_En) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_snr_control.rtnr_snr_sobel_3_en = NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Sobel_3_En) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_snr_control.rtnr_snr_mask = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Mask) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		rtnr_new_snr_control.rtnr_snr_result_edgestatus_invert_en = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Invert) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_snr_control.rtnr_snr_result_motion_invert_en =		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Motion_Invert) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_snr_control.rtnr_snr_result_offset_invert_en = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Offset_Invert) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		rtnr_new_snr_control.rtnr_snr_result_edgestatus_weight = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Weight) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_snr_control.rtnr_snr_result_motion_weight = 		NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Motion_Weight) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		rtnr_new_snr_control.rtnr_snr_result_offset = 				NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Offset) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		EDGE_STATUS[6] = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th6) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_STATUS[5] = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th5) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_STATUS[4] = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_STATUS[3] = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th3) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_STATUS[2] = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_STATUS[1] = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th1) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		EDGE_STATUS[0] = 	NR_TABLE8[ (DNR_TABLE_8[RTNR_Y_TABLE]+RTNR_SNR_Edgestatus_Th0) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];


	}
	rtd_outl(DI_IM_DI_RTNR_NEW_SNR_CONTROL_reg, rtnr_new_snr_control.regValue);

	drvif_color_newrtnr_snr_edge_th(&EDGE_STATUS[0]);

}
#endif
*/
#if 0 // Replase by PQA adaptive control Flow
void drvif_color_Ediff_AutoMode_RfCvbs(unsigned char channel, unsigned char VD_noise_level)
{
	unsigned char Ediff_TABLE = 0;
	unsigned char temp = VD_noise_level;

	di_im_di_rtnr_ediff_control_RBUS di_im_di_rtnr_ediff_control_RBUS_reg;
	di_im_di_rtnr_ediff_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_EDIFF_CONTROL_reg);
	if(VD_noise_level <= NR_LEVEL_MAX)
	{
		//I_Edge
		Ediff_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_EDGE];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_EDGE] + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}
		di_im_di_rtnr_ediff_control_RBUS_reg.cp_temporal_edge_crct_en= NR_TABLE8 [ (DNR_TABLE_8[Ediff_TABLE]+CP_Temporal_edge_crct_en)* NR_LEVEL_MAX + VD_noise_level - 1];
	}
	rtd_outl(DI_IM_DI_RTNR_EDIFF_CONTROL_reg, di_im_di_rtnr_ediff_control_RBUS_reg.regValue);

}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_Ediff_AutoMode_SdHd(unsigned char channel, unsigned char DNR_Auto_lvl_SdHd)
{
	unsigned char Ediff_TABLE = 0;
	unsigned char temp = DNR_Auto_lvl_SdHd;
	di_im_di_rtnr_ediff_control_RBUS di_im_di_rtnr_ediff_control_RBUS_reg;
	di_im_di_rtnr_ediff_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_EDIFF_CONTROL_reg);
	if(DNR_Auto_lvl_SdHd <= NR_LEVEL_MAX)
	{
		//I_Edge
		Ediff_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_EDGE];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_EDGE] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}
		di_im_di_rtnr_ediff_control_RBUS_reg.cp_temporal_edge_crct_en= NR_TABLE8[ (DNR_TABLE_8[Ediff_TABLE]+CP_Temporal_edge_crct_en)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
	}

	rtd_outl(DI_IM_DI_RTNR_EDIFF_CONTROL_reg, di_im_di_rtnr_ediff_control_RBUS_reg.regValue);
}
#endif

#if 0 // Replase by PQA adaptive control Flow
void drvif_color_Spatial_NR_AutoMode_RfCvbs(unsigned char channel, unsigned char VD_noise_level)
{
	unsigned char spatial_check[8];
	unsigned char temp = VD_noise_level;
	//unsigned char i, spatial_check_count=0,check_loop_count=0;
	unsigned char SPATIAL_Y_TABLE = 0, SPATIAL_C_TABLE = 0;
	unsigned int current_Signal_Status = 0;

	nr_dch1_cp_ctrl_RBUS dch1_CP_Ctrl_reg;
	nr_dch1_spatial_thl_RBUS dch1_Spatial_Thl_reg;
	nr_dch1_spatial_thl2_RBUS dch1_Spatial_Thl2_reg;
	nr_dch1_spatial_weight_RBUS dch1_Spatial_Weight_Reg;
	nr_dch1_local_var2_RBUS nr_dch1_local_var2_RBUS_Reg;
	mixer_ctrl_RBUS mixer_ctrl_reg;
	prelpf_ctrl_RBUS smooth_prelpf_ctrl_reg;

	dch1_CP_Ctrl_reg.regValue = rtd_inl(NR_DCH1_CP_CTRL_reg);
	dch1_Spatial_Thl_reg.regValue = rtd_inl(NR_DCH1_SPATIAL_THL_reg);
	dch1_Spatial_Thl2_reg.regValue = rtd_inl(NR_DCH1_SPATIAL_THL2_reg);
	dch1_Spatial_Weight_Reg.regValue = rtd_inl(NR_DCH1_SPATIAL_WEIGHT_reg);
	nr_dch1_local_var2_RBUS_Reg.regValue= rtd_inl(NR_DCH1_LOCAL_VAR2_reg);
	smooth_prelpf_ctrl_reg.regValue = rtd_inl(IEDGE_SMOOTH_PRELPF_CTRL_reg);
	mixer_ctrl_reg.regValue = rtd_inl(IEDGE_SMOOTH_MIXER_CTRL_reg);


	//current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	if(DEBUG_AUTO_NR == 0)
		current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	else	//	debug enable;
		current_Signal_Status = DEBUG_VD_NOISE;

	if(VD_noise_level <= NR_LEVEL_MAX)
	{
		//SPATIAL_Y
		SPATIAL_Y_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_Y];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_Y]  + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}

		dch1_CP_Ctrl_reg.cp_sresultweight = 			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SResultWeight) * NR_LEVEL_MAX + VD_noise_level - 1];
		dch1_CP_Ctrl_reg.cp_zoranfiltersizey =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_ZoranFilterSizeY) * NR_LEVEL_MAX + VD_noise_level - 1];
		dch1_CP_Ctrl_reg.cp_spatialenabley =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialEnableY) * NR_LEVEL_MAX + VD_noise_level - 1];
		dch1_Spatial_Weight_Reg.cp_fixedweight1y =		NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_FixedWeight1Y)*NR_LEVEL_MAX+VD_noise_level - 1];
		dch1_Spatial_Weight_Reg.cp_fixedweight2y =		NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_FixedWeight2Y)*NR_LEVEL_MAX+VD_noise_level - 1];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			dch1_Spatial_Thl2_reg.cp_spatialthlyx4 =		Lerp_NR_rate((DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlYx4), VD_noise_level, rate_Lerp_NR);
			dch1_Spatial_Thl_reg.cp_spatialthlyx2 =			Lerp_NR_rate((DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlYx2), VD_noise_level, rate_Lerp_NR);
			dch1_Spatial_Thl_reg.cp_spatialthly =			Lerp_NR_rate((DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlY), VD_noise_level, rate_Lerp_NR);
			dch1_Spatial_Weight_Reg.cp_weight1y =			Lerp_NR_rate((DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_Weight1Y), VD_noise_level, rate_Lerp_NR);
			dch1_Spatial_Weight_Reg.cp_weight2y =			Lerp_NR_rate((DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_Weight2Y), VD_noise_level, rate_Lerp_NR);
			nr_dch1_local_var2_RBUS_Reg.cp_sw_edge_thl = 		Lerp_NR_rate_32((DNR_TABLE_32[SPATIAL_Y_TABLE]+CP_Sw_Edge_Thl), VD_noise_level, rate_Lerp_NR);
		}
		else
		{
			dch1_Spatial_Thl2_reg.cp_spatialthlyx4 =		Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlYx4), VD_noise_status, VD_noise_status_offset);
			dch1_Spatial_Thl_reg.cp_spatialthlyx2 =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlYx2), VD_noise_status, VD_noise_status_offset);
			dch1_Spatial_Thl_reg.cp_spatialthly =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlY), VD_noise_status, VD_noise_status_offset);
			dch1_Spatial_Weight_Reg.cp_weight1y =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_Weight1Y), VD_noise_status, VD_noise_status_offset);
			dch1_Spatial_Weight_Reg.cp_weight2y =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_Weight2Y), VD_noise_status, VD_noise_status_offset);
			nr_dch1_local_var2_RBUS_Reg.cp_sw_edge_thl = 		Lerp_NR_TABLE32(current_Signal_Status, VD_noise_level, (DNR_TABLE_32[SPATIAL_Y_TABLE]+CP_Sw_Edge_Thl), VD_noise_status, VD_noise_status_offset);
		}
		nr_dch1_local_var2_RBUS_Reg.cp_en_sw_edge_thl = 	NR_TABLE8 [ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_En_Sw_Edge_Thl) * NR_LEVEL_MAX + VD_noise_level - 1];
		smooth_prelpf_ctrl_reg.prelpf_snr_sel = 	NR_TABLE8 [ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Prelpf_Snr_Sel) * NR_LEVEL_MAX + VD_noise_level - 1];
		//mixer_ctrl_reg.vfir_weight = *(NR_TABLE8 + (DNR_TABLE_8[SPATIAL_Y_TABLE]+Vfir_Weight) * NR_LEVEL_MAX + VD_noise_level - 1);

		//SPATIAL_C
		SPATIAL_C_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_C];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			if((scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)==0))
				AutoNR_Level_bound =7;
			else if((scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)==1))
				AutoNR_Level_bound =8;
			else if((scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)==2))
				AutoNR_Level_bound =9;
			else
				AutoNR_Level_bound =10;


			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_C]  + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}

		dch1_CP_Ctrl_reg.cp_zoranfiltersizec = 			NR_TABLE8 [ (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_ZoranFilterSizeC)* NR_LEVEL_MAX + VD_noise_level - 1];
		dch1_CP_Ctrl_reg.cp_spatialenablec =				NR_TABLE8 [ (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialEnableC) * NR_LEVEL_MAX + VD_noise_level - 1];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			dch1_Spatial_Thl2_reg.cp_spatialthlcx4 =			Lerp_NR_rate((DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlCx4), VD_noise_level, rate_Lerp_NR);
			dch1_Spatial_Thl_reg.cp_spatialthlcx2 =			Lerp_NR_rate((DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlCx2), VD_noise_level, rate_Lerp_NR);
			dch1_Spatial_Thl_reg.cp_spatialthlc =				Lerp_NR_rate((DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlC), VD_noise_level, rate_Lerp_NR);
		}
		else
		{
			dch1_Spatial_Thl2_reg.cp_spatialthlcx4 =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlCx4), VD_noise_status, VD_noise_status_offset);
			dch1_Spatial_Thl_reg.cp_spatialthlcx2 =			Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlCx2), VD_noise_status, VD_noise_status_offset);
			dch1_Spatial_Thl_reg.cp_spatialthlc =				Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlC), VD_noise_status, VD_noise_status_offset);
		}

	}

	rtd_outl(NR_DCH1_CP_CTRL_reg, dch1_CP_Ctrl_reg.regValue);
	rtd_outl(NR_DCH1_SPATIAL_THL_reg, dch1_Spatial_Thl_reg.regValue);
	rtd_outl(NR_DCH1_SPATIAL_THL2_reg, dch1_Spatial_Thl2_reg.regValue);
	rtd_outl(NR_DCH1_SPATIAL_WEIGHT_reg, dch1_Spatial_Weight_Reg.regValue);
	rtd_outl(NR_DCH1_LOCAL_VAR2_reg, nr_dch1_local_var2_RBUS_Reg.regValue);
	rtd_outl(IEDGE_SMOOTH_PRELPF_CTRL_reg,smooth_prelpf_ctrl_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_MIXER_CTRL_reg, mixer_ctrl_reg.regValue);

	spatial_check[0] = dch1_CP_Ctrl_reg.cp_spatialenabley;
	spatial_check[1] = dch1_Spatial_Thl_reg.cp_spatialthly;
	spatial_check[2] = dch1_Spatial_Thl_reg.cp_spatialthlyx2;
	spatial_check[3] = dch1_Spatial_Thl2_reg.cp_spatialthlyx4;
	spatial_check[4] = dch1_CP_Ctrl_reg.cp_spatialenablec;
	spatial_check[5] = dch1_Spatial_Thl_reg.cp_spatialthlc;
	spatial_check[6] = dch1_Spatial_Thl_reg.cp_spatialthlcx2;
	spatial_check[7] = dch1_Spatial_Thl2_reg.cp_spatialthlcx4;
	//=========for check double buffer write error=================================
//Elsie 20131003 remove double buffer checking
/*
	do{
		BusyCheckRegBit(VGIP_VGIP_CHN1_STATUS_reg, _BIT26,0x0001FFFF);//frank@0430 change wait vsync start
		//WaitFor_IEN_STOP1();

		dch1_CP_Ctrl_reg.regValue = rtd_inl(NR_DCH1_CP_CTRL_reg);
		dch1_Spatial_Thl_reg.regValue = rtd_inl(NR_DCH1_SPATIAL_THL_reg);
		dch1_Spatial_Thl2_reg.regValue = rtd_inl(NR_DCH1_SPATIAL_THL2_reg);
		spatial_check_count = 0;
		check_loop_count++;

		for(i=0;i<8;i++)
		{
			switch(i)
			{
				case 0:
					if(spatial_check[0] == dch1_CP_Ctrl_reg.cp_spatialenabley)
						spatial_check_count++;
					else
					{
						dch1_CP_Ctrl_reg.cp_spatialenabley=spatial_check[0];
					}
					break;
				case 1:
					if(spatial_check[1] == dch1_Spatial_Thl_reg.cp_spatialthly)
						spatial_check_count ++;
					else
					{
						dch1_Spatial_Thl_reg.cp_spatialthly=spatial_check[1];
					}
					break;
				case 2:
					if(spatial_check[2] == dch1_Spatial_Thl_reg.cp_spatialthlyx2)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl_reg.cp_spatialthlyx2=spatial_check[2];
					}
					break;
				case 3:
					if(spatial_check[3] == dch1_Spatial_Thl2_reg.cp_spatialthlyx4)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl2_reg.cp_spatialthlyx4=spatial_check[3];
					}
					break;
				case 4:
					if(spatial_check[4] == dch1_CP_Ctrl_reg.cp_spatialenablec)
						spatial_check_count++;
					else
					{
						dch1_CP_Ctrl_reg.cp_spatialenablec=spatial_check[4];
					}
					break;
				case 5:
					if(spatial_check[5] == dch1_Spatial_Thl_reg.cp_spatialthlc)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl_reg.cp_spatialthlc=spatial_check[5];
					}
					break;
				case 6:
					if(spatial_check[6] == dch1_Spatial_Thl_reg.cp_spatialthlcx2)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl_reg.cp_spatialthlcx2=spatial_check[6];
					}
					break;
				case 7:
					if(spatial_check[7] == dch1_Spatial_Thl2_reg.cp_spatialthlcx4)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl2_reg.cp_spatialthlcx4=spatial_check[7];
					}
					break;
				default:
					break;
			}

		}

		if(spatial_check_count<8)
		{

			rtd_outl(NR_DCH1_CP_CTRL_reg, dch1_CP_Ctrl_reg.regValue);
			rtd_outl(NR_DCH1_SPATIAL_THL_reg, dch1_Spatial_Thl_reg.regValue);
			rtd_outl(NR_DCH1_SPATIAL_THL2_reg, dch1_Spatial_Thl2_reg.regValue);
		}


	}while(spatial_check_count<8 && check_loop_count<6 );
*/
	//=================================================================
}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_Spatial_NR_AutoMode_SdHd(unsigned char channel, unsigned char DNR_Auto_lvl_SdHd)
{
	unsigned char spatial_check[8];
	unsigned char temp = DNR_Auto_lvl_SdHd;
	//unsigned char i, spatial_check_count=0,check_loop_count=0;
	unsigned char SPATIAL_Y_TABLE = 0, SPATIAL_C_TABLE = 0;
	nr_dch1_cp_ctrl_RBUS dch1_CP_Ctrl_reg;
	nr_dch1_spatial_thl_RBUS dch1_Spatial_Thl_reg;
	nr_dch1_spatial_thl2_RBUS dch1_Spatial_Thl2_reg;
	nr_dch1_spatial_weight_RBUS dch1_Spatial_Weight_Reg;
	nr_dch1_local_var2_RBUS nr_dch1_local_var2_RBUS_Reg;
	mixer_ctrl_RBUS mixer_ctrl_reg;
//	new_algo_0_RBUS snr_edge_dependent_ctrl_reg;
//	new_algo_1_RBUS snr_edge_dependent_ctrl_1_reg;
//	new_algo_2_RBUS snr_edge_dependent_ctrl_2_reg;
	prelpf_ctrl_RBUS smooth_prelpf_ctrl_reg;

	dch1_CP_Ctrl_reg.regValue = rtd_inl(NR_DCH1_CP_CTRL_reg);
	dch1_Spatial_Thl_reg.regValue = rtd_inl(NR_DCH1_SPATIAL_THL_reg);
	dch1_Spatial_Thl2_reg.regValue = rtd_inl(NR_DCH1_SPATIAL_THL2_reg);
	dch1_Spatial_Weight_Reg.regValue = rtd_inl(NR_DCH1_SPATIAL_WEIGHT_reg);
	nr_dch1_local_var2_RBUS_Reg.regValue= rtd_inl(NR_DCH1_LOCAL_VAR2_reg);
//	snr_edge_dependent_ctrl_reg.regValue = rtd_inl(NR_NEW_ALGO_0_reg);
//	snr_edge_dependent_ctrl_1_reg.regValue = rtd_inl(NR_NEW_ALGO_1_reg);
//	snr_edge_dependent_ctrl_2_reg.regValue = rtd_inl(NR_NEW_ALGO_2_reg);
	smooth_prelpf_ctrl_reg.regValue = rtd_inl(IEDGE_SMOOTH_PRELPF_CTRL_reg);
	mixer_ctrl_reg.regValue = rtd_inl(IEDGE_SMOOTH_MIXER_CTRL_reg);

	if(DNR_Auto_lvl_SdHd <= NR_LEVEL_MAX)
	{
		//SPATIAL_Y
		SPATIAL_Y_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_Y];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_Y] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		dch1_CP_Ctrl_reg.cp_sresultweight = 			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SResultWeight) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_CP_Ctrl_reg.cp_zoranfiltersizey =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_ZoranFilterSizeY) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_CP_Ctrl_reg.cp_spatialenabley =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialEnableY) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Thl2_reg.cp_spatialthlyx4 =		NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlYx4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Thl_reg.cp_spatialthlyx2 =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlYx2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Thl_reg.cp_spatialthly =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_SpatialThlY) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Weight_Reg.cp_weight1y =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_Weight1Y) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Weight_Reg.cp_weight2y =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_Weight2Y) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Weight_Reg.cp_fixedweight1y =		NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_FixedWeight1Y)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Weight_Reg.cp_fixedweight2y =		NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_FixedWeight2Y)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd - 1];
		nr_dch1_local_var2_RBUS_Reg.cp_sw_edge_thl = 		NR_TABLE32[ (DNR_TABLE_32[SPATIAL_Y_TABLE]+CP_Sw_Edge_Thl) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		nr_dch1_local_var2_RBUS_Reg.cp_en_sw_edge_thl = 	NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+CP_En_Sw_Edge_Thl) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

//		snr_edge_dependent_ctrl_reg.edgedependent_enable= 		NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Edgedependent_Enable) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

//		snr_edge_dependent_ctrl_1_reg.edgedependent_stepylow = 	NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Edgedependent_Stepylow) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
//		snr_edge_dependent_ctrl_1_reg.edgedependent_thrylow = 	*(NR_TABLE32 + (DNR_TABLE_32[SPATIAL_Y_TABLE]+Edgedependent_Thrylow) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
//		snr_edge_dependent_ctrl_reg.edgedependent_stepy = 		NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Edgedependent_Stepy) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
//		snr_edge_dependent_ctrl_reg.edgedependent_thry = 		*(NR_TABLE32 + (DNR_TABLE_32[SPATIAL_Y_TABLE]+Edgedependent_Thry) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

//		snr_edge_dependent_ctrl_2_reg.smoothedgenearby_enable = 	NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Smoothedgenearby_Enable) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
//		snr_edge_dependent_ctrl_2_reg.smoothedgenearby_range = 	NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Smoothedgenearby_Range) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
//		snr_edge_dependent_ctrl_2_reg.modified_lpf_enable = 		NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Modified_Lpf_Enable) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
//		snr_edge_dependent_ctrl_2_reg.modified_lpf_thr = 			*(NR_TABLE32 + (DNR_TABLE_32[SPATIAL_Y_TABLE]+Modified_Lpf_Thr) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		smooth_prelpf_ctrl_reg.prelpf_snr_sel = 	NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Prelpf_Snr_Sel) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		//mixer_ctrl_reg.vfir_weight = NR_TABLE8[ (DNR_TABLE_8[SPATIAL_Y_TABLE]+Vfir_Weight) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

		//SPATIAL_C
		SPATIAL_C_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_C];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_C] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		dch1_CP_Ctrl_reg.cp_zoranfiltersizec = 			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_ZoranFilterSizeC)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_CP_Ctrl_reg.cp_spatialenablec =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialEnableC) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Thl2_reg.cp_spatialthlcx4 =		NR_TABLE8[ (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlCx4) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Thl_reg.cp_spatialthlcx2 =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlCx2) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		dch1_Spatial_Thl_reg.cp_spatialthlc =			NR_TABLE8[ (DNR_TABLE_8[SPATIAL_C_TABLE]+CP_SpatialThlC) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];

	}

	rtd_outl(NR_DCH1_CP_CTRL_reg, dch1_CP_Ctrl_reg.regValue);
	rtd_outl(NR_DCH1_SPATIAL_THL_reg, dch1_Spatial_Thl_reg.regValue);
	rtd_outl(NR_DCH1_SPATIAL_THL2_reg, dch1_Spatial_Thl2_reg.regValue);
	rtd_outl(NR_DCH1_SPATIAL_WEIGHT_reg, dch1_Spatial_Weight_Reg.regValue);
	rtd_outl(NR_DCH1_LOCAL_VAR2_reg, nr_dch1_local_var2_RBUS_Reg.regValue);
//	rtd_outl(NR_NEW_ALGO_0_reg,snr_edge_dependent_ctrl_reg.regValue);
//	rtd_outl(NR_NEW_ALGO_1_reg,snr_edge_dependent_ctrl_1_reg.regValue);
//	rtd_outl(NR_NEW_ALGO_2_reg,snr_edge_dependent_ctrl_2_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_PRELPF_CTRL_reg,smooth_prelpf_ctrl_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_MIXER_CTRL_reg, mixer_ctrl_reg.regValue);

	spatial_check[0] = dch1_CP_Ctrl_reg.cp_spatialenabley;
	spatial_check[1] = dch1_Spatial_Thl_reg.cp_spatialthly;
	spatial_check[2] = dch1_Spatial_Thl_reg.cp_spatialthlyx2;
	spatial_check[3] = dch1_Spatial_Thl2_reg.cp_spatialthlyx4;
	spatial_check[4] = dch1_CP_Ctrl_reg.cp_spatialenablec;
	spatial_check[5] = dch1_Spatial_Thl_reg.cp_spatialthlc;
	spatial_check[6] = dch1_Spatial_Thl_reg.cp_spatialthlcx2;
	spatial_check[7] = dch1_Spatial_Thl2_reg.cp_spatialthlcx4;
	//=========for check double buffer write error=================================
//Elsie 20131003 remove double buffer checking
/*
	do{
		BusyCheckRegBit(VGIP_VGIP_CHN1_STATUS_reg, _BIT26,0x0001FFFF);//frank@0430 change wait vsync start
		//WaitFor_IEN_STOP1();

		dch1_CP_Ctrl_reg.regValue = rtd_inl(NR_DCH1_CP_CTRL_reg);
		dch1_Spatial_Thl_reg.regValue = rtd_inl(NR_DCH1_SPATIAL_THL_reg);
		dch1_Spatial_Thl2_reg.regValue = rtd_inl(NR_DCH1_SPATIAL_THL2_reg);
		spatial_check_count = 0;
		check_loop_count++;

		for(i=0;i<8;i++)
		{
			switch(i)
			{
				case 0:
					if(spatial_check[0] == dch1_CP_Ctrl_reg.cp_spatialenabley)
						spatial_check_count++;
					else
					{
						dch1_CP_Ctrl_reg.cp_spatialenabley=spatial_check[0];
					}
					break;
				case 1:
					if(spatial_check[1] == dch1_Spatial_Thl_reg.cp_spatialthly)
						spatial_check_count ++;
					else
					{
						dch1_Spatial_Thl_reg.cp_spatialthly=spatial_check[1];
					}
					break;
				case 2:
					if(spatial_check[2] == dch1_Spatial_Thl_reg.cp_spatialthlyx2)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl_reg.cp_spatialthlyx2=spatial_check[2];
					}
					break;
				case 3:
					if(spatial_check[3] == dch1_Spatial_Thl2_reg.cp_spatialthlyx4)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl2_reg.cp_spatialthlyx4=spatial_check[3];
					}
					break;
				case 4:
					if(spatial_check[4] == dch1_CP_Ctrl_reg.cp_spatialenablec)
						spatial_check_count++;
					else
					{
						dch1_CP_Ctrl_reg.cp_spatialenablec=spatial_check[4];
					}
					break;
				case 5:
					if(spatial_check[5] == dch1_Spatial_Thl_reg.cp_spatialthlc)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl_reg.cp_spatialthlc=spatial_check[5];
					}
					break;
				case 6:
					if(spatial_check[6] == dch1_Spatial_Thl_reg.cp_spatialthlcx2)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl_reg.cp_spatialthlcx2=spatial_check[6];
					}
					break;
				case 7:
					if(spatial_check[7] == dch1_Spatial_Thl2_reg.cp_spatialthlcx4)
						spatial_check_count++;
					else
					{
						dch1_Spatial_Thl2_reg.cp_spatialthlcx4=spatial_check[7];
					}
					break;
				default:
					break;
			}

		}

		if(spatial_check_count<8)
		{

			rtd_outl(NR_DCH1_CP_CTRL_reg, dch1_CP_Ctrl_reg.regValue);
			rtd_outl(NR_DCH1_SPATIAL_THL_reg, dch1_Spatial_Thl_reg.regValue);
			rtd_outl(NR_DCH1_SPATIAL_THL2_reg, dch1_Spatial_Thl2_reg.regValue);
		}

	}while(spatial_check_count<8 && check_loop_count<6 );
*/
	//=================================================================
}
#endif

#if 0 // Replase by PQA adaptive control Flow
void drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_RfCvbs(unsigned char channel, unsigned char VD_noise_level)
{
	unsigned char SPATIAL_Y_TABLE = 0;
	unsigned char current_Signal_Status;
	unsigned short curve_mapping_step[8];
	unsigned char i;

	if(DEBUG_AUTO_NR == 0)
		current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	else	//	debug enable;
		current_Signal_Status = DEBUG_VD_NOISE;

	nr_curve_mapping_ctrl_RBUS curve_mapping_ctrl_reg;
	nr_curve_mapping_step_0_RBUS curve_mapping_step_0_reg;
	nr_curve_mapping_step_1_RBUS curve_mapping_step_1_reg;
	nr_curve_mapping_step_2_RBUS curve_mapping_step_2_reg;
	nr_curve_mapping_step_3_RBUS curve_mapping_step_3_reg;
	nr_curve_mapping_w1_1_RBUS curve_mapping_w1_1_reg;
	nr_curve_mapping_w1_2_RBUS curve_mapping_w1_2_reg;
	nr_curve_mapping_w2_1_RBUS curve_mapping_w2_1_reg;
	nr_curve_mapping_w2_2_RBUS curve_mapping_w2_2_reg;
	new_lpf_nearby_ctrl_RBUS new_lpf_nearby_ctrl_reg;

	SPATIAL_Y_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_Y];
	curve_mapping_ctrl_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_CTRL_reg);
	curve_mapping_step_0_reg.regValue	=	rtd_inl(NR_CURVE_MAPPING_STEP_0_reg);
	curve_mapping_step_1_reg.regValue	=	rtd_inl(NR_CURVE_MAPPING_STEP_1_reg);
	curve_mapping_step_2_reg.regValue	=	rtd_inl(NR_CURVE_MAPPING_STEP_2_reg);
	curve_mapping_step_3_reg.regValue	=	rtd_inl(NR_CURVE_MAPPING_STEP_3_reg);
	curve_mapping_w1_1_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W1_1_reg);
	curve_mapping_w1_2_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W1_2_reg);
	curve_mapping_w2_1_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W2_1_reg);
	curve_mapping_w2_2_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W2_2_reg);
	new_lpf_nearby_ctrl_reg.regValue	=	rtd_inl(NR_NEW_LPF_NEARBY_CTRL_reg);
	//snr_db_ctrl_reg.regValue			=	IoReg_Read32(NR_SNR_DB_CTRL_reg);

	if (VD_noise_level <= NR_LEVEL_MAX)
	{
		for(i=CurvemappingMode_Step10;i<=CurvemappingMode_Step87;i++)
			{
				curve_mapping_step[i-CurvemappingMode_Step10] = NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+i)*NR_LEVEL_MAX+VD_noise_level-1];
				if(i!=CurvemappingMode_Step10)
					curve_mapping_step[i-CurvemappingMode_Step10] = curve_mapping_step[i-CurvemappingMode_Step10] + curve_mapping_step[i-CurvemappingMode_Step10-1];
			}
		curve_mapping_ctrl_reg.curvemappingmode_en		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Enable)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_step_0_reg.curvemapping_step1 	=	curve_mapping_step[0];
		curve_mapping_step_0_reg.curvemapping_step2 	=	curve_mapping_step[1];
		curve_mapping_step_1_reg.curvemapping_step3 	=	curve_mapping_step[2];
		curve_mapping_step_1_reg.curvemapping_step4 	=	curve_mapping_step[3];
		curve_mapping_step_2_reg.curvemapping_step5 	=	curve_mapping_step[4];
		curve_mapping_step_2_reg.curvemapping_step6 	=	curve_mapping_step[5];
		curve_mapping_step_3_reg.curvemapping_step7 	=	curve_mapping_step[6];
		curve_mapping_step_3_reg.curvemapping_step8 	=	curve_mapping_step[7];
		curve_mapping_w1_1_reg.curvemapping_w1_0 		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight10)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w1_1_reg.curvemapping_w1_1 		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight11)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w1_1_reg.curvemapping_w1_2		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight12)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w1_1_reg.curvemapping_w1_3		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight13)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w1_1_reg.curvemapping_w1_4		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight14)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w1_1_reg.curvemapping_w1_5		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight15)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w1_1_reg.curvemapping_w1_6		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight16)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w1_1_reg.curvemapping_w1_7		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight17)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w1_2_reg.curvemapping_w1_8		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight18)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_1_reg.curvemapping_w2_0 		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight20)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_1_reg.curvemapping_w2_1 		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight21)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_1_reg.curvemapping_w2_2		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight22)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_1_reg.curvemapping_w2_3		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight23)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_1_reg.curvemapping_w2_4		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight24)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_1_reg.curvemapping_w2_5		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight25)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_1_reg.curvemapping_w2_6		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight26)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_1_reg.curvemapping_w2_7		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight27)*NR_LEVEL_MAX+VD_noise_level-1];
		curve_mapping_w2_2_reg.curvemapping_w2_8		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight28)*NR_LEVEL_MAX+VD_noise_level-1];
		//new_lpf_nearby_ctrl_reg.smoothedgenearby_enable	=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+Smoothedgenearby_Enable)*NR_LEVEL_MAX+VD_noise_level-1];
		//new_lpf_nearby_ctrl_reg.smoothedgenearby_range	=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+Smoothedgenearby_Range)*NR_LEVEL_MAX+VD_noise_level-1];
		//new_lpf_nearby_ctrl_reg.smoothedgenearby_thd	=	Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_Y_TABLE]+Smoothedgenearby_Thl), VD_noise_status, VD_noise_status_offset];
		new_lpf_nearby_ctrl_reg.modified_lpf_enable		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+Modified_Lpf_Enable)*NR_LEVEL_MAX+VD_noise_level-1];
		new_lpf_nearby_ctrl_reg.modified_lpf_thr		=	Lerp_NR_TABLE32(current_Signal_Status, VD_noise_level, (DNR_TABLE_8[SPATIAL_Y_TABLE]+Modified_Lpf_Thr), VD_noise_status, VD_noise_status_offset);

		rtd_outl(NR_CURVE_MAPPING_CTRL_reg, curve_mapping_ctrl_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_STEP_0_reg, curve_mapping_step_0_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_STEP_1_reg, curve_mapping_step_1_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_STEP_2_reg, curve_mapping_step_2_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step_3_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_W1_1_reg, curve_mapping_w1_1_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_W2_1_reg, curve_mapping_w2_1_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_W2_2_reg, curve_mapping_w2_2_reg.regValue);
		rtd_outl(NR_NEW_LPF_NEARBY_CTRL_reg, new_lpf_nearby_ctrl_reg.regValue);
	}
}
#endif

#if 0 // Replase by PQA adaptive control Flow
void drvif_color_Intelligent_picture_Ctrl_RfCvbs(unsigned char channel, unsigned char VD_noise_level)//for T2 @ RF/CVBS, elieli 20130925
{
	unsigned short ratio;
	static unsigned char pre_VD_noise_level = 255;
	unsigned char coring_offset;
	color_sharp_dm_peaking_gain_RBUS dm_peaking_gain_reg;
	dm_peaking_gain_reg.regValue = rtd_inl(COLOR_SHARP_DM_PEAKING_GAIN_reg);
	color_sharp_dm_segpk_edgpk3_RBUS dm_segpk_edgpk3;
	dm_segpk_edgpk3.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg);
	color_sharp_dm_segpk_vpk2_RBUS dm_segpk_vpk2;
	dm_segpk_vpk2.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_VPK2_reg);
	color_sharp_dm_segpk_edgpk4_RBUS dm_segpk_edgpk4;
	dm_segpk_edgpk4.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_EDGPK4_reg);
	dm_peaking_bound_RBUS dm_peaking_bound_reg;
	dm_peaking_bound_reg.regValue = rtd_inl(COLOR_SHARP_DM_PEAKING_BOUND_reg);


	if(!intelligent_picture_table)
		return;

#if 0
		/*unsigned int debug_reg;
		debug_reg = rtd_inl(COLOR_DCC_D_DCC_FWUSED_0_reg);

		if((debug_reg & _BIT1)==_BIT1)
			ratio = (debug_reg & 0xFF0)>>4;*/

		if(MA_print_count%200==0)
			ROSPrintf("%d,%d,%d,%d,%d,%d,%d\n",intelligent_picture_table[0],intelligent_picture_table[1],intelligent_picture_table[2],intelligent_picture_table[3]
			,intelligent_picture_table[4],intelligent_picture_table[5],VD_noise_level);
#endif

	if(((intelligent_picture_table[INTELLIGENT_PICTURE_ENABLE]==0)||(VD_noise_level==pre_VD_noise_level)) && Sharpness_OSD_update == _FALSE)
		return;

	ratio = (VD_noise_level-1)<0?0:(VD_noise_level-1);
	ratio = (10-ratio)*103;

	if(VD_noise_level<6)
		coring_offset=0;
	else if(VD_noise_level<9)
		coring_offset=1;
	else
		coring_offset=2;

	dm_peaking_gain_reg.gain_pos = (unsigned char)((intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_TEXTURE_POS_GAIN]*ratio)>>10);
	dm_peaking_gain_reg.gain_neg = (unsigned char)((intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_TEXTURE_NEG_GAIN]*ratio)>>10);

	dm_segpk_edgpk3.gain_pos = (unsigned char)((intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_EDGE_POS_GAIN]*ratio)>>10);
	dm_segpk_edgpk3.gain_neg = (unsigned char)((intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_EDGE_NEG_GAIN]*ratio)>>10);

	dm_segpk_vpk2.vpk_gain_pos = (unsigned char)((intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_VERTICAL_POS_GAIN]*ratio)>>10);
	dm_segpk_vpk2.vpk_gain_neg = (unsigned char)((intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_VERTICAL_NEG_GAIN]*ratio)>>10);

	dm_segpk_vpk2.vpk_lv=(unsigned char)intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_VERTICAL_CORING]+coring_offset;
	dm_segpk_edgpk4.lv=(unsigned char)intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_EDGE_CORING]+coring_offset;;
	dm_peaking_bound_reg.lv=(unsigned char)intelligent_picture_table[INTELLIGENT_PICTURE_TABLE_TEXTURE_CORING]+coring_offset;;

	rtd_outl(COLOR_SHARP_DM_PEAKING_GAIN_reg, dm_peaking_gain_reg.regValue);
	rtd_outl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg, dm_segpk_edgpk3.regValue);
	rtd_outl(COLOR_SHARP_DM_SEGPK_VPK2_reg, dm_segpk_vpk2.regValue);
	rtd_outl(COLOR_SHARP_DM_SEGPK_EDGPK4_reg, dm_segpk_edgpk4.regValue);
	rtd_outl(COLOR_SHARP_DM_PEAKING_BOUND_reg, dm_peaking_bound_reg.regValue);

	pre_VD_noise_level = VD_noise_level;

	Sharpness_OSD_update = _FALSE;

}
#endif


#if 0 //Replase by PQA adaptive control Flow (Only SONY)
unsigned char scalerVIP_Calculate_NR_offset_byMotionCompare()
{
	unsigned int th[RTNR_OFFSET_byFilmMotionStatus_TH_MAX];
	unsigned char offset[RTNR_OFFSET_byFilmMotionStatus_TH_MAX+1];

	unsigned char i=0, source_index=0;
	unsigned int motion=0, ret_offset=0;
	di_im_di_si_film_motion_next_RBUS im_di_si_film_motion_next_reg;

	if((RPC_system_info_structure_table->VIP_source)<=VIP_QUALITY_CVBS_S_PAL)
		source_index = 0;
	else if((RPC_system_info_structure_table->VIP_source)>=VIP_QUALITY_HDMI_480I&&(RPC_system_info_structure_table->VIP_source)<=VIP_QUALITY_HDMI_576P)
		source_index = 1;
	else if((RPC_system_info_structure_table->VIP_source)>=VIP_QUALITY_HDMI_720P&&(RPC_system_info_structure_table->VIP_source)<=VIP_QUALITY_HDMI_1080P)
		source_index = 2;

	for(i=0;i<RTNR_OFFSET_byFilmMotionStatus_TH_MAX;i++)
		th[i] = NR_offset_byMotionCompare_th[source_index][i];
	for(i=0;i<RTNR_OFFSET_byFilmMotionStatus_TH_MAX+1;i++)
		offset[i] = NR_offset_byMotionCompare_offset[source_index][i];

	im_di_si_film_motion_next_reg.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);
	motion = im_di_si_film_motion_next_reg.regValue;

	for(i=0;i<RTNR_OFFSET_byFilmMotionStatus_TH_MAX;i++)
	{
		if(motion<th[i])
			break;
	}
	ret_offset = offset[i];


#if 0
	unsigned int th1[RTNR_OFFSET_byNoiseStatistic_TH_MAX]={7000, 10000, 13000, 17000, 23000, 30000, 45000, 80000, 180000,};
	unsigned char offset1[RTNR_OFFSET_byNoiseStatistic_TH_MAX+1]={0, 1, 2, 3, 4, 5, 6, 7, 8, 9};
	if(AutoMA_Struct->AutoMA3_En==0)
	{
	im_di_si_film_motion_next_reg.regValue = rtd_inl(DI_IM_DI_SI_FILM_MOTION_reg);
	motion = im_di_si_film_motion_next_reg.regValue;

	for(i=0;i<RTNR_OFFSET_byFilmMotionStatus_TH_MAX;i++)
	{
		if(motion<th[i])
			break;
	}
	ret_offset = offset[i];
	}
	else
	{
		motion = Noise_Stastic_Count;
		for(i=0;i<RTNR_OFFSET_byNoiseStatistic_TH_MAX;i++)
		{
			if(motion<th1[i])
				break;
		}
		ret_offset = offset1[i];
	}

#endif
#if 0
	static unsigned int counter=0;
	if(counter%50==0)
		ROSPrintf("ret_offset=%d,%d\n",ret_offset,motion);
	counter++;
#endif

	return ret_offset;
}
#endif

#if 0 //Replase by PQA adaptive control Flow (Only SONY)
unsigned char scalerVIP_RTNR_Level_Step_Change(unsigned char RTNR_LEVEL)
{
	static unsigned char pre_level=0;
	unsigned char step = 1;
	if(pre_level>RTNR_LEVEL)
		pre_level = pre_level - step;
	else if(pre_level<RTNR_LEVEL)
		pre_level = pre_level + step;

	return pre_level;
}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_SdHd(unsigned char channel, unsigned char DNR_Auto_lvl_SdHd)
{
	unsigned char SPATIAL_Y_TABLE = 0;
	unsigned short curve_mapping_step[8];
	unsigned char i;

	nr_curve_mapping_ctrl_RBUS curve_mapping_ctrl_reg;
	nr_curve_mapping_step_0_RBUS curve_mapping_step_0_reg;
	nr_curve_mapping_step_1_RBUS curve_mapping_step_1_reg;
	nr_curve_mapping_step_2_RBUS curve_mapping_step_2_reg;
	nr_curve_mapping_step_3_RBUS curve_mapping_step_3_reg;
	nr_curve_mapping_w1_1_RBUS curve_mapping_w1_1_reg;
	nr_curve_mapping_w1_2_RBUS curve_mapping_w1_2_reg;
	nr_curve_mapping_w2_1_RBUS curve_mapping_w2_1_reg;
	nr_curve_mapping_w2_2_RBUS curve_mapping_w2_2_reg;
	new_lpf_nearby_ctrl_RBUS new_lpf_nearby_ctrl_reg;

	SPATIAL_Y_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_SPATIAL_Y];
	curve_mapping_ctrl_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_CTRL_reg);
	curve_mapping_step_0_reg.regValue	=	rtd_inl(NR_CURVE_MAPPING_STEP_0_reg);
	curve_mapping_step_1_reg.regValue	=	rtd_inl(NR_CURVE_MAPPING_STEP_1_reg);
	curve_mapping_step_2_reg.regValue	=	rtd_inl(NR_CURVE_MAPPING_STEP_2_reg);
	curve_mapping_step_3_reg.regValue	=	rtd_inl(NR_CURVE_MAPPING_STEP_3_reg);
	curve_mapping_w1_1_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W1_1_reg);
	curve_mapping_w1_2_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W1_2_reg);
	curve_mapping_w2_1_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W2_1_reg);
	curve_mapping_w2_2_reg.regValue 	=	rtd_inl(NR_CURVE_MAPPING_W2_2_reg);
	new_lpf_nearby_ctrl_reg.regValue	=	rtd_inl(NR_NEW_LPF_NEARBY_CTRL_reg);
	//snr_db_ctrl_reg.regValue			=	IoReg_Read32(NR_SNR_DB_CTRL_reg);

	if (DNR_Auto_lvl_SdHd <= NR_LEVEL_MAX)
	{
		for(i=CurvemappingMode_Step10;i<=CurvemappingMode_Step87;i++)
		{
			curve_mapping_step[i-CurvemappingMode_Step10] = NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+i)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
			if(i!=CurvemappingMode_Step10)
				curve_mapping_step[i-CurvemappingMode_Step10] = curve_mapping_step[i-CurvemappingMode_Step10] + curve_mapping_step[i-CurvemappingMode_Step10-1];
		}

		curve_mapping_ctrl_reg.curvemappingmode_en		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Enable)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_step_0_reg.curvemapping_step1 	=	curve_mapping_step[0];
		curve_mapping_step_0_reg.curvemapping_step2 	=	curve_mapping_step[1];
		curve_mapping_step_1_reg.curvemapping_step3 	=	curve_mapping_step[2];
		curve_mapping_step_1_reg.curvemapping_step4 	=	curve_mapping_step[3];
		curve_mapping_step_2_reg.curvemapping_step5 	=	curve_mapping_step[4];
		curve_mapping_step_2_reg.curvemapping_step6 	=	curve_mapping_step[5];
		curve_mapping_step_3_reg.curvemapping_step7 	=	curve_mapping_step[6];
		curve_mapping_step_3_reg.curvemapping_step8 	=	curve_mapping_step[7];
		curve_mapping_w1_1_reg.curvemapping_w1_0 		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight10)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w1_1_reg.curvemapping_w1_1 		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight11)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w1_1_reg.curvemapping_w1_2		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight12)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w1_1_reg.curvemapping_w1_3		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight13)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w1_1_reg.curvemapping_w1_4		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight14)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w1_1_reg.curvemapping_w1_5		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight15)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w1_1_reg.curvemapping_w1_6		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight16)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w1_1_reg.curvemapping_w1_7		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight17)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w1_2_reg.curvemapping_w1_8		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight18)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_1_reg.curvemapping_w2_0 		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight20)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_1_reg.curvemapping_w2_1 		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight21)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_1_reg.curvemapping_w2_2		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight22)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_1_reg.curvemapping_w2_3		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight23)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_1_reg.curvemapping_w2_4		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight24)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_1_reg.curvemapping_w2_5		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight25)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_1_reg.curvemapping_w2_6		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight26)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_1_reg.curvemapping_w2_7		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight27)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		curve_mapping_w2_2_reg.curvemapping_w2_8		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+CurvemappingMode_Weight28)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		//new_lpf_nearby_ctrl_reg.smoothedgenearby_enable	=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+Smoothedgenearby_Enable)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		//new_lpf_nearby_ctrl_reg.smoothedgenearby_range	=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+Smoothedgenearby_Range)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		//new_lpf_nearby_ctrl_reg.smoothedgenearby_thd	=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+Smoothedgenearby_Thl)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		new_lpf_nearby_ctrl_reg.modified_lpf_enable		=	NR_TABLE8[(DNR_TABLE_8[SPATIAL_Y_TABLE]+Modified_Lpf_Enable)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		new_lpf_nearby_ctrl_reg.modified_lpf_thr		=	NR_TABLE32[(DNR_TABLE_32[SPATIAL_Y_TABLE]+Modified_Lpf_Thr)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];

		rtd_outl(NR_CURVE_MAPPING_CTRL_reg, curve_mapping_ctrl_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_STEP_0_reg, curve_mapping_step_0_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_STEP_1_reg, curve_mapping_step_1_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_STEP_2_reg, curve_mapping_step_2_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_STEP_3_reg, curve_mapping_step_3_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_W1_1_reg, curve_mapping_w1_1_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_W1_2_reg, curve_mapping_w1_2_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_W2_1_reg, curve_mapping_w2_1_reg.regValue);
		rtd_outl(NR_CURVE_MAPPING_W2_2_reg, curve_mapping_w2_2_reg.regValue);
		rtd_outl(NR_NEW_LPF_NEARBY_CTRL_reg, new_lpf_nearby_ctrl_reg.regValue);
	}
}
#endif

#if 0 // Replase by PQA adaptive control Flow
void drvif_color_Dark_k_value_AutoMode_RfCvbs(unsigned char channel, unsigned char VD_noise_level)
{
	unsigned char Dark_K_TABLE = 0;
	unsigned char temp = VD_noise_level;

	di_im_di_rtnr_k_dark_RBUS di_im_di_rtnr_k_dark_RBUS_reg;
	di_im_di_rtnr_k_dark_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_K_DARK_reg);
	if(VD_noise_level <= NR_LEVEL_MAX)
	{
		//Dark_K
		Dark_K_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_Dark_K];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_Dark_K]  + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}

		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_kout_dark_2 = 		NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Kout_Dark_2)* NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_kin_dark_2 = 		NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Kin_Dark_2)* NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_dark_th = 			NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Dark_Th)* NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_kout_dark = 		NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Kout_Dark)* NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_kin_dark = 			NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Kin_Dark)* NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_dark_k_en = 		NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Dark_K_en)* NR_LEVEL_MAX + VD_noise_level - 1];
	}
	rtd_outl(DI_IM_DI_RTNR_K_DARK_reg, di_im_di_rtnr_k_dark_RBUS_reg.regValue);

}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_Dark_k_value_AutoMode_HdSd(unsigned char channel, unsigned char DNR_Auto_lvl_SdHd)
{
	unsigned char Dark_K_TABLE = 0;
	unsigned char temp = DNR_Auto_lvl_SdHd;
	di_im_di_rtnr_k_dark_RBUS di_im_di_rtnr_k_dark_RBUS_reg;
	di_im_di_rtnr_k_dark_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_K_DARK_reg);
	if(DNR_Auto_lvl_SdHd <= NR_LEVEL_MAX)
	{
		//Dark_K
		Dark_K_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_Dark_K];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_Dark_K] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_kout_dark_2 = 		NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Kout_Dark_2)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_kin_dark_2 = 		NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Kin_Dark_2)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_dark_th = 			NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Dark_Th)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_kout_dark = 		NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Kout_Dark)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_kin_dark = 			NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Kin_Dark)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
		di_im_di_rtnr_k_dark_RBUS_reg.cp_temporal_y_dark_k_en = 		NR_TABLE8 [ (DNR_TABLE_8[Dark_K_TABLE]+CP_Temporal_Y_Dark_K_en)* NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1];
	}

	rtd_outl(DI_IM_DI_RTNR_K_DARK_reg, di_im_di_rtnr_k_dark_RBUS_reg.regValue);
}
#endif

#if 0 // Replase by PQA adaptive control Flo

void drvif_color_MCNR_AutoMode_RfCvbs(unsigned char channel, unsigned char VD_noise_level)
{
	unsigned char MCNR_TABLE = 0;
	unsigned char temp = VD_noise_level;

	di_im_di_rtnr_hmcnr_RBUS di_im_di_rtnr_hmcnr_RBUS_reg;
	di_im_di_rtnr_hmcnr_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_reg);

	if(VD_noise_level <= NR_LEVEL_MAX)
	{
		//MCNR
		MCNR_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_MCNR];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_MCNR]  + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}

		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_weight = 			NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_weight) * NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_ref_topline_th = 		NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_ref_topline_th) * NR_LEVEL_MAX + VD_noise_level - 1];
		//di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_debug_progressive = 	NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_debug_progressive) * NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_ref_topline_en = 		NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_ref_topline_en) * NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_uv_with_y = 		NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_uv_with_y) * NR_LEVEL_MAX + VD_noise_level - 1];
		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_search_range = 		NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_search_range) * NR_LEVEL_MAX + VD_noise_level - 1];
	}
	rtd_outl(DI_IM_DI_RTNR_HMCNR_reg, di_im_di_rtnr_hmcnr_RBUS_reg.regValue);
}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_MCNR_AutoMode_HdSd(unsigned char channel, unsigned char DNR_Auto_lvl_SdHd)
{
	unsigned char MCNR_TABLE = 0;
	unsigned char temp = DNR_Auto_lvl_SdHd;
	di_im_di_rtnr_hmcnr_RBUS di_im_di_rtnr_hmcnr_RBUS_reg;
	di_im_di_rtnr_hmcnr_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_HMCNR_reg);

	if(DNR_Auto_lvl_SdHd <= NR_LEVEL_MAX)
	{
		//MCNR
		MCNR_TABLE = DNR_LEVEL_TABLE[ DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_MCNR ];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[ DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_MCNR ] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_weight = 			NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_weight) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1 ];
		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_ref_topline_th = 		NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_ref_topline_th) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1 ];
		//di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_debug_progressive = 	NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_debug_progressive) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1 ];
		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_ref_topline_en = 		NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_ref_topline_en) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1 ];
		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_uv_with_y = 		NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_uv_with_y) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1 ];
		di_im_di_rtnr_hmcnr_RBUS_reg.cp_temporal_hmcnr_search_range = 		NR_TABLE8[ (DNR_TABLE_8[MCNR_TABLE]+CP_Temporal_HMCNR_search_range) * NR_LEVEL_MAX + DNR_Auto_lvl_SdHd - 1 ];
	}

	rtd_outl(DI_IM_DI_RTNR_HMCNR_reg, di_im_di_rtnr_hmcnr_RBUS_reg.regValue);
}
#endif

#if 0 // Replase by PQA adaptive control Flow
void drvif_color_MpegNR_AutoMode_RfCvbs(unsigned char channel, unsigned char VD_noise_level)
{
	unsigned char MPEGNR_H_TABLE = 0, MPEGNR_V_TABLE = 0;
	unsigned char temp = VD_noise_level;
	unsigned int current_Signal_Status = 0;

	mpegnr_ich1_mpegnr1_RBUS ich1_MPEGNR1_reg;
	mpegnr_ich1_mpegnr2_RBUS ich1_MPEGNR2_reg;
	nr_dch1_mpegnr1_RBUS dch1_MPEGNR1_Reg;

	ich1_MPEGNR1_reg.regValue = rtd_inl(MPEGNR_ICH1_MPEGNR1_reg);
	ich1_MPEGNR2_reg.regValue = rtd_inl(MPEGNR_ICH1_MPEGNR2_reg);
	dch1_MPEGNR1_Reg.regValue = rtd_inl(NR_DCH1_MPEGNR1_reg);

	//current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	if(DEBUG_AUTO_NR == 0)
		current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
	else	//	debug enable;
		current_Signal_Status = DEBUG_VD_NOISE;

	if(VD_noise_level <= NR_LEVEL_MAX)
	{
		//MPEGNR_H
		MPEGNR_H_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_MPEG_H];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVip_mpegNR+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_MPEG_H]  + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}

		//ich1_MPEGNR1_reg.cp_mpgupperbound_x = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgUpperBound_X)*NR_LEVEL_MAX+VD_noise_level-1];//for_LG_demo

		switch((RPC_system_info_structure_table->VIP_source))//for_LG_demo
		{
		 case VIP_QUALITY_CVBS_NTSC:
		 case VIP_QUALITY_CVBS_PAL:
		 case VIP_QUALITY_HDMI_480I:
		 case VIP_QUALITY_HDMI_576I:
		  ich1_MPEGNR1_reg.cp_mpgupperbound_x =6;
		  break;

		 default:
			 ich1_MPEGNR1_reg.cp_mpgupperbound_x =	NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgUpperBound_X)*NR_LEVEL_MAX+VD_noise_level-1];

		  break;

		}



		ich1_MPEGNR2_reg.cp_mpgdcgain = 				NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgDcGain)*NR_LEVEL_MAX+VD_noise_level-1];
		ich1_MPEGNR2_reg.cp_mpgdcqp = 				NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgDcQp)*NR_LEVEL_MAX+VD_noise_level-1];
		ich1_MPEGNR2_reg.cp_mpgfiltersel1 = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgFilterSel1)*NR_LEVEL_MAX+VD_noise_level-1];
		//ich1_MPEGNR2_reg.cp_mpgfiltersel2 = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgFilterSel2)*NR_LEVEL_MAX+VD_noise_level-1];
		ich1_MPEGNR2_reg.cp_mpgidxmode_x = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgIdxMode_X)*NR_LEVEL_MAX+VD_noise_level-1];
		if(AutoNR_Enable_by_Low_Mid_High)
			ich1_MPEGNR2_reg.cp_mpegresultweight_x = 		Lerp_NR_rate((DNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpegResultWeight_X), VD_noise_level, rate_Lerp_NR);
		else
			ich1_MPEGNR2_reg.cp_mpegresultweight_x = 		Lerp_NR_TABLE8(current_Signal_Status, VD_noise_level, (MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpegResultWeight_X), VD_noise_status, VD_noise_status_offset);
		ich1_MPEGNR2_reg.cp_mpegenable_x = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpegEnable_X)*NR_LEVEL_MAX+VD_noise_level-1];

		//MPEGNR_V
		MPEGNR_V_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_MPEG_V];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			VD_noise_level = temp;
			VD_noise_level = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVip_mpegNR+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_MPEG_V]  + VD_noise_level;
			VD_noise_level = (VD_noise_level>=AutoNR_Level_bound)?AutoNR_Level_bound:(VD_noise_level);
		}

		dch1_MPEGNR1_Reg.cp_mpglowerbound = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgLowerBound)*NR_LEVEL_MAX+VD_noise_level-1];
		dch1_MPEGNR1_Reg.cp_mpgupperbound = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgUpperBound)*NR_LEVEL_MAX+VD_noise_level-1];
		dch1_MPEGNR1_Reg.cp_mpglpmode = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgLPmode)*NR_LEVEL_MAX+VD_noise_level-1];
		dch1_MPEGNR1_Reg.cp_mpgidx_y = 				NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgIdx_Y)*NR_LEVEL_MAX+VD_noise_level-1];
		dch1_MPEGNR1_Reg.cp_mpegresultweight_y = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpegResultWeight_Y)*NR_LEVEL_MAX+VD_noise_level-1];
		dch1_MPEGNR1_Reg.cp_mpgidxmode_y = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgIdxMode_Y)*NR_LEVEL_MAX+VD_noise_level-1];
		dch1_MPEGNR1_Reg.cp_mpegenable_y_c = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpegEnable_Y_C)*NR_LEVEL_MAX+VD_noise_level-1];
		dch1_MPEGNR1_Reg.cp_mpegenable_y_y = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpegEnable_Y_Y)*NR_LEVEL_MAX+VD_noise_level-1];

	}

	rtd_outl(MPEGNR_ICH1_MPEGNR1_reg, ich1_MPEGNR1_reg.regValue);
	rtd_outl(MPEGNR_ICH1_MPEGNR2_reg, ich1_MPEGNR2_reg.regValue);
	rtd_outl(NR_DCH1_MPEGNR1_reg, dch1_MPEGNR1_Reg.regValue);

}
#endif


#if 0 //Replase by PQA adaptive control Flow
void drvif_color_DVBT_MpegNR()
{


    unsigned short   temp = 0;
    unsigned short   MaxValue = 0, SecondMaxValue;
    unsigned short   MaxValue_V, SecondMaxValue_V;
    unsigned char   i;
    unsigned char   MpegRatio, MpegRatio_V;
    mpegnr_mpegnr_ich1_cnthor0_RBUS ich1_CntHor0_reg;
    mpegnr_ich1_cnthor2_RBUS ich1_CntHor2_reg;
    mpegnr_ich1_cnthor4_RBUS ich1_CntHor4_reg;
    mpegnr_ich1_cnthor6_RBUS ich1_CntHor6_reg;

    di_cntver0_RBUS cntver0_reg;
    di_cntver2_RBUS cntver2_reg;
    di_cntver4_RBUS cntver4_reg;
    di_cntver6_RBUS cntver6_reg;

    unsigned short      MpgHorStart = 0;
    unsigned short      MpgHorEnd = 0;
    unsigned short      MpgVerStart = 0;
    unsigned short      MpgVerEnd = 0;
    unsigned short      width,height;
    unsigned short      th1,th2,th3;
    unsigned int		counter_H = 0;
//static unsigned int counter_ratio_sum = 0;

    mpegnr_ich1_hist_blking_hor_range_RBUS ich1_Hist_Blking_Hor_Range_reg;
    mpegnr_ich1_hist_blking_ver_range_RBUS ich1_Hist_Blking_Ver_Range_reg;
    //ich1_MPEGNR2_RBUS ich1_MPEGNR2_reg;


 // ich1_MPEGNR2_reg.regValue = rtd_inl(MPEGNR_ICH1_MPEGNR2_reg);
   ich1_Hist_Blking_Hor_Range_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_HIST_BLKING_HOR_RANGE_reg);
    MpgHorStart = ich1_Hist_Blking_Hor_Range_reg.cp_histhorstart ;
    MpgHorEnd = ich1_Hist_Blking_Hor_Range_reg.cp_histhorend;



    ich1_Hist_Blking_Ver_Range_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_HIST_BLKING_VER_RANGE_reg);
    MpgVerStart = ich1_Hist_Blking_Ver_Range_reg.cp_histverstart ;
    MpgVerEnd = ich1_Hist_Blking_Ver_Range_reg.cp_histverend;

    width=MpgHorEnd-MpgHorStart;
    height=MpgVerEnd-MpgVerStart;
    th3=width*height/1152;//300
    th2=th3/3;
    th1=th3/30;

	//read vertical counter to get MpgIdx_Y
    	 //==========================vertical
        MaxValue_V = 0;
	 SecondMaxValue_V = 0;
        cntver0_reg.regValue = scaler_rtd_inl(DI_CNTVER0_reg);
        cntver2_reg.regValue = scaler_rtd_inl(DI_CNTVER2_reg);
        cntver4_reg.regValue = scaler_rtd_inl(DI_CNTVER4_reg);
        cntver6_reg.regValue = scaler_rtd_inl(DI_CNTVER6_reg);
        for(i=0;i<8;i++)//read hor 8 counters
        {
        	switch(i)
        	{
        		case 0:
        	    	temp=cntver0_reg.cp_cntver0;
        	    	break;
        	    case 1:
        	    	temp=cntver0_reg.cp_cntver1;
        	    	break;
        	    case 2:
        	    	temp=cntver2_reg.cp_cntver2;
        	    	break;
        	    case 3:
        	    	temp=cntver2_reg.cp_cntver3;
        	    	break;
        	    case 4:
        	    	temp=cntver4_reg.cp_cntver4;
        	    	break;
        	    case 5:
        	    	temp=cntver4_reg.cp_cntver5;
        	    	break;
        	    case 6:
        	    	temp=cntver6_reg.cp_cntver6;
        	    	break;
        	    case 7:
        	    	temp=cntver6_reg.cp_cntver7;
        	    	break;
        	}

            if(MaxValue_V<= temp)
            {
            	     SecondMaxValue_V = MaxValue;
                   MaxValue_V = temp;
                   MpgIdx_Y = i;
            }
	     else if(SecondMaxValue_V <= temp)
            {
                   SecondMaxValue_V = temp;
            }
        }

	  if( (SecondMaxValue_V<th1) || (SecondMaxValue_V==0) )
            MpegRatio_V=0;
        else if(SecondMaxValue_V<th2)
            MpegRatio_V=MaxValue_V/SecondMaxValue_V/4;
        else if(SecondMaxValue_V<th3)
            MpegRatio_V=MaxValue_V/SecondMaxValue_V/2;
        else
            MpegRatio_V=MaxValue_V/SecondMaxValue_V;


	//read horizontal counter to get MpgIdx_X
    	//horizontal
        MaxValue = 0;
        SecondMaxValue = 0;
        ich1_CntHor0_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CNTHOR0_reg);
        ich1_CntHor2_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CNTHOR2_reg);
        ich1_CntHor4_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CNTHOR4_reg);
        ich1_CntHor6_reg.regValue = scaler_rtd_inl(MPEGNR_ICH1_CNTHOR6_reg);
        for(i=0;i<8;i++)//read hor 8 counters
        {
        	switch(i)
        	{
        		case 0:
        	    	temp=ich1_CntHor0_reg.cp_cnthor0;
        	    	break;
        	    case 1:
        	    	temp=ich1_CntHor0_reg.cp_cnthor1;
        	    	break;
        	    case 2:
        	    	temp=ich1_CntHor2_reg.cp_cnthor2;
        	    	break;
        	    case 3:
        	    	temp=ich1_CntHor2_reg.cp_cnthor3;
        	    	break;
        	    case 4:
        	    	temp=ich1_CntHor4_reg.cp_cnthor4;
        	    	break;
        	    case 5:
        	    	temp=ich1_CntHor4_reg.cp_cnthor5;
        	    	break;
        	    case 6:
        	    	temp=ich1_CntHor6_reg.cp_cnthor6;
        	    	break;
        	    case 7:
        	    	temp=ich1_CntHor6_reg.cp_cnthor7;
        	    	break;
        	}
            if(MaxValue <= temp)
            {
                   SecondMaxValue = MaxValue;
                   MaxValue = temp;
                   MpgIdx_X = i;
            }
            else if(SecondMaxValue <= temp)
            {
                   SecondMaxValue = temp;
            }
		 	counter_H= counter_H + temp;
        }

        if( (SecondMaxValue<th1) || (SecondMaxValue==0) )
            MpegRatio=0;
        else if(SecondMaxValue<th2)
            MpegRatio=MaxValue/SecondMaxValue/4;
        else if(SecondMaxValue<th3)
            MpegRatio=MaxValue/SecondMaxValue/2;
        else
            MpegRatio=MaxValue/SecondMaxValue;



//ich1_MPEGNR2_reg.cp_mpgidx_x=MpgIdx_X;
//scaler_rtd_outl(MPEGNR_ICH1_MPEGNR2_reg, ich1_MPEGNR2_reg.regValue);

}
#endif


#if 0 //Replase by PQA adaptive control Flow
void drvif_color_MpegNR_AutoMode_SdHd(unsigned char channel, unsigned char DNR_Auto_lvl_SdHd)
{
	unsigned char MPEGNR_H_TABLE = 0, MPEGNR_V_TABLE = 0;
	unsigned char temp = DNR_Auto_lvl_SdHd;
	mpegnr_ich1_mpegnr1_RBUS ich1_MPEGNR1_reg;
	mpegnr_ich1_mpegnr2_RBUS ich1_MPEGNR2_reg;
	nr_dch1_mpegnr1_RBUS dch1_MPEGNR1_Reg;

	ich1_MPEGNR1_reg.regValue = rtd_inl(MPEGNR_ICH1_MPEGNR1_reg);
	ich1_MPEGNR2_reg.regValue = rtd_inl(MPEGNR_ICH1_MPEGNR2_reg);
	dch1_MPEGNR1_Reg.regValue = rtd_inl(NR_DCH1_MPEGNR1_reg);

	drvif_color_DVBT_MpegNR();//young 20120804 add mpegNR MpgIdx_X decision
  	 ich1_MPEGNR2_reg.cp_mpgidx_x=MpgIdx_X;

	if(DNR_Auto_lvl_SdHd <= NR_LEVEL_MAX)
	{
		//MPEGNR_H
		MPEGNR_H_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_MPEG_H];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVip_mpegNR+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_MPEG_H] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		//ich1_MPEGNR1_reg.cp_mpgupperbound_x = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgUpperBound_X)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];//for_LG_demo

		switch((RPC_system_info_structure_table->VIP_source))//for_LG_demo
		{
		 case VIP_QUALITY_CVBS_NTSC:
		 case VIP_QUALITY_CVBS_PAL:
		 case VIP_QUALITY_HDMI_480I:
		 case VIP_QUALITY_HDMI_576I:
		  ich1_MPEGNR1_reg.cp_mpgupperbound_x =6;
		  break;

		 default:
			 ich1_MPEGNR1_reg.cp_mpgupperbound_x =		 NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgUpperBound_X)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];

		  break;

		}

		ich1_MPEGNR2_reg.cp_mpgdcgain = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgDcGain)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		ich1_MPEGNR2_reg.cp_mpgdcqp = 				NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgDcQp)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		ich1_MPEGNR2_reg.cp_mpgfiltersel1 = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgFilterSel1)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		//ich1_MPEGNR2_reg.cp_mpgfiltersel2 = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgFilterSel2)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		ich1_MPEGNR2_reg.cp_mpgidxmode_x = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpgIdxMode_X)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		ich1_MPEGNR2_reg.cp_mpegresultweight_x = 	NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpegResultWeight_X)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		ich1_MPEGNR2_reg.cp_mpegenable_x = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_H_TABLE]+CP_MpegEnable_X)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];

		//MPEGNR_V
		MPEGNR_V_TABLE = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_MPEG_V];
		if(AutoNR_Enable_by_Low_Mid_High)
		{
			DNR_Auto_lvl_SdHd = temp;
			DNR_Auto_lvl_SdHd = DNR_LEVEL_TABLE[DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(scalerVip_mpegNR+DNR_SELECT_OFF)*DNR_ITEM_MAX + DNR_ITEM_MPEG_V] + DNR_Auto_lvl_SdHd;
			DNR_Auto_lvl_SdHd = (DNR_Auto_lvl_SdHd>=AutoNR_Level_bound)?AutoNR_Level_bound:(DNR_Auto_lvl_SdHd);
		}

		dch1_MPEGNR1_Reg.cp_mpglowerbound = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgLowerBound)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		dch1_MPEGNR1_Reg.cp_mpgupperbound = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgUpperBound)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		dch1_MPEGNR1_Reg.cp_mpglpmode = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgLPmode)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		dch1_MPEGNR1_Reg.cp_mpgidx_y = 				NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgIdx_Y)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		dch1_MPEGNR1_Reg.cp_mpegresultweight_y = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpegResultWeight_Y)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		dch1_MPEGNR1_Reg.cp_mpgidxmode_y = 			NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpgIdxMode_Y)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		dch1_MPEGNR1_Reg.cp_mpegenable_y_c = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpegEnable_Y_C)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
		dch1_MPEGNR1_Reg.cp_mpegenable_y_y = 		NR_TABLE8[(MPEGNR_TABLE_8[MPEGNR_V_TABLE]+CP_MpegEnable_Y_Y)*NR_LEVEL_MAX+DNR_Auto_lvl_SdHd-1];
	}

//	if((MA_print_count % 300) == 0)
//		ROSPrintf("MPEGNR_H_TABLE = %d, MPEGNR_V_TABLE = %d, DNR_TABLE_SECET = %d\n",MPEGNR_H_TABLE, MPEGNR_V_TABLE,DNR_TABLE_SECET);

	rtd_outl(MPEGNR_ICH1_MPEGNR1_reg, ich1_MPEGNR1_reg.regValue);
	rtd_outl(MPEGNR_ICH1_MPEGNR2_reg, ich1_MPEGNR2_reg.regValue);
	rtd_outl(NR_DCH1_MPEGNR1_reg, dch1_MPEGNR1_Reg.regValue);

}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_DNRAUTO(unsigned char display,unsigned char AUTO_NR_style, unsigned char VD_noise_level, unsigned char DNR_Auto_lvl_SdHd)//ver.001 CSFC, from Magellen,20130311
{
//return;
	if( Scaler_InputSrcGetMainChType()==_SRC_HDMI ||
		Scaler_InputSrcGetMainChType()==_SRC_COMPONENT ||
		Scaler_InputSrcGetMainChType()==_SRC_YPBPR ||
		Scaler_InputSrcGetMainChType()==_SRC_PVR ||
		Scaler_InputSrcGetMainChType()==_SRC_VIDEO8 ||
		Scaler_InputSrcGetMainChType()==_SRC_USB ||
		Scaler_InputSrcGetMainChType()==_SRC_VO ||
		((Scaler_InputSrcGetMainChType()== _SRC_CVBS) && ((SmartPic_clue->VD_Signal_Status_value_avg) < 2) /*&& TV_05_style_ON*/) )  //20130826 roger, the CVBS conditoin only for TV05
	{
		drvif_color_DNR_AUTOMode(display, AUTO_NR_style, DNR_Auto_lvl_SdHd);
	}
	else if(Scaler_InputSrcGetMainChType()==_SRC_CVBS || Scaler_InputSrcGetMainChType()==_SRC_TV || Scaler_InputSrcGetMainChType()==_SRC_SV || Scaler_InputSrcGetMainChType()==_SRC_SCART)
	{
		drvif_color_TVAutoNR(display, AUTO_NR_style,VD_noise_level, DNR_Auto_lvl_SdHd);
	}

}
#endif

#if 0 //Replase by PQA adaptive control Flow
unsigned char drvif_color_DNR_AUTOMode(unsigned char display, unsigned char AUTO_NR_style, unsigned char DNR_Auto_lvl_SdHd)//ver.001 CSFC, sync from Mac in Magellen,20130311
{
//========================================================================//
//case 0 is new structure + TSB style for TSB project.
//========================================================================//

	static unsigned int counter_file = 0;
	if(((counter_file+4) % 7) == 0)
	{
		switch(AUTO_NR_style)
		{
			case 0: // for TOSHIBA
				drvif_color_VDNR_AutoMode_Off();
				drvif_color_RTNR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_RTNR_OF_SNR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Ediff_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Spatial_NR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Dark_k_value_AutoMode_HdSd(display, DNR_Auto_lvl_SdHd);
				drvif_color_MCNR_AutoMode_HdSd(display, DNR_Auto_lvl_SdHd);
				drvif_color_MpegNR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				// Hawaii add for Edge Peaking 20131022
				drvif_color_TSB_Edge_Peaking_AutoMode(DNR_Auto_lvl_SdHd,PictureMode);
				break;
			case 1: // default setting
				drvif_color_VDNR_AutoMode_Off();
				drvif_color_RTNR_AutoMode_SdHd(display, DNR_motion_lvl_SdHd);
				drvif_color_RTNR_OF_SNR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Ediff_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Spatial_NR_AutoMode_SdHd(display, DNR_motion_lvl_SdHd);
				//drvif_color_Spatial_NR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Dark_k_value_AutoMode_HdSd(display, DNR_Auto_lvl_SdHd);
				drvif_color_MCNR_AutoMode_HdSd(display, DNR_Auto_lvl_SdHd);
				if(AutoMA_Struct->AutoMA5_En == FALSE)//TRUE : disable MPEG on/off detector ; False : Enable MPEG on/off detector
				{
					drvif_color_MpegNR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				}
				break;
			case 2:	//for Sony
				Sony_Radio_Caculator_flag = Sony_radio_caculator_detect(1);
				if(Sony_Radio_Caculator_flag==1)
					Sony_Radio_Caculator_RTNR_offset = 9;
				else
					Sony_Radio_Caculator_RTNR_offset = 0;

				RTNR_LEVEL_SDHD_OFFSET_byMotionCompare = scalerVIP_Calculate_NR_offset_byMotionCompare();
				RTNR_LEVEL_SDHD_OFFSET_byMotionCompare = RTNR_LEVEL_SDHD_OFFSET_byMotionCompare+Sony_Radio_Caculator_RTNR_offset;
				RTNR_LEVEL_SDHD_SONY = ((RTNR_LEVEL_SDHD_SONY-RTNR_LEVEL_SDHD_OFFSET_byMotionCompare)<=1)?1:(RTNR_LEVEL_SDHD_SONY-RTNR_LEVEL_SDHD_OFFSET_byMotionCompare);
				RTNR_LEVEL_SDHD_SONY = scalerVIP_RTNR_Level_Step_Change(RTNR_LEVEL_SDHD_SONY);
				drvif_color_VDNR_AutoMode_Off();
				drvif_color_RTNR_AutoMode_SdHd(display, RTNR_LEVEL_SDHD_SONY);
				drvif_color_RTNR_OF_SNR_AutoMode_SdHd(display, RTNR_LEVEL_SDHD_SONY);
				drvif_color_Ediff_AutoMode_SdHd(display, RTNR_LEVEL_SDHD_SONY);
				drvif_color_Spatial_NR_AutoMode_SdHd(display, SPNR_LEVEL_SDHD_SONY);
				drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_SdHd(display, SPNR_LEVEL_SDHD_SONY);
				drvif_color_Dark_k_value_AutoMode_HdSd(display, RTNR_LEVEL_SDHD_SONY);
				drvif_color_MCNR_AutoMode_HdSd(display, RTNR_LEVEL_SDHD_SONY);
				scalerVIP_Adjusted_Shp_by_HistMeanValue_HDMI();//adjusted peaking to enhance NR effect, elieli 20131028
			#if 0
				if(MA_print_count%2==0)
					ROSPrintf("x=%d,%d,%d\n",Sony_Radio_Caculator_flag,RTNR_LEVEL_SDHD_SONY,Sony_Radio_Caculator_RTNR_offset);
			#endif
				//detect for every 2 flame
				counter_file=8;
				break;
			case 3:
			case 4:
			case 5:
			case 6:
			case 7:
			case 8:
			case 9:
			default:
				drvif_color_VDNR_AutoMode_Off();
				drvif_color_RTNR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_RTNR_OF_SNR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Ediff_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Spatial_NR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				drvif_color_Dark_k_value_AutoMode_HdSd(display, DNR_Auto_lvl_SdHd);
				drvif_color_MCNR_AutoMode_HdSd(display, DNR_Auto_lvl_SdHd);
				if(AutoMA_Struct->AutoMA5_En == FALSE)//TRUE : disable MPEG on/off detector ; False : Enable MPEG on/off detector
				{
					drvif_color_MpegNR_AutoMode_SdHd(display, DNR_Auto_lvl_SdHd);
				}
				break;
		}
	}
	counter_file++;
	return 0;
}
#endif

#if 0 // Replase by PQA adaptive control Flow
void drvif_color_TVAutoNR(unsigned char display, unsigned char AUTO_NR_style, unsigned char VD_noise_level, unsigned char DNR_Auto_lvl_SdHd)//ver.001 CSFC, sync from Mac in Magellen,20130311
{
//========================================================================//
//case 0 is new structure + TSB style for TSB project.
//========================================================================//
	static unsigned int counter_file = 0;
	if((counter_file % 7) == 0)
	{
		switch(AUTO_NR_style)
		{
			case 0:// for TOSHIBA
				drvif_color_VDNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_RTNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_RTNR_OF_SNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Ediff_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Spatial_NR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Dark_k_value_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_MCNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_MpegNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_TV_Auto_Sat_Coring_control(VD_noise_level, drvif_module_vdc_NoiseStatus_isr());
				// Hawaii add for Edge Peaking 20131022
				drvif_color_TSB_Edge_Peaking_AutoMode(VD_noise_level,PictureMode);
				break;
			case 1: //default auto NR Setting
				drvif_color_VDNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_RTNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_RTNR_OF_SNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Ediff_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Spatial_NR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Dark_k_value_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_MCNR_AutoMode_RfCvbs(display, VD_noise_level);
				if(AutoMA_Struct->AutoMA5_En == FALSE)//TRUE : disable MPEG on/off detector ; False : Enable MPEG on/off detector
				{
					drvif_color_MpegNR_AutoMode_RfCvbs(display, VD_noise_level);
				}
				drvif_color_TV_Auto_Sat_Coring_control(VD_noise_level, drvif_module_vdc_NoiseStatus_isr());

				break;
			case 2:// for SONY
				drvif_color_VDNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_RTNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_RTNR_OF_SNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Ediff_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Spatial_NR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Dark_k_value_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_MCNR_AutoMode_RfCvbs(display, VD_noise_level);
				//drvif_color_MpegNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_TV_Auto_Sat_Coring_control(VD_noise_level, drvif_module_vdc_NoiseStatus_isr());
				drvif_color_Intelligent_picture_Ctrl_RfCvbs(display, VD_noise_level);
				break;
			case 3:
			case 4:
			case 5:
			case 6:
			case 7:
			case 8:
			case 9:
			default: // default auto NR Setting, same as case 1
				drvif_color_VDNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_RTNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_RTNR_OF_SNR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Ediff_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Spatial_NR_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Spatial_NR_curve_mapping_mode_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_Dark_k_value_AutoMode_RfCvbs(display, VD_noise_level);
				drvif_color_MCNR_AutoMode_RfCvbs(display, VD_noise_level);
				if(AutoMA_Struct->AutoMA5_En == FALSE)//TRUE : disable MPEG on/off detector ; False : Enable MPEG on/off detector
				{
					drvif_color_MpegNR_AutoMode_RfCvbs(display, VD_noise_level);
				}
				drvif_color_TV_Auto_Sat_Coring_control(VD_noise_level, drvif_module_vdc_NoiseStatus_isr());
				break;
		}
	}
	counter_file++;
}
#endif

#if 0 //Replase by PQA adaptive control Flow
void drvif_color_TV_Auto_Sat_Coring_control(char level_index, unsigned int current_Signal_Status)
{
	static unsigned int VD_noise_level_avg = 0;
	static unsigned int counter_file = 0;

	VD_noise_level_avg = VD_noise_level_avg + level_index;
	if((counter_file % 30) == 0)
	{
//		color_icm_dm_uv_coring_RBUS		dm_uv_coring_REG;
		VD_noise_level_avg = (VD_noise_level_avg / 30);
		//ROSPrintf("\nVD_noise_level_avg = %d\n",VD_noise_level_avg);
		if(VD_noise_level_avg > 3)
		{
			//if(ABS(Previous_TV_signal_Status , current_Signal_Status) > 2)
				//ROSPrintf("[TV Auto NR ]::: R_Y= %d, R_C = %d,P_Status = %d, vdc_noise_v= %d, C-Cor= %d,	Intra off\n",  RTNR_Y, RTNR_C, Previous_TV_signal_Status, current_Signal_Status, C_Coring);
		}
		else
		{
//			dm_uv_coring_REG.u_coring = 0;
//			dm_uv_coring_REG.v_coring = 0;
			if((SCALER_GET_INPUT_TYPE(0) == _SRC_CVBS) && (AutoMA_Struct->AutoMA6_En==1))
			{
//				dm_uv_coring_REG.u_coring= 3;
//				dm_uv_coring_REG.v_coring= 3;
			}
//			rtd_outl(COLOR_ICM_DM_UV_CORING_reg,	dm_uv_coring_REG.regValue);
		}
		VD_noise_level_avg =0;
	}

	counter_file++;
}
#endif


#if 0 //Replase by PQA adaptive control Flow
// Hawaii add for Edge Peaking 20131022
unsigned int   Auto_peaking_print_count = 0;
void drvif_color_TSB_Edge_Peaking_AutoMode(unsigned char noise_level_idx,unsigned char PictureMode)
{


	// declaration and get parameters from share memory
	unsigned short	OSD_sharp_level = * (Edge_AutoPk_data);   //share memory start point
	unsigned short	HV_NEG_Min =*(Edge_AutoPk_data+1);
	unsigned short	HV_NEG_Max =*(Edge_AutoPk_data+2);
	unsigned short	HV_POS_Min = *(Edge_AutoPk_data+3);
	unsigned short	HV_POS_Max =*(Edge_AutoPk_data+4);
	unsigned short	G_Neg_Min = *(Edge_AutoPk_data+5);
	unsigned short	G_Neg_Max =*(Edge_AutoPk_data+6);
	unsigned short	G_Pos_Min =*(Edge_AutoPk_data+7);
	unsigned short	G_Pos_Max =*(Edge_AutoPk_data+8);
	unsigned short	LV_min =*(Edge_AutoPk_data+9);
	unsigned short	LV_max = *(Edge_AutoPk_data+10);
	unsigned short	HV_NEG_Middle= *(Edge_AutoPk_data+11);
	unsigned short	HV_POS_Middle  = *(Edge_AutoPk_data+12);
	unsigned short	G_Neg_Middle= *(Edge_AutoPk_data+13);
	unsigned short	G_Pos_Middle = *(Edge_AutoPk_data+14);
	unsigned short	LV_Middle= *(Edge_AutoPk_data+15);
	//unsigned short	edge_peaking_level =  *(Edge_AutoPk_data+16);


	unsigned char picture_mode_para = 0;
	unsigned char Edge_Peaking_Table_Idx = 0;

	Edge_Peaking_Table_Idx = *(DNR_LEVEL_TABLE+DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_peaking);

	if (PictureMode == 7) // Cricket mode
		picture_mode_para = 1;


	Auto_peaking_print_count++;

	if (AutoNR_Enable)
	{
		// Get following values from Edge_Peaking_Table
		HV_NEG_Middle	 = *(Edge_Peaking_Table + Edge_Peaking_Table_Idx * 2*5*15 + picture_mode_para * 5*15 + CP_HV_neg * 15 + noise_level_idx);
		HV_POS_Middle  	 = *(Edge_Peaking_Table + Edge_Peaking_Table_Idx * 2*5*15 + picture_mode_para * 5*15 + CP_HV_pos * 15 + noise_level_idx);
		G_Neg_Middle	 = *(Edge_Peaking_Table + Edge_Peaking_Table_Idx * 2*5*15 + picture_mode_para * 5*15 + CP_Gain_Neg * 15 + noise_level_idx);
		G_Pos_Middle 	 = *(Edge_Peaking_Table + Edge_Peaking_Table_Idx * 2*5*15 + picture_mode_para * 5*15 + CP_Gain_Pos * 15 + noise_level_idx);
		LV_Middle		 = *(Edge_Peaking_Table + Edge_Peaking_Table_Idx * 2*5*15 + picture_mode_para * 5*15 + CP_Coreing * 15 + noise_level_idx);


		// middle protection. min<=mid<=max
		HV_NEG_Middle = (HV_NEG_Middle > HV_NEG_Max) ? HV_NEG_Max : ((HV_NEG_Middle < HV_NEG_Min) ? HV_NEG_Min : HV_NEG_Middle);
		HV_POS_Middle = (HV_POS_Middle > HV_POS_Max) ? HV_POS_Max : ((HV_POS_Middle < HV_POS_Min) ? HV_POS_Min : HV_POS_Middle);
		G_Neg_Middle = (G_Neg_Middle > G_Neg_Max) ? G_Neg_Max : ((G_Neg_Middle < G_Neg_Min) ? G_Neg_Min : G_Neg_Middle);
		G_Pos_Middle = (G_Pos_Middle > G_Pos_Max) ? G_Pos_Max : ((G_Pos_Middle < G_Pos_Min) ? G_Pos_Min : G_Pos_Middle);
		LV_Middle = (LV_Middle > LV_max) ? LV_max : ((LV_Middle < LV_min) ? LV_min : LV_Middle);


	}

	//===================DEBUG============================
#if 0
	if(Auto_peaking_print_count%80 ==1)
	{

		ROSPrintf("=====[ScalerVIP.c] =====VD_noise_level=%d,DNR_Auto_lvl_SdHd=%d\n",VD_noise_level,DNR_Auto_lvl_SdHd);
		ROSPrintf("=====[ScalerVIP.c] =====Edge_Peaking_Table_Idx=%d,picture_mode_para=%d, noise_level_idx=%d\n",Edge_Peaking_Table_Idx,picture_mode_para,noise_level_idx);

		ROSPrintf("=====[ScalerVIP.c] =====OSD_level=%d\n",OSD_sharp_level);
		ROSPrintf("=====[ScalerVIP.c] =====HV_NEG_Min=%d\n",(unsigned char)HV_NEG_Min);
		ROSPrintf("=====[ScalerVIP.c] =====HV_NEG_Max=%d\n",HV_NEG_Max);
		ROSPrintf("=====[ScalerVIP.c] =====HV_POS_Min=%d\n",HV_POS_Min);
		ROSPrintf("=====[ScalerVIP.c] =====HV_POS_Max=%d\n",HV_POS_Max);
		ROSPrintf("=====[ScalerVIP.c] =====G_Neg_Min=%d\n",(unsigned char)G_Neg_Min);
		ROSPrintf("=====[ScalerVIP.c] =====G_Neg_Max=%d\n",G_Neg_Max);
		ROSPrintf("=====[ScalerVIP.c] =====G_Pos_Min=%d\n",G_Pos_Min);
		ROSPrintf("=====[ScalerVIP.c] =====G_Pos_Max=%d\n",G_Pos_Max);
		ROSPrintf("=====[ScalerVIP.c] =====LV_min=%d\n",LV_min);
		ROSPrintf("=====[ScalerVIP.c] =====LV_max=%d\n",LV_max);
		ROSPrintf("=====[ScalerVIP.c] =====HV_NEG_Middle=%d\n",HV_NEG_Middle);
		ROSPrintf("=====[ScalerVIP.c] =====HV_POS_Middle=%d\n",HV_POS_Middle);
		ROSPrintf("=====[ScalerVIP.c] =====G_Neg_Middle=%d\n",G_Neg_Middle);
		ROSPrintf("=====[ScalerVIP.c] =====G_Pos_Middle=%d\n",G_Pos_Middle);
		ROSPrintf("=====[ScalerVIP.c] =====LV_Middle=%d\n",LV_Middle);
	}
#endif
	//===================DEBUG============================


	color_sharp_dm_segpk_edgpk3_RBUS dm_segpk_edgpk3;
	color_sharp_dm_segpk_edgpk4_RBUS dm_segpk_edgpk4;
	dm_segpk_edgpk3.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg);
	dm_segpk_edgpk3.regValue = rtd_inl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg);

	if(noise_level_idx <= NR_LEVEL_MAX)
	{
		unsigned short temp = 0;

		temp = drvif_color_2parts_linear_interpolation( HV_NEG_Min, HV_NEG_Max, HV_NEG_Middle, OSD_sharp_level);
		dm_segpk_edgpk4.hv_neg = check_range(temp, 0, 1023);

		temp = drvif_color_2parts_linear_interpolation( HV_POS_Min, HV_POS_Max, HV_POS_Middle, OSD_sharp_level);
		dm_segpk_edgpk4.hv_pos = check_range(temp, 0, 1023);

		temp = drvif_color_2parts_linear_interpolation( G_Pos_Min, G_Pos_Max, G_Pos_Middle, OSD_sharp_level);
		dm_segpk_edgpk3.gain_pos = check_range(temp, 0, 255);

		temp = drvif_color_2parts_linear_interpolation( G_Neg_Min, G_Neg_Max, G_Neg_Middle, OSD_sharp_level);
		dm_segpk_edgpk3.gain_neg = check_range(temp, 0, 255);

		temp = drvif_color_2parts_linear_interpolation( LV_min, LV_max, LV_Middle, OSD_sharp_level);
		dm_segpk_edgpk4.lv = check_range(temp, 0, 1023);

	}
#if 0
	if(Auto_peaking_print_count%80 ==1)
	{
		ROSPrintf("=====[ScalerVIP.c] =====HV_NEG=%d\n",dm_segpk_edgpk4.hv_neg);
		ROSPrintf("=====[ScalerVIP.c] =====HV_POS=%d\n",dm_segpk_edgpk4.hv_pos);
		ROSPrintf("=====[ScalerVIP.c] =====G_Pos=%d\n",dm_segpk_edgpk3.gain_pos);
		ROSPrintf("=====[ScalerVIP.c] =====G_Neg=%d\n",dm_segpk_edgpk3.gain_neg);
		ROSPrintf("=====[ScalerVIP.c] =====LV=%d\n",dm_segpk_edgpk4.lv );
	}
#endif
	rtd_outl(COLOR_SHARP_DM_SEGPK_EDGPK3_reg, dm_segpk_edgpk3.regValue);
	rtd_outl(COLOR_SHARP_DM_SEGPK_EDGPK4_reg, dm_segpk_edgpk4.regValue);

}
#endif


/**
 * Profile stiall video or motion video
 *
 * @param	void
 * @return	void
 */

#if 0
static unsigned short H_Block_Pre[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
static unsigned short V_Block_Pre[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
void scalerVIP_colorProfileStillMotion(void)
{

	unsigned char ii;
	unsigned short H_Block_Sum = 0;
	unsigned short V_Block_Sum = 0;
	unsigned char H_Ratio[16];//H_Block_Pre*100/H_Block
	unsigned char V_Ratio[16];
	unsigned char H_cnt = 0;
	unsigned char V_cnt = 0;
	unsigned char Profile_Block_Num = 16;//set profile h&V block number
	//unsigned char VD_Noise_Status = 0; //removed in columbus

	unsigned short Profile_transition_sum = 0;

	static unsigned char exit_motion_cnt = 0;
	static unsigned char flag_profile_still;
	static unsigned char flag_profile_still_pre;
	static unsigned char still_frame_cnt = 0;
	static unsigned short H_Block_Sum_Pre;
	static unsigned short V_Block_Sum_Pre;

	scalerDrvPrint( "enter scalerVIP_colorProfileStillMotion\n" );

	if ( scalerVIP_colorProfileDectector( _CHANNEL1, Profile_Block_Num,  &H_Block[0], &V_Block[0], &Profile_transition_sum ) == 1 )
	{
		for ( ii=0 ; ii<Profile_Block_Num ; ii++ )
		{
			H_Block_Sum += H_Block[ii];
			V_Block_Sum += V_Block[ii];

			H_Ratio[ii] = H_Block_Pre[ii] * 100 / (H_Block[ii]+1);
			V_Ratio[ii] = V_Block_Pre[ii] * 100 / (V_Block[ii]+1);

			if ( H_Ratio[ii]<98 || H_Ratio[ii]>101 ) //check if a large motion
				H_cnt++;
			if ( V_Ratio[ii]<98 || V_Ratio[ii]>101 )
				V_cnt++;
		}
		//scalerDrvPrint( "H_Block_Sum%d, V_Block_Sum=%d\n", H_Block_Sum, V_Block_Sum );
#if 0 // print debug messages
		for ( ii=0 ; ii<Profile_Block_Num ; ii=ii+2 )
		{
			scalerDrvPrint( "H_Ratio[%d]=%d, V_Ratio[%d]=%d\n", ii,H_Ratio[ii], ii, V_Ratio[ii] );
		}
		scalerDrvPrint( "H_cnt=%d, V_cnt=%d\n", H_cnt, V_cnt );
#endif
		if ( H_cnt<3 && V_cnt<3 )
		{
			exit_motion_cnt++;
			if ( exit_motion_cnt >= 3 )
				flag_profile_still = 1;//pattern is still
		}
		else
		{
			flag_profile_still = 0;//pattern is motion
			still_frame_cnt = 0;
			exit_motion_cnt = 0;
		}

		for ( ii=0 ; ii<Profile_Block_Num ; ii++ )
		{
			H_Block_Pre[ii] = H_Block[ii];
			V_Block_Pre[ii] = V_Block[ii];
		}
		H_Block_Sum_Pre = H_Block_Sum;
		V_Block_Sum_Pre = V_Block_Sum;
	}
	else
		flag_profile_still = 2;//didn't dectection

	flag_profile_still_pre = flag_profile_still;
	if ( (flag_profile_still_pre==1) && (flag_profile_still_pre==flag_profile_still) ) {
		still_frame_cnt++;
		if ( still_frame_cnt == 120 )
			still_frame_cnt = 5;
	}

}
#endif

/**
 * Scaler task (user space) get histogram table from scaler driver (kernel space).
 *
 * @param	arg: pointer of SCALERDRV_COLORHISTOGRAM
 * @return	void
 */
 #if 0//frank@1126 reduce code
void scalerVIP_getColorHist(unsigned long arg)
{
//#ifdef CONFIG_LAS_VEGAS
	scalerDrvPrint( "enter scalerVIP_getColorHist\n" );

// oliver-
	#if 1
		// Don't need to do anything
		// oliver-
		/*
		copy_to_user(
			(void __user *)(&((SCALERDRV_COLORHISTOGRAM*)arg)->histogram[0]),
			(void*)(&reg_HistCnt[0]),
			sizeof(unsigned int)*COLOR_HISTOGRAM_LEVEL );

		*/
	#else
		unsigned char i;

		for ( i=0 ; i<COLOR_HISTOGRAM_LEVEL ; ++i ) {
			put_user( reg_HistCnt[i], &(((SCALERDRV_COLORHISTOGRAM *)arg)->histogram[i]) );
		}
	#endif


//#endif  // Erin 100326
}
 #endif


#if 0
 void scalerVIP_CorrectionBit1_Ctrl(unsigned char AutoMA_En, unsigned char VD_noise_level, unsigned char DNR_Auto_lvl_SdHd, unsigned char Y_LEVEL, unsigned char C_LEVEL, unsigned char Fade_flag)
{
	unsigned char level= 0, duty= 0;
	unsigned char RTNR_Y_TABLE = 0;
	di_im_di_rtnr_control_RBUS im_di_rtnr_control_reg;
	im_di_rtnr_control_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);
	//di_im_di_rtnr_control_RBUS di_im_di_rtnr_control_RBUS_reg;
	//di_im_di_rtnr_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

	// jimmy.lin 20131107 add fade detection
	if( Fade_flag ) {
		IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3); //set correction1 if fading
		return;
	}

	if(correctionBit1_duty_debug)
		duty = correctionBit1_duty_debug;
	else
	{
		if(AutoMA_En == 1)
		{
			if(Scaler_InputSrcGetMainChType()==_SRC_CVBS || Scaler_InputSrcGetMainChType()==_SRC_TV ||
				Scaler_InputSrcGetMainChType()==_SRC_SV || Scaler_InputSrcGetMainChType()==_SRC_SCART)
			{
				level = VD_noise_level-1;
			}
			else
			{
				level = DNR_Auto_lvl_SdHd-1;
			}
		}
		else
		{
			level = Y_LEVEL;
		}
		RTNR_Y_TABLE = *(DNR_LEVEL_TABLE+DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y);
		duty =	*(NR_TABLE8 + (DNR_TABLE_8[RTNR_Y_TABLE]+CP_RTNR_Rounding_Correction)* NR_LEVEL_MAX + level);
	}

	if(duty==0)
	{
		IoReg_ClearBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3);
		return;
	}

	// i signal
	if(0)//im_di_rtnr_control_reg.cp_rtnr_progressive!=1)
	{
		if(MA_print_count%duty==0||MA_print_count%duty==1)
			IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3); //correction bit1 enable: b80241a0 bit3
		else
			IoReg_ClearBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3);
	}
	else
	{
		if(MA_print_count%duty==0)
			IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3); //correction bit1 enable: b80241a0 bit3
		else
		IoReg_ClearBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3);
	}

	//if(MA_print_count%200==0)
		//ROSPrintf("CorrectionBit1 duty = %d,level=%d,%d,%d\n",duty,level,RTNR_Y_TABLE,DNR_TABLE_SECET);

}
#endif

#if 0
void scalerVIP_RTNR_SceneChange_Policy(unsigned char Enable_flag, unsigned char AutoMA_En, unsigned char VD_noise_level, unsigned char DNR_Auto_lvl_SdHd, unsigned char Y_LEVEL, unsigned char C_LEVEL)
{
	static unsigned char SceneChange_count = 0;
	static unsigned char pre_NEW_RTNR_Switch = 0;
	static unsigned char pre_OLD_RTNR_Switch = 0;
	static unsigned char pre_C_RTNR_Switch = 0;
	unsigned char Y_K_Level, C_K_Level;
	unsigned char RTNR_Y_TABLE = 0, RTNR_C_TABLE = 0;
	unsigned int k_value_0_7_Y = 0x77777777, k_value_8_15_Y=0x77777777, k_value_C = 0x77777777, Y_K_2D_TABLE[8];
	unsigned char AutoNr_RTNR_Coef[8][8];
	unsigned char i;
	unsigned char *rtnr_2D_kmap=NULL;
	unsigned int tmp, tmp2;

	if(AutoMA_En == 1)
	{
		if(Scaler_InputSrcGetMainChType()==_SRC_CVBS || Scaler_InputSrcGetMainChType()==_SRC_TV ||
			Scaler_InputSrcGetMainChType()==_SRC_SV || Scaler_InputSrcGetMainChType()==_SRC_SCART)
		{
			Y_K_Level = VD_noise_level-1;
			C_K_Level = VD_noise_level-1;
		}
		else
		{
			Y_K_Level = DNR_Auto_lvl_SdHd-1;
			C_K_Level = DNR_Auto_lvl_SdHd-1;
		}
	}
	else
	{
		Y_K_Level = Y_LEVEL;
		C_K_Level = C_LEVEL;
	}


	RTNR_Y_TABLE = *(DNR_LEVEL_TABLE+DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_Y);
	RTNR_C_TABLE = *(DNR_LEVEL_TABLE+DNR_TABLE_SECET*DNR_SELECT_MAX*DNR_ITEM_MAX+(DNR_SELECT_NR_TABLE)*DNR_ITEM_MAX + DNR_ITEM_RTNR_C);
	k_value_0_7_Y = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K0_K7) * NR_LEVEL_MAX + Y_K_Level);
	k_value_8_15_Y = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K8_K15) * NR_LEVEL_MAX + Y_K_Level);
	Y_K_2D_TABLE[7] = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_70_77) * NR_LEVEL_MAX + Y_K_Level);
	Y_K_2D_TABLE[6] = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_60_67) * NR_LEVEL_MAX + Y_K_Level);
	Y_K_2D_TABLE[5] = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_50_57) * NR_LEVEL_MAX + Y_K_Level);
	Y_K_2D_TABLE[4] = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_40_47) * NR_LEVEL_MAX + Y_K_Level);
	Y_K_2D_TABLE[3] = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_30_37) * NR_LEVEL_MAX + Y_K_Level);
	Y_K_2D_TABLE[2] = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_20_27) * NR_LEVEL_MAX + Y_K_Level);
	Y_K_2D_TABLE[1] = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_10_17) * NR_LEVEL_MAX + Y_K_Level);
	Y_K_2D_TABLE[0] = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_Y_TABLE]+CP_Temporal_Y_K_00_07) * NR_LEVEL_MAX + Y_K_Level);
	k_value_C = *(NR_TABLE32 + (DNR_TABLE_32[RTNR_C_TABLE]+CP_Temporal_C_K) * NR_LEVEL_MAX + C_K_Level);

	for(i=0;i<8;i++)
	{
		AutoNr_RTNR_Coef[i][0] = (Y_K_2D_TABLE[i] & 0x0000000f)>>0;
		AutoNr_RTNR_Coef[i][1] = (Y_K_2D_TABLE[i] & 0x000000f0)>>4;
		AutoNr_RTNR_Coef[i][2] = (Y_K_2D_TABLE[i] & 0x00000f00)>>8;
		AutoNr_RTNR_Coef[i][3] = (Y_K_2D_TABLE[i] & 0x0000f000)>>12;
		AutoNr_RTNR_Coef[i][4] = (Y_K_2D_TABLE[i] & 0x000f0000)>>16;
		AutoNr_RTNR_Coef[i][5] = (Y_K_2D_TABLE[i] & 0x00f00000)>>20;
		AutoNr_RTNR_Coef[i][6] = (Y_K_2D_TABLE[i] & 0x0f000000)>>24;
		AutoNr_RTNR_Coef[i][7] = (Y_K_2D_TABLE[i] & 0xf0000000)>>28;
	}
	rtnr_2D_kmap = &AutoNr_RTNR_Coef[0][0];

	if(Enable_flag)
	{
		if((SmartPic_clue->SceneChange_NR)==1)
		{
			SceneChange_count = 30;
			if(SC_detect_printf_log_flag)
				ROSPrintf("NEW_RTNR_Switch=%d,%d\n",NEW_RTNR_Switch,SceneChange_count);
		}
		if(SceneChange_count!=0)
		{
		//SC flag =1,just turn on correction bit. for T2 Sony 2644i
			if(SceneChange_count >=11)
			{
				IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3); //correction bit1 enable: b80241a0 bit3
				NEW_RTNR_Switch = 0;//6;
				OLD_RTNR_Switch = 0;//12;
				C_RTNR_Switch = 0;//6;
			}
			else if(SceneChange_count >=5)
			{
				IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3); //correction bit1 enable: b80241a0 bit3
				NEW_RTNR_Switch = 0;//5;
				OLD_RTNR_Switch = 0;//10;
				C_RTNR_Switch = 0;//5;
			}
			else
			{
				IoReg_SetBits(DI_IM_DI_RTNR_CONTROL_reg, _BIT3); //correction bit1 enable: b80241a0 bit3
				NEW_RTNR_Switch = 0;// 3;
				OLD_RTNR_Switch = 0;// 6;
				C_RTNR_Switch = 0;// 3;
			}

			SceneChange_count --;

			if(SceneChange_count>=100)
				SceneChange_count =100;
			else if(SceneChange_count<=0)
				SceneChange_count =0;

		}
		else
		{
			NEW_RTNR_Switch = 0;
			OLD_RTNR_Switch = 0;
			C_RTNR_Switch = 0;
		}
	}
	else
	{
		NEW_RTNR_Switch = 0;
		OLD_RTNR_Switch = 0;
		C_RTNR_Switch = 0;
	}
/*
	if(pre_NEW_RTNR_Switch!=NEW_RTNR_Switch)
	{
		for(i=0;i<64;i++)
			*(rtnr_2D_kmap+i) = CLAMP(*(rtnr_2D_kmap+i)+NEW_RTNR_Switch, 0, 7);
		for(i=0;i<8;i++)
			drvif_color_newrtnr_rtnr_k(i,&rtnr_2D_kmap[i*8]);
		pre_NEW_RTNR_Switch = NEW_RTNR_Switch;
	}
*/
	if(pre_OLD_RTNR_Switch!=OLD_RTNR_Switch)
	{
		for(i=0;i<8;i++)
		{
			tmp = ((k_value_0_7_Y & (0xf<<(i*4)))>>(i*4));
			tmp = (CLAMP(tmp+OLD_RTNR_Switch, 0, 15)<<(i*4));
			tmp2 = k_value_0_7_Y & (~(0xf<<(i*4)));
			k_value_0_7_Y = tmp | tmp2;

			tmp = ((k_value_8_15_Y & (0xf<<(i*4)))>>(i*4));
			tmp = (CLAMP(tmp+OLD_RTNR_Switch, 0, 15)<<(i*4));
			tmp2 = k_value_8_15_Y & (~(0xf<<(i*4)));
			k_value_8_15_Y = tmp | tmp2;

			drvif_color_rtnr_y_k(SLR_MAIN_DISPLAY, k_value_0_7_Y, k_value_8_15_Y);
			pre_OLD_RTNR_Switch = OLD_RTNR_Switch;
		}
/*
	ROSPrintf("OLD_RTNR_Switch=%d,\n",OLD_RTNR_Switch);
	ROSPrintf("%x,\n",k_value_0_7_Y);
	ROSPrintf("%x,\n",k_value_8_15_Y);
*/
	}

	if(pre_C_RTNR_Switch != C_RTNR_Switch)
	{
		for(i=0;i<8;i++)
		{
			tmp = ((k_value_C & (0xf<<(i*4)))>>(i*4));
			tmp = (CLAMP(tmp+C_RTNR_Switch, 0, 7)<<(i*4));
			tmp2 = k_value_C & (~(0xf<<(i*4)));
			k_value_C = tmp | tmp2;
			pre_C_RTNR_Switch = C_RTNR_Switch;
		}
		drvif_color_rtnr_c_k(SLR_MAIN_DISPLAY, k_value_C);
	}

}

#endif

#if 0
unsigned char drvif_color_chessboard_detection(unsigned char PF_Blk_Num
	, unsigned char th_profile_bin_cnt_diff, unsigned char th_hist_cnt_max2bin_percent, unsigned char th_hist_bincnt_diff_percent, unsigned char th_hist_binIdx_diff)
{
	unsigned char i=0,  j=0;

	unsigned char PF_H2V[16];
	unsigned char PF_Ratio=0;
	unsigned char pf_cnt_h = 0;//0:H_Blocks are all the same, >0:are not the same
	unsigned char pf_cnt_v = 0;//0:V_Blocks are all the same, >0:are not the same
	unsigned char pf_cnt_h2v = 0;//0:H_Block/(H_Block+V_Block) are all the same, >0:are not the same
	unsigned char flag_chessboard_profile=0;

	unsigned int HistCnt_Sum=0, bright=0, dark=0;
	unsigned int HistSort[32], HistCntSort_tmp;
	unsigned char HistSortIdx[32], HistSortIdx_tmp;
	unsigned char Brightest1, Brightest2, Brightest3;
	unsigned char Darkest1, Darkest2, Darkest3;
	unsigned char hist_cond_1=0, hist_cond_2=0, hist_cond_3=0;
	unsigned char flag_chessboard_hist=0;
	unsigned char flag_chessboard;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

// [1.] Profile Condition:------------------------------------------------------------------------------
	for(i=0;i<16;i++)
		PF_H2V[i] = ((H_Block[i]+V_Block[i])==0)?50:((100*H_Block[i])/(H_Block[i]+V_Block[i]));

	pf_cnt_h =0;
	pf_cnt_v =0;
	pf_cnt_h2v =0;
	PF_Ratio = ( (PF_H2V[0]+PF_H2V[PF_Blk_Num-1])==0 )?50:(100*PF_H2V[0])/(PF_H2V[0]+PF_H2V[PF_Blk_Num-1]);
	pf_cnt_h2v += (ABS( PF_Ratio, 50)<=3)?0:1;

	PF_Ratio = ( (H_Block[0]+H_Block[PF_Blk_Num-1])==0 )?50:(100*H_Block[0])/(H_Block[0]+H_Block[PF_Blk_Num-1]);
	pf_cnt_h += (ABS( PF_Ratio, 50)<=3)?0:1;

	PF_Ratio = ( (V_Block[0]+V_Block[PF_Blk_Num-1])==0 )?50:(100*V_Block[0])/(V_Block[0]+V_Block[PF_Blk_Num-1]);
	pf_cnt_v += (ABS( PF_Ratio, 50)<=3)?0:1;

	for(i=1;i<16;i++)
	{
		PF_Ratio = ( (PF_H2V[i-1]+PF_H2V[i])==0 )?50:(100*PF_H2V[i])/(PF_H2V[i-1]+PF_H2V[i]);
		pf_cnt_h2v += (ABS( PF_Ratio, 50)<=th_profile_bin_cnt_diff)?0:1;

		if((MA_print_count % 120) == 0 && AutoMa_chessboard_log_en)
			scalerDrvPrint("%d, pf_h2v=%d\n", i, ABS( PF_Ratio, 50));

		PF_Ratio = ( (H_Block[i-1]+H_Block[i])==0 )?50:(100*H_Block[i])/(H_Block[i-1]+H_Block[i]);
		pf_cnt_h += (ABS( PF_Ratio, 50)<=th_profile_bin_cnt_diff)?0:1;

		if((MA_print_count % 120) == 0 && AutoMa_chessboard_log_en)
			scalerDrvPrint("%d, pf_h=%d\n", i, ABS( PF_Ratio, 50));

		PF_Ratio = ( (V_Block[i-1]+V_Block[i])==0 )?50:(100*V_Block[i])/(V_Block[i-1]+V_Block[i]);
		pf_cnt_v += (ABS( PF_Ratio, 50)<=th_profile_bin_cnt_diff)?0:1;

		if((MA_print_count % 120) == 0 && AutoMa_chessboard_log_en)
			scalerDrvPrint("%d, pf_v=%d\n", i, ABS( PF_Ratio, 50));

	}

	if(pf_cnt_h==0 && pf_cnt_v==0 && pf_cnt_h2v==0)
		flag_chessboard_profile = 1;
	else
		flag_chessboard_profile = 0;

// [2.] chessboard hist begin------------------------------------------------------------------------------
	HistCnt_Sum=0;
	for(i=0;i<32;i++)
	{
		HistSortIdx[i]=i;
		HistSort[i] = reg_HistCnt[i];
		HistCnt_Sum += HistSort[i];
	}
	HistCnt_Sum = (HistCnt_Sum==0)?1:HistCnt_Sum;


	// Bubble sort begin==========
	for(i=0;i<32;i++)
	{
		for(j=i+1;j<32;j++)
	  	{
	  		if (HistSort[i]>HistSort[j])
	  		{
				HistCntSort_tmp=HistSort[i];
				HistSort[i]=HistSort[j];
				HistSort[j]=HistCntSort_tmp;

				HistSortIdx_tmp=HistSortIdx[i];
				HistSortIdx[i]=HistSortIdx[j];
				HistSortIdx[j]=HistSortIdx_tmp;
		    	}
		 }
	}
	//Bubble sort end ==========

	if((MA_print_count % 120) == 0 && AutoMa_chessboard_log_en)
	{
		for(i=0;i<32;i++)
			scalerDrvPrint("%d, HistCn= %d, HistSortIdx= %d, HistSort= %d\n", i, reg_HistCnt[i], HistSortIdx[i], HistSort[i]);
	}

	if(HistSortIdx[31]>HistSortIdx[30])
	{
		if(HistSortIdx[31]==31)
		{
			Brightest1=31;
			Brightest2=30;
			Brightest3=29	;
		}
		else
		{
			Brightest1=HistSortIdx[31]+1;
			Brightest2=HistSortIdx[31];
			Brightest3=HistSortIdx[31]-1;
		}

		if(HistSortIdx[30]==0)
		{
			Darkest1=0;
			Darkest2=1;
			Darkest3=2;
		}
		else
		{
			Darkest1=HistSortIdx[30]-1;
			Darkest2=HistSortIdx[30];
			Darkest3=HistSortIdx[30]+1;
		}
	}
	else
	{
		if(HistSortIdx[30]==31)
		{
			Brightest1=31;
			Brightest2=30;
			Brightest3=29;
		}
		else
		{
			Brightest1=HistSortIdx[30]+1;
			Brightest2=HistSortIdx[30];
			Brightest3=HistSortIdx[30]-1;
		}

		if(HistSortIdx[31]==0)
		{
			Darkest1=0;
			Darkest2=1;
			Darkest3=2;
		}
		else
		{
			Darkest1=HistSortIdx[31]-1;
			Darkest2=HistSortIdx[31];
			Darkest3=HistSortIdx[31]+1;
		}
	}

	dark = (reg_HistCnt[Darkest1]+reg_HistCnt[Darkest2]+reg_HistCnt[Darkest3]);
	bright = (reg_HistCnt[Brightest1]+reg_HistCnt[Brightest2]+reg_HistCnt[Brightest3]);

	if( (dark+bright)==0)
	{
		if((MA_print_count % 120) == 0 && AutoMa_chessboard_log_en)
			scalerDrvPrint("[VIP] Histogram's not ready.....");
		flag_chessboard_hist = 0;
	}
	else
	{
		if((MA_print_count % 120) == 0 && AutoMa_chessboard_log_en)
		{
			scalerDrvPrint("Darkest1=%d, Darkest2=%d, Darkest3=%d, dark=%d\n",Darkest1, Darkest2,Darkest3,dark);
			scalerDrvPrint("Brightest1=%d, Brightest2=%d, Brightest3=%d, bright=%d\n",Brightest1, Brightest2,Brightest3,bright);
		}

		hist_cond_1=( (100*(dark+bright))/HistCnt_Sum); //if big enough
		hist_cond_2 = ABS(Darkest1, Brightest1);//>12
		hist_cond_3 = (100*dark)/(dark+bright);
		hist_cond_3 = ABS(hist_cond_3, 50);

		if( hist_cond_1>=th_hist_cnt_max2bin_percent
		&& hist_cond_2>=th_hist_binIdx_diff
		&& hist_cond_3 <th_hist_bincnt_diff_percent )
			flag_chessboard_hist = 1;
		else
			flag_chessboard_hist = 0;
	}

// [3.] final decision:------------------------------------------------------------------------------
	flag_chessboard = (flag_chessboard_profile & flag_chessboard_hist);

	if((MA_print_count % 120) == 0 && AutoMa_chessboard_log_en)
	{
		scalerDrvPrint("\nhist_cond_1=%d (>%d), hist_cond_2=%d(>%d), hist_cond_3=%d(<%d)\n", hist_cond_1,th_hist_cnt_max2bin_percent, hist_cond_2,th_hist_binIdx_diff, hist_cond_3,th_hist_bincnt_diff_percent);
		scalerDrvPrint("VIP [chessboard flag]:\nprofile=%d\nhist=%d\n\nflag_chessboard=%d\n", flag_chessboard_profile,flag_chessboard_hist,flag_chessboard);
	}

	return flag_chessboard;

    //return(1);
}
#endif

#if 0//frank@1127 reduce ocde
unsigned char drvif_color_get_flag_chessboard(void)
{
	return flag_chessboard&0x1;
}
#endif

#if 0 // sync from panasonic
//=========================Elsie 20130424: RTNR adaptive=========================
unsigned char SNR_weight_bound1 = 0;
unsigned char Peaking_edge_gain_bound = 0 ;
unsigned char Peaking_texture_gain_neg_bound=0;
unsigned char Peaking_vertical_gain_neg_bound=0;
unsigned char Peaking_texture_gain_neg =0, Peaking_vertical_gain_neg=0;

void scalerVIP_newRTNR_Adaptive_detect(SCALER_CHANNEL_NUM channel, unsigned char * plevel_flag, unsigned char * pPan_flag, unsigned char * pBigSmoothArea_flag)
{
	static unsigned int RTNR_MAD_count_Y_avg_sum = 0,sum_average =0;
	static unsigned int RTNR_MAD_count_U_avg_sum = 0,sum_average_U =0;
	static unsigned int RTNR_MAD_count_V_avg_sum = 0,sum_average_V =0;
	//unsigned short Active_Region[4];
	//unsigned int RTNR_TempMAD_count_Y=0,total_pix; //rtnr_noise_new;
	//unsigned int RTNR_MAD_count_Y_avg=0,RTNR_MAD_count_U_avg=0,RTNR_MAD_count_V_avg=0; // TL_ratio, Lar_ave,
	unsigned char curr_motion_status = 0;
	//static unsigned int mad_u_counter = 0;
	//unsigned int mad_v_counter = 0;
	unsigned char BigSmoothAreaLuma_flag, BigSmoothAreaChroma_flag;

//=========correction bit check ==============

	di_im_di_rtnr_control_RBUS di_im_di_rtnr_control_RBUS_reg;
	di_im_di_rtnr_control_RBUS_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);

//====================================

/*
//===========================================================
//========================Motion MAD Check =======================
//===========================================================

	di_im_di_rtnr_mad_y_counter_RBUS im_di_rtnr_mad_y_counter_reg;
	di_im_di_rtnr_mad_u_counter_RBUS im_di_rtnr_mad_u_counter_reg;
	di_im_di_rtnr_mad_v_counter_RBUS im_di_rtnr_mad_v_counter_reg;

	im_di_rtnr_mad_y_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);
	im_di_rtnr_mad_u_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_U_COUNTER_reg);
	im_di_rtnr_mad_v_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_V_COUNTER_reg);

	RTNR_TempMAD_count_Y = im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery;
	mad_u_counter=im_di_rtnr_mad_u_counter_reg.regValue;
	mad_v_counter=im_di_rtnr_mad_v_counter_reg.regValue;
	drvif_color_activeregion_dragon(channel, &Active_Region[0]);
*/

//===========================================================
//========================Motion Pan Check =======================
//===========================================================

	*pPan_flag = scalerVIP_DI_MiddleWare_GetStatus(STATUS_PAN);
	pan_detect_flag = *pPan_flag;

//===========================================================
//========================Big Smooth Area ========================
//===========================================================

	BigSmoothAreaLuma_flag = scalerVIP_BigSmoothAreaDetection_luma();
	BigSmoothAreaChroma_flag = scalerVIP_BigSmoothAreaDetection_chroma();
	*pBigSmoothArea_flag = (BigSmoothAreaLuma_flag & BigSmoothAreaChroma_flag);

/*
//====================get condition===========================
	total_pix = Active_Region[1]*Active_Region[3];

	if(total_pix==0)
		return;

	RTNR_MAD_count_Y_avg = (RTNR_TempMAD_count_Y*1000)/total_pix;
	RTNR_MAD_count_U_avg = (mad_u_counter*1000)/total_pix;
	RTNR_MAD_count_V_avg = (mad_v_counter*1000)/total_pix;
	*/

	RTNR_MAD_count_Y_avg_sum += RTNR_MAD_count_Y_avg;
	RTNR_MAD_count_U_avg_sum += RTNR_MAD_count_U_avg;
	RTNR_MAD_count_V_avg_sum += RTNR_MAD_count_V_avg;

	if((MA_print_count % 5) == 0)
	{
		sum_average = RTNR_MAD_count_Y_avg_sum/5;
		RTNR_MAD_count_Y_avg_sum=0;
		sum_average_U = RTNR_MAD_count_U_avg_sum/5;
		RTNR_MAD_count_U_avg_sum=0;
		sum_average_V = RTNR_MAD_count_V_avg_sum/5;
		RTNR_MAD_count_V_avg_sum=0;
		//ROSPrintf("[mad]RTNR_MAD_count_Y_avg_sum = %d\n",sum_average);
		//ROSPrintf("[mad]RTNR_MAD_count_U_avg_sum = %d\n",sum_average_U);
		//ROSPrintf("[mad]RTNR_MAD_count_V_avg_sum = %d\n",sum_average_V);
	}

	if(di_im_di_rtnr_control_RBUS_reg.cp_rtnr_progressive!=1)
	{
		if((SCALER_GET_INPUT_TYPE(channel) == _SRC_TV) || (SCALER_GET_INPUT_TYPE(channel) == _SRC_CVBS))
		{
			curr_motion_status = scalerVideo_GetCurMotionStatus();
		}
		else
		{
			curr_motion_status = (SmartPic_clue->di_motion_status);
		}
	}
	else
	{
		curr_motion_status = DNR_Auto_lvl_SdHd;
	}

	*plevel_flag = scalerVIP_StillMotion();
}

//=========================Elsie 20130424 end=========================

#endif

#if 0
void scalerVIP_colorMAChromaBW(void)
{
	unsigned char thr_CircleCntMax = 20;
	unsigned int *reg_HistCnt=(SmartPic_clue->Y_Main_Hist);

	//	scalerDrvPrint( "set scalerVIP_colorMAChromaBW  AAA.....%x  \n" ,yc_bw_ctrl_reg.chroma_bw_lo);

	if (( reg_HistCnt[0] < 0x310 && reg_HistCnt[0] > 0x270 &&
		reg_HistCnt[13] < 0x150 && reg_HistCnt[13] > 0x100 &&
		 reg_HistCnt[15]  > 0x15d0 &&
		 reg_HistCnt[14]  > 0x180 && reg_HistCnt[14]  < 0x1f0 &&
		 reg_HistCnt[17]  < 0x70 && reg_HistCnt[16]  < 0xb0)
		 ||  ( reg_HistCnt[14]  > 0x2700&& reg_HistCnt[16]<0x30
		&& reg_HistCnt[15]<0x30&& reg_HistCnt[13]<0x30
		&& reg_HistCnt[12]<0x30&& reg_HistCnt[11]<0x30
		&& reg_HistCnt[0]<0x30&& reg_HistCnt[31]<0x30)
		 )
		{
			if(CircleCnt< thr_CircleCntMax)
					 CircleCnt = CircleCnt +2;
		//ROSPrintf( "Circle HIT  \n" );

		}
	else if(CircleCnt > 0)
		{
			CircleCnt--;
		//ROSPrintf( "Circle OUT  \n" );
		}
}

#endif

#if 0

unsigned char drvif_color_compute_noise_level(unsigned char channel)
{
	static unsigned int counter_file = 0;
	static unsigned int RTNR_MAD_count_Y_avg_sum = 0;

	unsigned int current_Signal_Status = 0;
	unsigned char rate_Lerp_NR_Level_0, rate_Lerp_NR_Level_1;
	unsigned int DCC_Histogram_Mean_value = 0;

	DCC_Histogram_Mean_value = SmartPic_clue->Hist_Y_Mean_Value;
//==================================================================
//==================compute VD_noise_level of ==============================
//=======================TV_CVBS ====================================
//==================================================================
	if(DEBUG_AUTO_NR == 0)
		//current_Signal_Status = drvif_module_vdc_NoiseStatus_isr();
		current_Signal_Status = (SmartPic_clue->VD_Signal_Status_value_avg) ;  //yuan1024 for rtnr n files avg

	else	//	debug enable;
		current_Signal_Status = DEBUG_VD_NOISE;

	if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 1] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 1 ])
		VD_noise_level = 1;
	else if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 2] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 2 ])
		VD_noise_level = 2;
	else if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 3] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 3 ])
		VD_noise_level = 3;
	else if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 4] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 4 ])
		VD_noise_level = 4;
	else if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 5] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 5 ])
		VD_noise_level = 5;
	else if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 6] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 6 ])
		VD_noise_level = 6;
	else if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 7] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 7 ])
		VD_noise_level = 7;
	else if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 8] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 8 ])
		VD_noise_level = 8;
	else if(current_Signal_Status < NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + 9] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + 9 ])
		VD_noise_level = 9;
	else
		VD_noise_level = 10;

	rate_Lerp_NR_Level_0 = NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + VD_noise_level-1] + NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + VD_noise_level-1];
	rate_Lerp_NR_Level_1 = NR_TABLE8[ VD_noise_status * NR_LEVEL_MAX + VD_noise_level] - NR_TABLE8[ VD_noise_status_offset* NR_LEVEL_MAX + VD_noise_level];

	if(VD_noise_level == 1)
		rate_Lerp_NR = 0;
	else
		if((rate_Lerp_NR_Level_0 >= current_Signal_Status) || (rate_Lerp_NR_Level_1 == rate_Lerp_NR_Level_0))
			rate_Lerp_NR = 0;
		else
			rate_Lerp_NR = (current_Signal_Status -rate_Lerp_NR_Level_0) * 100 / (rate_Lerp_NR_Level_1 - rate_Lerp_NR_Level_0);
/*
	if((MA_print_count %100) == 0){
	ROSPrintf("\nrate_Lerp_NR = %d 	%d	%d	%d\n", rate_Lerp_NR,current_Signal_Status,rate_Lerp_NR_Level_0,rate_Lerp_NR_Level_1);
	}
*/

//==================================================================
//==================compute VD_noise_level of ==============================
//=======================TV_CVBS end==================================
//==================================================================


//==================================================================
//================compute DNR_Auto_lvl_SdHd of ==============================
//==========================SDHD====================================
//==================================================================
/*
	di_im_di_rtnr_control_RBUS im_di_rtnr_control_reg;
	di_im_di_rtnr_mad_y_counter_RBUS im_di_rtnr_mad_y_counter_reg;
	im_di_rtnr_control_reg.regValue = rtd_inl(DI_IM_DI_RTNR_CONTROL_reg);
	im_di_rtnr_mad_y_counter_reg.regValue = rtd_inl(DI_IM_DI_RTNR_MAD_Y_COUNTER_reg);

	RTNR_TempMAD_count_Y = im_di_rtnr_mad_y_counter_reg.cp_temporal_mad_countery;

	drvif_color_activeregion_dragon(channel, &Active_Region[0]);

//====================get condition===========================
	total_pix = Active_Region[1]*Active_Region[3];
	if(total_pix==0)
		return 0;
	RTNR_MAD_count_Y_avg = (RTNR_TempMAD_count_Y*1000)/total_pix;
*/

	RTNR_MAD_count_Y_avg_sum += RTNR_MAD_count_Y_avg;

	if(((counter_file % DNR_Auto_Count_Num) == 0)&&(counter_file != 0 ))
	{

		RTNR_MAD_count_Y_sum_avg = RTNR_MAD_count_Y_avg_sum/DNR_Auto_Count_Num;
		RTNR_MAD_count_Y_avg_sum = 0;

		if(DEBUG_AUTO_NR == 1)
		{	//	debug enable;
			RTNR_MAD_count_Y_sum_avg = DEBUG_RTNR_MAD;
			DCC_Histogram_Mean_value = DEBUG_HISTOGRAM_MEAN;
		}

		if((RTNR_MAD_count_Y_sum_avg >= 0) && (RTNR_MAD_count_Y_sum_avg <= 50))
		{
			if(DCC_Histogram_Mean_value <= 30)
				DNR_Auto_lvl_SdHd = 1;
			else if((DCC_Histogram_Mean_value >= 31) && (DCC_Histogram_Mean_value <= 50))
				DNR_Auto_lvl_SdHd = 2;
			else if((DCC_Histogram_Mean_value >= 51) && (DCC_Histogram_Mean_value <= 80))
				DNR_Auto_lvl_SdHd = 3;
			else if(DCC_Histogram_Mean_value >= 81)
				DNR_Auto_lvl_SdHd = 4;
		}
		else if((RTNR_MAD_count_Y_sum_avg >= 51) && (RTNR_MAD_count_Y_sum_avg <= 250))
		{
			if(DCC_Histogram_Mean_value <= 30)
				DNR_Auto_lvl_SdHd = 2;
			else if((DCC_Histogram_Mean_value >= 31) && (DCC_Histogram_Mean_value <= 50))
				DNR_Auto_lvl_SdHd = 3;
			else if((DCC_Histogram_Mean_value >= 51) && (DCC_Histogram_Mean_value <= 80))
				DNR_Auto_lvl_SdHd = 4;
			else if(DCC_Histogram_Mean_value >= 81)
				DNR_Auto_lvl_SdHd = 5;
		}
		else if(RTNR_MAD_count_Y_sum_avg >= 251)
		{
			if(DCC_Histogram_Mean_value <= 30)
				DNR_Auto_lvl_SdHd = 4;
			else if((DCC_Histogram_Mean_value >= 31) && (DCC_Histogram_Mean_value <= 50))
				DNR_Auto_lvl_SdHd = 5;
			else if((DCC_Histogram_Mean_value >= 51) && (DCC_Histogram_Mean_value <= 80))
				DNR_Auto_lvl_SdHd = 6;
			else if(DCC_Histogram_Mean_value >= 81)
				DNR_Auto_lvl_SdHd = 7;
		}
		else
		{
			DNR_Auto_lvl_SdHd = 7;
		}

	}

#if 0
	// NR Level Style for Sony==================
	//=======start========================
	//==================================
		if(DCC_Histogram_Mean_value<=9)
			RTNR_LEVEL_SDHD_SONY = 6;
		else if (DCC_Histogram_Mean_value<=11)
			RTNR_LEVEL_SDHD_SONY = 7;
		else if (DCC_Histogram_Mean_value<=12)
			RTNR_LEVEL_SDHD_SONY = 8;
		else if (DCC_Histogram_Mean_value<=13)
			RTNR_LEVEL_SDHD_SONY = 8;
		else if (DCC_Histogram_Mean_value<=14)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=17)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=19)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=22)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=25)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=28)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=31)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=34)
			RTNR_LEVEL_SDHD_SONY = 10;
		else if (DCC_Histogram_Mean_value<=37)
			RTNR_LEVEL_SDHD_SONY = 10;
		else if (DCC_Histogram_Mean_value<=40)
			RTNR_LEVEL_SDHD_SONY = 10;
		else if (DCC_Histogram_Mean_value<=43)
			RTNR_LEVEL_SDHD_SONY = 10;
		else if (DCC_Histogram_Mean_value<=47)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=50)
			RTNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=52)
			RTNR_LEVEL_SDHD_SONY = 8;
		else if (DCC_Histogram_Mean_value<=53)
			RTNR_LEVEL_SDHD_SONY = 7;
		else if (DCC_Histogram_Mean_value<=55)
			RTNR_LEVEL_SDHD_SONY = 6;
		else if (DCC_Histogram_Mean_value<=56)
			RTNR_LEVEL_SDHD_SONY = 5;
		else if (DCC_Histogram_Mean_value<=57)
			RTNR_LEVEL_SDHD_SONY = 4;
		else if (DCC_Histogram_Mean_value<=59)
			RTNR_LEVEL_SDHD_SONY = 3;
		else if (DCC_Histogram_Mean_value<=62)
			RTNR_LEVEL_SDHD_SONY = 2;
		else
			RTNR_LEVEL_SDHD_SONY = 1;


		if(DCC_Histogram_Mean_value<=5)
			SPNR_LEVEL_SDHD_SONY = 10;
		else if (DCC_Histogram_Mean_value<=10)
			SPNR_LEVEL_SDHD_SONY = 9;
		else if (DCC_Histogram_Mean_value<=15)
			SPNR_LEVEL_SDHD_SONY = 8;
		else if (DCC_Histogram_Mean_value<=20)
			SPNR_LEVEL_SDHD_SONY = 7;
		else if (DCC_Histogram_Mean_value<=25)
			SPNR_LEVEL_SDHD_SONY = 6;
		else if (DCC_Histogram_Mean_value<=30)
			SPNR_LEVEL_SDHD_SONY = 5;
		else if (DCC_Histogram_Mean_value<=35)
			SPNR_LEVEL_SDHD_SONY = 4;
		else if (DCC_Histogram_Mean_value<=40)
			SPNR_LEVEL_SDHD_SONY = 3;
		else if (DCC_Histogram_Mean_value<=50)
			SPNR_LEVEL_SDHD_SONY = 2;
		else
			SPNR_LEVEL_SDHD_SONY = 1;
	// NR Level Style for Sony==================
	//=======end========================
	//==================================
#endif
	if(DCC_Histogram_Mean_value<=9)
		RTNR_LEVEL_SDHD_SONY = 7;
	else if (DCC_Histogram_Mean_value<=10)
		RTNR_LEVEL_SDHD_SONY = 7;
	else if (DCC_Histogram_Mean_value<=12)
		RTNR_LEVEL_SDHD_SONY = 8;
	else if (DCC_Histogram_Mean_value<=13)
		RTNR_LEVEL_SDHD_SONY = 9;
	else if (DCC_Histogram_Mean_value<=15)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=17)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=19)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=22)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=25)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=28)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=31)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=34)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=37)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=40)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=43)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=47)
		RTNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=51)
		RTNR_LEVEL_SDHD_SONY = 9;
	else if (DCC_Histogram_Mean_value<=52)
		RTNR_LEVEL_SDHD_SONY = 8;
	else if (DCC_Histogram_Mean_value<=53)
		RTNR_LEVEL_SDHD_SONY = 7;
	else if (DCC_Histogram_Mean_value<=55)
		RTNR_LEVEL_SDHD_SONY = 6;
	else if (DCC_Histogram_Mean_value<=56)
		RTNR_LEVEL_SDHD_SONY = 5;
	else if (DCC_Histogram_Mean_value<=57)
		RTNR_LEVEL_SDHD_SONY = 4;
	else if (DCC_Histogram_Mean_value<=59)
		RTNR_LEVEL_SDHD_SONY = 3;
	else if (DCC_Histogram_Mean_value<=62)
		RTNR_LEVEL_SDHD_SONY = 2;
	else
		RTNR_LEVEL_SDHD_SONY = 1;


	if(DCC_Histogram_Mean_value<=5)
		SPNR_LEVEL_SDHD_SONY = 10;
	else if (DCC_Histogram_Mean_value<=10)
		SPNR_LEVEL_SDHD_SONY = 9;
	else if (DCC_Histogram_Mean_value<=15)
		SPNR_LEVEL_SDHD_SONY = 8;
	else if (DCC_Histogram_Mean_value<=20)
		SPNR_LEVEL_SDHD_SONY = 7;
	else if (DCC_Histogram_Mean_value<=25)
		SPNR_LEVEL_SDHD_SONY = 6;
	else if (DCC_Histogram_Mean_value<=30)
		SPNR_LEVEL_SDHD_SONY = 5;
	else if (DCC_Histogram_Mean_value<=35)
		SPNR_LEVEL_SDHD_SONY = 4;
	else if (DCC_Histogram_Mean_value<=40)
		SPNR_LEVEL_SDHD_SONY = 3;
	else if (DCC_Histogram_Mean_value<=50)
		SPNR_LEVEL_SDHD_SONY = 2;
	else
		SPNR_LEVEL_SDHD_SONY = 1;

#if 0
	if(MA_print_count%100==0)
	{
		ROSPrintf("RTNR_LEVEL_SDHD_SONY=%d,SPNR_LEVEL_SDHD_SONY=%d,mean=%d \n",RTNR_LEVEL_SDHD_SONY,SPNR_LEVEL_SDHD_SONY,DCC_Histogram_Mean_value);
	}
#endif
	counter_file++;

	//v=============get Level to ap===============v
	if(AutoNR_Enable == FALSE)
	{
		switch(Scaler_GetAutoMA(Set_MA_input))
		{
			case 0:
				//AutoMA_Flag[Get_MA_input_Level] = VD_noise_level-1;
				//AutoMA_Flag[Get_MA_input_rate] = rate_Lerp_NR;
				break;
			case 1:
				//AutoMA_Flag[Get_MA_input_Level] = DNR_Auto_lvl_SdHd-1;
				//AutoMA_Flag[Get_MA_input_rate] = 0;
				break;
			default:
				//AutoMA_Flag[Get_MA_input_Level] = 0;
				//AutoMA_Flag[Get_MA_input_rate] = 0;
				ROSPrintf("AutoMA_Flag error\n");
				break;
		}
	}
	//^=====================================^

	//=============compute max NR level for low mid high
	if(AutoNR_Enable_by_Low_Mid_High)
	{
		if((scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)==0))
			AutoNR_Level_bound =7;
		else if((scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)==1))
			AutoNR_Level_bound =8;
		else if((scalerVIP_getDNR(scaler_disp_info[_CHANNEL1].input_src)==2))
			AutoNR_Level_bound =9;
		else
			AutoNR_Level_bound =10;
	}
	//======================================

	//debug Print : 0~3 => 0:DNR, 1:RTNR, 2: SNR, 3:INR
	if((MA_print_count %60) == 0){
		drvif_color_Print_NR_log(current_Signal_Status, 0);
	}
	else if(((MA_print_count+15) %60) == 0){
		drvif_color_Print_NR_log(current_Signal_Status, 1);
	}
	else if(((MA_print_count+30) %60) == 0){
		drvif_color_Print_NR_log(current_Signal_Status, 2);
	}
	else if(((MA_print_count+45) %60) == 0){
		drvif_color_Print_NR_log(current_Signal_Status, 3);
	}

	return 0;

}

#endif

//####################################################

unsigned char scalerVIP_resolution_detection(void)
{
#if 0
	//100: absolutely native 1080i/1080p
	//0: absolutely scaled SD content
	//255: no valid data to detection

	unsigned char detection_value = 255;
	char InputSourceDetFlag;
	unsigned short detection_value = 0;
	InputSourceDetFlag = scalerVIP_ReadSrcDet(2, 20, 0);
	if(InputSourceDetFlag != SUCCESS)
		return 255;

	if(Step_Hist[0]+Step_Hist[1] < 210000)
		detection_value = 0;
	else
		detection_value = (Step_Hist[0]+Step_Hist[1]-210000)>>11;

	if(detection_value > 100)
		detection_value = 100;

	return (unsigned char)detection_value;
#endif
	return 0;
}

unsigned char scalerVIP_Get_ChromaErrorEn_from_viptab(unsigned char isSmoothtoggle, unsigned char smoothtoggle_source)
{
	SLR_VIP_TABLE *vipTable_shareMem = scaler_GetShare_Memory_VIP_TABLE_Struct();
	unsigned char which_source = 0;

	if (isSmoothtoggle)
	{
		which_source = smoothtoggle_source;
	}
	else
	{
		if (RPC_system_info_structure_table)
			which_source=(RPC_system_info_structure_table->VIP_source);
		else
			return 0;
	}

	if (vipTable_shareMem)
		return vipTable_shareMem->VIP_QUALITY_Coef[which_source][VIP_QUALITY_FUNCTION_MA_Chroma_Error];
	else
		return 0;

}

void scalerVIP_pattern_detected(void)
{
	static unsigned char cnt = 0;

	mpegnr_ich1_accessdata_ctrl_pk_RBUS accessdata_ctrl_pk_reg;
	mpegnr_ich1_accessdata_posctrl_pk_RBUS accessdata_posctrl_pk_reg;
	mpegnr_ich1_readdata_data_y1_pk_RBUS readdata_data_y1_pk_reg;
	mpegnr_ich1_readdata_data_c1_pk_RBUS readdata_data_c1_pk_RBUS;
	accessdata_ctrl_pk_reg.regValue = rtd_inl(MPEGNR_ICH1_AccessData_CTRL_PK_reg);
	accessdata_posctrl_pk_reg.regValue = rtd_inl(MPEGNR_ICH1_AccessData_PosCtrl_PK_reg);
	readdata_data_y1_pk_reg.regValue = rtd_inl(MPEGNR_ICH1_ReadData_DATA_Y1_PK_reg);
	readdata_data_c1_pk_RBUS.regValue = rtd_inl(MPEGNR_ICH1_ReadData_DATA_C1_PK_reg);

	accessdata_ctrl_pk_reg.write_en = 1;
	accessdata_posctrl_pk_reg.startx = 100;
	accessdata_posctrl_pk_reg.starty = 100;
	readdata_data_y1_pk_reg.y00 = 255;

	if(cnt == 0)
	{
		readdata_data_c1_pk_RBUS.u00 = 255;
		readdata_data_c1_pk_RBUS.v00 = 0;
		cnt = 1;
	}
	else
	{
		readdata_data_c1_pk_RBUS.u00 = 0;
		readdata_data_c1_pk_RBUS.v00 = 255;
		cnt = 0;
	}

	rtd_outl(MPEGNR_ICH1_AccessData_CTRL_PK_reg, accessdata_ctrl_pk_reg.regValue);
	rtd_outl(MPEGNR_ICH1_AccessData_PosCtrl_PK_reg, accessdata_posctrl_pk_reg.regValue);
	rtd_outl(MPEGNR_ICH1_ReadData_DATA_Y1_PK_reg, readdata_data_y1_pk_reg.regValue);
	rtd_outl(MPEGNR_ICH1_ReadData_DATA_C1_PK_reg, readdata_data_c1_pk_RBUS.regValue);
}

void Scaler_color_print_scalerinfo_isr(void)
{
	color_dcc_d_dcc_fwused_1_RBUS dcc_fwused_1_reg;
	dcc_fwused_1_reg.regValue = rtd_inl(COLOR_DCC_D_DCC_FWUSED_1_reg);
	if((system_info_structure_table) && (dcc_fwused_1_reg.VipInfo == 1) && (RPC_system_info_structure_table)) {
		ROSPrintf("===== VIP_scaler_info =====\n");
		/*============================================*/
		ROSPrintf("Input_src_Type = %d\n", system_info_structure_table->Input_src_Type);
		ROSPrintf("Input_src_Form = %d\n", system_info_structure_table->Input_src_Form);
		ROSPrintf("Input_VO_Form = %d\n", system_info_structure_table->Input_VO_Form);
		ROSPrintf("input_TVD_Form = %d\n", system_info_structure_table->Input_TVD_Form);
		ROSPrintf("vdc_color_standard = %d\n", system_info_structure_table->vdc_color_standard);
		ROSPrintf("Timing = %d\n", system_info_structure_table->Timing);
		ROSPrintf("HDMI_video_format = %d\n", system_info_structure_table->HDMI_video_format);
		ROSPrintf("VIP_source = %d\n", RPC_system_info_structure_table->VIP_source);
		ROSPrintf("Display_RATIO_TYPE = %d\n", system_info_structure_table->Display_RATIO_TYPE);
		ROSPrintf("HDMI_data_range = %d\n", system_info_structure_table->HDMI_data_range);
		ROSPrintf("HDR_flag = %d\n", system_info_structure_table->HDR_flag);
		ROSPrintf("DolbyHDR_flag = %d\n", system_info_structure_table->DolbyHDR_flag);

		ROSPrintf("input_display = %d\n", system_info_structure_table->input_display);
		ROSPrintf("HDMI_color_space = %d\n", system_info_structure_table->HDMI_color_space);
		ROSPrintf("IV_Start = %d\n", system_info_structure_table->IV_Start);
		ROSPrintf("IH_Start = %d\n", system_info_structure_table->IH_Start);
		ROSPrintf("I_Height = %d\n", system_info_structure_table->I_Height);
		ROSPrintf("I_Width = %d\n", system_info_structure_table->I_Width);
		ROSPrintf("Mem_Height = %d\n", system_info_structure_table->Mem_Height);
		ROSPrintf("Mem_Width = %d\n", system_info_structure_table->Mem_Width);
		ROSPrintf("Cap_Height = %d\n", system_info_structure_table->Cap_Height);
		ROSPrintf("Cap_Width = %d\n", system_info_structure_table->Cap_Width);
		ROSPrintf("DI_Width = %d\n", system_info_structure_table->DI_Width);
		ROSPrintf("D_Height = %d\n", system_info_structure_table->D_Height);
		ROSPrintf("D_Width = %d\n", system_info_structure_table->D_Width);
		ROSPrintf("color_fac_src_idx = %d\n", system_info_structure_table->color_fac_src_idx);
		ROSPrintf("Project_ID = %d\n", RPC_system_info_structure_table->Project_ID);
		/*============================================*/
		ROSPrintf("===== VIP_scaler_info end =====\n");
	}

}

unsigned char scalerVIP_check_vdc_hw_pwr()
{
	//crt_sys_pll_27x3_RBUS sys_pll_27x3_reg;
	sys_reg_sys_clken1_RBUS sys_reg_sys_clken1;

	//sys_pll_27x3_reg.regValue = rtdf_inl(CRT_SYS_PLL_27X3_reg);
	sys_reg_sys_clken1.regValue = rtd_inl(SYS_REG_SYS_CLKEN1_reg);

	if (sys_reg_sys_clken1.clken_vdec == 1 &&
		system_info_structure_table->Input_src_Form == _SRC_FROM_VDC) /*&&
		sys_pll_27x3_reg.pll27x_pow == 1 &&
		sys_pll_27x3_reg.pll27x_rstb == 1 &&
		sys_pll_27x3_reg.pll27x_vcorstb == 1 &&
		sys_pll_27x3_reg.pll27x_ps_en == 1)
		*/
		return 1;
	else
		return 0;
}

unsigned long g_DoWriteRGB2YUV = 0;
void scalerVIP_Write_RGB2YUV(unsigned long arg)
{
	g_DoWriteRGB2YUV = arg;
	/*ROSPrintf("scalerVIP_Write_RGB2YUV %d\n");*/
}

void scalerVIP_Set_Inv_Gamma_En(unsigned char arg)
{
	g_Inv_Gamma = arg;
}
void scalerVIP_Inv_Gamma_En_Write(void)
{
	if(g_Inv_Gamma > 1 || pGamma_Table == NULL)
		return;
	unsigned char enable = g_Inv_Gamma;

	g_Inv_Gamma =255;

	inv_gamma_inv_gamma_ctrl_2_RBUS inv_gamma_ctrl_2_REG;

	inv_gamma_ctrl_2_REG.regValue = rtd_inl(INV_GAMMA_INV_GAMMA_CTRL_2_reg);

	//if (display == SLR_MAIN_DISPLAY) {
			inv_gamma_ctrl_2_REG.inv_gamma_m_tab_sel = enable; /* use tab-1*/
	//}
#ifdef CONFIG_DUAL_CHANNEL  /* There are two channels*/
	//else {
	//	inv_gamma_ctrl_2_REG.inv_gamma_s_tab_sel = g_Inv_Gamma?2:0; /* use tab-2*/
	//}
#endif
	rtd_outl(INV_GAMMA_INV_GAMMA_CTRL_2_reg, inv_gamma_ctrl_2_REG.regValue);

}


void scalerVIP_color_colorspacergb2yuvtransfer(unsigned char channel, unsigned short *table_index)
{
	if (g_DoWriteRGB2YUV == 0)
		return;

	g_DoWriteRGB2YUV = 0;

	if (system_info_structure_table == NULL)
		return;

	if (table_index == NULL)
		table_index = (unsigned short *)&system_info_structure_table->RGB2YUV_COEF_CSMatrix;

	if (channel == _CHANNEL1)  { /*main always access tab-1*/

		rgb2yuv_ich1_rgb2yuv_ctrl_RBUS  ich1_RGB2YUV_CTRL_REG;

		rgb2yuv_tab1_m11_m12_RBUS tab1_m11_m12_reg;
		rgb2yuv_tab1_m13_m21_RBUS tab1_m13_m21_reg;
		rgb2yuv_tab1_m22_m23_RBUS tab1_m22_m23_reg;
		rgb2yuv_tab1_m31_m32_RBUS tab1_m31_m32_reg;
		rgb2yuv_tab1_m33_ygain_RBUS tab1_m33_ygain_reg;
		rgb2yuv_tab1_yo_RBUS tab1_yo_reg;

		ich1_RGB2YUV_CTRL_REG.regValue = rtd_inl(RGB2YUV_ICH1_RGB2YUV_CTRL_reg);

		ich1_RGB2YUV_CTRL_REG.sel_table = 0;
		ich1_RGB2YUV_CTRL_REG.en_rgb2yuv = 0;
		ich1_RGB2YUV_CTRL_REG.sel_y_gain = 1;

		rtd_outl(RGB2YUV_ICH1_RGB2YUV_CTRL_reg, ich1_RGB2YUV_CTRL_REG.regValue);

		/*main  all tab-1*/
		tab1_m11_m12_reg.m11 = table_index[_RGB2YUV_m11];
		tab1_m11_m12_reg.m12 = table_index[_RGB2YUV_m12];
		rtd_outl(RGB2YUV_Tab1_M11_M12_reg, tab1_m11_m12_reg.regValue);
		tab1_m13_m21_reg.m13 = table_index[_RGB2YUV_m13];
		tab1_m13_m21_reg.m21 = table_index[_RGB2YUV_m21];
		rtd_outl(RGB2YUV_Tab1_M13_M21_reg, tab1_m13_m21_reg.regValue);
		tab1_m22_m23_reg.m22 = table_index[_RGB2YUV_m22];
		tab1_m22_m23_reg.m23 = table_index[_RGB2YUV_m23];
		rtd_outl(RGB2YUV_Tab1_M22_M23_reg, tab1_m22_m23_reg.regValue);
		tab1_m31_m32_reg.m31 = table_index[_RGB2YUV_m31];
		tab1_m31_m32_reg.m32 = table_index[_RGB2YUV_m32];
		rtd_outl(RGB2YUV_Tab1_M31_M32_reg, tab1_m31_m32_reg.regValue);
		tab1_m33_ygain_reg.m33 = table_index[_RGB2YUV_m33];
		tab1_m33_ygain_reg.y_gain = table_index[_RGB2YUV_Y_gain];
		rtd_outl(RGB2YUV_Tab1_M33_YGain_reg, tab1_m33_ygain_reg.regValue);

		tab1_yo_reg.yo_even = table_index[_RGB2YUV_Yo_even];
		tab1_yo_reg.yo_odd = table_index[_RGB2YUV_Yo_odd];
		rtd_outl(RGB2YUV_Tab1_Yo_reg, tab1_yo_reg.regValue);

		ich1_RGB2YUV_CTRL_REG.sel_rgb = table_index[_RGB2YUV_sel_RGB];
		ich1_RGB2YUV_CTRL_REG.set_r_in_offset = table_index[_RGB2YUV_set_Yin_offset];
		ich1_RGB2YUV_CTRL_REG.set_uv_out_offset = table_index[_RGB2YUV_set_UV_out_offset];
		ich1_RGB2YUV_CTRL_REG.sel_uv_off = table_index[_RGB2YUV_sel_UV_off];
		ich1_RGB2YUV_CTRL_REG.matrix_bypass = table_index[_RGB2YUV_Matrix_bypass];
		ich1_RGB2YUV_CTRL_REG.sel_y_gain = table_index[_RGB2YUV_Enable_Y_gain];

		ich1_RGB2YUV_CTRL_REG.sel_table = 0;
		ich1_RGB2YUV_CTRL_REG.en_rgb2yuv = 1;

		rtd_outl(RGB2YUV_ICH1_RGB2YUV_CTRL_reg, ich1_RGB2YUV_CTRL_REG.regValue);

	}
	/*
	else
	{
		rgb2yuv_ich2_rgb2yuv_ctrl_RBUS	ich2_RGB2YUV_CTRL_REG;

		rgb2yuv_tab2_m11_m12_RBUS tab2_m11_m12_reg;
		rgb2yuv_tab2_m13_m21_RBUS tab2_m13_m21_reg;
		rgb2yuv_tab2_m22_m23_RBUS tab2_m22_m23_reg;
		rgb2yuv_tab2_m31_m32_RBUS tab2_m31_m32_reg;
		rgb2yuv_tab2_m33_y_gain_RBUS tab2_m33_ygain_reg;
		rgb2yuv_tab2_yo_RBUS tab2_yo_reg;

		ich2_RGB2YUV_CTRL_REG.regValue = IoReg_Read32(RGB2YUV_ICH2_RGB2YUV_CTRL_reg);
		ich2_RGB2YUV_CTRL_REG.sel_table = 1;
		ich2_RGB2YUV_CTRL_REG.en_rgb2yuv = 0;
		rtd_outl(RGB2YUV_ICH2_RGB2YUV_CTRL_reg, ich2_RGB2YUV_CTRL_REG.regValue);

		//sub  all tab-2
		tab2_m11_m12_reg.m11 = table_index[_RGB2YUV_m11];
		tab2_m11_m12_reg.m12 = table_index[_RGB2YUV_m12];
		rtd_outl(RGB2YUV_TAB2_M11_M12_reg, tab2_m11_m12_reg.regValue);
		tab2_m13_m21_reg.m13 = table_index[_RGB2YUV_m13];
		tab2_m13_m21_reg.m21 = table_index[_RGB2YUV_m21];
		rtd_outl(RGB2YUV_TAB2_M13_M21_reg, tab2_m13_m21_reg.regValue);
		tab2_m22_m23_reg.m22 = table_index[_RGB2YUV_m22];
		tab2_m22_m23_reg.m23 = table_index[_RGB2YUV_m23];
		rtd_outl(RGB2YUV_TAB2_M22_M23_reg, tab2_m22_m23_reg.regValue);
		tab2_m31_m32_reg.m31 = table_index[_RGB2YUV_m31];
		tab2_m31_m32_reg.m32 = table_index[_RGB2YUV_m32];
		rtd_outl(RGB2YUV_TAB2_M31_M32_reg, tab2_m31_m32_reg.regValue);
		tab2_m33_ygain_reg.m33 = table_index[_RGB2YUV_m33];
		tab2_m33_ygain_reg.y_gain = table_index[_RGB2YUV_Y_gain];
		rtd_outl(RGB2YUV_TAB2_M33_Y_GAIN_reg, tab2_m33_ygain_reg.regValue);

		tab2_yo_reg.yo_even = table_index[_RGB2YUV_Yo_even];
		tab2_yo_reg.yo_odd = table_index[_RGB2YUV_Yo_odd];
		rtd_outl(RGB2YUV_TAB2_YO_reg, tab2_yo_reg.regValue);

		ich2_RGB2YUV_CTRL_REG.sel_rgb = table_index[_RGB2YUV_sel_RGB];
		ich2_RGB2YUV_CTRL_REG.set_r_in_offset = table_index[_RGB2YUV_set_Yin_offset];
		ich2_RGB2YUV_CTRL_REG.set_uv_out_offset = table_index[_RGB2YUV_set_UV_out_offset];
		ich2_RGB2YUV_CTRL_REG.sel_uv_off = table_index[_RGB2YUV_sel_UV_off];
		ich2_RGB2YUV_CTRL_REG.matrix_bypass = table_index[_RGB2YUV_Matrix_bypass];
		ich2_RGB2YUV_CTRL_REG.sel_y_gain = table_index[_RGB2YUV_Enable_Y_gain];

		ich2_RGB2YUV_CTRL_REG.sel_table = 1;
		ich2_RGB2YUV_CTRL_REG.en_rgb2yuv = 1;

		rtd_outl(RGB2YUV_ICH2_RGB2YUV_CTRL_reg, ich2_RGB2YUV_CTRL_REG.regValue);

	}
	*/
}

void scalerVIP_Set_FW_Film_Mode_En(unsigned char enable)
{
	di_im_di_film_new_function_main_RBUS im_di_film_new_function_main_reg;
	im_di_film_new_function_main_reg.regValue = rtd_inl(DI_IM_DI_FILM_NEW_FUNCTION_MAIN_reg);
	g_fw_film_en = enable;
	im_di_film_new_function_main_reg.fw_film_en = m_film_clear_isr?0:enable;

	rtd_outl(DI_IM_DI_FILM_NEW_FUNCTION_MAIN_reg, im_di_film_new_function_main_reg.regValue);
}
void scalerVIP_Set_Noise_Level(unsigned char Level)
{
	Noise_Level = Level;
}
unsigned char scalerVIP_Get_Noise_Level(void)
{
	return Noise_Level;
}
unsigned char scalerVIP_Get_PT_NO(void)
{
	unsigned char i=0;

	for(i=0;i<200;i++)
	{
		if(DynamicOptimizeSystem[i]==1)
		{
			return i;
		}
	}
	return 0;

}

//============= Set Info to MEMC  jzl 20151231====================
#ifdef CONFIG_RTK_KDEV_MEMC_INTERRUPT
void scalerVIP_Set_MEMC_Info_toVCPU(void)
{
	_system_setting_info* system_info_structure_table = NULL;
	system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

	if((system_info_structure_table == NULL)) {
		if(MA_print_count%360==0) {
			ROSPrintf(" === scalerVIP_Set_MEMC_Info_toVCPU === \n\n");
			ROSPrintf(" Mem = %x\n\n",system_info_structure_table);
		}
		return;
	}
	system_info_structure_table->MEMC_ISRIINFO_TO_VCPU.memc_cadence = Scaler_MEMC_GetCadence();
	system_info_structure_table->MEMC_ISRIINFO_TO_VCPU.memc_avdelay = Scaler_MEMC_GetAVSyncDelay();

}
#endif

extern int PictureMode_flg;
void scalerVIP_Set_Info_toMEMC(void)
{
	setScalerVIPInfo.bSRC_VO = (system_info_structure_table->Input_src_Type == _SRC_VO)? 1:0;
	setScalerVIPInfo.source_type = RPC_system_info_structure_table->VIP_source;
	setScalerVIPInfo.bHDR_Chg = (RPC_system_info_structure_table->HDR_info.HDR_Setting_Status == 3)? 1:0;
	setScalerVIPInfo.PictureMode_Chg = PictureMode_flg;
	if(PictureMode_flg == 1)
		PictureMode_flg = 0;

	unsigned int osd_bri_sub = 0;// (system_info_structure_table->OSD_Info.Brightness_Gain_Sub);
	unsigned int osd_con_sub = 0;
	setScalerVIPInfo.mBrightness = ((osd_bri_sub<<8) + (system_info_structure_table->OSD_Info.Brightness_Gain)) & 0xffff;	// uint16: msb: bri_sub; lsb: bri_main
	setScalerVIPInfo.mContrast= ((osd_con_sub<<8) + (system_info_structure_table->OSD_Info.Contrast_Gain)) & 0xffff;	// uint16: msb: bri_sub; lsb: bri_main

	static unsigned int su_hor_factor_pre, su_ver_factor_pre, sd_hor_factor_pre, sd_ver_factor_pre;
	unsigned int su_hor_factor_cur, su_ver_factor_cur, sd_hor_factor_cur, sd_ver_factor_cur;

	scaleup_dm_uzu_scale_hor_factor_RBUS	scaleup_dm_uzu_scale_hor_factor_reg;
	scaleup_dm_uzu_scale_hor_factor_reg.regValue = rtd_inl(SCALEUP_DM_UZU_Scale_Hor_Factor_reg);
	su_hor_factor_cur = scaleup_dm_uzu_scale_hor_factor_reg.hor_factor;

	scaleup_dm_uzu_scale_ver_factor_RBUS	scaleup_dm_uzu_scale_ver_factor_reg;
	scaleup_dm_uzu_scale_ver_factor_reg.regValue = rtd_inl(SCALEUP_DM_UZU_Scale_Ver_Factor_reg);
	su_ver_factor_cur = scaleup_dm_uzu_scale_ver_factor_reg.ver_factor;

	scaledown_ich1_uzd_scale_hor_factor_RBUS	scaledown_ich1_uzd_scale_hor_factor_reg;
	scaledown_ich1_uzd_scale_hor_factor_reg.regValue = rtd_inl(SCALEDOWN_ICH1_UZD_Scale_Hor_Factor_reg);
	sd_hor_factor_cur = scaledown_ich1_uzd_scale_hor_factor_reg.hor_fac;

	scaledown_ich1_uzd_scale_ver_factor_RBUS	scaledown_ich1_uzd_scale_ver_factor_reg;
	scaledown_ich1_uzd_scale_ver_factor_reg.regValue = rtd_inl(SCALEDOWN_ICH1_UZD_Scale_Ver_Factor_reg);
	sd_ver_factor_cur = scaledown_ich1_uzd_scale_ver_factor_reg.ver_fac;

	if((su_hor_factor_pre != su_hor_factor_cur) || (su_ver_factor_pre != su_ver_factor_cur)
		|| (sd_hor_factor_pre != sd_hor_factor_cur) || (sd_ver_factor_pre != sd_ver_factor_cur))
	{
		setScalerVIPInfo.bZoomAction = 1;
	}
	else
	{
		setScalerVIPInfo.bZoomAction = 0;
	}

	su_hor_factor_pre = su_hor_factor_cur;
	su_ver_factor_pre = su_ver_factor_cur;
	sd_hor_factor_pre = sd_hor_factor_cur;
	sd_ver_factor_pre = sd_ver_factor_cur;

	//xy shift
	static int hor_front_pre, hor_back_pre, ver_front_pre, ver_back_pre;
	int hor_front_cur, hor_back_cur, ver_front_cur, ver_back_cur;

	scaledown_ich1_sdnr_cutout_range_hor_RBUS ich1_sdnr_cutout_range_hor_reg;
	ich1_sdnr_cutout_range_hor_reg.regValue = rtd_inl(SCALEDOWN_ich1_sdnr_cutout_range_hor_reg);
	hor_front_cur = ich1_sdnr_cutout_range_hor_reg.hor_front;
	hor_back_cur = ich1_sdnr_cutout_range_hor_reg.hor_back;

	scaledown_ich1_sdnr_cutout_range_ver0_RBUS ich1_sdnr_cutout_range_ver0_reg;
	ich1_sdnr_cutout_range_ver0_reg.regValue = rtd_inl(SCALEDOWN_ich1_sdnr_cutout_range_ver0_reg);
	ver_front_cur = ich1_sdnr_cutout_range_ver0_reg.ver_front;
	ver_back_cur = ich1_sdnr_cutout_range_ver0_reg.ver_back;

	if((hor_front_pre != hor_front_cur) || (hor_back_pre != hor_back_cur)
		|| (ver_front_pre != ver_front_cur) || (ver_back_pre != ver_back_cur))
	{
		setScalerVIPInfo.bShiftAction = 1;
	}
	else
	{
		setScalerVIPInfo.bShiftAction = 0;
	}

	hor_front_pre = hor_front_cur;
	hor_back_pre = hor_back_cur;
	ver_front_pre = ver_front_cur;
	ver_back_pre = ver_back_cur;

	unsigned char i=0;
	UINT32 Hist_diff = 0;

	for (i=0; i<COLOR_HISTOGRAM_LEVEL; i++)
	{
		if (SmartPic_clue->Y_Main_Hist[i] > 10000)
		{
			setScalerVIPInfo.mDarkLevel = (i*2);
			break;
		}
	}

	for (i=0; i<COLOR_HISTOGRAM_LEVEL; i++)
	{
		if(Y_Main_Hist_pre[i] > SmartPic_clue->Y_Main_Hist[i])
			Hist_diff = Hist_diff + (Y_Main_Hist_pre[i] - SmartPic_clue->Y_Main_Hist[i]);
		else
			Hist_diff = Hist_diff + (SmartPic_clue->Y_Main_Hist[i] - Y_Main_Hist_pre[i]);
	}

	setScalerVIPInfo.Hist_SC_flg = ((Hist_diff > 5000) ? 1 : 0);

//	if(Hist_SC_flg = 1)
//		printk("$$$   Hist_diff = (%x)   $$$\r\n$$$   Hist_SC_flg = (%d)   $$$\r\n", Hist_diff, Hist_SC_flg);

	for(i =  0; i < COLOR_HISTOGRAM_LEVEL; i++){
		Y_Main_Hist_pre[i] = SmartPic_clue->Y_Main_Hist[i];
	}

	// soccer patch
	{
		unsigned short  h_soccer_grass[24]={10, 10, 4, 7, 7, 16, 117, 703, 11, 1, 0, 0, 0, 0, 1, 1, 5, 37, 24, 8, 7, 6, 6, 8};
		unsigned int  s_soccer_grass[32]={28, 98, 814, 34, 10, 3, 2, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
		unsigned short  y_soccer_grass[32]={0, 0, 0, 0, 1, 1, 2, 4, 8, 11, 15, 77, 301, 129, 284, 58, 29, 26, 13, 7, 3, 2, 2, 2, 1, 1, 1, 2, 1, 1, 0, 0};

		unsigned short h_ratio, s_ratio, y_ratio;
		unsigned short h_th = 950, s_th = 950, y_th = 920;

		h_ratio = scalerVIP_ratio_inner_product_base_16(&h_soccer_grass[0], &hue_hist_ratio[0], 24);
		s_ratio = scalerVIP_ratio_inner_product_base(&s_soccer_grass[0], &sat_hist_ratio[0], 32);
		y_ratio = scalerVIP_ratio_inner_product_base_16(&y_soccer_grass[0], &Y_hist_ratio[0], 32);

		if((h_ratio>h_th) && (s_ratio>s_th) && (y_ratio>y_th))
		{
			setScalerVIPInfo.mSoccer_holdfrm = 8;
		}
		else if(setScalerVIPInfo.mSoccer_holdfrm>0)
		{
			setScalerVIPInfo.mSoccer_holdfrm--;
		}
		else
		{
			setScalerVIPInfo.mSoccer_holdfrm = 0;
		}
	}

	//high-freq and player OSD change
	{
		if(system_info_structure_table->Input_src_Type == _SRC_HDMI)
		{
			if(RTNR_MAD_count_Y_avg>800 && RTNR_MAD_count_Y3_avg<20)
				setScalerVIPInfo.bVIP_still = 1;
			else
				setScalerVIPInfo.bVIP_still = 0;
		}
	}

}

SET_MEMC_SCALER_VIP_INFO scalerVIP_Get_Info_fromScaler(void)
{
	return setScalerVIPInfo;
}

//============= Set Info to MEMC  =============================

unsigned int *g_Share_Memory_DCC_Force_Write = NULL;
void scalerVIP_Set_DCC_ForceWrite_Flag(unsigned long arg)
{
	g_Share_Memory_DCC_Force_Write = ((unsigned int *)arg);
}

void scalerVIP_color_DRV_SNR_Veritcal_NR(DRV_SNR_Veritcal_NR *ptr)
{
	iedge_smooth_vfilter_0_RBUS vfilter_0_reg;
	iedge_smooth_vfilter_1_RBUS vfilter_1_reg;
	iedge_smooth_vfilter_2_RBUS vfilter_2_reg;
	iedge_smooth_vfilter_3_RBUS vfilter_3_reg;
	#if 0 //jyyang20161215
	iedge_smooth_vfilter_4_RBUS vfilter_4_reg;
	iedge_smooth_vfilter_5_RBUS vfilter_5_reg;
	iedge_smooth_vfilter_6_RBUS vfilter_6_reg
	#endif
	vfilter_0_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_0_reg);
	vfilter_1_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_1_reg);
	vfilter_2_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_2_reg);
	vfilter_3_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_3_reg);
	#if 0 //jyyang20161215
	vfilter_4_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_4_reg);
	vfilter_5_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_5_reg);
	vfilter_6_reg.regValue = rtd_inl(IEDGE_SMOOTH_VFILTER_6_reg);
	#endif
	vfilter_0_reg.avlpf_en = ptr->SNR_Veritcal_avlpf_En;
	vfilter_2_reg.avlpf_c_en = ptr->SNR_Veritcal_C_En;
	vfilter_0_reg.avlpf_correct_en = ptr->SNR_Veritcal_correct_En;
	vfilter_0_reg.avlpf_bw_pattern_en = ptr->SNR_Veritcal_BW_En;
	vfilter_0_reg.vfir_weight = ptr->SNR_Veritcal_Y_Weight;
	vfilter_2_reg.vfir_c_weight = ptr->SNR_Veritcal_C_Weight;
	vfilter_0_reg.avlpf_mindiff_th_start = ptr->SNR_Veritcal_Th_start;
	vfilter_0_reg.avlpf_mindiff_curve_rate_start = ptr->SNR_Veritcal_Rate_start;
	vfilter_0_reg.avlpf_mindiff_th_finish = ptr->SNR_Veritcal_Th_finish;
	vfilter_0_reg.avlpf_mindiff_curve_rate_finish = ptr->SNR_Veritcal_Rate_finish;
	vfilter_1_reg.avlpf_max_weight = ptr->SNR_Veritcal_Max_MinDiff_Weight;
	vfilter_1_reg.avlpf_min_weight = ptr->SNR_Veritcal_Min_MinDiff_Weight;
	vfilter_1_reg.avlpf_maxmindiff_th = ptr->SNR_Veritcal_MaxMinDiff_Th;
	vfilter_1_reg.avlpf_maxmindiff_curve_rate = ptr->SNR_Veritcal_MaxMinDiff_Rate;
	vfilter_2_reg.avlpf_bw_th = ptr->SNR_Veritcal_BWPattern_Th;
	vfilter_2_reg.avlpf_bw_margin = ptr->SNR_Veritcal_BWPattern_Margin;
	vfilter_2_reg.avlpf_bw_curve_rate = ptr->SNR_Veritcal_BWPattern_Rate;
	#if 0 //jyyang20161215
	vfilter_4_reg.esmex_iedge_vfir_enable = ptr->SNR_Vertical_fir_En;
	vfilter_4_reg.egsm_avlpf_vmode = ptr->SNR_Veritcal_Vmode;
	vfilter_4_reg.egsm_avlpf_clamp_en = ptr->SNR_Vertical_Clamp_En;
	vfilter_4_reg.egsm_avlpf_clampth = ptr->SNR_Vertical_Clamp_Th;
	vfilter_4_reg.egsm_avlpf_mindiff_th2_start = ptr->SNR_Vertical_Th2_start;
	vfilter_6_reg.egsm_avlpf2d_en = ptr->SNR_Veritcal_avlpf2D_En;
	vfilter_6_reg.egsm_avlpf2d_tolirant_en = ptr->SNR_Veritcal_avlpf2D_Tolirant_En;
	vfilter_5_reg.egsm_avlpf2d_tolirantmode = ptr->SNR_Veritcal_avlpf2D_Tolirant_Mode;
	vfilter_6_reg.egsm_avlpf2d_tolirantoffset = ptr->SNR_Veritcal_avlpf2D_Tolirant_Offset;
	#endif
	// :Vfir_En, :Vmode, :Clamp_En, :Clamp_th, :Th2_sta, :avlpf2D_En, :avlpf2D_Tol_En, :avlpf2D_Tol_Mode, :avlpf2D_Tol_Offset
	// 0, 1, 0, 6, 0, 0, 0, 0, 4
	rtd_outl(IEDGE_SMOOTH_VFILTER_0_reg, vfilter_0_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_VFILTER_1_reg, vfilter_1_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_VFILTER_2_reg, vfilter_2_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_VFILTER_3_reg, vfilter_3_reg.regValue);
	#if 0 //jyyang20161215
	rtd_outl(IEDGE_SMOOTH_VFILTER_4_reg, vfilter_4_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_VFILTER_5_reg, vfilter_5_reg.regValue);
	rtd_outl(IEDGE_SMOOTH_VFILTER_6_reg, vfilter_6_reg.regValue);
	#endif
}



void scalerVIP_Teeth_detcted(void)
{
	di_di_smd_waterflow_teeth_ctr_RBUS di_di_smd_waterflow_teeth_ctr;
	unsigned int teeth_value=0,gmv_avg=0;
	static unsigned int teeth_avg=0,bad_cnt=0 ,Step_Hist_th=0xc80;
	static unsigned char gmv_avg_th=50;

	di_im_di_ma_field_teeth_th_a_RBUS teeth_detect_th_a_reg;

	di_di_smd_waterflow_teeth_ctr.regValue= rtd_inl(DI_DI_SMD_WaterFlow_Teeth_Ctr_reg);
	di_di_smd_waterflow_teeth_ctr.smd_waterflow_protect_en =1;
	//di_di_smd_waterflow_teeth_ctr.smd_compensate_teeth_th_wf = 5;

	rtd_outl(DI_DI_SMD_WaterFlow_Teeth_Ctr_reg,di_di_smd_waterflow_teeth_ctr.regValue);

	teeth_value = rtd_inl(DI_DI_SMD_WaterFlow_Teeth_Count_reg)&0xffff;


	if((teeth_avg >=1023))
	{
		if((teeth_value<1023)&&(bad_cnt<63))
		{
			teeth_value = 1023;
			bad_cnt++;
			//ROSPrintf("\n 1 teeth_value %d ,teeth_avg %d ,bad_cnt %d \n ",teeth_value,teeth_avg,bad_cnt);
		}
		else
		{
			bad_cnt=0;
		}

	}
	//if(rtd_inl(0xb802e4f4)==12)
	//ROSPrintf("\n 2 teeth_value %d ,teeth_avg %d ,bad_cnt %d \n ",teeth_value,teeth_avg,bad_cnt);

	teeth_avg = scalerVIP_compute_I_teeth_Index_Ave(teeth_value,0);



	if(RPC_SmartPic_clue->SceneChange == 1){
		gmv_avg = scalerVIP_compute_I_Gmv_Index_Ave(scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio(),1);
	} else {
		gmv_avg = scalerVIP_compute_I_Gmv_Index_Ave(scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio(),0);
	}

	teeth_detect_th_a_reg.regValue= rtd_inl(DI_IM_DI_MA_FIELD_TEETH_TH_A_reg);

	DI_Video_Broken=0;
	DI_Res_Pat_pan_65ppf = 0;

	//if(rtd_inl(0xb802e4f4)==15)
	//	printk("\n gmv_avg %d ,Step_Hist[0] %X ,teeth_avg %d \n ",gmv_avg,Step_Hist[0] ,teeth_avg);

	if((gmv_avg>=gmv_avg_th)&&Step_Hist[0] <Step_Hist_th) // more still and high frequency less pattern
	{
		gmv_avg_th =50;
		Step_Hist_th = 0xc80;

#if 0
		if(teeth_avg>=100)
		{
			teeth_detect_th_a_reg.ma_fieldteethstha =40;
			DI_Video_Broken =1;
		}
		else if(teeth_avg<=70)
		{
			teeth_detect_th_a_reg.ma_fieldteethstha =0;
			DI_Video_Broken=0;

		}
		else
		{
			teeth_detect_th_a_reg.ma_fieldteethstha = (2*teeth_avg)/5;
			DI_Video_Broken=1;
		}
#else
		if(teeth_avg>=1023)
		{
			teeth_detect_th_a_reg.ma_fieldteethstha =40;
			DI_Video_Broken =1;
		}
		else
		{
			teeth_detect_th_a_reg.ma_fieldteethstha = 0;
			DI_Video_Broken=0;
		}


#endif

	}
	else
	{
		//printk("\n rord fail  %d , %d  \n",gmv_avg,Step_Hist[0]);
		gmv_avg_th =55;
		Step_Hist_th = 0xc80;
		teeth_detect_th_a_reg.ma_fieldteethstha = 0;
	}


	if (gmv_avg <= 38 ){
			DI_Res_Pat_pan_65ppf = 1;
	}

	rtd_outl(DI_IM_DI_MA_FIELD_TEETH_TH_A_reg,teeth_detect_th_a_reg.regValue);

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
	{
		ROSPrintf("\n gmv_avg %d , teeth_avg %d  \n ",gmv_avg,teeth_avg);
		ROSPrintf("\n DI_Video_Broken %d , Step_Hist[0] %d  \n ",DI_Video_Broken,Step_Hist[0]);

	}

}

void scalerVIP_DI_GMV_AVG_for_film()//for DTV576i
{
	#if 1
	unsigned int gmv_avg=0;
	if(RPC_SmartPic_clue->SceneChange == 1){
		gmv_avg = scalerVIP_compute_I_Gmv_Index_Ave(scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio(),1);
	} else	{
		gmv_avg = scalerVIP_compute_I_Gmv_Index_Ave(scalerVIP_DI_MiddleWare_MCNR_Get_GMV_Ratio(),0);
	}

	if( gmv_avg >= 90 )
		GMV_status_for_Filim = 1;
	else
		GMV_status_for_Filim = 0;

	#else
	short i = 0;
	unsigned char vpan_up_pass_total = 0, vpan_down_pass_total = 0, pass = 0;
	di_di_smd_gmvcoeff3_RBUS smd_gmvcoeff3_reg;
	static unsigned char Pass_Result_Sequence[VPAN_PASS_COUNT] = {0,0,0,0,0,0,0,0,0,0,
							      0,0,0,0,0,0,0,0,0,0,
							      0,0,0,0,0,0,0,0,0,0};

	smd_gmvcoeff3_reg.regValue = rtd_inl(DI_DI_SMD_GMVCOEFF3_reg);

	if (smd_gmvcoeff3_reg.smd_gmv2_x == 3 && (smd_gmvcoeff3_reg.smd_gmv2_y < 3 || smd_gmvcoeff3_reg.smd_gmv1_y <3))
		pass = 2; // move up
	else if (smd_gmvcoeff3_reg.smd_gmv2_x == 3 && (smd_gmvcoeff3_reg.smd_gmv2_y > 3 || smd_gmvcoeff3_reg.smd_gmv1_y > 3))
		pass = 1; // move down
	else
		pass = 0;

	// assign pass sequence
	for (i=VPAN_PASS_COUNT-2; i>=0; i--){
		Pass_Result_Sequence[i+1] = Pass_Result_Sequence[i];
	}
	Pass_Result_Sequence[0] = pass;

	for (i=0; i<VPAN_PASS_COUNT; i++)
	{
		if (Pass_Result_Sequence[i] == 2)
			vpan_up_pass_total++;
		else if (Pass_Result_Sequence[i] == 1)
			vpan_down_pass_total++;
	}

	if (vpan_up_pass_total > 12)
		VPan_status_for_Filim = 2;
	else if (vpan_down_pass_total > 12)
		VPan_status_for_Filim = 1;
	else
		VPan_status_for_Filim = 0;

	if((MA_print_count%debug_print_delay_time==0)&&(Start_Print.ID_Pattern_107==TRUE))
	{
		ROSPrintf("StatusUpdate : VPan_status_for_Filim = %d \n",VPan_status_for_Filim);
		ROSPrintf("StatusUpdate : gmv_y = %d %d \n",smd_gmvcoeff3_reg.smd_gmv1_y,smd_gmvcoeff3_reg.smd_gmv2_y);
		ROSPrintf("StatusUpdate : gmv_x = %d %d %d \n",smd_gmvcoeff3_reg.smd_gmv1_x,smd_gmvcoeff3_reg.smd_gmv2_x,smd_gmvcoeff3_reg.smd_gmv3_x);
		ROSPrintf("StatusUpdate : vpan_up_pass_total = %d \n",vpan_up_pass_total);
		ROSPrintf("StatusUpdate : vpan_down_pass_total = %d \n",vpan_down_pass_total);
	}




	#endif

}

#ifndef CONFIG_RTK_KDEV_VGIP_INTERRUPT
void VIP_SetShareMemAddr(SCALER_RPC_SHARE_MEM *a_ptShareMem)
{
	//SmartPic_clue = (_clues *)(a_ptShareMem->ulAddr[SMARTPIC_CLUS_IDX]);
	RPC_SmartPic_clue = (_clues *)(a_ptShareMem->ulAddr[RPC_SMARTPIC_CLUS_IDX]);
	reg_HistCnt_Sub = (unsigned int *)(a_ptShareMem->ulAddr[HIST_CNT_SUB_MEM_IDX]);
	DCR_TABLE = (unsigned char *)(a_ptShareMem->ulAddr[DCR_TABLE_MEM_IDX]);
}

void scalerVIP_Share_Memory_Access_VIP_TABLE_CRC_Struct(unsigned long arg)
{
	vip_table_crc_isr = ((VIP_table_crc_value_ISR *)arg);
}

void scalerVIP_Share_Memory_Access_VIP_TABLE_Struct(unsigned long arg)
{
 	g_Share_Memory_VIP_TABLE_Struct_isr= ((SLR_VIP_TABLE *)arg);
	scalerVIP_Share_Memory_Access_NR_Init();
	scalerVIP_Share_Memory_Access_Sharpness_Init();

	#ifdef VCPU_INTERRUPT
		ROSPM_AddDevice(&vip_device);
	#endif
 }
void scalerVIP_SetDCC_system_info_structure_table(unsigned long arg)
{
	ROSPrintf("SetDCC_system_info_structure_table\n");
	system_info_structure_table = ((_system_setting_info*)arg);
}
#endif

char ScalerVIP_Set_PQ_ByPass_Lv_ISR(unsigned char table_idx)
{
	char ret;

	_RPC_system_setting_info *RPC_system_info_structure_table = NULL;
	RPC_system_info_structure_table = scaler_GetShare_Memory_RPC_system_setting_info_Struct();

	if(RPC_system_info_structure_table == NULL){
		if(MA_print_count%360==0)
			ROSPrintf("Warning! Share Memory PQ data NULL,system_info = %x, \n", RPC_system_info_structure_table);
		return;
	}

	ret = fwif_color_PQ_ByPass_Handler_ISR(table_idx, 1, RPC_system_info_structure_table, 0);

	return ret;
}

char ScalerVIP_Get_PQ_ByPass_Lv_ISR(void)
{
	char ret;

	_RPC_system_setting_info *RPC_system_info_structure_table = NULL;
	RPC_system_info_structure_table = scaler_GetShare_Memory_system_setting_info_Struct();

	if((RPC_system_info_structure_table == NULL) ) {
		if(MA_print_count%360==0)
			ROSPrintf("Share Memory PQ data ERROR,RPC_VIP_system_info_structure_table = %x\n",RPC_system_info_structure_table);
		return 0;
	}

	ret = fwif_color_PQ_ByPass_Handler_ISR(0, 0, RPC_system_info_structure_table, 0);

	return ret;
}

char fwif_color_PQ_ByPass_Handler_ISR(unsigned char table_idx, unsigned char isSet_Flag, _RPC_system_setting_info *RPC_VIP_system_info_structure_table, unsigned char Force_byPass)
{
	unsigned char tbl_idx, i;
	VIP_PQ_ByPass_Struct *pPQ_ByPass_Struct;

	if (isSet_Flag == 1){

		if (table_idx >= VIP_PQ_ByPass_TBL_Max)
			table_idx = 0;

		RPC_VIP_system_info_structure_table->PQ_ByPass_Ctrl.table_idx = table_idx;
		tbl_idx = table_idx;

		pPQ_ByPass_Struct = &(RPC_VIP_system_info_structure_table->PQ_ByPass_Ctrl.PQ_ByPass_Struct[tbl_idx]);

		for (i=0; i<VIP_PQ_ByPass_ITEMS_Max; i++) {
			if (pPQ_ByPass_Struct->VIP_PQ_ByPass_TBL[i] == 1  || Force_byPass == 1)
				drvif_color_set_PQ_ByPass_ISR(i);
		}
	}

	return RPC_VIP_system_info_structure_table->PQ_ByPass_Ctrl.table_idx;
}

char drvif_color_set_PQ_ByPass_ISR(unsigned char bypass_item)
{
	di_im_di_control_RBUS di_im_di_control_reg;
	switch(bypass_item) {
		/*===============I Domain===========*/
		case PQ_ByPass_Iedge_Smooth:
			IoReg_ClearBits(IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_reg, IEDGE_SMOOTH_EdgeSmooth_EX_CTRL_edgesmoothex_en_mask);//_BIT0
		break;

		case PQ_ByPass_MPEG_NR:
			IoReg_ClearBits(MPEGNR_ICH1_MPEGNR2_reg, MPEGNR_ICH1_MPEGNR2_cp_mpegenable_x_mask);//_BIT0
			IoReg_SetBits(NR_SNR_DB_CTRL_reg, NR_SNR_DB_CTRL_snr_db_apply_mask); /* SNR DB apply */
		break;

		case PQ_ByPass_HSD_DITHER:
			IoReg_ClearBits(HSD_DITHER_SD_Dither_CTRL1_reg, HSD_DITHER_SD_Dither_CTRL1_ch1_dithering_table_select_mask); //_BIT5 | _BIT6
		break;

		case PQ_ByPass_HSD_DITHER_Temporal:
			IoReg_ClearBits(HSD_DITHER_SD_Dither_CTRL1_reg, HSD_DITHER_SD_Dither_CTRL1_ch1_temporal_enable_mask);//_BIT4
		break;

		case PQ_ByPass_RTNR_Y:
			IoReg_ClearBits(DI_IM_DI_RTNR_CONTROL_reg, DI_IM_DI_RTNR_CONTROL_cp_rtnr_y_enable_mask);//_BIT0
			IoReg_SetBits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);	/* HW do not clear this bit, alway turn on, setting will be apply while v_sync*/
		break;

		case PQ_ByPass_RTNR_C:
			IoReg_ClearBits(DI_IM_DI_RTNR_CONTROL_reg, DI_IM_DI_RTNR_CONTROL_cp_rtnr_c_enable_mask);//_BIT1
			IoReg_SetBits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);	/* HW do not clear this bit, alway turn on, setting will be apply while v_sync*/
		break;

		case PQ_ByPass_MCNR:
			IoReg_ClearBits(DI_IM_DI_RTNR_HMCNR_reg, DI_IM_DI_RTNR_HMCNR_cp_temporal_hmcnr_y_en_mask);//_BIT7
		break;

		case PQ_ByPass_I_DCTI:
			IoReg_ClearBits(IDCTI_I_DCTI_CTRL_1_reg, IDCTI_I_DCTI_CTRL_1_dcti_en_mask);//_BIT0
		break;

		case PQ_ByPass_ImpulseNR:
			IoReg_ClearBits(NR_DCH1_CP_Ctrl_reg, NR_DCH1_CP_Ctrl_cp_impulseenable_mask);//_BIT0
			IoReg_SetBits(NR_SNR_DB_CTRL_reg, NR_SNR_DB_CTRL_snr_db_apply_mask); /* SNR DB apply */
		break;

		case PQ_ByPass_SNR_C:
			IoReg_ClearBits(NR_DCH1_CP_Ctrl_reg, NR_DCH1_CP_Ctrl_cp_spatialenablec_mask);//_BIT1
			IoReg_SetBits(NR_SNR_DB_CTRL_reg, NR_SNR_DB_CTRL_snr_db_apply_mask); /* SNR DB apply */
		break;

		case PQ_ByPass_SNR_Y:
			IoReg_ClearBits(NR_DCH1_CP_Ctrl_reg, NR_DCH1_CP_Ctrl_cp_spatialenabley_mask);//_BIT2
			IoReg_SetBits(NR_SNR_DB_CTRL_reg, NR_SNR_DB_CTRL_snr_db_apply_mask); /* SNR DB apply */
		break;

		case PQ_ByPass_MosquiutoNR:
			IoReg_ClearBits(NR_MOSQUITO_CTRL_reg, NR_MOSQUITO_CTRL_mosquito_detect_en_mask);//_BIT0
		break;

		case PQ_ByPass_I_Peaking:
//			IoReg_ClearBits(PEAKING_ICH1_PEAKING_FILTER_reg, PEAKING_ICH1_PEAKING_FILTER_peaking_enable_mask);//_BIT26 // mac5 no I_Peaking
		break;

		case PQ_ByPass_MB_Peaking:
			IoReg_ClearBits(COLOR_MB_PEAKING_MB_PEAKING_CTRL_reg, COLOR_MB_PEAKING_MB_PEAKING_CTRL_mb_peaking_en_mask);//_BIT0
		break;

		/*Sub*/
#ifdef VIP_CONFIG_DUAL_CHANNEL
		case PQ_ByPass_HSD_DITHER_Sub:
			IoReg_ClearBits(SUB_DITHER_I_Sub_Dither_CTRL1_reg, SUB_DITHER_I_Sub_Dither_CTRL1_ch2_dithering_table_select_mask);//_BIT5|_BIT6
		break;

		case PQ_ByPass_HSD_DITHER_Temporal_Sub:
			IoReg_ClearBits(SUB_DITHER_I_Sub_Dither_CTRL1_reg, SUB_DITHER_I_Sub_Dither_CTRL1_ch2_temporal_enable_mask);//_BIT4
		break;

		case PQ_ByPass_I_Peaking_Sub:
			IoReg_ClearBits(PEAKING_ICH2_PEAKING_FILTER_reg, PEAKING_ICH2_PEAKING_FILTER_peaking_enable_mask);//_BIT26
		break;
#endif
		/*===============D Domain===========*/
		/*Main*/
		case PQ_ByPass_USM:
			IoReg_ClearBits(SCALEUP_DM_USM_reg, SCALEUP_DM_USM_usm_en_mask);//_BIT0
		break;

		case PQ_ByPass_SU_Peaking:
			IoReg_ClearBits(SCALEUP_DM_UZU_Peaking_Coring_reg, SCALEUP_DM_UZU_Peaking_Coring_pk_en_mask);//_BIT16
		break;

		case PQ_ByPass_SHP_DLTI:
			IoReg_ClearBits(COLOR_SHARP_SHP_DLTI_CTRL_1_reg, COLOR_SHARP_SHP_DLTI_CTRL_1_dlti_en_mask);//_BIT0
		break;

		case PQ_ByPass_DCC:
			IoReg_D_domain_ClearBits(COLOR_D_VC_Global_CTRL_reg, COLOR_D_VC_Global_CTRL_dcc_en_mask);//_BIT0
		break;

		case PQ_ByPass_DCTI:
			IoReg_D_domain_ClearBits(COLOR_D_VC_Global_CTRL_reg, COLOR_D_VC_Global_CTRL_m_dcti_en_mask);//_BIT2
			IoReg_ClearBits(COLOR_D_VC_Global_CTRL_DB_reg, COLOR_D_VC_Global_CTRL_DB_db_load_shift);//_BIT0
		break;

		case PQ_ByPass_ICM:
			IoReg_D_domain_ClearBits(COLOR_D_VC_Global_CTRL_reg, COLOR_D_VC_Global_CTRL_m_icm_en_mask);//_BIT3
		break;

		case PQ_ByPass_SHP:
			IoReg_D_domain_ClearBits(COLOR_D_VC_Global_CTRL_reg, COLOR_D_VC_Global_CTRL_m_sharp_en_mask);//_BIT4
		break;

		case PQ_ByPass_Dedge_Smooth:
			IoReg_D_domain_ClearBits(COLOR_D_VC_Global_CTRL_reg, COLOR_D_VC_Global_CTRL_m_edgesmooth_en_mask);//_BIT5
		break;

		case PQ_ByPass_CDS:
			IoReg_ClearBits(COLOR_SHARP_DM_CDS_CM0_U_BOUND_0_reg, COLOR_SHARP_DM_CDS_CM0_U_BOUND_0_cds_enable_mask);//_BIT27
		break;

		case PQ_ByPass_UV_Offset:
			IoReg_ClearBits(YUV2RGB_D_UVOFFSETBYY_CONTROL_reg, YUV2RGB_D_UVOFFSETBYY_CONTROL_uvoffsetbyy_main_en_mask);//_BIT0
		break;

		case PQ_ByPass_V_CTI:
			IoReg_ClearBits(SCALEUP_DM_MEM_CRC_CTRL_reg, SCALEUP_DM_MEM_CRC_CTRL_vcti_en_mask);//_BIT4
		break;

		case PQ_ByPass_sRGB:
			IoReg_ClearBits(SRGB_sRGB_CTRL_reg, SRGB_sRGB_CTRL_srgb_m_tab_sel_mask);//_BIT0|_BIT1
		break;

		case PQ_ByPass_Gamma:
			IoReg_ClearBits(GAMMA_GAMMA_CTRL_2_reg, GAMMA_GAMMA_CTRL_2_gamma_m_tab_sel_mask);//_BIT6|_BIT7
		break;

		case PQ_ByPass_InvGamma:
			IoReg_ClearBits(INV_GAMMA_INV_GAMMA_CTRL_2_reg, INV_GAMMA_INV_GAMMA_CTRL_2_inv_gamma_m_tab_sel_mask);//_BIT6|_BIT7
		break;

		case PQ_ByPass_ColorTemp:
//			IoReg_ClearBits(COLOR_TEMP_Color_Temp_CTRL_reg, COLOR_TEMP_Color_Temp_CTRL_color_temp_en_mask);//_BIT0 //mac5p no colortmp
		break;

		case PQ_ByPass_DITHER:
			IoReg_ClearBits(DITHER_DITHERING_CTRL_reg, DITHER_DITHERING_CTRL_function_enable_mask);//_BIT5
		break;

		case PQ_ByPass_DITHER_Temporal:
			IoReg_ClearBits(DITHER_DITHERING_CTRL_reg, DITHER_DITHERING_CTRL_temporal_enable_mask);//_BIT4
		break;

		/*Sub*/
#ifdef VIP_CONFIG_DUAL_CHANNEL
		case PQ_ByPass_DCTI_Sub:
			IoReg_ClearBits(COLOR_D_VC_Global_CTRL_reg, COLOR_D_VC_Global_CTRL_s_dcti_en_mask);//_BIT17
		break;

		case PQ_ByPass_ICM_Sub:
			IoReg_ClearBits(COLOR_D_VC_Global_CTRL_reg, COLOR_D_VC_Global_CTRL_s_icm_en_mask);//_BIT18
		break;

		case PQ_ByPass_SHP_Sub:
			IoReg_ClearBits(COLOR_D_VC_Global_CTRL_reg, COLOR_D_VC_Global_CTRL_s_sharp_en_mask);//_BIT19
		break;

		case PQ_ByPass_sRGB_Sub:
			IoReg_ClearBits(SRGB_sRGB_CTRL_reg, SRGB_sRGB_CTRL_srgb_s_tab_sel_mask);//_BIT2|_BIT3
		break;

		case PQ_ByPass_Gamma_Gamma:
			IoReg_ClearBits(GAMMA_GAMMA_CTRL_2_reg, GAMMA_GAMMA_CTRL_2_gamma_s_tab_sel_mask);//_BIT4|_BIT5
		break;

		case PQ_ByPass_InvGamma_Sub:
			IoReg_ClearBits(INV_GAMMA_INV_GAMMA_CTRL_2_reg, INV_GAMMA_INV_GAMMA_CTRL_2_inv_gamma_s_tab_sel_mask);//_BIT4|_BIT5
		break;
#endif
		/* new */
		case PQ_ByPass_I_DI_IP_Enable:

			di_im_di_control_reg.ip_enable=0;
			di_im_di_control_reg.write_enable_8=1;
			IoReg_Write32(DI_IM_DI_CONTROL_reg, di_im_di_control_reg.regValue);
			//IoReg_ClearBits(DI_IM_DI_CONTROL_reg, DI_IM_DI_CONTROL_ip_enable_mask);//_BIT28
			IoReg_ClearBits(VGIP_Data_Path_Select_reg, VGIP_Data_Path_Select_uzd1_in_sel_mask);	/*path need to change while IP disable*/
			IoReg_SetBits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);	/* HW do not clear this bit, alway turn on, setting will be apply while v_sync*/
// Mac5p fix me
//			IoReg_SetBits(VGIP_VGIP_CHN1_ACT_HSTA_Width_reg, VGIP_VGIP_CHN1_ACT_HSTA_Width_ch1_db_rdy_mask);	/* path double buffer*/
		break;


	}

	return 0;
}

char scalerVIP_PF_BlackDetection(void)
{
	_clues* SmartPic_clue=NULL;
	SmartPic_clue = scaler_GetShare_Memory_SmartPic_Clue_Struct();

	if(SmartPic_clue==NULL){
		return 0;
	}

	unsigned int IWid, ILen, ISTA_H, ISTA_V;
	static unsigned int IWid_LastFrame, ILen_LastFrame, ISTA_H_LastFrame, ISTA_V_LastFrame;
	static unsigned int BBD_Act_X_LastFrame, BBD_Act_Y_LastFrame, BBD_Act_W_LastFrame, BBD_Act_H_LastFrame;
	static unsigned char ISTA_SMF_MEASURED = 0;
	static unsigned int ISTA_H_SMF, ISTA_V_SMF;
	unsigned char SmallShift_TH = 2;
	//unsigned char Detected = 0;
	//IWid = SmartPic_clue->SCALER_DISP_INFO.IphActWid_H;
	//ILen = SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V;
	//ISTA_H = SmartPic_clue->SCALER_DISP_INFO.IpvActSTA_H;
	//ISTA_V = SmartPic_clue->SCALER_DISP_INFO.IpvActSTA_V;


	IWid = SmartPic_clue->SCALER_DISP_INFO.IphActWid_Pre;
	ILen = SmartPic_clue->SCALER_DISP_INFO.IpvActLen_Pre;
	ISTA_H =SmartPic_clue->SCALER_DISP_INFO.IphActSTA_Pre;
	ISTA_V =SmartPic_clue->SCALER_DISP_INFO.IpvActSTA_Pre;



	smartfit_auto_field_RBUS smartfit_auto_field; // 2000
	smartfit_auto_h_boundary_RBUS smartfit_auto_h_boundary; //2004 hin
	smartfit_auto_v_boundary_RBUS smartfit_auto_v_boundary; //2008 vin
	smartfit_auto_r_g_b_margin_RBUS smartfit_auto_r_g_b_margin; //200c TH
	smartfit_auto_adj_RBUS smartfit_auto_adj; // 2010 start
	smartfit_auto_result_vsta_end_RBUS smartfit_auto_result_vsta_end; //2014 result v
	smartfit_auto_result_hsta_end_RBUS smartfit_auto_result_hsta_end; //2018 result h


	smartfit_auto_field.regValue = scaler_rtd_inl(SMARTFIT_AUTO_FIELD_reg);
	smartfit_auto_h_boundary.regValue = scaler_rtd_inl(SMARTFIT_AUTO_H_BOUNDARY_reg);
	smartfit_auto_v_boundary.regValue = scaler_rtd_inl(SMARTFIT_AUTO_V_BOUNDARY_reg);
	smartfit_auto_r_g_b_margin.regValue = scaler_rtd_inl(SMARTFIT_AUTO_R_G_B_MARGIN_reg);


	SmartPic_clue->BlackDetectionInfo.DetectFlag = 0;
	static unsigned int cnt, protect_cnt = 0;

	smartfit_auto_adj.regValue = scaler_rtd_inl(SMARTFIT_AUTO_ADJ_reg);
	if (IWid == IWid_LastFrame && ILen == ILen_LastFrame && ISTA_H == ISTA_H_LastFrame && ISTA_V == ISTA_V_LastFrame) {


		if (smartfit_auto_adj.now_af ==0 ) {
			smartfit_auto_result_vsta_end.regValue = scaler_rtd_inl(SMARTFIT_AUTO_RESULT_VSTA_END_reg);
			smartfit_auto_result_hsta_end.regValue = scaler_rtd_inl(SMARTFIT_AUTO_RESULT_HSTA_END_reg);

			#if 0 /* Debug Log*/
			if (cnt %300 ==0) {
				printk("cnt=%d, IWid_Pre = %d, ILen_Pre = %d\n",cnt, IWid,ILen);
				printk("ISTA_H_Pre = %d, ISTA_V_Pre = %d\n",ISTA_H,ISTA_V);
				printk("x1 = %d, x2 = %d\n",smartfit_auto_result_vsta_end.regValue,smartfit_auto_result_hsta_end.regValue);
				printk("ISTA_H = %d, ISTA_V = %d, IWid = %d, ILen = %d\n", SmartPic_clue->SCALER_DISP_INFO.IpvActSTA_H, SmartPic_clue->SCALER_DISP_INFO.IpvActSTA_V, SmartPic_clue->SCALER_DISP_INFO.IphActWid_H, SmartPic_clue->SCALER_DISP_INFO.IpvActLen_V);
				printk("HTotal = %d, VTotal=%d\n", Scaler_DispGetInputInfo(SLR_INPUT_H_LEN), Scaler_DispGetInputInfo(SLR_INPUT_V_LEN));
				printk("ISTA_H_SMF = %d, ISTA_V_SMF = %d\n",ISTA_H_SMF,ISTA_V_SMF);
			}
			#endif

			/* protection*/
			if (smartfit_auto_result_vsta_end.vx_sta== 0 && smartfit_auto_result_vsta_end.vx_end ==0 && smartfit_auto_result_hsta_end.hx_sta == 0x3fff && smartfit_auto_result_hsta_end.hx_end == 0) {
				SmartPic_clue->BlackDetectionInfo.DetectFlag = 0;
				smartfit_auto_adj.now_af = 1;
				scaler_rtd_outl(SMARTFIT_AUTO_ADJ_reg, smartfit_auto_adj.regValue); // en
			} else {
				if (ISTA_SMF_MEASURED == 0) {
					ISTA_SMF_MEASURED = 1;

					ISTA_H_SMF = smartfit_auto_result_hsta_end.hx_sta;
					ISTA_V_SMF = smartfit_auto_result_vsta_end.vx_sta;

					smartfit_auto_h_boundary.hb_sta = ISTA_H_SMF;
					smartfit_auto_h_boundary.hb_end = (ISTA_H_SMF + IWid-1);
					smartfit_auto_v_boundary.vb_sta = ISTA_V_SMF;
					smartfit_auto_v_boundary.vb_end= (ISTA_V_SMF+ILen-1);
					smartfit_auto_r_g_b_margin.red_nm = 63;
					smartfit_auto_r_g_b_margin.grn_nm = 5;
					smartfit_auto_r_g_b_margin.blu_nm = 63;


				} else {
					/*update BBD result*/
					if (abs(((int)smartfit_auto_result_hsta_end.hx_sta-(int)ISTA_H_SMF)-(int)BBD_Act_X_LastFrame)>SmallShift_TH ||
				            abs(((int)smartfit_auto_result_vsta_end.vx_sta-(int)ISTA_V_SMF)-(int)BBD_Act_Y_LastFrame)>SmallShift_TH ||
				            abs(((int)smartfit_auto_result_hsta_end.hx_end-(int)smartfit_auto_result_hsta_end.hx_sta+1)-(int)BBD_Act_W_LastFrame)>SmallShift_TH ||
				            abs(((int)smartfit_auto_result_vsta_end.vx_end-(int)smartfit_auto_result_vsta_end.vx_sta+1)-(int)BBD_Act_H_LastFrame)>SmallShift_TH) {

						SmartPic_clue->BlackDetectionInfo.DetectFlag = 1;
						SmartPic_clue->BlackDetectionInfo.OriRegion.x = 0;
						SmartPic_clue->BlackDetectionInfo.OriRegion.y = 0;
						SmartPic_clue->BlackDetectionInfo.OriRegion.w = IWid;
						SmartPic_clue->BlackDetectionInfo.OriRegion.h = ILen;

						SmartPic_clue->BlackDetectionInfo.ActRegion.x = smartfit_auto_result_hsta_end.hx_sta-ISTA_H_SMF;
						SmartPic_clue->BlackDetectionInfo.ActRegion.y = smartfit_auto_result_vsta_end.vx_sta-ISTA_V_SMF;
						SmartPic_clue->BlackDetectionInfo.ActRegion.w = (smartfit_auto_result_hsta_end.hx_end-smartfit_auto_result_hsta_end.hx_sta+1);
						SmartPic_clue->BlackDetectionInfo.ActRegion.h = (smartfit_auto_result_vsta_end.vx_end-smartfit_auto_result_vsta_end.vx_sta+1);
						#if 0 /* Debug Log*/
						printk("Difference : xdiff = %d ydiff =%d, wdiff=%d, hdiff=%d\n", abs((int)(smartfit_auto_result_hsta_end.hx_sta-(int)ISTA_H_SMF)-(int)BBD_Act_X_LastFrame),
							abs(((int)smartfit_auto_result_vsta_end.vx_sta-(int)ISTA_V_SMF)-(int)BBD_Act_Y_LastFrame),
							abs(((int)smartfit_auto_result_hsta_end.hx_end-(int)smartfit_auto_result_hsta_end.hx_sta+1)-(int)BBD_Act_W_LastFrame),
							abs(((int)smartfit_auto_result_vsta_end.vx_end-(int)smartfit_auto_result_vsta_end.vx_sta+1)-(int)BBD_Act_H_LastFrame));
						#endif
					}
					/*Set next time detection*/
					smartfit_auto_h_boundary.hb_sta = ISTA_H_SMF;
					smartfit_auto_h_boundary.hb_end = (ISTA_H_SMF + IWid-1);
					smartfit_auto_v_boundary.vb_sta = ISTA_V_SMF;
					smartfit_auto_v_boundary.vb_end= (ISTA_V_SMF+ILen-1);
					smartfit_auto_r_g_b_margin.red_nm = 63;
					smartfit_auto_r_g_b_margin.grn_nm = 5;
					smartfit_auto_r_g_b_margin.blu_nm = 63;

					/*update detection info*/
					BBD_Act_X_LastFrame = smartfit_auto_result_hsta_end.hx_sta-ISTA_H_SMF;
					BBD_Act_Y_LastFrame = smartfit_auto_result_vsta_end.vx_sta-ISTA_V_SMF;
					BBD_Act_W_LastFrame = smartfit_auto_result_hsta_end.hx_end-smartfit_auto_result_hsta_end.hx_sta+1;
					BBD_Act_H_LastFrame = smartfit_auto_result_vsta_end.vx_end-smartfit_auto_result_vsta_end.vx_sta+1;


				}

				smartfit_auto_field.smartfit_src_sel = 1;
				smartfit_auto_field.adj_source = 0;
				scaler_rtd_outl(SMARTFIT_AUTO_FIELD_reg, smartfit_auto_field.regValue);
				scaler_rtd_outl(SMARTFIT_AUTO_H_BOUNDARY_reg, smartfit_auto_h_boundary.regValue);
				scaler_rtd_outl(SMARTFIT_AUTO_V_BOUNDARY_reg, smartfit_auto_v_boundary.regValue);
				scaler_rtd_outl(SMARTFIT_AUTO_R_G_B_MARGIN_reg, smartfit_auto_r_g_b_margin.regValue);

				smartfit_auto_adj.m_vgen_en = 0;
				smartfit_auto_adj.now_af = 1;
				scaler_rtd_outl(SMARTFIT_AUTO_ADJ_reg, smartfit_auto_adj.regValue); // en

			}


		} else {
			protect_cnt++;
			if (protect_cnt%10==0) {
				smartfit_auto_adj.now_af = 0;
				scaler_rtd_outl(SMARTFIT_AUTO_ADJ_reg, smartfit_auto_adj.regValue); // en
				protect_cnt = 0;

				smartfit_auto_adj.now_af = 1;
				scaler_rtd_outl(SMARTFIT_AUTO_ADJ_reg, smartfit_auto_adj.regValue); // en
				//printk("[SMF] AF Time out\n");

			}


		}
	}else {
		smartfit_auto_adj.now_af = 0; // stop
		scaler_rtd_outl(SMARTFIT_AUTO_ADJ_reg, smartfit_auto_adj.regValue); // en

		smartfit_auto_field.smartfit_src_sel = 1;
		smartfit_auto_field.adj_source = 0;
		smartfit_auto_h_boundary.hb_sta = 0;
		smartfit_auto_h_boundary.hb_end = Scaler_DispGetInputInfo(SLR_INPUT_H_LEN)-1;
		smartfit_auto_v_boundary.vb_sta = 0;
		smartfit_auto_v_boundary.vb_end= Scaler_DispGetInputInfo(SLR_INPUT_V_LEN)-1;
		smartfit_auto_r_g_b_margin.red_nm = 4;
		smartfit_auto_r_g_b_margin.grn_nm = 4;
		smartfit_auto_r_g_b_margin.blu_nm = 4;

		scaler_rtd_outl(SMARTFIT_AUTO_FIELD_reg, smartfit_auto_field.regValue);
		scaler_rtd_outl(SMARTFIT_AUTO_H_BOUNDARY_reg, smartfit_auto_h_boundary.regValue);
		scaler_rtd_outl(SMARTFIT_AUTO_V_BOUNDARY_reg, smartfit_auto_v_boundary.regValue);
		scaler_rtd_outl(SMARTFIT_AUTO_R_G_B_MARGIN_reg, smartfit_auto_r_g_b_margin.regValue);

		smartfit_auto_adj.m_vgen_en = 0;
		smartfit_auto_adj.now_af = 1;
		scaler_rtd_outl(SMARTFIT_AUTO_ADJ_reg, smartfit_auto_adj.regValue); // en

		ISTA_SMF_MEASURED = 0;

	}

	IWid_LastFrame = IWid;
	ILen_LastFrame = ILen;
	ISTA_H_LastFrame = ISTA_H;
	ISTA_V_LastFrame = ISTA_V;
	cnt ++;

	return 0;

}


void scalerVIP_Set_BlackDetection_EN(unsigned char bEnable)
{
	BlackDetection_en = bEnable;


}

unsigned char scalerVIP_access_tv002_style_demo_flag(unsigned char access_mode, unsigned char *pFlag)
{
	static unsigned char flag_tv002_style_demo = 0;
	if (access_mode == 0)
		return flag_tv002_style_demo;
	else if (access_mode == 1) {
		if (pFlag != NULL)
			flag_tv002_style_demo = *pFlag;
		else
			return 0;
	}
	return 1;
}

void* scalerVIP_get_tv002_style_demo_struct(void)
{
	extern  SLR_VIP_TABLE_CUSTOM_TV002 m_customVipTable_demo_tv002;

	return (void*)&m_customVipTable_demo_tv002;
}
#if 0
void scalerVIP_Set_ID_Spec_Reg_TV002(SLR_VIP_TABLE* ShareMem_VIP_TBL, _RPC_system_setting_info* RPC_system_infoTBL, _system_setting_info* system_infoTBL, _clues* SmartPic_clue, unsigned int MA_print_count)
{
	extern unsigned char ID_TV002_Flag[ID_ITEM_TV002_MAX];
	extern DRV_di_smd_table_t gSMDtable[7];

	short tmp;
	unsigned char vip_src = RPC_system_infoTBL->VIP_source;
	unsigned char  SMD_TBL_Sel = ShareMem_VIP_TBL->VIP_QUALITY_Coef[vip_src][VIP_QUALITY_FUNCTION_DI_SMD_Level];
	static unsigned char pre_ID_status_SMD = 0xFF, pre_ID_status_MA_mode = 0xFF;

	di_di_smd_pan1_RBUS init_di_smd_pan1_reg;
	di_di_smd_hardwarepan_modify1_RBUS di_di_smd_hardwarepan_modify1;
	di_di_smd_gmvcoeff3_RBUS init_di_smd_gmvcoeff3_reg;
	di_di_smd_control_candidatelist_RBUS init_smd_control_candidatelist_reg;
	di_di_smd_choosecandidate_RBUS 	smd_choosecandidate_reg;
	di_im_new_mcnr_pan_condition_RBUS di_im_new_mcnr_pan_condition;
	di_im_new_mcnr_control4_RBUS di_im_new_mcnr_control4;
	di_di_smd_additionalcoeff1_RBUS init_di_smd_additionalcoeff1_reg;
	di_im_di_control_RBUS di_control_reg;

#if 1	/* spec SMD setting */
	if((ID_TV002_Flag[ID_MovingClockTower_TV002] != 0xFF) || (ID_TV002_Flag[ID_WaterfallStair_TV002] != 0xFF)) {

		init_di_smd_pan1_reg.regValue = rtd_inl(DI_DI_SMD_Pan1_reg);
		di_di_smd_hardwarepan_modify1.regValue = rtd_inl(DI_DI_SMD_HardwarePan_Modify1_reg);
		init_di_smd_gmvcoeff3_reg.regValue = rtd_inl(DI_DI_SMD_GMVCoeff3_reg);
		init_smd_control_candidatelist_reg.regValue = rtd_inl(DI_DI_SMD_Control_CandidateList_reg);
		smd_choosecandidate_reg.regValue = rtd_inl(DI_DI_SMD_ChooseCandidate_reg);
		di_im_new_mcnr_pan_condition.regValue = rtd_inl(DI_IM_NEW_MCNR_PAN_CONDITION_reg);
		di_im_new_mcnr_control4.regValue = rtd_inl(DI_IM_NEW_MCNR_CONTROL4_reg);
		init_di_smd_additionalcoeff1_reg.regValue = rtd_inl(DI_DI_SMD_AdditionalCoeff1_reg);

		if (ID_TV002_Flag[ID_MovingPTG_Mono_TV002] == 1) {
			if (pre_ID_status_SMD != ID_MovingPTG_Mono_TV002) {
				pre_ID_status_SMD = ID_MovingPTG_Mono_TV002;
				init_di_smd_pan1_reg.smd_apply_result_mode = 3;
				init_di_smd_pan1_reg.smd_firmware_pan = 1;
				init_di_smd_pan1_reg.smd_searchmv_apply = 0;
				init_di_smd_pan1_reg.smd_hardware_pan_en = 0;
				init_di_smd_pan1_reg.smd_firmware_pan_sad_th = 0;

				di_di_smd_hardwarepan_modify1.smd_firmwarepan_sadmax = 200;

				init_smd_control_candidatelist_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 0;

				init_di_smd_additionalcoeff1_reg.smd_result_en = gSMDtable[SMD_TBL_Sel].smd_additionalcoeff.result_en;

				rtd_outl(DI_DI_SMD_Pan1_reg, init_di_smd_pan1_reg.regValue);
				rtd_outl(DI_DI_SMD_HardwarePan_Modify1_reg, di_di_smd_hardwarepan_modify1.regValue);
				rtd_outl(DI_DI_SMD_Control_CandidateList_reg, init_smd_control_candidatelist_reg.regValue);
				rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
				rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);

			}

			tmp = ((di_im_new_mcnr_pan_condition.h_pan_mv_value-10)*(-1))/2+ 3;
			init_di_smd_gmvcoeff3_reg.smd_firmwaremv_x = (tmp>6)?(6):((tmp<0)?(0):(tmp));
			tmp = (di_im_new_mcnr_control4.n_mcnr_v_pan_mv-3)*(-1)+3;
			init_di_smd_gmvcoeff3_reg.smd_firmwaremv_y = (tmp>6)?(6):((tmp<0)?(0):(tmp));
			rtd_outl(DI_DI_SMD_GMVCoeff3_reg, init_di_smd_gmvcoeff3_reg.regValue);
			rtd_setbits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);
		} else if (ID_TV002_Flag[ID_MovingClockTower_TV002] == 1) {
			if (pre_ID_status_SMD != ID_MovingClockTower_TV002) {
				pre_ID_status_SMD = ID_MovingClockTower_TV002;
				init_di_smd_pan1_reg.smd_apply_result_mode = gSMDtable[SMD_TBL_Sel].smd_pan.apply_result_mode;
				init_di_smd_pan1_reg.smd_firmware_pan = 1;
				init_di_smd_pan1_reg.smd_searchmv_apply = 0;
				init_di_smd_pan1_reg.smd_hardware_pan_en = 0;
				init_di_smd_pan1_reg.smd_firmware_pan_sad_th = 0;

				di_di_smd_hardwarepan_modify1.smd_firmwarepan_sadmax = 200;

				init_di_smd_gmvcoeff3_reg.smd_firmwaremv_x = 3;
				init_di_smd_gmvcoeff3_reg.smd_firmwaremv_y = 1;

				init_smd_control_candidatelist_reg.smd_upperbound_sad_forjudgemv = 200;
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 50;

				init_di_smd_additionalcoeff1_reg.smd_result_en = gSMDtable[SMD_TBL_Sel].smd_additionalcoeff.result_en;

				rtd_outl(DI_DI_SMD_Pan1_reg, init_di_smd_pan1_reg.regValue);
				rtd_outl(DI_DI_SMD_HardwarePan_Modify1_reg, di_di_smd_hardwarepan_modify1.regValue);
				rtd_outl(DI_DI_SMD_Control_CandidateList_reg, init_smd_control_candidatelist_reg.regValue);
				rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
				rtd_outl(DI_DI_SMD_GMVCoeff3_reg, init_di_smd_gmvcoeff3_reg.regValue);
				rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);
				rtd_setbits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);
			}
		} else if (ID_TV002_Flag[ID_WaterfallStair_TV002] == 1) {
			if (pre_ID_status_SMD != ID_WaterfallStair_TV002) {
				pre_ID_status_SMD = ID_WaterfallStair_TV002;
				init_di_smd_pan1_reg.smd_apply_result_mode = gSMDtable[SMD_TBL_Sel].smd_pan.apply_result_mode;
				init_di_smd_pan1_reg.smd_firmware_pan = gSMDtable[SMD_TBL_Sel].smd_pan.firmware_pan;
				init_di_smd_pan1_reg.smd_searchmv_apply = gSMDtable[SMD_TBL_Sel].smd_pan.searchmv_apply;
				init_di_smd_pan1_reg.smd_hardware_pan_en = gSMDtable[SMD_TBL_Sel].smd_pan.hardware_pan_en;
				init_di_smd_pan1_reg.smd_firmware_pan_sad_th = gSMDtable[SMD_TBL_Sel].smd_pan.firmware_pan_sad_th;

				di_di_smd_hardwarepan_modify1.smd_firmwarepan_sadmax = gSMDtable[SMD_TBL_Sel].Smd_Pan_modify.smd_firmwarepan_sadmax;

				init_di_smd_gmvcoeff3_reg.smd_firmwaremv_x = gSMDtable[SMD_TBL_Sel].smd_gmvcoeff3.mv_x;
				init_di_smd_gmvcoeff3_reg.smd_firmwaremv_y = gSMDtable[SMD_TBL_Sel].smd_gmvcoeff3.mv_y;

				init_smd_control_candidatelist_reg.smd_upperbound_sad_forjudgemv = gSMDtable[SMD_TBL_Sel].smd_control.upperbound_sad;
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 125;	/* ori setting is in VP_init()*/

				init_di_smd_additionalcoeff1_reg.smd_result_en = 0;

				rtd_outl(DI_DI_SMD_Pan1_reg, init_di_smd_pan1_reg.regValue);
				rtd_outl(DI_DI_SMD_HardwarePan_Modify1_reg, di_di_smd_hardwarepan_modify1.regValue);
				rtd_outl(DI_DI_SMD_Control_CandidateList_reg, init_smd_control_candidatelist_reg.regValue);
				rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
				rtd_outl(DI_DI_SMD_GMVCoeff3_reg, init_di_smd_gmvcoeff3_reg.regValue);
				rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);
				rtd_setbits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);
			}
		} else {
			if (pre_ID_status_SMD != ID_ITEM_TV002_MAX) {
				pre_ID_status_SMD = ID_ITEM_TV002_MAX;
				init_di_smd_pan1_reg.smd_apply_result_mode = gSMDtable[SMD_TBL_Sel].smd_pan.apply_result_mode;
				init_di_smd_pan1_reg.smd_firmware_pan = gSMDtable[SMD_TBL_Sel].smd_pan.firmware_pan;
				init_di_smd_pan1_reg.smd_searchmv_apply = gSMDtable[SMD_TBL_Sel].smd_pan.searchmv_apply;
				init_di_smd_pan1_reg.smd_hardware_pan_en = gSMDtable[SMD_TBL_Sel].smd_pan.hardware_pan_en;
				init_di_smd_pan1_reg.smd_firmware_pan_sad_th = gSMDtable[SMD_TBL_Sel].smd_pan.firmware_pan_sad_th;

				di_di_smd_hardwarepan_modify1.smd_firmwarepan_sadmax = gSMDtable[SMD_TBL_Sel].Smd_Pan_modify.smd_firmwarepan_sadmax;

				init_di_smd_gmvcoeff3_reg.smd_firmwaremv_x = gSMDtable[SMD_TBL_Sel].smd_gmvcoeff3.mv_x;
				init_di_smd_gmvcoeff3_reg.smd_firmwaremv_y = gSMDtable[SMD_TBL_Sel].smd_gmvcoeff3.mv_y;

				init_smd_control_candidatelist_reg.smd_upperbound_sad_forjudgemv = gSMDtable[SMD_TBL_Sel].smd_control.upperbound_sad;
				smd_choosecandidate_reg.smd_reliablerange_sad_th = 125;	/* ori setting is in VP_init()*/

				init_di_smd_additionalcoeff1_reg.smd_result_en = gSMDtable[SMD_TBL_Sel].smd_additionalcoeff.result_en;

				rtd_outl(DI_DI_SMD_Pan1_reg, init_di_smd_pan1_reg.regValue);
				rtd_outl(DI_DI_SMD_HardwarePan_Modify1_reg, di_di_smd_hardwarepan_modify1.regValue);
				rtd_outl(DI_DI_SMD_Control_CandidateList_reg, init_smd_control_candidatelist_reg.regValue);
				rtd_outl(DI_DI_SMD_ChooseCandidate_reg, smd_choosecandidate_reg.regValue);
				rtd_outl(DI_DI_SMD_GMVCoeff3_reg, init_di_smd_gmvcoeff3_reg.regValue);
				rtd_outl(DI_DI_SMD_AdditionalCoeff1_reg, init_di_smd_additionalcoeff1_reg.regValue);
				rtd_setbits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);
			}
		}
	}
#endif

#if 1	/* DI intra,weave*/
	if((ID_TV002_Flag[ID_MovingCircle_TV002] != 0xFF)) {
		di_control_reg.regValue = rtd_inl(DI_IM_DI_CONTROL_reg);
		if (ID_TV002_Flag[ID_MovingCircle_TV002] == 1) {
			if (pre_ID_status_MA_mode != ID_MovingCircle_TV002) {
				pre_ID_status_MA_mode = ID_MovingCircle_TV002;
				di_control_reg.ma_controlmode = 2;
				di_control_reg.write_enable_0 = 1;
				rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);
				rtd_setbits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);
			}
		} else {
			if (pre_ID_status_MA_mode != ID_ITEM_TV002_MAX) {
				pre_ID_status_MA_mode = ID_ITEM_TV002_MAX;
				di_control_reg.ma_controlmode = 1;
				di_control_reg.write_enable_0 = 1;
				rtd_outl(DI_IM_DI_CONTROL_reg, di_control_reg.regValue);
				rtd_setbits(DI_db_reg_ctl_reg, DI_db_reg_ctl_db_apply_mask);
			}
		}
	}

#endif
	/* debug log*/
	unsigned int print_flag = system_infoTBL->ISR_Printf_Flag.TV002_Flag;
	unsigned int print_delay = system_infoTBL->ISR_Printf_Flag.Delay_Time;
	if((print_flag&_BIT8) != 0)
	{	if((MA_print_count%print_delay)==0)
			printk("app reg,st=%d,%d\n",pre_ID_status_SMD, pre_ID_status_MA_mode);
	}

}
#endif
extern void Scaler_recheck_sharpness_table(void);
void scalerVIP_VO_resolution_change_hack(void)
{
	if (system_info_structure_table == NULL)
		return;

	if (system_info_structure_table->Input_src_Form != _SRC_FROM_VO)
		return;

	static unsigned char mode_pre = 0xff;
	unsigned char mode = Scaler_DispGetInputInfo(SLR_INPUT_MODE_CURR);

	if (mode_pre != mode)
		Scaler_recheck_sharpness_table();

	mode_pre = mode;
}

void scalerVIP_SNR_3x3_Block_Hist_Calculate(_system_setting_info* system_info_structure_table, _clues* SmartPic_clue)
{
	nr_maxmin_histogram_data_0_RBUS reg_nr_maxmin_histogram_data_0_RBUS;
	nr_maxmin_histogram_data_1_RBUS reg_nr_maxmin_histogram_data_1_RBUS;

 	unsigned int maxmin_hist0, maxmin_hist1, maxmin_hist2, maxmin_hist3, Total;

	reg_nr_maxmin_histogram_data_0_RBUS.regValue = rtd_inl(NR_MAXMIN_HISTOGRAM_DATA_0_reg);
	reg_nr_maxmin_histogram_data_1_RBUS.regValue = rtd_inl(NR_MAXMIN_HISTOGRAM_DATA_1_reg);

	maxmin_hist0 = reg_nr_maxmin_histogram_data_0_RBUS.maxmin_hist0;
	maxmin_hist1 = reg_nr_maxmin_histogram_data_0_RBUS.maxmin_hist1;
	maxmin_hist2 = reg_nr_maxmin_histogram_data_1_RBUS.maxmin_hist2;
	maxmin_hist3 = reg_nr_maxmin_histogram_data_1_RBUS.maxmin_hist3;

	Total = maxmin_hist0 + maxmin_hist1 + maxmin_hist2 + maxmin_hist3;

	SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y[0] = maxmin_hist0;
	SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y[1] = maxmin_hist1;
	SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y[2] = maxmin_hist2;
	SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y[3] = maxmin_hist3;

	if (Total == 0)
		Total = 1;
	SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y_ratio[0] = maxmin_hist0 * 1000 / Total;
	SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y_ratio[1] = maxmin_hist1 * 1000  / Total;
	SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y_ratio[2] = maxmin_hist2 * 1000  / Total;
	SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y_ratio[3] = maxmin_hist3 * 1000  / Total;
#if 0
	if (MA_print_count%100==0)
		ROSPrintf("~%d,%d,%d,%d,%d,%d,%d,%d,~\n", SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y[0], SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y[1],
		SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y[2],SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y[3], SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y_ratio[0],
		SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y_ratio[1],SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y_ratio[2],
		SmartPic_clue->SNR_3x3_Block_Hist_INFO.Counter_Y_ratio[3])
#endif
}

